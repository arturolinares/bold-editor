!function(){var Ajax={};Ajax.settings={},Ajax.post=function(a){return new AjaxRequest("post",a)},Ajax.get=function(a){return new AjaxRequest("get",a)};var AjaxRequest=function(a,b){var c={method:a,url:"",before:function(){},success:function(){},error:function(){},data:!1,async:!0,headers:{}};this.p=this.extend(c,b),this.p=this.extend(this.p,Ajax.settings),this.p.method=this.p.method.toUpperCase(),this.prepareData(),this.xhr=new XMLHttpRequest,this.xhr.open(this.p.method,this.p.url,this.p.async),this.setHeaders(),!1!==("function"!=typeof this.p.before||this.p.before(this.xhr))&&this.send()};AjaxRequest.prototype={extend:function(a,b){if(b)for(var c in b)a[c]=b[c];return a},prepareData:function(){"POST"!==this.p.method||this.isFormData()||(this.p.headers["Content-Type"]="application/x-www-form-urlencoded"),"object"!=typeof this.p.data||this.isFormData()||(this.p.data=this.toParams(this.p.data)),"GET"===this.p.method&&(this.p.url=this.p.data?this.p.url+"?"+this.p.data:this.p.url)},setHeaders:function(){this.xhr.setRequestHeader("X-Requested-With",this.p.headers["X-Requested-With"]||"XMLHttpRequest");for(var a in this.p.headers)this.xhr.setRequestHeader(a,this.p.headers[a])},isFormData:function(){return void 0!==window.FormData&&this.p.data instanceof window.FormData},isComplete:function(){return!(this.xhr.status<200||this.xhr.status>=300&&304!==this.xhr.status)},send:function(){this.p.async?(this.xhr.onload=this.loaded.bind(this),this.xhr.send(this.p.data)):(this.xhr.send(this.p.data),this.loaded.call(this))},loaded:function(){if(this.isComplete()){var a=this.xhr.response,b=this.parseJson(a);a=b||a,"function"==typeof this.p.success&&this.p.success(a,this.xhr)}else"function"==typeof this.p.error&&this.p.error(this.xhr.statusText)},parseJson:function(a){try{var b=JSON.parse(a);if(b&&"object"==typeof b)return b}catch(a){}return!1},toParams:function(a){return Object.keys(a).map(function(b){return encodeURIComponent(b)+"="+encodeURIComponent(a[b])}).join("&")}};var DomCache=[0],DomExpando="data"+(new Date).getTime(),DomHClass="is-hidden",DomHMClass="is-hidden-mobile",Dom=function(a,b){return this.parse(a,b)};Dom.ready=function(a){"loading"!=document.readyState?a():document.addEventListener("DOMContentLoaded",a)},Dom.prototype={get sdom(){return!0},get length(){return this.nodes.length},parse:function(a,b){var c,d=/^\s*<(\w+|!)[^>]*>/;if(a){if(a.sdom)return this.nodes=a.nodes,a;c="string"!=typeof a?a.nodeType&&11===a.nodeType?a.childNodes:a.nodeType||a===window?[a]:a:d.test(a)?this.create(a):this._query(a,b)}else c=[];this.nodes=this._slice(c)},create:function(a){if(/^<(\w+)\s*\/?>(?:<\/\1>|)$/.test(a))return[document.createElement(RegExp.$1)];var b=[],c=document.createElement("div"),d=c.childNodes;c.innerHTML=a;for(var e=0,f=d.length;e<f;e++)b.push(d[e]);return b},add:function(a){this.nodes=this.nodes.concat(this._toArray(a))},get:function(a){return this.nodes[a||0]||!1},getAll:function(){return this.nodes},eq:function(a){return new Dom(this.nodes[a])},first:function(){return new Dom(this.nodes[0])},last:function(){return new Dom(this.nodes[this.nodes.length-1])},contents:function(){return this.get().childNodes},each:function(a){for(var b=this.nodes.length,c=0;c<b;c++)a.call(this,this.nodes[c].sdom?this.nodes[c].get():this.nodes[c],c);return this},is:function(a){return this.filter(a).length>0},filter:function(a){var b;return void 0===a?this:(b="function"==typeof a?a:function(b){return a instanceof Node?a===b:a&&a.sdom?-1!==a.nodes.indexOf(b):(b.matches=b.matches||b.msMatchesSelector||b.webkitMatchesSelector,1===b.nodeType&&b.matches(a||"*"))},new Dom(this.nodes.filter(b)))},not:function(a){return this.filter(function(b){return!new Dom(b).is(a||!0)})},find:function(a){var b=[];return this.each(function(c){for(var d=this._query(a||"*",c),e=0;e<d.length;e++)b.push(d[e])}),new Dom(b)},children:function(a){var b=[];return this.each(function(a){if(a.children)for(var c=a.children,d=0;d<c.length;d++)b.push(c[d])}),new Dom(b).filter(a)},parent:function(a){var b=[];return this.each(function(a){a.parentNode&&b.push(a.parentNode)}),new Dom(b).filter(a)},parents:function(a,b){b=this._getContext(b);var c=[];return this.each(function(d){for(var e=d.parentNode;e&&e!==b;)a?new Dom(e).is(a)&&c.push(e):c.push(e),e=e.parentNode}),new Dom(c)},closest:function(a,b){b=this._getContext(b),a=a.sdom?a.get():a;var c=[],d=a&&a.nodeType;return this.each(function(e){do{if(d&&e===a||new Dom(e).is(a))return c.push(e)}while((e=e.parentNode)&&e!==b)}),new Dom(c)},next:function(a){return this._getSibling(a,"nextSibling")},nextElement:function(a){return this._getSibling(a,"nextElementSibling")},prev:function(a){return this._getSibling(a,"previousSibling")},prevElement:function(a){return this._getSibling(a,"previousElementSibling")},css:function(a,b){if(void 0===b&&"object"!=typeof a){var c=this.get();return"width"===a||"height"===a?c.style?this._getHeightOrWidth(a,c,!1)+"px":void 0:c.style?getComputedStyle(c,null)[a]:void 0}return this.each(function(c){var d={};"object"==typeof a?d=a:d[a]=b;for(var e in d)c.style&&(c.style[e]=d[e])})},attr:function(a,b,c){if(c=c?"data-":"",void 0===b&&"object"!=typeof a){var d=this.get();return d&&3!==d.nodeType?"checked"===a?d.checked:this._getBooleanFromStr(d.getAttribute(c+a)):void 0}return this.each(function(d){var e={};"object"==typeof a?e=a:e[a]=b;for(var f in e)3!==d.nodeType&&("checked"===f?d.checked=e[f]:d.setAttribute(c+f,e[f]))})},data:function(a,b){if(void 0===a){var c=/^data\-(.+)$/,d=this.get().attributes,e={},f=function(a){return a[1].toUpperCase()};for(var g in d)if(d[g]&&c.test(d[g].nodeName)){var h=d[g].nodeName.match(c)[1],i=d[g].value;h=h.replace(/-([a-z])/g,f),i=this._isObjectString(i)?this._toObject(i):this._isNumber(i)?parseFloat(i):this._getBooleanFromStr(i),e[h]=i}return e}return this.attr(a,b,!0)},val:function(a){if(void 0===a){var b=this.get();return b.type&&"checkbox"===b.type?b.checked:b.value}return this.each(function(b){b.value=a})},removeAttr:function(a){return this.each(function(b){var c=function(a){3!==b.nodeType&&b.removeAttribute(a)};a.split(" ").forEach(c)})},removeData:function(a){return this.each(function(b){var c=function(a){3!==b.nodeType&&b.removeAttribute("data-"+a)};a.split(" ").forEach(c)})},dataset:function(a,b){return this.each(function(c){DomCache[this.dataindex(c)][a]=b})},dataget:function(a){return DomCache[this.dataindex(this.get())][a]},dataindex:function(a){var b=a[DomExpando],c=DomCache.length;return b||(b=a[DomExpando]=c,DomCache[b]={}),b},addClass:function(a){return this._eachClass(a,"add")},removeClass:function(a){return this._eachClass(a,"remove")},toggleClass:function(a){return this._eachClass(a,"toggle")},hasClass:function(a){return this.nodes.some(function(b){return!!b.classList&&b.classList.contains(a)})},empty:function(){return this.each(function(a){a.innerHTML=""})},html:function(a){return void 0===a?this.get().innerHTML||"":this.empty().append(a)},text:function(a){return void 0===a?this.get().textContent||"":this.each(function(b){b.textContent=a})},after:function(a){return this._inject(a,function(a,b){if("string"==typeof a)b.insertAdjacentHTML("afterend",a);else for(var c=a instanceof Node?[a]:this._toArray(a).reverse(),d=0;d<c.length;d++)b.parentNode.insertBefore(c[d],b.nextSibling);return b})},before:function(a){return this._inject(a,function(a,b){if("string"==typeof a)b.insertAdjacentHTML("beforebegin",a);else for(var c=a instanceof Node?[a]:this._toArray(a),d=0;d<c.length;d++)b.parentNode.insertBefore(c[d],b);return b})},append:function(a){return this._inject(a,function(a,b){if("string"==typeof a||"number"==typeof a)b.insertAdjacentHTML("beforeend",a);else for(var c=a instanceof Node?[a]:this._toArray(a),d=0;d<c.length;d++)b.appendChild(c[d]);return b})},prepend:function(a){return this._inject(a,function(a,b){if("string"==typeof a||"number"==typeof a)b.insertAdjacentHTML("afterbegin",a);else for(var c=a instanceof Node?[a]:this._toArray(a).reverse(),d=0;d<c.length;d++)b.insertBefore(c[d],b.firstChild);return b})},wrap:function(a){return this._inject(a,function(a,b){var c="string"==typeof a||"number"==typeof a?this.create(a)[0]:a instanceof Node?a:this._toArray(a)[0];return b.parentNode&&b.parentNode.insertBefore(c,b),c.appendChild(b),new Dom(c)})},unwrap:function(){return this.each(function(a){var b=new Dom(a);return b.replaceWith(b.contents())})},replaceWith:function(a){return this._inject(a,function(a,b){for(var c=document.createDocumentFragment(),d="string"==typeof a||"number"==typeof a?this.create(a):a instanceof Node?[a]:this._toArray(a),e=0;e<d.length;e++)c.appendChild(d[e]);var f=c.childNodes[0];return b.parentNode.replaceChild(c,b),f})},remove:function(){return this.each(function(a){a.parentNode&&a.parentNode.removeChild(a)})},clone:function(a){var b=[];return this.each(function(c){var d=this._clone(c);a&&(d=this._cloneEvents(c,d)),b.push(d)}),new Dom(b)},show:function(){return this.each(function(a){if(a.style&&this._hasDisplayNone(a)){var b,c=a.getAttribute("domTargetShow"),d=!!a.classList&&a.classList.contains(DomHClass),e=!!a.classList&&a.classList.contains(DomHMClass);d?(b=DomHClass,a.classList.remove(DomHClass)):e?(b=DomHMClass,a.classList.remove(DomHMClass)):a.style.display=c||"block",b&&a.setAttribute("domTargetHide",b),a.removeAttribute("domTargetShow")}}.bind(this))},hide:function(){return this.each(function(a){if(a.style&&!this._hasDisplayNone(a)){var b=a.style.display,c=a.getAttribute("domTargetHide");c===DomHClass?a.classList.add(DomHClass):c===DomHMClass?a.classList.add(DomHMClass):("block"!==b&&a.setAttribute("domTargetShow",b),a.style.display="none"),a.removeAttribute("domTargetHide")}})},scrollTop:function(a){var b=this.get(),c=b===window,d=9===b.nodeType,e=d?document.scrollingElement||document.body.parentNode||document.body||document.documentElement:b;return void 0!==a?void(c?window.scrollTo(0,a):e.scrollTop=a):d?void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0:c?window.pageYOffset:e.scrollTop},offset:function(){return this._getDim("Offset")},position:function(){return this._getDim("Position")},width:function(a,b){return this._getSize("width","Width",a,b)},height:function(a,b){return this._getSize("height","Height",a,b)},outerWidth:function(){return this._getInnerOrOuter("width","outer")},outerHeight:function(){return this._getInnerOrOuter("height","outer")},innerWidth:function(){return this._getInnerOrOuter("width","inner")},innerHeight:function(){return this._getInnerOrOuter("height","inner")},click:function(){return this._triggerEvent("click")},focus:function(){return this._triggerEvent("focus")},trigger:function(a){return this.each(function(b){for(var c=a.split(" "),d=0;d<c.length;d++){var e,f={bubbles:!0,cancelable:!0};try{e=new window.CustomEvent(c[d],f)}catch(a){e=document.createEvent("CustomEvent"),e.initCustomEvent(c[d],!0,!0)}b.dispatchEvent(e)}})},on:function(a,b,c){return this.each(function(d){for(var e=a.split(" "),f=0;f<e.length;f++){var g=this._getEventName(e[f]),h=this._getEventNamespace(e[f]);b=c?this._getOneHandler(b,a):b,d.addEventListener(g,b),d._e=d._e||{},d._e[h]=d._e[h]||{},d._e[h][g]=d._e[h][g]||[],d._e[h][g].push(b)}})},one:function(a,b){return this.on(a,b,!0)},off:function(a,b){var c=function(a,b,c){return a===c},d=function(a,b,c,d){return b===d},e=function(a,b,c,d){return a===c&&b===d},f=function(){return!0};return void 0===a?this.each(function(a){this._offEvent(a,!1,!1,b,f)}):this.each(function(f){for(var g=a.split(" "),h=0;h<g.length;h++){var i=this._getEventName(g[h]),j=this._getEventNamespace(g[h]);"_events"===j?this._offEvent(f,i,j,b,c):i||"_events"===j?this._offEvent(f,i,j,b,e):this._offEvent(f,i,j,b,d)}})},serialize:function(a){for(var b={},c=this.get().elements,d=0;d<c.length;d++){var e=c[d];if((!/(checkbox|radio)/.test(e.type)||e.checked)&&(e.name&&!e.disabled&&"file"!==e.type)){if("select-multiple"===e.type)for(var f=0;f<e.options.length;f++){var g=e.options[f];g.selected&&(b[e.name]=g.value)}b[e.name]=this._isNumber(e.value)?parseFloat(e.value):this._getBooleanFromStr(e.value)}}return a?b:this._toParams(b)},ajax:function(a,b){if(void 0!==AjaxRequest){var c=this.attr("method")||"post",d={url:this.attr("action"),data:this.serialize(),success:a,error:b};return new AjaxRequest(c,d)}},_queryContext:function(a,b){return b=this._getContext(b),3!==b.nodeType&&"function"==typeof b.querySelectorAll?b.querySelectorAll(a):[]},_query:function(a,b){if(b)return this._queryContext(a,b);if(/^[.#]?[\w-]*$/.test(a)){if("#"===a[0]){var c=document.getElementById(a.slice(1));return c?[c]:[]}return"."===a[0]?document.getElementsByClassName(a.slice(1)):document.getElementsByTagName(a)}return document.querySelectorAll(a)},_getContext:function(a){return a="string"==typeof a?document.querySelector(a):a,a&&a.sdom?a.get():a||document},_inject:function(a,b){for(var c=this.nodes.length,d=[];c--;){var e="function"==typeof a?a.call(this,this.nodes[c]):a,f=0===c?e:this._clone(e),g=b.call(this,f,this.nodes[c]);g&&(g.sdom?d.push(g.get()):d.push(g))}return new Dom(d)},_cloneEvents:function(a,b){var c=a._e;if(c){b._e=c;for(var d in c._events)for(var e=0;e<c._events[d].length;e++)b.addEventListener(d,c._events[d][e])}return b},_clone:function(a){if(void 0!==a)return"string"==typeof a?a:a instanceof Node||a.nodeType?a.cloneNode(!0):"length"in a?[].map.call(this._toArray(a),function(a){return a.cloneNode(!0)}):void 0},_slice:function(a){return a&&0!==a.length?a.length?[].slice.call(a.nodes||a):[a]:[]},_eachClass:function(a,b){return this.each(function(c){if(a){var d=function(a){c.classList&&c.classList[b](a)};a.split(" ").forEach(d)}})},_triggerEvent:function(a){var b=this.get();return b&&3!==b.nodeType&&b[a](),this},_getOneHandler:function(a,b){var c=this;return function(){a.apply(this,arguments),c.off(b)}},_getEventNamespace:function(a){var b=a.split("."),c=b[1]?b[1]:"_events";return b[2]?c+b[2]:c},_getEventName:function(a){return a.split(".")[0]},_offEvent:function(a,b,c,d,e){for(var f in a._e)for(var g in a._e[f])if(e(g,f,b,c))for(var h=a._e[f][g],i=0;i<h.length;i++)void 0!==d&&h[i].toString()!==d.toString()||(a.removeEventListener(g,h[i]),a._e[f][g].splice(i,1),0===a._e[f][g].length&&delete a._e[f][g],0===Object.keys(a._e[f]).length&&delete a._e[f])},_getInnerOrOuter:function(a,b){return this[a](void 0,b)},_getDocSize:function(a,b){var c=a.body,d=a.documentElement;return Math.max(c["scroll"+b],c["offset"+b],d["client"+b],d["scroll"+b],d["offset"+b])},_getSize:function(a,b,c,d){if(void 0===c){var e=this.get();return c=3===e.nodeType?0:9===e.nodeType?this._getDocSize(e,b):e===window?window["inner"+b]:this._getHeightOrWidth(a,e,d||"normal"),Math.round(c)}return this.each(function(b){c=parseFloat(c),c+=this._adjustResultHeightOrWidth(a,b,d||"normal"),new Dom(b).css(a,c+"px")}.bind(this))},_getHeightOrWidth:function(a,b,c){if(!b)return 0;var d=a.charAt(0).toUpperCase()+a.slice(1),e=0,f=getComputedStyle(b,null),g=new Dom(b),h=g.parents().filter(function(a){return 1===a.nodeType&&"none"===getComputedStyle(a,null).display&&a});if("none"===f.display&&h.add(b),0!==h.length){var i="visibility: hidden !important; display: block !important;",j=[];h.each(function(a){var b=new Dom(a),c=b.attr("style");null!==c&&j.push(c),b.attr("style",null!==c?c+";"+i:i)}),e=g.get()["offset"+d]-this._adjustResultHeightOrWidth(a,b,c),h.each(function(a,b){var c=new Dom(a);void 0===j[b]?c.removeAttr("style"):c.attr("style",j[b])})}else e=b["offset"+d]-this._adjustResultHeightOrWidth(a,b,c);return e},_adjustResultHeightOrWidth:function(a,b,c){if(!b||!1===c)return 0;var d=0,e=getComputedStyle(b,null),f="border-box"===e.boxSizing;return"height"===a?(("inner"===c||"normal"===c&&f)&&(d+=(parseFloat(e.borderTopWidth)||0)+(parseFloat(e.borderBottomWidth)||0)),"outer"===c&&(d-=(parseFloat(e.marginTop)||0)+(parseFloat(e.marginBottom)||0))):(("inner"===c||"normal"===c&&f)&&(d+=(parseFloat(e.borderLeftWidth)||0)+(parseFloat(e.borderRightWidth)||0)),"outer"===c&&(d-=(parseFloat(e.marginLeft)||0)+(parseFloat(e.marginRight)||0))),d},_getDim:function(a){var b=this.get();return 3===b.nodeType?{top:0,left:0}:this["_get"+a](b)},_getPosition:function(a){return{top:a.offsetTop,left:a.offsetLeft}},_getOffset:function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.documentElement,e=c.defaultView;return{top:b.top+e.pageYOffset-d.clientTop,left:b.left+e.pageXOffset-d.clientLeft}},_getSibling:function(a,b){a=a&&a.sdom?a.get():a;var c,d=a&&a.nodeType;return this.each(function(e){for(;e=e[b];)if(d&&e===a||new Dom(e).is(a))return void(c=e)}),new Dom(c)},_toArray:function(a){if(a instanceof NodeList){for(var b=[],c=0;c<a.length;c++)b[c]=a[c];return b}return void 0===a?[]:a.sdom?a.nodes:a},_toParams:function(a){var b="";for(var c in a)b+="&"+this._encodeUri(c)+"="+this._encodeUri(a[c]);return b.replace(/^&/,"")},_toObject:function(a){return new Function("return "+a)()},_encodeUri:function(a){return encodeURIComponent(a).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},_isNumber:function(a){return!isNaN(a)&&!isNaN(parseFloat(a))},_isObjectString:function(a){return-1!==a.search(/^{/)},_getBooleanFromStr:function(a){return"true"===a||"false"!==a&&a},_hasDisplayNone:function(a){return"none"===a.style.display||"none"===(a.currentStyle?a.currentStyle.display:getComputedStyle(a,null).display)}};var uuid=0,$R=function(a,b){return RedactorApp(a,b,[].slice.call(arguments,2))};$R.app=[],$R.version="3.3.5",$R.options={},$R.modules={},$R.services={},$R.classes={},$R.plugins={},$R.mixins={},$R.modals={},$R.lang={},$R.dom=function(a,b){return new Dom(a,b)},$R.ajax=Ajax,$R.Dom=Dom,$R.keycodes={BACKSPACE:8,DELETE:46,UP:38,DOWN:40,ENTER:13,SPACE:32,ESC:27,TAB:9,CTRL:17,META:91,SHIFT:16,ALT:18,RIGHT:39,LEFT:37},$R.env={plugin:"plugins",module:"modules",service:"services",class:"classes",mixin:"mixins"},"undefined"!=typeof jQuery&&function(a){a.fn.redactor=function(a){return RedactorApp(this.toArray(),a,[].slice.call(arguments,1))}}(jQuery);var RedactorApp=function(a,b,c){for(var d,e=Array.isArray(a)?a:a&&a.nodeType?[a]:document.querySelectorAll(a),f="string"==typeof b||"function"==typeof b,g=[],h=0;h<e.length;h++){var i=e[h],j=$R.dom(i);if(d=j.dataget("redactor"),d||f||(d=new App(i,b,uuid),j.dataset("redactor",d),$R.app[uuid]=d,uuid++),d&&f){var k="destroy"===b;b=k?"stop":b;var l;"function"==typeof b?l=b.apply(d,c):(c.unshift(b),l=d.api.apply(d,c)),void 0!==l&&g.push(l),k&&j.dataset("redactor",!1)}}return 0===g.length||1===g.length?0===g.length?d:g[0]:g};$R.add=function(a,b,c){if(void 0!==$R.env[a])if(c.translations&&($R.lang=$R.extend(!0,{},$R.lang,c.translations)),c.modals&&($R.modals=$R.extend(!0,{},$R.modals,c.modals)),"mixin"===a)$R[$R.env[a]][b]=c;else{var d=function(){};if(d.prototype=c,c.mixins)for(var e=0;e<c.mixins.length;e++)$R.inherit(d,$R.mixins[c.mixins[e]]);$R[$R.env[a]][b]=d}},$R.addLang=function(a,b){void 0===$R.lang[a]&&($R.lang[a]={}),$R.lang[a]=$R.extend($R.lang[a],b)},$R.create=function(a){var b=a.split("."),c=[].slice.call(arguments,1),d="classes";void 0!==$R.env[b[0]]&&(d=$R.env[b[0]],a=b.slice(1).join("."));var e=new $R[d][a];if(e.init){var f=e.init.apply(e,c);return f||e}return e},$R.inherit=function(a,b){var c=function(){};c.prototype=b;var d=new c;for(var e in a.prototype)a.prototype.__lookupGetter__(e)?d.__defineGetter__(e,a.prototype.__lookupGetter__(e)):d[e]=a.prototype[e];return a.prototype=d,a.prototype.super=b,a},$R.error=function(a){throw a},$R.extend=function(){var a={},b=!1,c=0,d=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(b=arguments[0],c++);for(;c<d;c++){var e=arguments[c];!function(c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(b&&"[object Object]"===Object.prototype.toString.call(c[d])?a[d]=$R.extend(!0,a[d],c[d]):a[d]=c[d])}(e)}return a},$R.opts={animation:!0,lang:"en",direction:"ltr",spellcheck:!0,structure:!1,scrollTarget:!1,styles:!0,stylesClass:"redactor-styles",placeholder:!1,source:!0,showSource:!1,inline:!1,breakline:!1,markup:"p",enterKey:!0,clickToEdit:!1,clickToSave:!1,clickToCancel:!1,focus:!1,focusEnd:!1,minHeight:!1,maxHeight:!1,maxWidth:!1,plugins:[],callbacks:{},preClass:!1,preSpaces:4,tabindex:!1,tabAsSpaces:!1,tabKey:!0,autosave:!1,autosaveName:!1,autosaveData:!1,toolbar:!0,toolbarFixed:!0,toolbarFixedTarget:document,toolbarFixedTopOffset:0,toolbarExternal:!1,toolbarContext:!0,air:!1,formatting:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],formattingAdd:!1,formattingHide:!1,buttons:["html","format","bold","italic","deleted","lists","image","file","link"],buttonsTextLabeled:!1,buttonsAdd:[],buttonsAddFirst:[],buttonsAddAfter:!1,buttonsAddBefore:!1,buttonsHide:[],buttonsHideOnMobile:[],imageUpload:!1,imageUploadParam:"file",imageData:!1,imageEditable:!0,imageCaption:!0,imageLink:!0,imagePosition:!1,imageResizable:!1,imageFloatMargin:"10px",imageFigure:!0,imageObserve:!0,fileUpload:!1,fileUploadParam:"file",fileData:!1,fileAttachment:!1,uploadData:!1,dragUpload:!0,multipleUpload:!0,clipboardUpload:!0,uploadBase64:!1,linkTarget:!1,linkTitle:!1,linkNewTab:!0,linkNofollow:!1,linkSize:30,linkValidation:!0,cleanOnEnter:!0,cleanInlineOnEnter:!1,paragraphize:!0,removeScript:!0,removeNewLines:!1,removeComments:!0,replaceTags:{b:"strong",i:"em",strike:"del"},pastePlainText:!1,pasteLinkTarget:!1,pasteImages:!0,pasteLinks:!0,pasteClean:!0,pasteKeepStyle:[],pasteKeepClass:[],pasteKeepAttrs:["td","th"],pasteBlockTags:["pre","h1","h2","h3","h4","h5","h6","table","tbody","thead","tfoot","th","tr","td","ul","ol","li","blockquote","p","figure","figcaption"],pasteInlineTags:["a","img","br","strong","ins","code","del","span","samp","kbd","sup","sub","mark","var","cite","small","b","u","em","i","abbr"],activeButtons:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",u:"underline"},activeButtonsAdd:{},activeButtonsObservers:{},autoparse:!0,autoparseStart:!0,autoparsePaste:!0,autoparseLinks:!0,autoparseImages:!0,autoparseVideo:!0,shortcodes:{"p.":{format:"p"},"quote.":{format:"blockquote"},"pre.":{format:"pre"},"h1.":{format:"h1"},"h2.":{format:"h2"},"h3.":{format:"h3"},"h4.":{format:"h4"},"h5.":{format:"h5"},"h6.":{format:"h6"},"*.":{format:"ul"}},shortcodesAdd:!1,shortcuts:{"ctrl+shift+m, meta+shift+m":{api:"module.inline.clearformat"},"ctrl+b, meta+b":{api:"module.inline.format",args:"b"},"ctrl+i, meta+i":{api:"module.inline.format",args:"i"},"ctrl+u, meta+u":{api:"module.inline.format",args:"u"},"ctrl+h, meta+h":{api:"module.inline.format",args:"sup"},"ctrl+l, meta+l":{api:"module.inline.format",args:"sub"},"ctrl+k, meta+k":{api:"module.link.open"},"ctrl+alt+0, meta+alt+0":{api:"module.block.format",args:"p"},"ctrl+alt+1, meta+alt+1":{api:"module.block.format",args:"h1"},"ctrl+alt+2, meta+alt+2":{api:"module.block.format",args:"h2"},"ctrl+alt+3, meta+alt+3":{api:"module.block.format",args:"h3"},"ctrl+alt+4, meta+alt+4":{api:"module.block.format",args:"h4"},"ctrl+alt+5, meta+alt+5":{api:"module.block.format",args:"h5"},"ctrl+alt+6, meta+alt+6":{api:"module.block.format",args:"h6"},"ctrl+shift+7, meta+shift+7":{api:"module.list.toggle",args:"ol"},"ctrl+shift+8, meta+shift+8":{api:"module.list.toggle",args:"ul"}},shortcutsAdd:!1,grammarly:!0,notranslate:!1,bufferLimit:100,emptyHtml:"<p></p>",markerChar:"\ufeff",imageTypes:["image/png","image/jpeg","image/gif"],imageAttrs:["alt","title","src","class","width","height","srcset"],inlineTags:["a","span","strong","strike","b","u","em","i","code","del","ins","samp","kbd","sup","sub","mark","var","cite","small","abbr"],blockTags:["pre","ul","ol","li","p","h1","h2","h3","h4","h5","h6","dl","dt","dd","div","table","tbody","thead","tfoot","tr","th","td","blockquote","output","figcaption","figure","address","section","header","footer","aside","article","iframe"],regex:{youtube:/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,vimeo:/(http|https)?:\/\/(?:www.|player.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_-]+)?/gi,imageurl:/((https?|www)[^\s]+\.)(jpe?g|png|gif)(\?[^\s-]+)?/gi,url:/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/gi},input:!0,zindex:!1,modes:{inline:{pastePlainText:!0,pasteImages:!1,enterKey:!1,toolbar:!1,autoparse:!1,source:!1,showSource:!1,styles:!1,air:!1},original:{styles:!1}}},$R.lang.en={format:"Format",image:"Image",file:"File",link:"Link",bold:"Bold",italic:"Italic",deleted:"Strikethrough",underline:"Underline",superscript:"Superscript",subscript:"Subscript","bold-abbr":"B","italic-abbr":"I","deleted-abbr":"S","underline-abbr":"U","superscript-abbr":"Sup","subscript-abbr":"Sub",lists:"Lists","link-insert":"Insert Link","link-edit":"Edit Link","link-in-new-tab":"Open link in new tab",unlink:"Unlink",cancel:"Cancel",close:"Close",insert:"Insert",save:"Save",delete:"Delete",text:"Text",edit:"Edit",title:"Alt",paragraph:"Normal text",quote:"Quote",code:"Code",heading1:"Heading 1",heading2:"Heading 2",heading3:"Heading 3",heading4:"Heading 4",heading5:"Heading 5",heading6:"Heading 6",filename:"Name",optional:"optional",unorderedlist:"Unordered List",orderedlist:"Ordered List",outdent:"Outdent",indent:"Indent",horizontalrule:"Line",upload:"Upload","upload-label":"Drop files here or click to upload","accessibility-help-label":"Rich text editor",caption:"Caption",bulletslist:"Bullets",numberslist:"Numbers","image-position":"Position",none:"None",left:"Left",right:"Right",center:"Center",undo:"Undo",redo:"Redo"},$R.buttons={html:{title:"HTML",icon:!0,api:"module.source.toggle"},undo:{title:"## undo ##",icon:!0,api:"module.buffer.undo"},redo:{title:"## redo ##",icon:!0,api:"module.buffer.redo"},format:{title:"## format ##",icon:!0,dropdown:{p:{title:"## paragraph ##",api:"module.block.format",args:{tag:"p"}},blockquote:{title:"## quote ##",api:"module.block.format",args:{tag:"blockquote"}},pre:{title:"## code ##",api:"module.block.format",args:{tag:"pre"}},h1:{title:"## heading1 ##",api:"module.block.format",args:{tag:"h1"}},h2:{title:"## heading2 ##",api:"module.block.format",args:{tag:"h2"}},h3:{title:"## heading3 ##",api:"module.block.format",args:{tag:"h3"}},h4:{title:"## heading4 ##",api:"module.block.format",args:{tag:"h4"}},h5:{title:"## heading5 ##",api:"module.block.format",args:{tag:"h5"}},h6:{title:"## heading6 ##",api:"module.block.format",args:{tag:"h6"}}}},bold:{title:"## bold-abbr ##",icon:!0,tooltip:"## bold ##",api:"module.inline.format",args:{tag:"b"}},italic:{title:"## italic-abbr ##",icon:!0,tooltip:"## italic ##",api:"module.inline.format",args:{tag:"i"}},deleted:{title:"## deleted-abbr ##",icon:!0,tooltip:"## deleted ##",api:"module.inline.format",args:{tag:"del"}},underline:{title:"## underline-abbr ##",icon:!0,tooltip:"## underline ##",api:"module.inline.format",args:{tag:"u"}},sup:{title:"## superscript-abbr ##",icon:!0,tooltip:"## superscript ##",api:"module.inline.format",args:{tag:"sup"}},sub:{title:"## subscript-abbr ##",icon:!0,tooltip:"## subscript ##",api:"module.inline.format",args:{tag:"sub"}},lists:{title:"## lists ##",icon:!0,observe:"list",dropdown:{observe:"list",unorderedlist:{title:"&bull; ## unorderedlist ##",api:"module.list.toggle",args:"ul"},orderedlist:{title:"1. ## orderedlist ##",api:"module.list.toggle",args:"ol"},outdent:{title:"< ## outdent ##",api:"module.list.outdent"},indent:{title:"> ## indent ##",api:"module.list.indent"}}},ul:{title:"&bull; ## bulletslist ##",icon:!0,api:"module.list.toggle",observe:"list",args:"ul"},ol:{title:"1. ## numberslist ##",icon:!0,api:"module.list.toggle",observe:"list",args:"ol"},outdent:{title:"## outdent ##",icon:!0,api:"module.list.outdent",observe:"list"},indent:{title:"## indent ##",icon:!0,api:"module.list.indent",observe:"list"},image:{title:"## image ##",icon:!0,api:"module.image.open"},file:{title:"## file ##",icon:!0,api:"module.file.open"},link:{title:"## link ##",icon:!0,observe:"link",dropdown:{observe:"link",link:{title:"## link-insert ##",api:"module.link.open"},unlink:{title:"## unlink ##",api:"module.link.unlink"}}},line:{title:"## horizontalrule ##",icon:!0,api:"module.line.insert"}};var App=function(a,b,c){this.module={},this.plugin={},this.instances={},this.started=!1,this.stopped=!1,this.uuid=c,this.rootElement=a,this.rootOpts=b,this.dragInside=!1,this.dragComponentInside=!1,this.keycodes=$R.keycodes,this.namespace="redactor",this.$win=$R.dom(window),this.$doc=$R.dom(document),this.$body=$R.dom("body"),this.editorReadOnly=!1,this.opts=$R.create("service.options",b,a),this.lang=$R.create("service.lang",this),this.buildServices(),this.buildModules(),this.buildPlugins(),this.start()};App.prototype={start:function(){this.stopped=!1,this.broadcast("start"),this.broadcast("startcode"),this.opts.clickToEdit?this.broadcast("startclicktoedit"):(this.broadcast("enable"),this.opts.showSource&&this.broadcast("startcodeshow"),this.broadcast("enablefocus")),this.broadcast("started"),this.started=!0},stop:function(){this.started=!1,this.stopped=!0,this.broadcast("stop"),this.broadcast("disable"),this.broadcast("stopped")},isStarted:function(){return this.started},isStopped:function(){return this.stopped},buildServices:function(){var a=["options","lang"],b=["uuid","keycodes","opts","lang","$win","$doc","$body"],c=[];for(var d in $R.services)-1===a.indexOf(d)&&(this[d]=$R.create("service."+d,this),c.push(d),b.push(d));for(var e=0;e<c.length;e++)for(var f=c[e],g=0;g<b.length;g++){var h=b[g];f!==h&&(this[f][h]=this[h])}},buildModules:function(){for(var a in $R.modules)this.module[a]=$R.create("module."+a,this),this.instances[a]=this.module[a]},buildPlugins:function(){for(var a=this.opts.plugins,b=0;b<a.length;b++){var c=a[b];void 0!==$R.plugins[c]&&(this.plugin[c]=$R.create("plugin."+c,this),this.instances[c]=this.plugin[c])}},isDragInside:function(){return this.dragInside},setDragInside:function(a){this.dragInside=a},isDragComponentInside:function(){return this.dragComponentInside},setDragComponentInside:function(a){this.dragComponentInside=a},getDragComponentInside:function(){return this.dragComponentInside},isReadOnly:function(){return this.editorReadOnly},enableReadOnly:function(){this.editorReadOnly=!0,this.broadcast("enablereadonly"),this.component.clearActive(),this.toolbar.disableButtons()},disableReadOnly:function(){this.editorReadOnly=!1,this.broadcast("disablereadonly"),this.toolbar.enableButtons()},callMessageHandler:function(a,b,c){var d=b.split(".");if(1===d.length)"function"==typeof a["on"+b]&&a["on"+b].apply(a,c);else{d[0]="on"+d[0];var e=this.utils.checkProperty(a,d);"function"==typeof e&&e.apply(a,c)}},broadcast:function(a){var b=[].slice.call(arguments,1);for(var c in this.instances)this.callMessageHandler(this.instances[c],a,b);return this.callback.trigger(a,b)},on:function(a,b){this.callback.add(a,b)},off:function(a,b){this.callback.remove(a,b)},api:function(a){if((this.isStarted()||"start"===a)&&(!this.isReadOnly()||"disableReadOnly"===a)){this.broadcast("state");var b=[].slice.call(arguments,1),c=a.split("."),d=1===c.length,e="on"===c[0]||"off"===c[0],f=!e&&2===c.length,g="plugin"===c[0],h="module"===c[0];if(d){if("function"==typeof this[c[0]])return this.callInstanceMethod(this,c[0],b)}else{if(e)return"on"===c[0]?this.on(c[1],b[0]):this.off(c[1],b[0]||void 0);if(f){if(this.isInstanceExists(this,c[0]))return this.callInstanceMethod(this[c[0]],c[1],b);$R.error(new Error('Service "'+c[0]+'" not found'))}else if(g){if(this.isInstanceExists(this.plugin,c[1]))return this.callInstanceMethod(this.plugin[c[1]],c[2],b);$R.error(new Error('Plugin "'+c[1]+'" not found'))}else if(h){if(this.isInstanceExists(this.module,c[1]))return this.callInstanceMethod(this.module[c[1]],c[2],b);$R.error(new Error('Module "'+c[1]+'" not found'))}}}},isInstanceExists:function(a,b){
return void 0!==a[b]},callInstanceMethod:function(a,b,c){if("function"==typeof a[b])return a[b].apply(a,c)}},$R.add("mixin","formatter",{buildArgs:function(a){this.args={class:a.class||!1,style:a.style||!1,attr:a.attr||!1},this.args.class||this.args.style||this.args.attr||(this.args=!1)},applyArgs:function(a,b){return a=this.args?this[this.type](this.args,!1,a,b):this._clearAll(a,b)},clearClass:function(a,b){this.selection.save();var c=b?$R.dom(b):this.getElements(a,!0);return c.removeAttr("class"),b=this._unwrapSpanWithoutAttr(c.getAll()),this.selection.restore(),b},clearStyle:function(a,b){this.selection.save();var c=b?$R.dom(b):this.getElements(a,!0);return c.removeAttr("style"),b=this._unwrapSpanWithoutAttr(c.getAll()),this.selection.restore(),b},clearAttr:function(a,b){this.selection.save();var c=b?$R.dom(b):this.getElements(a,!0);return this._removeAllAttr(c),b=this._unwrapSpanWithoutAttr(c.getAll()),this.selection.restore(),b},set:function(a,b,c,d){!1!==d&&this.selection.save();var e=c?$R.dom(c):this.getElements(b);return a.class&&(e.removeAttr("class"),e.addClass(a.class)),a.style&&(e.removeAttr("style"),e.css(a.style),e.each(function(a){var b=$R.dom(a);b.attr("data-redactor-style-cache",b.attr("style"))})),a.attr&&(this._removeAllAttr(e),e.attr(a.attr)),!1!==d&&this.selection.restore(),e.getAll()},toggle:function(a,b,c,d){!1!==d&&this.selection.save();var e=c?$R.dom(c):this.getElements(b);a.class&&(e.toggleClass(a.class),e.each(function(a){""===a.className&&a.removeAttribute("class")}));var f;return a.style&&(f=a.style,e.each(function(a){var b=$R.dom(a);for(var c in f){var d=f[c],e=b.css(c);e=this.utils.isRgb(e)?this.utils.rgb2hex(e):e.replace(/"/g,""),d=this.utils.isRgb(d)?this.utils.rgb2hex(d):d.replace(/"/g,""),e=this.utils.hex2long(e),d=this.utils.hex2long(d);("string"==typeof d?d.toLowerCase():d)===("string"==typeof e?e.toLowerCase():e)?b.css(c,""):b.css(c,d)}this._convertStyleQuotes(b),this.utils.removeEmptyAttr(a,"style")?b.removeAttr("data-redactor-style-cache"):b.attr("data-redactor-style-cache",b.attr("style"))}.bind(this))),a.attr&&(f=a.attr,e.each(function(a){var b=$R.dom(a);for(var c in f)b.attr(c)?b.removeAttr(c):b.attr(c,f[c])})),!1!==d&&this.selection.restore(),e.getAll()},add:function(a,b,c,d){!1!==d&&this.selection.save();var e=c?$R.dom(c):this.getElements(b);if(a.class&&e.addClass(a.class),a.style){var f=a.style;e.each(function(a){var b=$R.dom(a);b.css(f),b.attr("data-redactor-style-cache",b.attr("style")),this._convertStyleQuotes(b)}.bind(this))}return a.attr&&e.attr(a.attr),!1!==d&&this.selection.restore(),e.getAll()},remove:function(a,b,c,d){!1!==d&&this.selection.save();var e=c?$R.dom(c):this.getElements(b);if(a.class&&(e.removeClass(a.class),e.each(function(a){""===a.className&&a.removeAttribute("class")})),a.style){var f=a.style;e.each(function(a){var b=$R.dom(a);b.css(f,""),this.utils.removeEmptyAttr(a,"style")?b.removeAttr("data-redactor-style-cache"):b.attr("data-redactor-style-cache",b.attr("style"))}.bind(this))}return a.attr&&e.removeAttr(a.attr),c=this._unwrapSpanWithoutAttr(e.getAll()),!1!==d&&this.selection.restore(),c},_removeAllAttr:function(a){a.each(function(a){for(var b=a.attributes.length;b-- >0;){var c=a.attributes[b],d=c.name;"style"!==d&&"class"!==d&&a.removeAttributeNode(c)}})},_convertStyleQuotes:function(a){var b=a.attr("style");b&&a.attr("style",b.replace(/"/g,"'"))},_clearAll:function(a,b){!1!==b&&this.selection.save();for(var c=0;c<a.length;c++)for(var d=a[c];d.attributes.length>0;)d.removeAttribute(d.attributes[0].name);return a=this._unwrapSpanWithoutAttr(a),!1!==b&&this.selection.restore(),a},_unwrapSpanWithoutAttr:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];d.attributes.length<=0&&3!==d.nodeType&&"SPAN"===d.tagName?$R.dom(d).unwrap():b.push(d)}return b}}),$R.add("mixin","dom",$R.Dom.prototype),$R.add("mixin","component",{get cmnt(){return!0}}),$R.add("service","options",{init:function(a,b){var c=$R.dom(b),d=$R.extend({},$R.opts,b?c.data():{},$R.options);return d=$R.extend(!0,d,a)}}),$R.add("service","lang",{init:function(a){this.app=a,this.opts=a.opts,this.vars=this._build(this.opts.lang)},rebuild:function(a){this.opts.lang=a,this.vars=this._build(a)},extend:function(a){this.vars=$R.extend(this.vars,a)},parse:function(a){if(void 0===a)return"";var b=a.match(/## (.*?) ##/g);if(b)for(var c=0;c<b.length;c++){var d=b[c].replace(/^##\s/g,"").replace(/\s##$/g,"");a=a.replace(b[c],this.get(d))}return a},get:function(a){var b="";return void 0!==this.vars[a]?b=this.vars[a]:"en"!==this.opts.lang&&void 0!==$R.lang.en[a]&&(b=$R.lang.en[a]),b},_build:function(a){var b=$R.lang.en;return"en"!==a&&(b=void 0!==$R.lang[a]?$R.lang[a]:b),b}}),$R.add("service","callback",{init:function(a){this.app=a,this.opts=a.opts,this.callbacks={},this.opts.callbacks&&this._set(this.opts.callbacks,"")},stop:function(){this.callbacks={}},add:function(a,b){this.callbacks[a]||(this.callbacks[a]=[]),this.callbacks[a].push(b)},remove:function(a,b){if(void 0===b)delete this.callbacks[a];else{for(var c=0;c<this.callbacks[a].length;c++)this.callbacks[a].splice(c,1);0===Object.keys(this.callbacks[a]).length&&delete this.callbacks[a]}},trigger:function(a,b){var c=this._loop(a,b,this.callbacks);return void 0===c&&b&&!1!==b[0]?b[0]:c},_set:function(a,b){for(var c in a){var d=""===b?c:b+"."+c;"object"==typeof a[c]?this._set(a[c],d):(this.callbacks[d]=[],this.callbacks[d].push(a[c]))}},_loop:function(a,b,c){var d;for(var e in c)if(a===e)for(var f=0;f<c[e].length;f++)d=c[e][f].apply(this.app,b);return d}}),$R.add("service","animate",{init:function(a){this.animationOpt=a.opts.animation},start:function(a,b,c,d){var e={duration:!1,iterate:!1,delay:!1,timing:!1,prefix:"redactor-"};return e="function"==typeof c?e:$R.extend(e,c),d="function"==typeof c?c:d,new $R.AnimatePlay(a,b,e,d,this.animationOpt)},stop:function(a){this.$el=$R.dom(a),this.$el.removeClass("redactor-animated");var b=this.$el.attr("redactor-animate-effect");this.$el.removeClass(b),this.$el.removeAttr("redactor-animate-effect");var c=this.$el.attr("redactor-animate-hide");c&&this.$el.addClass(c).removeAttr("redactor-animate-hide"),this.$el.off("animationend webkitAnimationEnd")}}),$R.AnimatePlay=function(a,b,c,d,e){return this.hidableEffects=["fadeOut","flipOut","slideUp","zoomOut","slideOutUp","slideOutRight","slideOutLeft"],this.prefixes=["","-webkit-"],this.$el=$R.dom(a),this.$body=$R.dom("body"),this.callback=d,this.animation=e?b:this.buildAnimationOff(b),this.defaults=c,"slideUp"===this.animation&&this.$el.height(this.$el.height()),this.isInanimate()?this.inanimate():this.animate()},$R.AnimatePlay.prototype={buildAnimationOff:function(a){return this.isHidable(a)?"hide":"show"},buildHideClass:function(){return"redactor-animate-hide"},isInanimate:function(){return"show"===this.animation||"hide"===this.animation},isAnimated:function(){return this.$el.hasClass("redactor-animated")},isHidable:function(a){return-1!==this.hidableEffects.indexOf(a)},inanimate:function(){this.defaults.timing="linear";var a;return"show"===this.animation?(a=this.buildHideClass(),this.$el.attr("redactor-animate-hide",a),this.$el.removeClass(a)):(a=this.$el.attr("redactor-animate-hide"),this.$el.addClass(a).removeAttr("redactor-animate-hide")),"function"==typeof this.callback&&this.callback(this),this},animate:function(){var a=this.defaults.delay?this.defaults.delay:0;return setTimeout(function(){if(this.$body.addClass("no-scroll-x"),this.$el.addClass("redactor-animated"),!this.$el.attr("redactor-animate-hide")){var a=this.buildHideClass();this.$el.attr("redactor-animate-hide",a),this.$el.removeClass(a)}this.$el.addClass(this.defaults.prefix+this.animation),this.$el.attr("redactor-animate-effect",this.defaults.prefix+this.animation),this.set(this.defaults.duration+"s",this.defaults.iterate,this.defaults.timing),this.complete()}.bind(this),1e3*a),this},set:function(a,b,c){for(var d=this.prefixes.length;d--;)!1===a&&""!==a||this.$el.css(this.prefixes[d]+"animation-duration",a),!1===b&&""!==b||this.$el.css(this.prefixes[d]+"animation-iteration-count",b),!1===c&&""!==c||this.$el.css(this.prefixes[d]+"animation-timing-function",c)},clean:function(){this.$body.removeClass("no-scroll-x"),this.$el.removeClass("redactor-animated"),this.$el.removeClass(this.defaults.prefix+this.animation),this.$el.removeAttr("redactor-animate-effect"),this.set("","","")},complete:function(){this.$el.one("animationend webkitAnimationEnd",function(){if(this.$el.hasClass(this.defaults.prefix+this.animation)&&this.clean(),this.isHidable(this.animation)){var a=this.$el.attr("redactor-animate-hide");this.$el.addClass(a).removeAttr("redactor-animate-hide")}"slideUp"===this.animation&&this.$el.height(""),"function"==typeof this.callback&&this.callback(this.$el)}.bind(this))}},$R.add("service","caret",{init:function(a){this.app=a},setStart:function(a){this._setCaret("Start",a)},setEnd:function(a){this._setCaret("End",a)},setBefore:function(a){this._setCaret("Before",a)},setAfter:function(a){this._setCaret("After",a)},isStart:function(a){return this._isStartOrEnd(a,"First")},isEnd:function(a){return this._isStartOrEnd(a,"Last")},setAtEnd:function(a){var b=this.inspector.parse(a),c=b.getTag(),d=document.createRange();if(this._isInPage(a)){if("a"===c){var e=this.utils.createInvisibleChar();$R.dom(a).after(e),d.selectNodeContents(e),d.collapse(!0)}else d.selectNodeContents(a),d.collapse(!1);this.selection.setRange(d)}},setAtStart:function(a){var b=document.createRange(),c=this.inspector.parse(a);if(this._isInPage(a)){if(b.setStart(a,0),b.collapse(!0),c.isInline()||this.utils.isEmpty(a)){var d=this.utils.createInvisibleChar();b.insertNode(d),b.selectNodeContents(d),b.collapse(!1)}this.selection.setRange(b)}},setAtBefore:function(a){var b=this.inspector.parse(a),c=document.createRange();if(this._isInPage(a)){if(c.setStartBefore(a),c.collapse(!0),b.isInline()){var d=this.utils.createInvisibleChar();a.parentNode.insertBefore(d,a),c.selectNodeContents(d),c.collapse(!1)}this.selection.setRange(c)}},setAtAfter:function(a){var b=document.createRange();if(this._isInPage(a)){b.setStartAfter(a),b.collapse(!0);var c=this.utils.createInvisibleChar();b.insertNode(c),b.selectNodeContents(c),b.collapse(!1),this.selection.setRange(b)}},setAtPrev:function(a){var b=a.previousSibling;b&&(b=3===b.nodeType&&this._isEmptyTextNode(b)?b.previousElementSibling:b)&&this.setEnd(b)},setAtNext:function(a){var b=a.nextSibling;b&&(b=3===b.nodeType&&this._isEmptyTextNode(b)?b.nextElementSibling:b)&&this.setStart(b)},_setCaret:function(a,b){var c=this.inspector.parse(b),d=c.getNode();d&&(this.component.clearActive(),this["_set"+a](d,c,c.getTag()))},_setStart:function(a,b,c){if(b.isText())return this.editor.focus(),this.setAtStart(a);if("ul"===c||"ol"===c){a=b.findFirstNode("li");var d=this.utils.getFirstElement(a),e=this.inspector.parse(d);if(d&&e.isComponent())return this.setStart(e.getComponent())}else if("dl"===c)a=b.findFirstNode("dt");else{if("br"===c||"hr"===c)return this.setBefore(a);if("td"===c||"th"===c){var f=b.getFirstElement(a);if(f)return this.setStart(f)}else{if("table"===c||"tr"===c)return this.setStart(b.findFirstNode("th, td"));if(b.isComponentType("code")&&!b.isFigcaption()){var g=b.findLastNode("pre, code");return this.editor.focus(),this.setAtStart(g)}if("figure"===c&&b.isComponentType("table")){var h=b.getTable(),i=this.inspector.parse(h);return this.setStart(i.findFirstNode("th, td"))}if(!b.isComponentType("table")&&b.isComponent()&&!b.isFigcaption())return this.component.setActive(a)}}this.editor.focus(),this._setInline(a,"Start")||this.setAtStart(a)},_setEnd:function(a,b,c){if(b.isText())return this.editor.focus(),this.setAtEnd(a);if("ul"===c||"ol"===c){a=b.findLastNode("li");var d=this.utils.getLastElement(a),e=this.inspector.parse(d);if(d&&e.isComponent())return this.setEnd(e.getComponent())}else if("dl"===c)a=b.findLastNode("dd");else{if("br"===c||"hr"===c)return this.setAfter(a);if("td"===c||"th"===c){var f=b.getLastElement();if(f)return this.setEnd(f)}else{if("table"===c||"tr"===c)return this.setEnd(b.findLastNode("th, td"));if(b.isComponentType("code")&&!b.isFigcaption()){var g=b.findLastNode("pre, code");return this.editor.focus(),this.setAtEnd(g)}if("figure"===c&&b.isComponentType("table")){var h=b.getTable(),i=this.inspector.parse(h);return this.setEnd(i.findLastNode("th, td"))}if(!b.isComponentType("table")&&b.isComponent()&&!b.isFigcaption())return this.component.setActive(a)}}if(this.editor.focus(),!this._setInline(a,"End")){if(this.utils.isEmpty(a))return this.setStart(a);this.setAtEnd(a)}},_setBefore:function(a,b,c){return 3===a.nodeType?this.setAtBefore(a):b.isInline()?this.setAtBefore(a):b.isFirstTableCell()?this.setAtPrev(b.getComponent()):"td"===c||"th"===c?this.setAtPrev(a):b.isFirstListItem()?this.setAtPrev(b.getList()):b.isFigcaption()?this.setStart(b.getComponent()):!b.isComponentType("table")&&b.isComponent()?this.setAtPrev(b.getComponent()):b.isBlock()?this.setAtPrev(a):(this.editor.focus(),void this.setAtBefore(a))},_setAfter:function(a,b,c){return 3===a.nodeType?this.setAtAfter(a):b.isInline()?this.setAtAfter(a):b.isLastTableCell()?this.setAtNext(b.getComponent()):"td"===c||"th"===c?this.setAtNext(a):b.isFirstListItem()?this.setAtNext(b.getList()):!b.isComponentType("table")&&b.isComponent()?this.setAtNext(b.getComponent()):b.isBlock()?this.setAtNext(a):(this.editor.focus(),void this.setAtAfter(a))},_setInline:function(a,b){var c=this._hasInlineChild(a,"Start"===b?"first":"last");if(c)return"Start"===b?this.setStart(c):this.setEnd(c),!0},_isStartOrEnd:function(a,b){var c=this.utils.getNode(a);if(!c)return!1;var d=this.inspector.parse(c);if((c=this._getStartEndNode(c,d,b))&&3!==c.nodeType&&"LI"!==c.tagName){var e=3===c.nodeType?c.textContent:c.innerHTML;if(""===(e=this.utils.trimSpaces(e)))return!0}if(!d.isFigcaption()&&d.isComponent()&&!d.isComponentEditable())return!0;var f=this.offset.get(c,!0);return!!f&&("First"===b?0===f.start:f.end===this.offset.size(c,!0))},_isInPage:function(a){return!(!a||!a.nodeType)&&(a!==document.body&&document.body.contains(a))},_hasInlineChild:function(a,b){var c=this.inspector.parse(a),d="first"===b?c.getFirstNode():c.getLastNode(),e=$R.dom(d);if(d&&3!==d.nodeType&&this.inspector.isInlineTag(d.tagName)&&!e.hasClass("redactor-component")&&!e.hasClass("non-editable"))return d},_isEmptyTextNode:function(a){var b=a.textContent.trim().replace(/\n/,"");return""===(b=this.utils.removeInvisibleChars(b))},_getStartEndNode:function(a,b,c){return b.isFigcaption()?a=b.getFigcaption():b.isTable()?a=b["find"+c+"Node"]("th, td"):b.isList()?a=b["find"+c+"Node"]("li"):b.isComponentType("code")&&(a=b.findLastNode("pre, code")),a}});var containsNode=function(a){return document.getSelection().containsNode(a,!0)};"containsNode"in Selection.prototype||(containsNode=containsNodePolyfill);var containsNodePolyfill=function(a){var b=document.getSelection(),c=b.anchorNode.parentNode,d=b.focusNode.parentNode,e=b.getRangeAt(0).getBoundingClientRect(),f=a.getBoundingClientRect();return!!$R.dom(c).closest(a).length||(!!$R.dom(d).closest(a).length||e.top<f.top&&e.height>f.height)};$R.add("service","selection",{init:function(a){this.app=a},is:function(){var a=this.get();if(a){var b=a.anchorNode,c=this.inspector.parse(b);return c.isInEditor()||c.isEditor()}return!1},isCollapsed:function(){var a=this.get(),b=this.getRange();return!(!a||!a.isCollapsed)||!(!b||0!==b.toString().length)},isBackwards:function(){var a=!1,b=this.get();if(b&&!b.isCollapsed){var c=document.createRange();c.setStart(b.anchorNode,b.anchorOffset),c.setEnd(b.focusNode,b.focusOffset),a=c.collapsed,c.detach()}return a},isIn:function(a){var b=$R.dom(a).get(),c=this.getCurrent();return!(!c||!b)&&b.contains(c)},isText:function(){var a=this.get();if(a){var b=a.anchorNode,c=this.getBlock(b),d=this.getBlocks();if(c&&this.inspector.isTableCellTag(c.tagName)||!1===c&&0===d.length)return!0}return!1},isAll:function(a){var b=this.utils.getNode(a);if(!b)return!1;var c=this.editor.isEditor(b),d=this.inspector.parse(b);if(!d.isFigcaption()&&this.component.isNonEditable(b)&&this.component.isActive(b))return!0;if(c){var e=this.editor.getElement(),f=e.html().replace(/<p><\/p>$/i,"");if(this.getHtml(!1).length!==f.length)return!1}if(c&&this.editor.isEmpty()||this.isCollapsed())return!1;var g=this.offset.get(b,!0),h=this.offset.size(b,!0);return!c&&d.isComponentType("code")&&(h=this.getText().trim().length),!(!g||0!==g.start||g.end!==h)},hasNonEditable:function(){var a=this.getHtml(),b=$R.dom("<div>").html(a);return!this.isCollapsed()&&0!==b.find(".non-editable").length},setRange:function(a){var b=window.getSelection();b.removeAllRanges(),b.addRange(a)},setAll:function(a){var b=this.utils.getNode(a);if(b){var c=this.inspector.parse(b);if(this.component.clearActive(),this.editor.focus(),this.editor.saveScroll(),this.editor.disableNonEditables(),b&&"TABLE"===b.tagName){var d=c.findFirstNode("td, th"),e=c.findLastNode("td, th");$R.dom(d).prepend(this.marker.build("start")),$R.dom(e).append(this.marker.build("end")),this.restoreMarkers()}else if(!c.isFigcaption()&&this.component.isNonEditable(b))this.component.setActive(b);else{c.isComponentType("code")&&(b=c.getComponentCodeElement(),b.focus());var f=document.createRange();f.selectNodeContents(b),this.setRange(f)}this.editor.enableNonEditables(),this.editor.restoreScroll()}},get:function(){var a=window.getSelection();return a.rangeCount>0?a:null},getRange:function(){var a=this.get();return a&&a.getRangeAt(0)?a.getRangeAt(0):null},getTextBeforeCaret:function(a){a=void 0===a?1:a;var b=this.editor.getElement().get(),c=this.getRange(),d=!1;return c&&(c=c.cloneRange(),c.collapse(!0),c.setStart(b,0),d=c.toString().slice(-a)),d},getTextAfterCaret:function(a){a=void 0===a?1:a;var b=this.editor.getElement().get(),c=this.getRange(),d=!1;if(c){var e=c.cloneRange();e.selectNodeContents(b),e.setStart(c.endContainer,c.endOffset),d=e.toString().slice(0,a)}return d},getPosition:function(){var a=this.getRange(),b={top:0,left:0,width:0,height:0};if(window.getSelection&&a.getBoundingClientRect){a=a.cloneRange();var c=a.startOffset-1;a.setStart(a.startContainer,c<0?0:c);var d=a.getBoundingClientRect();b={top:d.top,left:d.left,width:d.right-d.left,height:d.bottom-d.top}}return b},getCurrent:function(){var a=!1,b=this.get(),c=this.component.getActive();if(c)a=c;else if(b&&this.is()){var d=this.inspector.parse(b.anchorNode);a=!d.isEditor()&&b.anchorNode}return a},getParent:function(){var a=!1,b=this.getCurrent();if(b){var c=b.parentNode;a=!this.inspector.parse(c).isEditor()&&c}return a},getElement:function(a){for(var b=a||this.getCurrent();b;){var c=this.inspector.parse(b);if(c.isElement()&&c.isInEditor())return b;b=b.parentNode}return!1},getInline:function(a){for(var b=a||this.getCurrent(),c=!1;b;)this._isInlineNode(b)&&(c=b),b=b.parentNode;return c},getInlineFirst:function(a){for(var b=a||this.getCurrent();b;){if(this._isInlineNode(b))return b;b=b.parentNode}return!1},getInlineAll:function(a){for(var b=a||this.getCurrent(),c=[];b;)this._isInlineNode(b)&&c.push(b),b=b.parentNode;return c},getBlock:function(a){for(var b=a||this.getCurrent();b;){var c=this.inspector.parse(b);if(this.inspector.isBlockTag(b.tagName)&&c.isInEditor(b))return b;b=b.parentNode}return!1},getInlinesAllSelected:function(a){if(this.isAll())return[];var b=this.getInlines({all:!0}),c=this.getNodes({textnodes:!0,inline:!1}),d=this.getText().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),e=[];if(0!==c.length)return e;if(""===d)e=b;else if(b.length>1)for(var f=0;f<b.length;f++)this._isTextSelected(b[f],d)&&e.push(b[f]);else 1===b.length&&this._isTextSelected(b[0],d)&&(e=b);return e=a&&a.tags?this._filterNodesByTags(e,a.tags):e},getInlines:function(a){for(var b=this.getNodes(),c=[],d=0;d<b.length;d++){var e;if(a&&a.all)for(e=b[d];e;)this._isInlineNode(e)&&!this._isInNodesArray(c,e)&&c.push(e),e=e.parentNode;else(e=this.getInline(b[d]))&&!this._isInNodesArray(c,e)&&c.push(e)}return c=a&&a.tags?this._filterNodesByTags(c,a.tags):c,c=a&&a.inside?this._filterInlinesInside(c,a):c},getBlocks:function(a){var b=this.getNodes(),c=this.getBlock();b=0===b.length&&c?[c]:b;for(var d=[],e=0;e<b.length;e++){var f=this.getBlock(b[e]);$R.dom(f).hasClass("non-editable")||f&&!this._isInNodesArray(d,f)&&d.push(f)}return d=a&&a.tags?this._filterNodesByTags(d,a.tags):d,d=a&&a.first?this._filterBlocksFirst(d,a):d},getElements:function(a){var b=this.getNodes({textnodes:!1}),c=this.getBlock();b=0===b.length&&c?[c]:b;for(var d=[],e=0;e<b.length;e++)this._isInNodesArray(d,b[e])||d.push(b[e]);return d=a&&a.tags?this._filterNodesByTags(d,a.tags):d},getNodes:function(a){var b=[],c=this.component.getActive();if(c)b=this._getNodesComponent(c);else if(this.isCollapsed()){var d=this.getCurrent();b=d?[d]:[]}else this.is()&&!c&&(b=this._getRangeSelectedNodes());return b=this._filterServicesNodes(b),b=this._filterEditor(b),b=a&&a.tags?this._filterNodesByTags(b,a.tags):b,b=a&&a.textnodes?this._filterNodesTexts(b,a):b,b=a&&!a.textnodes?this._filterNodesElements(b):b},getText:function(){var a=this.get();return a?this.utils.removeInvisibleChars(a.toString()):""},getHtml:function(a){var b="",c=this.get();if(c){for(var d=document.createElement("div"),e=c.rangeCount,f=0;f<e;++f)d.appendChild(c.getRangeAt(f).cloneContents());b=d.innerHTML,b=!1!==a?this.cleaner.output(b):b,b=b.replace(/<p><\/p>$/i,"")}return b},clear:function(){this.component.clearActive(),this.get().removeAllRanges()},collapseToStart:function(){var a=this.get();a&&!a.isCollapsed&&a.collapseToStart()},collapseToEnd:function(){var a=this.get();a&&!a.isCollapsed&&a.collapseToEnd()},saveActiveComponent:function(){var a=this.component.getActive();return!!a&&(this.savedComponent=a,!0)},restoreActiveComponent:function(){return!!this.savedComponent&&(this.component.setActive(this.savedComponent),!0)},save:function(){this._clearSaved();var a=this.getElement(),b=["TD","TH","P","DIV","PRE","H1","H2","H3","H4","H5","H6","LI","BLOCKQUOTE"];!a||-1===b.indexOf(a.tagName)||""!==a.innerHTML&&"<br>"!==a.innerHTML?this.saveActiveComponent()||(this.saved=this.offset.get()):this.savedElement=a},restore:function(){(this.saved||this.savedComponent||this.savedElement)&&(this.editor.saveScroll(),this.savedElement?this.caret.setStart(this.savedElement):this.restoreActiveComponent()||this.offset.set(this.saved),this._clearSaved(),this.editor.restoreScroll())},saveMarkers:function(){this._clearSaved(),this.saveActiveComponent()||this.marker.insert()},restoreMarkers:function(){this.editor.saveScroll(),this.restoreActiveComponent()||this.marker.restore(),this._clearSaved(),this.editor.restoreScroll()},_getNextNode:function(a){if(a.hasChildNodes())return a.firstChild;for(;a&&!a.nextSibling;)a=a.parentNode;return a?a.nextSibling:null},_getNodesComponent:function(a){var b=this.getCurrent(),c=this.inspector.parse(b);return c.isFigcaption()?[c.getFigcaption()]:[a]},_getRangeSelectedNodes:function(){var a=[],b=this.getRange(),c=b.startContainer,d=b.startContainer,e=b.endContainer,f=this.editor.getElement();if(d===f.get()&&this.isAll())a=this.utils.getChildNodes(f);else if(c==e)a=[c];else{for(;c&&c!=e;)a.push(c=this._getNextNode(c));for(c=b.startContainer;c&&c!=b.commonAncestorContainer;)a.unshift(c),c=c.parentNode}return a},_isInNodesArray:function(a,b){return-1!==a.indexOf(b)},_filterEditor:function(a){for(var b=[],c=0;c<a.length;c++){this.inspector.parse(a[c]).isInEditor()&&b.push(a[c])}return b},_filterServicesNodes:function(a){for(var b=[],c=0;c<a.length;c++){var d=$R.dom(a[c]),e=!1;a[c]&&3===a[c].nodeType&&this.utils.isEmpty(a[c])&&(e=!0),(d.hasClass("redactor-script-tag")||d.hasClass("redactor-component-caret")||d.hasClass("redactor-selection-marker")||d.hasClass("non-editable"))&&(e=!0),e||b.push(a[c])}return b},_filterNodesTexts:function(a,b){for(var c=[],d=0;d<a.length;d++)if(3===a[d].nodeType||b.keepbr&&"BR"===a[d].tagName){var e=this.getInline(a[d]),f=e&&b&&!1===b.inline;f||c.push(a[d])}return c},_filterNodesElements:function(a){for(var b=[],c=0;c<a.length;c++)3!==a[c].nodeType&&b.push(a[c]);return b},_filterNodesByTags:function(a,b,c){for(var d=[],e=0;e<a.length;e++)if(c&&3===a[e].nodeType)d.push(a[e]);else if(3!==a[e].nodeType){var f=a[e].tagName.toLowerCase();-1!==b.indexOf(f.toLowerCase())&&d.push(a[e])}return d},_filterBlocksFirst:function(a){for(var b=[],c=0;c<a.length;c++){var d=$R.dom(a[c]),e=d.parent().get(),f=d.parent().hasClass("redactor-in"),g=e&&("TD"===e.tagName||"TH"===e.tagName);(f||g)&&b.push(a[c])}return b},_filterInlinesInside:function(a){for(var b=[],c=0;c<a.length;c++)containsNode(a[c],!0)&&b.push(a[c]);return b},_isTextSelected:function(a,b){var c=this.utils.removeInvisibleChars(a.textContent);return b===c||-1!==c.search(b)||-1!==b.search(new RegExp("^"+this.utils.escapeRegExp(c)))||-1!==b.search(new RegExp(this.utils.escapeRegExp(c)+"$"))},_isInlineNode:function(a){var b=this.inspector.parse(a);return this.inspector.isInlineTag(a.tagName)&&b.isInEditor()},_clearSaved:function(){this.saved=!1,this.savedComponent=!1,this.savedElement=!1}}),$R.add("service","element",{init:function(a){this.app=a,this.rootElement=a.rootElement,this.$element={},this.type="inline"},start:function(){this._build(),this._buildType()},isType:function(a){return a===this.type},getType:function(){return this.type},getElement:function(){return this.$element},_build:function(){this.$element=$R.dom(this.rootElement)},_buildType:function(){var a=this.$element.get().tagName;this.type="TEXTAREA"===a?"textarea":this.type,this.type="DIV"===a?"div":this.type,this.type=this.opts.inline?"inline":this.type}}),$R.add("service","editor",{init:function(a){this.app=a,this.scrolltop=!1,this.pasting=!1},start:function(){this._build()},focus:function(){this.isFocus()||this._isContenteditableFocus()||(this.saveScroll(),this.$editor.focus(),this.restoreScroll())},startFocus:function(){this.caret.setStart(this.getFirstNode())},endFocus:function(){this.caret.setEnd(this.getLastNode())},isPasting:function(){return this.pasting},enablePasting:function(){this.pasting=!0},disablePasting:function(){this.pasting=!1},saveScroll:function(){this.scrolltop=this._getScrollTarget().scrollTop()},restoreScroll:function(){!1!==this.scrolltop&&(this._getScrollTarget().scrollTop(this.scrolltop),this.scrolltop=!1)},disableNonEditables:function(){this.$noneditables=this.$editor.find("[contenteditable=false]"),this.$noneditables.attr("contenteditable",!0)},enableNonEditables:function(){this.$noneditables&&setTimeout(function(){this.$noneditables.attr("contenteditable",!1)}.bind(this),1)},getFirstNode:function(){return this.$editor.contents()[0]},getLastNode:function(){var a=this.$editor.contents();return a[a.length-1]},isSourceMode:function(){return this.source.getElement().hasClass("redactor-source-open")},isEditor:function(a){return $R.dom(a).get()===this.$editor.get()},isEmpty:function(a){return this.utils.isEmptyHtml(this.$editor.html(),!1,a)},isFocus:function(){var a=$R.dom(document.activeElement);return 0!==this.$editor.find(".redactor-component-active").length||0!==a.closest(".redactor-in-"+this.uuid).length},setEmpty:function(){this.$editor.html(this.opts.emptyHtml)},getElement:function(){return this.$editor},_build:function(){var a=this.element.getElement(),b=this.element.isType("textarea")?"<div>":a.get();this.$editor=$R.dom(b)},_getScrollTarget:function(){var a=this.$doc;return a=this.opts.toolbarFixedTarget!==document?$R.dom(this.opts.toolbarFixedTarget):this.opts.scrollTarget?$R.dom(this.opts.scrollTarget):a},_isContenteditableFocus:function(){var a=this.selection.getBlock();return 0!==(a?$R.dom(a).closest("[contenteditable=true]").not(".redactor-in"):[]).length}}),$R.add("service","container",{init:function(a){this.app=a},start:function(){this._build()},getElement:function(){return this.$container},_build:function(){var a=this.element.isType("inline")?"<span>":"<div>";this.$container=$R.dom(a)}}),$R.add("service","source",{init:function(a){this.app=a,this.$source={},this.content=""},start:function(){this._build(),this._buildName(),this._buildStartedContent()},getElement:function(){return this.$source},getCode:function(){return this.$source.val()},getName:function(){return this.$source.attr("name")},getStartedContent:function(){return this.content},setCode:function(a){return this.insertion.set(a,!0,!1)},isNameGenerated:function(){return this.name},rebuildStartedContent:function(){this._buildStartedContent()},_build:function(){var a=this.element.getElement(),b=this.element.isType("textarea"),c=b?a.get():"<textarea>";this.$source=$R.dom(c)},_buildName:function(){var a=this.element.getElement();this.name=a.attr("name"),this.$source.attr("name",this.name?this.name:"content-"+this.uuid)},_buildStartedContent:function(){var a=this.element.getElement(),b=this.element.isType("textarea")?a.val():a.html();this.content=b.trim()}}),$R.add("service","statusbar",{init:function(a){this.app=a,this.$statusbar={},this.items=[]},start:function(){this.$statusbar=$R.dom("<ul>"),this.$statusbar.attr("dir",this.opts.direction)},add:function(a,b){return this.update(a,b)},update:function(a,b){var c;return void 0!==this.items[a]?c=this.items[a]:(c=$R.dom("<li>"),this.$statusbar.append(c),this.items[a]=c),c.html(b)},get:function(a){return!!this.items[a]&&this.items[a]},remove:function(a){this.items[a]&&(this.items[a].remove(),delete this.items[a])},getItems:function(){return this.items},removeItems:function(){this.items={},this.$statusbar.html("")},getElement:function(){return this.$statusbar}}),$R.add("service","toolbar",{init:function(a){this.app=a,this.buttons=[],this.dropdownOpened=!1,this.buttonsObservers={}},start:function(){this.is()&&(this.opts.activeButtons=this.opts.activeButtonsAdd?this._extendActiveButtons():this.opts.activeButtons,this.create())},stopObservers:function(){this.buttonsObservers={}},create:function(){this.$wrapper=$R.dom("<div>"),this.$toolbar=$R.dom("<div>")},observe:function(){if(this.is()){this.setButtonsInactive();var a,b;for(var c in this.buttonsObservers)b=this.buttonsObservers[c],a=this.getButton(c),this.app.broadcast("button."+b+".observe",a);var d=this.opts.activeButtons,e=this.selection.getInlinesAllSelected(),f=this.selection.getInline();this.selection.isCollapsed()&&f&&e.push(f);var g=this._inlinesToTags(e);for(var h in d)-1!==g.indexOf(h)&&(a=this.getButton(d[h]))&&a.setActive()}},is:function(){return!(!this.opts.toolbar||this.detector.isMobile()&&this.opts.air)},isAir:function(){return!!this.is()&&this.$toolbar.hasClass("redactor-air")},isFixed:function(){return!!this.is()&&this.$toolbar.hasClass("redactor-toolbar-fixed")},isContextBar:function(){return this.$body.find("#redactor-context-toolbar-"+this.uuid).hasClass("open")},isTarget:function(){return this.opts.toolbarFixedTarget!==document},getElement:function(){return this.$toolbar},getWrapper:function(){return this.$wrapper},getDropdown:function(){return this.dropdownOpened},getTargetElement:function(){return $R.dom(this.opts.toolbarFixedTarget)},getButton:function(a){var b=this._findButton(".re-"+a);return 0!==b.length&&b.dataget("data-button-instance")},getButtons:function(){var a=[];return this._findButtons().each(function(b){var c=$R.dom(b);a.push(c.dataget("data-button-instance"))}),a},getButtonsKeys:function(){var a=[];return this._findButtons().each(function(b){var c=$R.dom(b);a.push(c.attr("data-re-name"))}),a},addButton:function(a,b,c,d,e){c=c||"end";var f=$R.create("toolbar.button",this.app,a,b);return b.observe&&(this.opts.activeButtonsObservers[a]={observe:b.observe,button:f}),this.is()&&("first"===c?this.$toolbar.prepend(f):"after"===c?d.after(f):"before"===c?d.before(f):this.$toolbar.append(f)),f},addButtonFirst:function(a,b){return this.addButton(a,b,"first")},addButtonAfter:function(a,b,c){var d=this.getButton(a);return d?this.addButton(b,c,"after",d):this.addButton(b,c)},addButtonBefore:function(a,b,c){var d=this.getButton(a);return d?this.addButton(b,c,"before",d):this.addButton(b,c)},addButtonObserver:function(a,b){this.buttonsObservers[a]=b},
setButtons:function(a){this.buttons=a},setDropdown:function(a){this.dropdownOpened=a},setButtonsInactive:function(){for(var a=this.getButtons(),b=0;b<a.length;b++)a[b].setInactive()},setButtonsActive:function(){for(var a=this.getButtons(),b=0;b<a.length;b++)a[b].setActive()},disableButtons:function(){for(var a=this.getButtons(),b=0;b<a.length;b++)a[b].disable()},enableButtons:function(){for(var a=this.getButtons(),b=0;b<a.length;b++)a[b].enable()},_findButton:function(a){return this.is()?this.$toolbar.find(a):$R.dom()},_findButtons:function(){return this.is()?this.$toolbar.find(".re-button"):$R.dom()},_extendActiveButtons:function(){return $R.extend({},this.opts.activeButtons,this.opts.activeButtonsAdd)},_inlinesToTags:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].tagName.toLowerCase());return b}}),$R.add("class","toolbar.button",{mixins:["dom"],init:function(a,b,c){this.app=a,this.opts=a.opts,this.lang=a.lang,this.$body=a.$body,this.toolbar=a.toolbar,this.detector=a.detector,this.obj=c,this.name=b,this.dropdown=!1,this.tooltip=!1,this._init()},isActive:function(){return this.hasClass("redactor-button-active")},isDisabled:function(){return this.hasClass("redactor-button-disabled")},hasIcon:function(){return this.obj.icon&&!this.opts.buttonsTextLabeled},setDropdown:function(a){this.obj.dropdown=a,this.obj.message=!1,this.dropdown=$R.create("toolbar.dropdown",this.app,this.name,this.obj.dropdown),this.attr("data-dropdown",!0)},setMessage:function(a,b){this.obj.message=a,this.obj.args=b,this.obj.dropdown=!1},setApi:function(a,b){this.obj.api=a,this.obj.args=b,this.obj.dropdown=!1},setTitle:function(a){this.obj.title=this.lang.parse(a),this.obj.tooltip=this.obj.title,this.attr({alt:this.obj.tooltip,"aria-label":this.obj.tooltip}),this.attr("data-re-icon")||this.html(this.obj.title)},setTooltip:function(a){this.obj.tooltip=this.lang.parse(a),this.attr({alt:this.obj.tooltip,"aria-label":this.obj.tooltip})},setIcon:function(a){this.opts.buttonsTextLabeled||(this.obj.icon=!0,this.$icon=$R.dom(a),this.html(""),this.append(this.$icon),this.attr("data-re-icon",!0),this.addClass("re-button-icon"),this.setTooltip(this.obj.title),this._buildTooltip())},setActive:function(){this.addClass("redactor-button-active")},setInactive:function(){this.removeClass("redactor-button-active")},hideTooltip:function(){this.$body.find(".re-button-tooltip").remove()},getDropdown:function(){return this.dropdown},disable:function(){this.addClass("redactor-button-disabled")},enable:function(){this.removeClass("redactor-button-disabled")},toggle:function(a){a&&a.preventDefault(),this.isDisabled()||(this.obj.dropdown?this.dropdown.toggle(a):this.obj.api?this.app.api(this.obj.api,this.obj.args,this.name):this.obj.message&&this.app.broadcast(this.obj.message,this.obj.args,this.name),this.hideTooltip())},_init:function(){this._parseTitle(),this._parseTooltip(),this._build(),this._buildCallback(),this._buildAttributes(),this._buildObserver(),this.hasIcon()?(this._buildIcon(),this._buildTooltip()):this.html(this.obj.title)},_parseTooltip:function(){this.obj.tooltip=this.obj.tooltip?this.lang.parse(this.obj.tooltip):this.obj.title},_parseTitle:function(){this.obj.title=this.lang.parse(this.obj.title)},_build:function(){this.parse("<a>"),this.addClass("re-button re-"+this.name),this.attr("data-re-name",this.name),this.dataset("data-button-instance",this),this.obj.dropdown&&this.setDropdown(this.obj.dropdown)},_buildCallback:function(){this.on("click",this.toggle.bind(this))},_buildAttributes:function(){var a={href:"#",alt:this.obj.tooltip,rel:this.name,role:"button","aria-label":this.obj.tooltip,tabindex:"-1"};this.attr(a)},_buildObserver:function(){void 0!==this.obj.observe&&this.toolbar.addButtonObserver(this.name,this.obj.observe)},_buildIcon:function(){var a=this.obj.icon,b=/(<([^>]+)>)/gi.test(a);this.$icon=b?$R.dom(a):$R.dom("<i>"),b||this.$icon.addClass("re-icon-"+this.name),this.append(this.$icon),this.attr("data-re-icon",!0),this.addClass("re-button-icon")},_buildTooltip:function(){this.detector.isDesktop()&&(this.tooltip=$R.create("toolbar.button.tooltip",this.app,this))}}),$R.add("class","toolbar.button.tooltip",{mixins:["dom"],init:function(a,b){this.app=a,this.uuid=a.uuid,this.opts=a.opts,this.$body=a.$body,this.toolbar=a.toolbar,this.$button=b,this.created=!1,this._init()},open:function(){if(!this.$button.hasClass("redactor-button-disabled")&&!this.$button.hasClass("redactor-button-active")){this.created=!0,this.parse("<span>"),this.addClass("re-button-tooltip re-button-tooltip-"+this.uuid),this.$body.append(this),this.html(this.$button.attr("alt"));var a=this.$button.offset(),b=this.$button.height(),c=this.$button.width();this.css({top:a.top+b+4+"px",left:a.left+c/2-this.width()/2+"px",position:"absolute"}),this.show()}},close:function(){this.created&&!this.$button.hasClass("redactor-button-disabled")&&(this.remove(),this.created=!1)},_init:function(){this.$button.on("mouseover",this.open.bind(this)),this.$button.on("mouseout",this.close.bind(this))}}),$R.add("class","toolbar.dropdown",{mixins:["dom"],init:function(a,b,c){this.app=a,this.uuid=a.uuid,this.opts=a.opts,this.$win=a.$win,this.$doc=a.$doc,this.$body=a.$body,this.animate=a.animate,this.toolbar=a.toolbar,this.name=b,this.started=!1,this.items="format"===b?$R.extend({},!0,c):c,this.$items=[]},toggle:function(a){this.started||this._build(),this.isOpened()&&this.isActive()?this.close(!1):this.open(a)},isOpened:function(){var a=this.$body.find(".redactor-dropdown-"+this.uuid+".open");return 0!==a.length&&a.attr("data-re-name")===this.name},isActive:function(){return 0!==this.$body.find("#redactor-dropdown-"+this.uuid+"-"+this.name+".open").length},getName:function(){return this.attr("data-re-name")},getItem:function(a){return this.$items[a]},getItemsByClass:function(a){var b=[];for(var c in this.$items){var d=this.$items[c];"object"==typeof d&&d.attr("data-re-name")&&d.hasClass(a)&&b.push(d)}return b},open:function(a){this._closeAll(),this.$btn=this.toolbar.getButton(this.name),this.app.broadcast("dropdown.open",a,this,this.$btn),this.toolbar.setDropdown(this),this.show(),this.removeClass("redactor-animate-hide"),this.addClass("open"),this._observe(),this.$btn.hideTooltip(),this.$btn.setActive(),this.$doc.on("keyup.redactor.dropdown-"+this.uuid,this._handleKeyboard.bind(this)),this.$doc.on("click.redactor.dropdown-"+this.uuid,this.close.bind(this)),this.updatePosition(),this.app.broadcast("dropdown.opened",a,this,this.$btn)},close:function(a,b){if(a){var c=$R.dom(a.target);if(this._isButton(a)||c.hasClass("redactor-dropdown-not-close")||c.hasClass("redactor-dropdown-item-disabled"))return void a.preventDefault()}this.app.broadcast("dropdown.close",this,this.$btn),this.toolbar.setDropdown(!1),this.$btn.setInactive(),!1===b?this._close():this.animate.start(this,"fadeOut",this._close.bind(this))},updatePosition:function(){var a=this.toolbar.isFixed(),b=this.toolbar.isTarget(),c=this.$btn.height(),d=this.$btn.width(),e=this.$btn.offset(),f="absolute",g=2;a&&(e.top=b?this.$btn.offset().top:this.$btn.position().top,f="fixed",g+=this.opts.toolbarFixedTopOffset);var h=e.left+0,i=parseFloat(this.css("width")),j=this.$win.width(),k=j<h+i?i-d:0,l=h-k,m=e.top+c+g;l=l<0?4:l,this.css({maxHeight:"",position:f,top:m+"px",left:l+"px"});var n=this.$win.height(),o=this.$doc.scrollTop(),p=n-(m-o)-10;this.css("max-height",p+"px")},_build:function(){this.parse("<div>"),this.attr("dir",this.opts.direction),this.attr("id","redactor-dropdown-"+this.uuid+"-"+this.name),this.attr("data-re-name",this.name),this.addClass("redactor-dropdown redactor-dropdown-"+this.uuid+" redactor-dropdown-"+this.name),this.dataset("data-dropdown-instance",this),this.items.sdom||"string"==typeof this.items?this._buildDom():this._buildItems(),this.$body.append(this),this.started=!0},_buildDom:function(){this.html("").append($R.dom(this.items))},_buildItems:function(){this.items="format"===this.name?this._buildFormattingItems():this.items;for(var a in this.items){var b=this.items[a];if("observe"===a)this.attr("data-observe",this.items[a]);else{var c=$R.create("toolbar.dropdown.item",this.app,a,b,this);this.$items[a]=c,this.append(c)}}},_buildFormattingItems:function(){for(var a in this.items)-1===this.opts.formatting.indexOf(a)&&delete this.items[a];if(this.opts.formattingHide)for(var a in this.items)-1!==this.opts.formattingHide.indexOf(a)&&delete this.items[a];if(this.opts.formattingAdd)for(var a in this.opts.formattingAdd)this.items[a]=this.opts.formattingAdd[a];return this.items},_handleKeyboard:function(a){27===a.which&&this.close()},_isButton:function(a){return $R.dom(a.target).closest(".re-button").get()===this.$btn.get()},_close:function(){this.$btn.setInactive(),this.$doc.off(".redactor.dropdown-"+this.uuid),this.removeClass("open"),this.addClass("redactor-animate-hide"),this.app.broadcast("dropdown.closed",this,this.$btn)},_closeAll:function(){this.$body.find(".redactor-dropdown-"+this.uuid+".open").each(function(a){$R.dom(a).dataget("data-dropdown-instance")._close()})},_observe:function(){var a=this.attr("data-observe");a&&this.app.broadcast("dropdown."+a+".observe",this)}}),$R.add("class","toolbar.dropdown.item",{mixins:["dom"],init:function(a,b,c,d){this.app=a,this.lang=a.lang,this.dropdown=d,this.name=b,this.obj=c,this._init()},setTitle:function(a){this.$span.html(a)},getTitle:function(){return this.$span.html()},enable:function(){this.removeClass("redactor-dropdown-item-disabled")},disable:function(){this.addClass("redactor-dropdown-item-disabled")},toggle:function(a){a&&a.preventDefault(),this.hasClass("redactor-dropdown-item-disabled")||(this.obj.message?this.app.broadcast(this.obj.message,this.obj.args,this.name):this.obj.api&&this.app.api(this.obj.api,this.obj.args,this.name))},_init:function(){this.parse("<a>"),this.attr("href","#"),this.addClass("redactor-dropdown-item-"+this.name),this.obj.classname&&this.addClass(this.obj.classname),this.attr("data-re-name",this.name),this.on("click",this.toggle.bind(this)),this.$span=$R.dom("<span>"),this.append(this.$span),this.setTitle(this.lang.parse(this.obj.title))}}),$R.add("service","cleaner",{init:function(a){this.app=a,this.opts=a.opts,this.storedComponents=[],this.storedImages=[],this.storedLinks=[],this.deniedTags=["font","html","head","link","title","body","meta","applet"],this.convertRules={},this.unconvertRules={},this.reComments=/<!--[\s\S]*?-->\n?/g,this.reSpacedEmpty=/^(||\s||<br\s?\/?>||&nbsp;)$/i,this.reScriptTag=/<script(.*?[^>]?)>([\w\W]*?)<\/script>/gi},addConvertRules:function(a,b){this.convertRules[a]=b},addUnconvertRules:function(a,b){this.unconvertRules[a]=b},input:function(a,b,c){a=this.encodePreCode(a),a=a.replace(/\$/g,"&#36;"),a=a.replace(/&amp;/g,"&"),a=$R.create("cleaner.figure",this.app).convert(a,this.convertRules),a=this.storeComponents(a),a=this.replaceTags(a,this.opts.replaceTags),a=this._setSpanAttr(a),a=this._setStyleCache(a),a=this.removeTags(a,this.deniedTags),a=this.opts.removeScript?this._removeScriptTag(a):this._replaceScriptTag(a),a=this.opts.removeComments?this.removeComments(a):a,a=this._isSpacedEmpty(a)?this.opts.emptyHtml:a,a=this.restoreComponents(a),a=this._cleanWrapped(a);var d=this.utils.buildWrapper(a);d.find("img, svg").removeAttr("onload");var e=["alt","title","src","class","width","height","srcset","style"];return d.find("img").each(function(a){if(a.attributes.length>0)for(var b=a.attributes,c=b.length-1;c>=0;c--)-1===b[c].name.search(/^data\-/)&&-1===e.indexOf(b[c].name)&&a.removeAttribute(b[c].name)}),a=this.utils.getWrapperHtml(d),a=b?this.paragraphize(a):a},output:function(a,b){return a=this.removeInvisibleSpaces(a),a=a.replace(/&#36;/g,"$"),this._isSpacedEmpty(a)?"":this._isParagraphEmpty(a)?"":(a=this.removeServiceTagsAndAttrs(a,b),a=this.storeComponents(a),a=this.removeSpanWithoutAttributes(a),a=this.removeFirstBlockBreaklineInHtml(a),a=this.opts.removeScript?a:this._unreplaceScriptTag(a),a=this.opts.preClass?this._setPreClass(a):a,a=this.opts.linkNofollow?this._setLinkNofollow(a):a,a=this.opts.removeNewLines?this.cleanNewLines(a):a,a=this.restoreComponents(a),a=$R.create("cleaner.figure",this.app).unconvert(a,this.unconvertRules),a=this.removeEmptyAttributes(a,["style","class","rel","alt","title"]),a=this.cleanSpacesInPre(a),a=this.tidy(a),a=a.replace(/&amp;/g,"&"),this.opts.breakline&&(a=a.replace(/<br\s?\/?>/gi,"<br>\n"),a=a.replace(/<br\s?\/?>\n+/gi,"<br>\n")),a=""===a.replace(/\n/g,"")?"":a)},paste:function(a){a=this.storeComponents(a);var b=this.deniedTags.concat(["iframe"]);a=this.removeTags(a,b),a=a.replace(new RegExp("<!doctype([\\s\\S]+?)>","gi"),""),a=a.replace(new RegExp("<style([\\s\\S]+?)</style>","gi"),""),a=a.replace(new RegExp("</p><br /><p","gi"),"</p><p");var c=this._isHtmlMsWord(a);if(a=this._cleanGDocs(a),a=c?this._cleanMsWord(a):a,!this.opts.pasteClean)return a=this.restoreComponents(a);if(this.opts.pastePlainText)return a=this.restoreComponents(a),this.pastePlainText(a);var d=this.utils.buildWrapper(a);d.find("*").removeAttr("style"),d.find("[data-redactor-tag]").each(function(a){var b=$R.dom(a);b.removeAttr("data-redactor-tag"),this.utils.isEmptyHtml(b.html())?b.html("<br>").unwrap():a.lastChild&&"BR"===a.lastChild.tagName?b.unwrap():b.append("<br>").unwrap()}.bind(this)),a=this.utils.getWrapperHtml(d),a=a.replace(/<br\s?\/?>$/,""),a=a.replace(/<br\s?\/?><\/(td|th)>/,"</$1>");var e=this.opts.pasteBlockTags.concat(this.opts.pasteInlineTags);a=this.removeTagsExcept(a,e),a=this.opts.pasteLinks?a:this.removeTags(a,["a"]),a=this.opts.pasteImages?a:this.removeTags(a,["img"]);var d=this.utils.buildWrapper(a),f=d.find("*"),g=0!==this.opts.pasteKeepStyle.length?","+this.opts.pasteKeepStyle.join(","):"";f.not("[data-redactor-style-cache]"+g).removeAttr("style");var h=0!==this.opts.pasteKeepClass.length?","+this.opts.pasteKeepClass.join(","):"";f.not("[data-redactor-style-cache], span.redactor-component"+h).removeAttr("class");var i=0!==this.opts.pasteKeepAttrs.length?","+this.opts.pasteKeepAttrs.join(","):"";f.not("img, a, span.redactor-component, [data-redactor-style-cache]"+i).each(function(a){for(var b=a.attributes,c=b.length-1;c>=0;c--)"class"!==a.attributes[0].name&&a.removeAttribute(b[c].name)}),this.opts.pasteLinks&&!1!==this.opts.pasteLinkTarget&&d.find("a").attr("target",this.opts.pasteLinkTarget),d.find("[data-redactor-style-cache]").each(function(a){var b=a.getAttribute("data-redactor-style-cache");a.setAttribute("style",b)});var j=this.opts.imageAttrs;return d.find("img").each(function(a){if(a.attributes.length>0)for(var b=a.attributes,c=b.length-1;c>=0;c--)-1===j.indexOf(b[c].name)&&a.removeAttribute(b[c].name)}),d.find("span").each(function(a){0===a.attributes.length&&$R.dom(a).unwrap()}),d.find(this.opts.inlineTags.join(",")).each(function(a){0===a.attributes.length&&this.utils.isEmptyHtml(a.innerHTML)&&$R.dom(a).unwrap()}.bind(this)),d.find("ul, ol").each(function(a){var b=a.previousSibling;if(b&&"LI"===b.tagName){var c=$R.dom(b);c.find("p").unwrap(),c.append(a)}}),a=this.utils.getWrapperHtml(d),a=a.replace(/<li><p>/gi,"<li>"),a=a.replace(/<\/p><\/li>/gi,"</li>"),this.opts.breakline&&(a=a.replace(/\n/g,"<br>")),a=a.replace(/<p>&nbsp;<\/p>/gi,"<p></p>"),a=a.replace(/<p><br\s?\/?><\/p>/gi,"<p></p>"),c&&(a=a.replace(/<p><\/p>/gi,""),a=a.replace(/<p>\s<\/p>/gi,"")),a=this.restoreComponents(a)},pastePlainText:function(a){return a=this.opts.pasteLinks?this.storeLinks(a):a,a=this.opts.pasteImages?this.storeImages(a):a,a=this.getPlainText(a),a=this._replaceNlToBr(a),a=this.opts.pasteLinks?this.restoreLinks(a):a,a=this.opts.pasteImages?this.restoreImages(a):a},tidy:function(a){return a},paragraphize:function(a){return a=$R.create("cleaner.paragraphize",this.app).convert(a)},getFlatText:function(a){var b=$R.dom("<div>");return a.nodeType||a.dom?b.append(a):(a=a.toString(),a=a.trim(),b.html(a)),a=b.get().textContent||b.get().innerText||"",void 0===a?"":a},getPlainText:function(a){a=a.replace(/<!--[\s\S]*?-->/gi,""),a=a.replace(/<style[\s\S]*?style>/gi,""),a=a.replace(/<p><\/p>/g,""),a=a.replace(/<\/div>|<\/li>|<\/td>/gi,"\n"),a=a.replace(/<\/p>/gi,"\n\n"),a=a.replace(/<\/H[1-6]>/gi,"\n\n");var b=document.createElement("div");return b.innerHTML=a,a=b.textContent||b.innerText,a.trim()},replaceTags:function(a,b){if(b){var c=this,d=Object.keys(b),e=this.utils.buildWrapper(a);e.find(d.join(",")).each(function(a){c.utils.replaceToTag(a,b[a.tagName.toLowerCase()])}),a=this.utils.getWrapperHtml(e)}return a},replaceNbspToSpaces:function(a){return a.replace("&nbsp;"," ")},replaceBlocksToBr:function(a){return a=a.replace(/<\/div>|<\/li>|<\/td>|<\/p>|<\/H[1-6]>/gi,"<br>")},cleanNewLines:function(a){return a.replace(/\r?\n/g,"")},cleanSpacesInPre:function(a){return a.replace("&nbsp;&nbsp;&nbsp;&nbsp;","    ")},removeInvisibleSpaces:function(a){return a=this.utils.removeInvisibleChars(a),a=a.replace(/&#65279;/gi,"")},removeNl:function(a){return a=a.replace(/\n/g," "),a=a.replace(/\s+/g,"s")},removeBrAtEnd:function(a){return a=a.replace(/<br\s?\/?>$/gi," "),a=a.replace(/<br\s?\/?><li/gi,"<li")},removeTags:function(a,b){var c=b?/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi:/(<([^>]+)>)/gi,d=b?function(a,c){return-1===b.indexOf(c.toLowerCase())?a:""}:"";return a.replace(c,d)},removeTagsExcept:function(a,b){if(void 0===b)return a.replace(/(<([^>]+)>)/gi,"");var c=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return a.replace(c,function(a,c){return-1===b.indexOf(c.toLowerCase())?"":a})},removeComments:function(a){return a.replace(this.reComments,"")},removeServiceTagsAndAttrs:function(a,b){var c=this.utils.buildWrapper(a),d=this;return!1!==b&&c.find(".redactor-selection-marker").each(function(a){var b=$R.dom(a);return""===d.utils.removeInvisibleChars(b.text())?b.remove():b.unwrap()}),c.find("[data-redactor-style-cache]").removeAttr("data-redactor-style-cache"),this.utils.getWrapperHtml(c)},removeSpanWithoutAttributes:function(a){var b=this.utils.buildWrapper(a);return b.find("span").removeAttr("data-redactor-span data-redactor-style-cache").each(function(a){0===a.attributes.length&&$R.dom(a).unwrap()}),this.utils.getWrapperHtml(b)},removeFirstBlockBreaklineInHtml:function(a){return a.replace(new RegExp("</li><br\\s?/?>","gi"),"</li>")},removeEmptyAttributes:function(a,b){for(var c=this.utils.buildWrapper(a),d=0;d<b.length;d++)c.find("["+b[d]+'=""]').removeAttr(b[d]);return this.utils.getWrapperHtml(c)},encodeHtml:function(a){return a=a.replace(/<br\s?\/?>/g,"\n"),a=a.replace(/&nbsp;/g," "),a=a.replace(/”/g,'"'),a=a.replace(/“/g,'"'),a=a.replace(/‘/g,"'"),a=a.replace(/’/g,"'"),a=this.encodeEntities(a),a=a.replace(/\$/g,"&#36;"),this.opts.preSpaces&&(a=a.replace(/\t/g,new Array(this.opts.preSpaces+1).join(" "))),a},encodePreCode:function(a){var b=a.match(new RegExp("<code(.*?)>(.*?)<pre(.*?)>(.*?)</pre>(.*?)</code>","gi"));if(null!==b)for(var c=0;c<b.length;c++){var d=b[c].match(new RegExp("<pre(.*?)>([\\w\\W]*?)</pre>","i"));a=a.replace(d[0],this.encodeEntities(d[0]))}var e=this.utils.buildWrapper(a);return e.find("code code").replaceWith(this._encodeOuter.bind(this)),e.find("code pre").replaceWith(this._encodeOuter.bind(this)),e.find("pre pre").replaceWith(this._encodeOuter.bind(this)),e.find("code, pre").each(this._encodePreCodeLine.bind(this)),a=this.utils.getWrapperHtml(e),a=this._decodeMarkers(a)},encodeEntities:function(a){return a=this.decodeEntities(a),a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},encodePhpCode:function(a){return a=a.replace("<?php","&lt;?php"),a=a.replace("<?","&lt;?"),a=a.replace("?>","?&gt;")},decodeEntities:function(a){return String(a).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},storeComponents:function(a){var b=this.utils.getElementsFromHtml(a,"figure","table");return this._storeMatched(a,b,"Components","figure")},restoreComponents:function(a){return this._restoreMatched(a,"Components","figure")},storeLinks:function(a){var b=this.utils.getElementsFromHtml(a,"a");return this._storeMatched(a,b,"Links","a")},storeImages:function(a){var b=this.utils.getElementsFromHtml(a,"img");return this._storeMatched(a,b,"Images","img")},restoreLinks:function(a){return this._restoreMatched(a,"Links","a")},restoreImages:function(a){return this._restoreMatched(a,"Images","img")},_cleanWrapped:function(a){return a=a.replace(new RegExp("<p><figure([\\w\\W]*?)</figure></p>","gi"),"<figure$1</figure>")},_cleanGDocs:function(a){return a=a.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),a=a.replace(/<b(.*?)id="docs-internal-guid(.*?)">([\w\W]*?)<\/b>/gi,"$3"),a=a.replace(/<span[^>]*(font-style:\s?italic;\s?font-weight:\s?bold|font-weight:\s?bold;\s?font-style:\s?italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>"),a=a.replace(/<span[^>]*(font-style:\s?italic;\s?font-weight:\s?600|font-weight:\s?600;\s?font-style:\s?italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>"),a=a.replace(/<span[^>]*(font-style:\s?italic;\s?font-weight:\s?700|font-weight:\s?700;\s?font-style:\s?italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>"),a=a.replace(/<span[^>]*font-style:\s?italic[^>]*>([\w\W]*?)<\/span>/gi,"<i>$1</i>"),a=a.replace(/<span[^>]*font-weight:\s?bold[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>"),a=a.replace(/<span[^>]*font-weight:\s?700[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>"),a=a.replace(/<span[^>]*font-weight:\s?600[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>")},_cleanMsWord:function(a){a=a.replace(/<!--[\s\S]+?-->/gi,""),a=a.replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,""),a=a.replace(/<(\/?)s>/gi,"<$1strike>"),a=a.replace(/&nbsp;/gi," "),a=a.replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,b){return b.length>0?b.replace(/./," ").slice(Math.floor(b.length/2)).split("").join(" "):""});var b=this.utils.buildWrapper(a);b.find(".MsoFootnoteText").each(function(a){var b=$R.dom(a),c=b.parent();0!==c.length&&-1!==c.attr("style").search(/mso-element:footnote/)&&b.find("a").attr("id","_"+c.attr("id"))}),b.find(".MsoFootnoteReference").each(function(a){var b=$R.dom(a),c=b.parent();0!==c.length&&"A"===c.get().tagName&&c.attr("id",c.attr("name"))}),b.find("p").each(function(a){var b=$R.dom(a),c=b.attr("style"),d=/mso-list:\w+ \w+([0-9]+)/.exec(c);d&&b.attr("data-listLevel",parseInt(d[1],10))}),this._parseWordLists(b),b.find("[align]").removeAttr("align"),b.find("[name]").removeAttr("name"),b.find("span").each(function(a){var b=$R.dom(a);/mso-list:Ignore/.exec(b.attr("style"))?b.remove():b.unwrap()}),b.find("[style]").removeAttr("style"),b.find("[class^='Mso']").removeAttr("class"),b.find("a").filter(function(a){return!a.hasAttribute("href")}).unwrap(),a=this.utils.getWrapperHtml(b),a=a.replace(/<p[^>]*><\/p>/gi,""),a=a.replace(/<li>·/gi,"<li>"),a=a.trim(),a=a.replace(/\/(p|ul|ol|h1|h2|h3|h4|h5|h6|blockquote)>\s+<(p|ul|ol|h1|h2|h3|h4|h5|h6|blockquote)/gi,"/$1>\n<$2");for(var c="",d=a.split(/\n/),e=0;e<d.length;e++){var f=""!==d[e]&&-1===d[e].search(/>$/)?" ":"\n";c+=d[e]+f}return c},_parseWordLists:function(a){var b=0,c=null,d=null,e=null;a.find("p").each(function(a){var f=$R.dom(a),g=f.attr("data-listLevel");if(null===g&&f.hasClass("MsoListParagraphCxSpMiddle")&&(g=1),null!==g){var h=f.text(),i=/^\s*\w+\./.test(h)?"<ol></ol>":"<ul></ul>";if(f.hasClass("MsoListParagraphCxSpFirst")||f.hasClass("MsoNormal")?(d=$R.dom(i),f.before(d)):g>b&&0!==b&&(e=$R.dom(i),c.append(e),d=e),g<b)for(var j=b-g+1,k=0;k<j;k++)d=d.parent();f.find("span").first().unwrap(),c=$R.dom("<li>"+f.html().trim()+"</li>"),null===d&&(f.before(i),d=f.prev()),d.append(c),f.remove(),b=g}else d=null,b=0})},_isSpacedEmpty:function(a){return-1!==a.search(this.reSpacedEmpty)},_isParagraphEmpty:function(a){return-1!==a.search(/^<p><\/p>$/i)},_isHtmlMsWord:function(a){return a.match(/class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i)},_setSpanAttr:function(a){var b=this.utils.buildWrapper(a);return b.find("span").attr("data-redactor-span",!0),this.utils.getWrapperHtml(b)},_setStyleCache:function(a){var b=this.utils.buildWrapper(a);return b.find("[style]").each(function(a){var b=$R.dom(a);b.attr("data-redactor-style-cache",b.attr("style"))}),this.utils.getWrapperHtml(b)},_setPreClass:function(a){var b=this.utils.buildWrapper(a);return b.find("pre").addClass(this.opts.preClass),this.utils.getWrapperHtml(b)},_setLinkNofollow:function(a){var b=this.utils.buildWrapper(a);return b.find("a").attr("rel","nofollow"),this.utils.getWrapperHtml(b)},_replaceScriptTag:function(a){return a.replace(this.reScriptTag,'<script class="redactor-script-tag" $1>$2<\/script>')},_unreplaceScriptTag:function(a){return a.replace(/<script class="redactor-script-tag"(.*?[^>]?)>([\w\W]*?)<\/script>/gi,"<script$1>$2<\/script>")},_replaceNlToBr:function(a){return a.replace(/\n/g,"<br />")},_removeScriptTag:function(a){return a.replace(this.reScriptTag,"")},_storeMatched:function(a,b,c,d){if(this["stored"+c]=[],b)for(var e=0;e<b.length;e++)this["stored"+c][e]=b[e],a=a.replace(b[e],"####"+d+e+"####");return a},_restoreMatched:function(a,b,c){if(this["stored"+b])for(var d=0;d<this["stored"+b].length;d++)a=a.replace("####"+c+d+"####",this["stored"+b][d]);return a},_decodeMarkers:function(a){return a.replace(/&lt;span\sid="selection-marker-(start|end)"\sclass="redactor-selection-marker"&gt;(.*?[^>]?)&lt;\/span&gt;/g,'<span id="selection-marker-$1" class="redactor-selection-marker">​</span>')},_encodeOuter:function(a){return this.encodeEntities(a.outerHTML)},_encodePreCodeLine:function(a){var b=a.firstChild;if("PRE"!=a.tagName||!b||"CODE"!==b.tagName){var c=this.decodeEntities(a.innerHTML);c=c.replace(/&nbsp;/g," ").replace(/<br\s?\/?>/g,"\n"),c=this.opts.preSpaces?c.replace(/\t/g,new Array(this.opts.preSpaces+1).join(" ")):c,a.textContent=c}}}),$R.add("class","cleaner.figure",{init:function(a){this.app=a,this.opts=a.opts,this.utils=a.utils,this.detector=a.detector},convert:function(a,b){var c=this.utils.buildWrapper(a);return c.find("img").each(this._convertImage.bind(this)),c.find("hr").each(this._convertLine.bind(this)),c.find("iframe").each(this._convertIframe.bind(this)),c.find("table").each(this._convertTable.bind(this)),c.find("form").each(this._convertForm.bind(this)),c.find("figure pre").each(this._convertCode.bind(this)),c.find("[data-redactor-type=variable]").addClass("redactor-component"),c.find("figure").not(".redactor-component, .redactor-figure-code").each(this._convertWidget.bind(this)),c.find("figure pre").each(this._setContenteditableCode.bind(this)),c.find(".redactor-component, .non-editable").attr("contenteditable",!1),this.detector.isIe()&&c.find("[data-redactor-type=table]").removeAttr("contenteditable"),c.find("figcaption, td, th").attr("contenteditable",!0),c.find(".redactor-component, figcaption").attr("tabindex","-1"),this._acceptExtraRules(c,b),this.utils.getWrapperHtml(c)},unconvert:function(a,b){a=a.replace(/<\/([^>]+)><div data-redactor-tag/g,"</$1>\n<div data-redactor-tag"),a=a.replace(/<\/([^>]+)><p/g,"</$1>\n<p");var c=this.utils.buildWrapper(a);return c.find("th, td, figcaption, figure, pre, code, .redactor-component").removeAttr("contenteditable tabindex"),c.find("figure").removeClass("redactor-component redactor-component-active redactor-uploaded-figure"),c.find("[data-redactor-type=variable]").removeClass("redactor-component redactor-component-active"),c.find("figure[data-redactor-type=line]").unwrap(),c.find("figure[data-redactor-type=widget]").each(this._unconvertWidget.bind(this)),c.find("figure[data-redactor-type=form]").each(this._unconvertForm.bind(this)),c.find("figure[data-redactor-type=table]").each(this._unconvertTable.bind(this)),c.find("figure[data-redactor-type=image]").removeAttr("rel").each(this._unconvertImages.bind(this)),c.find("img").removeAttr("data-redactor-type").removeClass("redactor-component"),c.find(".non-editable").removeAttr("contenteditable"),c.find("figure").each(this._removeTypes.bind(this)),c.find("span.redactor-component-caret").remove(),c=this._unconvertBreakTag(c),this._acceptExtraRules(c,b),a=this.utils.getWrapperHtml(c),a=a.replace(/<br\s?\/?>$/,""),a=a.replace(/<br\s?\/?><\/(td|th)>/,"</$1>")},_convertImage:function(a){var b=$R.dom(a);if(!this._isNonEditable(b)){this.opts.imageObserve&&!b.attr("data-image")&&b.attr("data-image",this.utils.getRandomId());var c=b.closest("a"),d=b.closest("figure");if(0===d.children().not("a, img, br, figcaption").length){if(0===d.length){var e=0!==c.length?c.closest("p"):b.closest("p");if(!1===this.opts.imageFigure&&0!==e.length){d=this.utils.replaceToTag(e,"figure"),d.addClass("redactor-replace-figure")}else 0!==e.length&&e.unwrap(),d=0!==c.length?c.wrap("<figure>"):b.wrap("<figure>")}else d.hasClass("redactor-uploaded-figure")?d.removeClass("redactor-uploaded-figure"):d.addClass("redactor-keep-figure");this._setFigure(d,"image")}}},_convertTable:function(a){if(!this._isNonEditable(a)){var b=this._wrapFigure(a);this._setFigure(b,"table")}},_convertLine:function(a){if(!this._isNonEditable(a)){var b=this._wrapFigure(a);this._setFigure(b,"line")}},_convertForm:function(a){if(!this._isNonEditable(a)){var b=this.utils.replaceToTag(a,"figure");this._setFigure(b,"form")}},_convertIframe:function(a){if(!this._isNonEditable(a)){if(0===$R.dom(a).closest(".redactor-component").length){var b=a.getAttribute("src"),c=b&&(b.match(this.opts.regex.youtube)||b.match(this.opts.regex.vimeo)),d=this._wrapFigure(a);c&&this._setFigure(d,"video")}}},_convertCode:function(a){if(!this._isNonEditable(a)){var b=this._wrapFigure(a);this._setFigure(b,"code")}},_convertWidget:function(a){if(!this._isNonEditable(a)){var b=$R.dom(a);b.addClass("redactor-component"),b.attr("data-redactor-type","widget"),b.attr("data-widget-code",encodeURI(a.innerHTML.trim()))}},_unconvertBreakTag:function(a){return a.find("[data-redactor-tag]").each(function(a){var b=$R.dom(a);if(b.removeAttr("data-redactor-tag"),this.utils.isEmptyHtml(b.html()))b.unwrap();else if(a.lastChild&&"BR"===a.lastChild.tagName)b.unwrap();else{var c=b.nextElement();0!==c.length&&c.attr("data-redactor-tag")&&a.appendChild(document.createElement("br")),b.unwrap()}}.bind(this)),a},_unconvertForm:function(a){this.utils.replaceToTag(a,"form")},_unconvertTable:function(a){$R.dom(a).unwrap()},_unconvertWidget:function(a){var b=$R.dom(a);b.html(decodeURI(b.attr("data-widget-code"))),b.removeAttr("data-widget-code")},_unconvertImages:function(a){var b=$R.dom(a);b.removeClass("redactor-component");var c=0!==b.closest("li").length,d=0!==b.closest("table").length,e=0!==b.find("figcaption").length,f=b.attr("style"),g=!(null===f||""===f),h=""!==b.attr("class");(c||d&&!e&&!g&&!h)&&b.unwrap()},_removeTypes:function(a){var b=$R.dom(a),c=b.attr("data-redactor-type"),d=["image","widget","line","video","code","form","table"];if(c&&-1!==d.indexOf(c)&&b.removeAttr("data-redactor-type"),b.hasClass("redactor-keep-figure"))b.removeClass("redactor-keep-figure");else if("image"===c&&!1===this.opts.imageFigure){var e=0!==b.find("figcaption").length;e||(b.hasClass("redactor-replace-figure")?(b.removeClass("redactor-replace-figure"),this.utils.replaceToTag(b,"p")):b.unwrap())}b.removeClass("redactor-replace-figure")},_wrapFigure:function(a){var b=$R.dom(a),c=b.closest("figure");return 0===c.length?b.wrap("<figure>"):c},_setFigure:function(a,b){a.addClass("redactor-component"),a.attr("data-redactor-type",b)},_setContenteditableCode:function(a){if(!this._isNonEditable(a)){var b=$R.dom(a),c=b.children("code").first();(0!==c.length?c:b).attr("contenteditable",!0).attr("tabindex","-1")}},_acceptExtraRules:function(a,b){for(var c in b)"function"==typeof b[c]&&b[c](a)},_isNonEditable:function(a){return 0!==$R.dom(a).closest(".non-editable").length}}),$R.add("class","cleaner.paragraphize",{init:function(a){this.app=a,this.opts=a.opts,this.utils=a.utils,this.element=a.element,this.stored=[],this.storedComments=[],this.remStart="#####replace",this.remEnd="#####",
this.paragraphizeTags=["table","div","pre","form","ul","ol","h1","h2","h3","h4","h5","h6","dl","blockquote","figcaption","address","section","header","footer","aside","article","object","style","script","iframe","select","input","textarea","button","option","map","area","math","hr","fieldset","legend","hgroup","nav","figure","details","menu","summary","p"]},convert:function(a){var b=this._isConverted(a);return b=!0===b?this._convert(a):b,b=this._convertTable(b)},_convert:function(a,b){var c=this.opts.breakline||b?"sdivtag":this.opts.markup,d=b?"tbr":"br";a=this._storeTags(a),a=this._storeComments(a),a=a.trim(),a=this._trimLinks(a),a=a.replace(/xparagraphmarkerz(?:\r\n|\r|\n)$/g,""),a=a.replace(/xparagraphmarkerz$/g,""),a=a.replace(/xparagraphmarkerz(?:\r\n|\r|\n)/g,"\n"),a=a.replace(/xparagraphmarkerz/g,"\n"),this.opts.breakline?(a=a.replace(/<br\s?\/?>(?:\r\n|\r|\n)/gi,"xbreakmarkerz\n"),a=a.replace(/<br\s?\/?>/gi,"xbreakmarkerz\n")):a=a.replace(/[\n]+/g,"\n");for(var e="",f=a.split("\n"),g=0;g<f.length;g++)e+="<"+c+">"+f[g]+"</"+c+">\n";return a=e.replace(/\n$/,""),a=a.replace(new RegExp("<"+c+">\\s+#####","gi"),"#####"),a=a.replace(new RegExp("<"+c+">#####","gi"),"#####"),a=a.replace(new RegExp("#####</"+c+">","gi"),"#####"),a=this.opts.breakline?a.replace(/xbreakmarkerz/gi,"<br>"):a,a=this._restoreTags(a),a=this._restoreComments(a),this.opts.breakline?a=a.replace(new RegExp("<"+c+"></"+c+">","gi"),"<"+c+"><br></"+c+">"):(a=a.replace(new RegExp("<"+c+"><br\\s?/?></"+c+">","gi"),""),a=a.replace(new RegExp("<"+c+"></"+c+">","gi"),"")),a=a.replace(new RegExp("<sdivtag>","gi"),'<div data-redactor-tag="'+d+'">'),a=a.replace(new RegExp("sdivtag","gi"),"div"),a=a.replace(/<\/([^>]+)><div data-redactor-tag/g,"</$1>\n<div data-redactor-tag")},_convertTable:function(a){var b=this.utils.buildWrapper(a);return b.find("td, th").each(this._convertCell.bind(this)),a=this.utils.getWrapperHtml(b)},_convertCell:function(a){var b=$R.dom(a);this.stored=[];var c=this._convert(b.html(),!0);b.html(c)},_storeTags:function(a){var b=this,c=this.utils.buildWrapper(a);return c.find(this.paragraphizeTags.join(", ")).each(function(a,c){var d=document.createTextNode(b.remStart+c+b.remEnd+"xparagraphmarkerz");b.stored.push(a.outerHTML),a.parentNode.replaceChild(d,a)}),this.utils.getWrapperHtml(c)},_storeComments:function(a){var b=a.match(new RegExp("\x3c!--([\\w\\W]*?)--\x3e","gi"));if(null!==b)for(var c=0;c<b.length;c++)a=a.replace(b[c],"#####xstarthtmlcommentzz"+c+"xendhtmlcommentzz#####"),this.storedComments.push(b[c]);return a},_restoreTags:function(a){for(var b=0;b<this.stored.length;b++)this.stored[b]=this.stored[b].replace(/\$/g,"&#36;"),a=a.replace(this.remStart+b+this.remEnd,this.stored[b]);return a},_restoreComments:function(a){for(var b=0;b<this.storedComments.length;b++)a=a.replace("#####xstarthtmlcommentzz"+b+"xendhtmlcommentzz#####",this.storedComments[b]);return a},_trimLinks:function(a){var b=this.utils.buildWrapper(a);return b.find("a").each(this._trimLink.bind(this)),a=this.utils.getWrapperHtml(b)},_trimLink:function(a){var b=$R.dom(a);b.html(b.html().trim())},_isConverted:function(a){return this._isDisabled(a)?a:!this._isEmptyHtml(a)||this.opts.emptyHtml},_isDisabled:function(){return!1===this.opts.paragraphize||this.element.isType("inline")},_isEmptyHtml:function(a){return""===a||"<p></p>"===a||"<div></div>"===a}}),$R.add("service","detector",{init:function(a){this.app=a,this.userAgent=navigator.userAgent.toLowerCase()},isWebkit:function(){return/webkit/.test(this.userAgent)},isFirefox:function(){return this.userAgent.indexOf("firefox")>-1},isIe:function(a){if(document.documentMode||/Edge/.test(navigator.userAgent))return"edge";var b;return b=RegExp("msie"+(isNaN(a)?"":"\\s"+a),"i").test(navigator.userAgent),b||(b=!!navigator.userAgent.match(/Trident.*rv[ :]*11\./)),b},isMobile:function(){return/(iPhone|iPod|Android)/.test(navigator.userAgent)},isDesktop:function(){return!/(iPhone|iPod|iPad|Android)/.test(navigator.userAgent)},isIpad:function(){return/iPad/.test(navigator.userAgent)}}),$R.add("service","offset",{init:function(a){this.app=a},get:function(a,b){var c={start:0,end:0},d=this.utils.getNode(a);if(!d)return!1;var e=this.editor.isEditor(d),f=!!e||this.selection.isIn(d),g=this.selection.getRange();if(e||f){if(this.selection.is()&&f){var h=$R.dom(g.startContainer),i=h.hasClass("redactor-component")?g.startOffset:0,j=g.cloneRange();j.selectNodeContents(d),j.setEnd(g.startContainer,g.startOffset);var k=this._getString(g,b);c.start=this._getString(j,b).length-i,c.end=c.start+k.length+i}}else c=!1;return c},set:function(a,b){if(!this._setComponentOffset(b)){this.component.clearActive();var c=this.utils.getNode(b);if(c){var d=this.size(c),e=0,f=document.createRange();a.end=a.end>d?d:a.end,f.setStart(c,0),f.collapse(!0);for(var g=[c],h=!1,i=!1;!i&&(c=g.pop());)if(3==c.nodeType){var j=e+c.length;!h&&!this._isFigcaptionNext(c)&&a.start>=e&&a.start<=j&&(f.setStart(c,a.start-e),h=!0),h&&a.end>=e&&a.end<=j&&(f.setEnd(c,a.end-e),i=!0),e=j}else for(var k=c.childNodes.length;k--;)g.push(c.childNodes[k]);this.selection.setRange(f)}}},size:function(a,b){var c=this.utils.getNode(a);if(c){var d=document.createRange(),e=d.cloneRange();return e.selectNodeContents(c),this._getString(e,b).length}return 0},_getString:function(a,b){var c=a.toString();return c=this.editor.isEmpty()?c.replace(/\uFEFF/g,""):c,c=b?c.trim():c},_setComponentOffset:function(a){return!!this.component.isNonEditable(a)&&this.component.setActive(a)},_isFigcaptionNext:function(a){var b=a.nextSibling;return""===a.nodeValue.trim()&&b&&"FIGCAPTION"===b.tagName}}),$R.add("service","inspector",{init:function(a){this.app=a},parse:function(a){return $R.create("inspector.parser",this.app,this,a)},isText:function(a){if("string"==typeof a&&!/^\s*<(\w+|!)[^>]*>/.test(a))return!0;var b=$R.dom(a).get();return b&&3===b.nodeType},isInlineTag:function(a,b){var c=this._extendTags(this.opts.inlineTags,b);return this._isTag(a)&&-1!==c.indexOf(a.toLowerCase())},isBlockTag:function(a,b){var c=this._extendTags(this.opts.blockTags,b);return this._isTag(a)&&-1!==c.indexOf(a.toLowerCase())},isTableCellTag:function(a){return-1!==["td","th"].indexOf(a.toLowerCase())},isHeadingTag:function(a){return-1!==["h1","h2","h3","h4","h5","h6"].indexOf(a.toLowerCase())},_isTag:function(a){return void 0!==a&&a},_extendTags:function(a,b){if(a=a.concat(a),b)for(var c=0;c<b.length;c++)a.push(b[c]);return a}}),$R.add("class","inspector.parser",{init:function(a,b,c){this.app=a,this.uuid=a.uuid,this.opts=a.opts,this.utils=a.utils,this.editor=a.editor,this.selection=a.selection,this.inspector=b,this.el=c,this.$el=$R.dom(this.el,".redactor-in-"+this.uuid),this.node=this.$el.get(),this.node&&8===this.node.nodeType&&(this.node=!1),this.$component=this.$el.closest(".redactor-component",".redactor-in")},isEditor:function(){return this.node===this.editor.getElement().get()},isInEditor:function(){return 0!==this.$el.parents(".redactor-in-"+this.uuid).length},isComponent:function(){return 0!==this.$component.length},isComponentType:function(a){return this.getComponentType()===a},isComponentActive:function(){return this.isComponent()&&this.$component.hasClass("redactor-component-active")},isComponentEditable:function(){var a=["code","table"],b=this.getComponentType();return this.isComponent()&&-1!==a.indexOf(b)},isFigcaption:function(){return this.getFigcaption()},isPre:function(){return this.getPre()},isCode:function(){var a=this.$el.closest("code"),b=a.parent("pre");return 0!==a.length&&0===b.length},isList:function(){return this.getList()},isFirstListItem:function(){return this._getLastOrFirstListItem("first")},isLastListItem:function(){return this._getLastOrFirstListItem("last")},isFirstTableCell:function(){return this._getLastOrFirstTableCell("first")},isLastTableCell:function(){return this._getLastOrFirstTableCell("last")},isTable:function(){return this.isComponentType("table")||this.getTable()},isHeading:function(){return this.getHeading()},isBlockquote:function(){return this.getBlockquote()},isDl:function(){return this.getDl()},isParagraph:function(){return this.getParagraph()},isLink:function(){return this.getLink()},isFile:function(){return this.getFile()},isText:function(){return this.inspector.isText(this.el)},isInline:function(){var a=this.opts.inlineTags;return!!this.isElement()&&-1!==a.indexOf(this.node.tagName.toLowerCase())},isBlock:function(){var a=this.opts.blockTags;return!!this.isElement()&&-1!==a.indexOf(this.node.tagName.toLowerCase())},isElement:function(){return this.node&&this.node.nodeType&&3!==this.node.nodeType},hasParent:function(a){return 0!==this.$el.closest(a.join(",")).length},getNode:function(){return this.node},getTag:function(){return!!this.isElement()&&this.node.tagName.toLowerCase()},getComponent:function(){return!!this.isComponent()&&this.$component.get()},getComponentType:function(){return!!this.isComponent()&&this.$component.attr("data-redactor-type")},getFirstNode:function(){return this.utils.getFirstNode(this.node)},getLastNode:function(){return this.utils.getLastNode(this.node)},getFirstElement:function(){return this.utils.getFirstElement(this.node)},getLastElement:function(){return this.utils.getLastElement(this.node)},getFigcaption:function(){return this._getClosestNode("figcaption")},getPre:function(){return this._getClosestNode("pre")},getCode:function(){return this._getClosestNode("code")},getList:function(){return this._getClosestNode("ul, ol")},getParentList:function(){return this._getClosestUpNode("ul, ol")},getListItem:function(){return this._getClosestNode("li")},getTable:function(){return this.getComponentType("table")?this.$component.find("table").get():this._getClosestNode("table")},getTableCell:function(){var a=this.$el.closest("td, th");return 0!==a.length&&a.get()},getComponentCodeElement:function(){return!!this.isComponentType("code")&&this.$component.find("pre code, pre").last().get()},getImageElement:function(){return!!this.isComponentType("image")&&this.$component.find("img").get()},getParagraph:function(){return this._getClosestNode("p")},getHeading:function(){return this._getClosestNode("h1, h2, h3, h4, h5, h6")},getDl:function(){return this._getClosestNode("dl")},getBlockquote:function(){return this._getClosestNode("blockquote")},getLink:function(){var a=this.isComponent()&&!this.isFigcaption();if(this.isComponentType("table")||!a){var b=this._getClosestElement("a");return!(!b||b.attr("data-file"))&&b.get()}return!1},getFile:function(){var a=this.isComponent();if(this.isComponentType("table")||!a){var b=this._getClosestElement("a");return!(!b||!b.attr("data-file"))&&b.get()}return!1},findFirstNode:function(a){return this.$el.find(a).first().get()},findLastNode:function(a){return this.$el.find(a).last().get()},_getLastOrFirstListItem:function(a){var b=this.getList(),c=this.getTag();if(b&&"li"===c){var d=$R.dom(b).find("li")[a]().get();if(d&&this.node===d)return!0}return!1},_getLastOrFirstTableCell:function(a){var b=this.getTable(),c=this.getTag();if(b&&("td"===c||"th"===c)){var d=$R.dom(b).find("td, th")[a]().get();if(d&&this.node===d)return!0}return!1},_getClosestUpNode:function(a){var b=this.$el.parents(a,".redactor-in-"+this.uuid).last();return 0!==b.length&&b.get()},_getClosestNode:function(a){var b=this.$el.closest(a,".redactor-in-"+this.uuid);return 0!==b.length&&b.get()},_getClosestElement:function(a){var b=this.$el.closest(a,".redactor-in-"+this.uuid);return 0!==b.length&&b}}),$R.add("service","marker",{init:function(a){this.app=a},build:function(a,b){var c=document.createElement("span");return c.id="selection-marker-"+this._getPos(a),c.className="redactor-selection-marker",c.innerHTML=this.opts.markerChar,b?c.outerHTML:c},buildHtml:function(a){return this.build(a,!0)},insert:function(a){this.remove();var b="both"!==a&&("start"===a||this.selection.isCollapsed());this.selection.is()||this.editor.focus();var c=this.selection.getRange();if(c){var d=this.build("start"),e=this.build("end"),f=c.cloneRange();return b||(f.collapse(!1),f.insertNode(e)),f.setStart(c.startContainer,c.startOffset),f.collapse(!0),f.insertNode(d),c.setStartAfter(d),b||c.setEndBefore(e),this.selection.setRange(c),d}},find:function(a,b){var c=this.editor.getElement(),d=(b||c).find("span#selection-marker-"+this._getPos(a));return 0!==d.length&&d.get()},restore:function(){var a=this.find("start"),b=this.find("end"),c=this.selection.getRange();if(c&&this.selection.is()||(this.editor.focus(),c=document.createRange()),a){var d=!!b&&b.previousSibling,e=a.nextSibling;e=(!e||3!==e.nodeType||""!==e.textContent.replace(/[\n\t]/g,""))&&e,b?e&&"selection-marker-end"===e.id?this._restoreInject(c,a):d&&e?(c.selectNodeContents(d),c.collapse(!1),c.setStart(e,0)):d&&!e?(c.selectNodeContents(d),c.collapse(!1),c.setStartAfter(a)):(c.setStartAfter(a),c.setEndBefore(b)):e?(c.selectNodeContents(e),c.collapse(!0)):this._restoreInject(c,a),this.selection.setRange(c),a&&a.parentNode.removeChild(a),b&&b.parentNode.removeChild(b)}},remove:function(){var a=this.find("start"),b=this.find("end");a&&a.parentNode.removeChild(a),b&&b.parentNode.removeChild(b)},_getPos:function(a){return void 0===a?"start":a},_restoreInject:function(a,b){var c=this.utils.createInvisibleChar();$R.dom(b).after(c),a.selectNodeContents(c),a.collapse(!1)}}),$R.add("service","component",{init:function(a){this.app=a,this.activeClass="redactor-component-active"},create:function(a,b){return $R.create(a+".component",this.app,b)},build:function(a){var b,c=$R.dom(a),d=c.attr("data-redactor-type");return d&&(b=this.create(d,a)),b||a},remove:function(a,b){var c=$R.dom(a).closest(".redactor-component"),d=c.attr("data-redactor-type"),e=c.parent(),f=this.inspector.parse(e),g=this.utils.findSiblings(c,"prev"),h=this.utils.findSiblings(c,"next");if(!1!==this.app.broadcast(d+".delete",c)){if(c.remove(),this.app.broadcast(d+".deleted",c),this.app.broadcast("contextbar.close"),this.app.broadcast("imageresizer.stop"),!1!==b){var i=f.getTableCell();i&&this.utils.isEmptyHtml(i.innerHTML)?this.caret.setStart(i):h?this.caret.setStart(h):g?this.caret.setEnd(g):this.editor.startFocus()}this.editor.isEmpty()&&(this.editor.setEmpty(),this.editor.startFocus(),this.app.broadcast("empty"))}},isNonEditable:function(a){var b=this.inspector.parse(a);return b.isComponent()&&!b.isComponentEditable()},isActive:function(a){var b;if(a){var c=this.inspector.parse(a);return b=$R.dom(c.getComponent()),b.hasClass(this.activeClass)}return b=this._find(),0!==b.length},getActive:function(a){var b=this._find();return 0!==b.length&&(a?b:b.get())},setActive:function(a){this.clearActive(),this.editor.focus();var b=this.inspector.parse(a),c=b.getComponent(),d=$R.dom(c);if(!b.isFigcaption()){var e=d.find(".redactor-component-caret");0===e.length&&(e=this._buildCaret(),d.prepend(e)),this.caret.setAtStart(e.get())}d.addClass(this.activeClass)},clearActive:function(){var a=this._find();a.removeClass(this.activeClass),a.find(".redactor-component-caret").remove(),this.app.broadcast("imageresizer.stop")},setOnEvent:function(a,b){this.clearActive();var c=this.inspector.parse(a.target);c.isFigcaption()||c.isComponentEditable()||c.isComponent()&&(this.setActive(a.target),!0!==b&&a.preventDefault())},executeScripts:function(scripts){if(void 0===scripts){var $editor=this.editor.getElement(),scripts=$editor.find("[data-redactor-type]").find("script").getAll();this.executeScripts.call(this,scripts)}else for(var i=0;i<scripts.length;i++){if(""!==scripts[i].src){var src=scripts[i].src;this.$doc.find('head script[src="'+src+'"]').remove();var $script=$R.dom("<script>");$script.attr("src",src),$script.attr("async defer"),$script.get().onload=function(){-1!==src.search("instagram")&&window.instgrm.Embeds.process(),this.executeScripts(scripts.slice(i+1))}.bind(this);var head=document.getElementsByTagName("head")[0];head&&head.appendChild($script.get());break}try{eval(scripts[i].innerHTML)}catch(a){}}},_find:function(){return this.editor.getElement().find("."+this.activeClass)},_buildCaret:function(){var a=$R.dom("<span>");return a.addClass("redactor-component-caret"),a.attr("contenteditable",!0),a}}),$R.add("service","insertion",{init:function(a){this.app=a},set:function(a,b,c){return null===a&&(a=""),a=!1!==b?this.cleaner.input(a):a,a=!1!==b?this.cleaner.paragraphize(a):a,this.editor.getElement().html(a),!1!==c&&this.editor.endFocus(),a},insertNode:function(a,b){this.editor.focus();var c=this.utils.isFragment(a)?a:this.utils.createFragment(a);return this._collapseSelection(),this._insertFragment(c),this._setCaret(b,c),this._sendNodes(c.nodes)},insertBreakLine:function(){return this.insertNode(document.createElement("br"),"after")},insertNewline:function(){return this.insertNode(document.createTextNode("\n"),"after")},insertText:function(a){return this.insertHtml(this.cleaner.getFlatText(a))},insertChar:function(a){return this.insertNode(a,"after")},insertRaw:function(a){return this.insertHtml(a,!1)},insertToEnd:function(a,b){if(a){3===a.nodeType&&-1!==a.nodeValue.search(/^\n/)&&(a=a.previousElementSibling);var c=$R.dom(a);if(c.attr("data-redactor-type")===b){var d=this.opts.breakline?"<br>":"<p>",e=$R.dom(d);c.after(e),this.caret.setStart(e)}}},insertPoint:function(a){var b,c,d=this.marker.build("start"),e=!1,f=a.clientX,g=a.clientY;if(document.caretPositionFromPoint){var h=document.caretPositionFromPoint(f,g),i=document.getSelection();c=this.inspector.parse(h.offsetNode),c.isInEditor()&&(b=i.getRangeAt(0),b.setStart(h.offsetNode,h.offset),b.collapse(!0),b.insertNode(d),e=!0)}else document.caretRangeFromPoint&&(b=document.caretRangeFromPoint(f,g),c=this.inspector.parse(b.startContainer),c.isInEditor()&&(b.insertNode(d),e=!0));return e},insertToPoint:function(a,b,c,d){if(!0!==c&&!this.insertPoint(a)){var e=this.editor.getLastNode();$R.dom(e).after(this.marker.build("start"))}return this.component.clearActive(),this.selection.restoreMarkers(),this.insertHtml(b,d)},insertToOffset:function(a,b){return this.offset.set({start:a,end:a}),this.insertHtml(b)},insertHtml:function(a,b){if(this.opts.input){var c=this.utils.parseHtml(a);if(this.selection.isAll())return this._insertToAllSelected(c);if(!this.selection.is()){var d=$R.dom("<p>");this.editor.getElement().append(d),this.caret.setStart(d)}var e=this.selection.isCollapsed(),f=this.selection.isText(),g=this.selection.getCurrent(),h=this.selection.getBlock(),i=this.inspector.parse(g);this._collapseSelection(),c=this._getCleanedInput(c,i,b);var j,k,l=this._isFigure(c.html),m=this._isComponentSpan(c.html),n=this.inspector.isText(c.html);if(this.editor.isEmpty())return this._insertToEmptyEditor(c.html);if(i.isComponent()&&!i.isComponentEditable())return this._insertToWidget(g,i,c.html);if(m)return this.insertNode(c.nodes,"end");if(l&&!f&&!i.isList())return i.isInline()?this._insertToInline(g,c):(j=this.utils.createFragment(c.html),this.utils.splitNode(g,j),this.caret.setEnd(j.last),this._sendNodes(j.nodes));if(i.isCode())return this._insertToCode(c,g,b);if(i.isPre())return this._insertToPre(c,b);if(i.isHeading()||i.isFigcaption())return c.html=!1!==b?this.cleaner.removeTagsExcept(c.html,["a"]):c.html,c.html=!1!==b?this.cleaner.replaceNbspToSpaces(c.html):c.html,j=this.utils.createFragment(c.html),this.insertNode(j,"end");if(this.opts.breakline&&h&&"DIV"===h.tagName)return c.html=!1!==b?this.cleaner.paragraphize(c.html):c.html,j=this.utils.createFragment(c.html),this.utils.splitNode(g,j),this.caret.setEnd(j.last),this._sendNodes(j.nodes);if(n)return!f&&"br"!==this.opts.markup&&this._hasBlocksAndImages(c.nodes)?(c.html=!1!==b?this.cleaner.paragraphize(c.html):c.html,j=this.utils.createFragment(c.html),this.utils.splitNode(g,j),this.caret.setEnd(j.last),this._sendNodes(j.nodes)):(c.html=!1!==b?c.html.replace(/\n/g,"<br>"):c.html,j=this.utils.createFragment(c.html),this.insertNode(j.nodes,"end"));if(!e&&!l)return c.html=!1!==b?this.cleaner.paragraphize(c.html):c.html,j=this.utils.createFragment(c.html),this.insertNode(j,"end");if(i.isInline()&&!this._isPlainHtml(c.html))return this._insertToInline(g,c);if(i.isBlockquote()||i.isDl())return k=this.opts.inlineTags,k.concat(["br"]),c.html=!1!==b?this.cleaner.replaceBlocksToBr(c.html):c.html,c.html=!1!==b?this.cleaner.removeTagsExcept(c.html,k):c.html,j=this.utils.createFragment(c.html),this.insertNode(j,"end");if(i.isParagraph())return this._isPlainHtml(c.html)?this.insertNode(c.nodes,"end"):(c.html=!1!==b?this.cleaner.paragraphize(c.html):c.html,j=this.utils.createFragment(c.html),this.utils.splitNode(g,j),this.caret.setEnd(j.last),this._sendNodes(j.nodes));if(i.isList()&&(k=this.opts.inlineTags,k=k.concat(["br","li","ul","ol","img"]),c.html=!1!==b?this.cleaner.replaceBlocksToBr(c.html):c.html,c.html=!1!==b?this.cleaner.removeTagsExcept(c.html,k):c.html,c.html=!1!==b?this.cleaner.removeBrAtEnd(c.html):c.html,j=this.utils.createFragment(c.html),c.nodes=j.nodes,this._containsTags(c.html,["ul","ol","li"]))){var o=this.selection.getElement(g);if(o&&"LI"===o.tagName&&this.caret.isStart(o)){c.nodes=$R.dom(j.nodes).unwrap("ul, ol").getAll(),$R.dom(o).before(c.nodes);var p=c.nodes[c.nodes.length-1];return this.caret.setEnd(p),this._sendNodes(c.nodes)}return this._isPlainHtml(c.html)?this.insertNode(j,"end"):(j=this._buildList(c,o,j),this.utils.splitNode(g,j,!0),this.caret.setEnd(j.last),this._sendNodes(j.nodes))}return this.insertNode(c.nodes,"end")}},_insertToAllSelected:function(a){var b=this.set(a.html),c=this.utils.parseHtml(b);return this._sendNodes(c.nodes)},_insertToEmptyEditor:function(a){a=this.cleaner.paragraphize(a);var b=this.utils.createFragment(a),c=this.editor.getElement();return c.html(""),c.append(b.frag),this.caret.setEnd(b.last),this._sendNodes(b.nodes)},_insertToInline:function(a,b){var c=this.utils.createFragment(b.html);return this.utils.splitNode(a,c,!1,!0),this.caret.setEnd(c.last),this._sendNodes(c.nodes)},_insertToCode:function(a,b,c){a.html=!1!==c?this.cleaner.encodeHtml(a.html):a.html,a.html=!1!==c?this.cleaner.removeNl(a.html):a.html;var d=this.utils.createFragment(a.html),e=this.insertNode(d,"end");return this.utils.normalizeTextNodes(b),e},_insertToPre:function(a,b){a.html=!1!==b?this.cleaner.encodeHtml(a.html):a.html;var c=this.utils.createFragment(a.html);return this.insertNode(c,"end")},_insertToWidget:function(a,b,c){c=this._isComponentSpan(c)?c:this.cleaner.paragraphize(c);var d=this.utils.createFragment(c),e=b.getComponent(),f=$R.dom(e);return f.after(d.frag),f.remove(),this.caret.setEnd(d.last),this._sendNodes(d.nodes)},_insertFragment:function(a){var b=this.selection.getRange();if(b){if(this.selection.isCollapsed()){var c=b.startContainer;3!==c.nodeType&&"BR"===c.tagName&&(this.caret.setAfter(c),c.parentNode.removeChild(c))}else b.deleteContents();b.insertNode(a.frag)}},_sendNodes:function(a){for(var b=0;b<a.length;b++){var c=a[b],d=3!==c.nodeType&&"function"==typeof c.getAttribute&&c.getAttribute("data-redactor-type");d&&this.app.broadcast(d+".inserted",this.component.build(c))}return this.detector.isIe()&&this.editor.getElement().find("[data-redactor-type=table]").attr("contenteditable",!0),this.app.broadcast("inserted",a),this.component.executeScripts(),a},_setCaret:function(a,b){var c=this._isLastInline(b);a?(a=c&&"end"===a?"after":a,this.caret["set"+this.utils.ucfirst(a)](b.last)):!1!==a&&c&&this.caret.setAfter(b.last)},_isLastInline:function(a){if(a.last){return this.inspector.parse(a.last).isInline()}return!1},_getCleanedInput:function(a,b,c){var d=b.isCode()||b.isPre();return a.html=a.html.replace(/&nbsp;/g," "),a.html=d||!1===c?a.html:this.cleaner.input(a.html),a=d||!1===c?a:this.utils.parseHtml(a.html)},_getContainer:function(a){return $R.dom(this.utils.createTmpContainer(a))},_buildList:function(a,b,c){var d=a.nodes,e=d[0];if(e&&3!==e.nodeType&&"li"===e.tagName){var f=$R.dom(b),g=f.get().tagName.toLowerCase(),h=$R.dom("<"+g+" />");return h.append(c.nodes),this.utils.createFragment(h.get().outerHTML)}return c},_containsTags:function(a,b){return 0!==this._getContainer(a).find(b.join(",")).length},_collapseSelection:function(){},_hasFigureOrTable:function(a){return 0!==this._getContainer(a).find("figure, table").length},_hasBlocks:function(a){return 0!==this._getContainer(a).find(this.opts.blockTags.join(",")).length},_hasBlocksAndImages:function(a){return 0!==this._getContainer(a).find(this.opts.blockTags.join(",")+",img").length},_isPlainHtml:function(a){return 0===this._getContainer(a).find(this.opts.blockTags.join(",")+", img").length},_isFigure:function(a){if(this._isHtmlString(a))return 0!==$R.dom(a).closest("figure").length},_isComponentSpan:function(a){if(this._isHtmlString(a))return 0!==$R.dom(a).closest("span.redactor-component").length},_isHtmlString:function(a){return!("string"==typeof a&&!/^\s*<(\w+|!)[^>]*>/.test(a))}}),$R.add("service","block",{init:function(a){this.app=a,this.tags=["p","div","blockquote","pre","h1","h2","h3","h4","h5","h6"]},format:function(a){return this.params={args:!1},this.params.type=a.type?a.type:"set",this.params.tag="string"==typeof a?a:a.tag||this.opts.markup,this.params.tag=this.params.tag.toLowerCase(),this.params.args={class:a.class||!1,style:a.style||!1,attr:a.attr||!1},a.class||a.style||a.attr||(this.params.args=!1),this._format()},add:function(a,b){return this._apply("add",a,b)},set:function(a,b){return this._apply("set",a,b)},toggle:function(a,b){return this._apply("toggle",a,b)},remove:function(a,b){return this._apply("remove",a,b)},clearFormat:function(a){return this._clear(a,"all")},clearStyle:function(a){return this._clear(a,"style")},clearClass:function(){return this._clear(tags,"class")},clearAttr:function(){return this._clear(tags,"attr")},_format:function(){var a=[];this.collapsed=this.selection.isCollapsed(),this.selection.save();var b=(this.selection.getBlock(),this._getBlocks()),c=this._isToggleFormatType(b)?"toggle":"set",d=this._getReplacedTag(c);return a=this._replaceBlocks(b,d),a=this._buildNodes(a),this._restoreSelection(a),a},_clear:function(a,b,c,d){!1!==c&&this.selection.save();var e=this._getElements(a,d);return"all"===b?this._removeAllAttr(e,!1):"style"===b?(e.removeAttr("style"),e.removeAttr("data-redactor-style-cache")):"class"===b?e.removeAttr("class"):"attr"===b&&this._removeAllAttr(e),d=e.getAll(),!1!==c&&this._restoreSelection(d),d},_getElements:function(a,b){return b?$R.dom(b):$R.dom(this._getBlocks(a))},_getBlocks:function(a){for(var b=this.selection.getBlocks({tags:a||this.tags}),c=[],d=0;d<b.length;d++)("DIV"!==b[d].tagName||b[d].getAttribute("data-redactor-tag"))&&c.push(b[d]);return c},_getReplacedTag:function(a){return this.opts.breakline?"toggle"===a?"div":"p"===this.params.tag?"div":this.params.tag:"toggle"===a?this.opts.markup:this.params.tag},_isStandardParagraph:function(){return!this.opts.breakline&&"p"===this.opts.markup},_isStandardDiv:function(){return!this.opts.breakline&&"div"===this.opts.markup},_isBreaklineBlock:function(a){return a&&"DIV"===a.tagName&&"br"===a.getAttribute("data-redactor-tag")},_isToggleFormatType:function(a){for(var b=0,c=a.length,d=0;d<c;d++)a[d]&&this.params.tag===a[d].tagName.toLowerCase()&&b++;return b===c},_isCurrentBlockOneAndEmpty:function(a){return this.collapsed&&1===a.length&&this.utils.isEmpty(a[0])},_buildNodes:function(a){return a.length>0&&(a=this._applyArgs(a,!1),a=this._combinePre(a),a=this._cleanBlocks(a)),a},_replaceBlocks:function(a,b){for(var c=[],d=0;d<a.length;d++){var e=this.utils.replaceToTag(a[d],b);c.push(e.get())}return c},_combinePre:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].nextElementSibling;if(d&&"PRE"===a[c].tagName&&"PRE"===d.tagName){var e=$R.dom(a[c]),f=$R.dom(d),g=document.createTextNode("\n");e.append(g),e.append(f),f.unwrap("pre")}b.push(a[c])}return b},_cleanBlocks:function(a){for(var b=["h1","h2","h3","h4","h5","h6"],c=this.opts.inlineTags,d=0;d<a.length;d++){var e=a[d].tagName.toLowerCase(),f=$R.dom(a[d]);-1!==b.indexOf(e)?f.find("span").not(".redactor-component, .non-editable, .redactor-selection-marker").unwrap():"pre"===e&&f.find(c.join(",")).not(".redactor-selection-marker").unwrap(),this.opts.breakline&&"div"===e?f.attr("data-redactor-tag","br"):f.removeAttr("data-redactor-tag"),this.utils.normalizeTextNodes(a[d])}return a},_cleanEmptyClass:function(a){a.each(function(a){""===a.className&&a.removeAttribute("class")})},_cleanEmptyStyle:function(a){this.utils.removeEmptyAttr(a.get(),"style")?a.removeAttr("data-redactor-style-cache"):a.attr("data-redactor-style-cache",a.attr("style"))},_apply:function(a,b,c,d,e){!1!==d&&this.selection.save();var f=this._getElements(c,e);if(b.class&&("set"===a?(f.removeAttr("class"),f.addClass(b.class)):"add"===a?f.addClass(b.class):"toggle"===a?f.toggleClass(b.class):"remove"===a&&f.removeClass(b.class),this._cleanEmptyClass(f)),b.attr&&("set"===a?(this._removeAllAttr(f),f.attr(b.attr)):"add"===a?f.attr(b.attr):"toggle"===a?(g=b.attr,f.each(function(a){var b=$R.dom(a);for(var c in g)b.attr(c)?b.removeAttr(c):b.attr(c,g[c])})):"remove"===a&&f.removeAttr(b.attr)),b.style)if("set"===a)f.removeAttr("style"),f.css(b.style),f.each(function(a){var b=$R.dom(a);b.attr("data-redactor-style-cache",b.attr("style"))});else if("add"===a){var g=b.style;f.each(function(a){var b=$R.dom(a);b.css(g),b.attr("data-redactor-style-cache",b.attr("style")),this._convertStyleQuotes(b)}.bind(this))}else if("toggle"===a){var g=b.style;f.each(function(a){var b=$R.dom(a);for(var c in g){var d=g[c],e=b.css(c);e=this.utils.isRgb(e)?this.utils.rgb2hex(e):e.replace(/"/g,""),d=this.utils.isRgb(d)?this.utils.rgb2hex(d):d.replace(/"/g,""),e=this.utils.hex2long(e),d=this.utils.hex2long(d);("string"==typeof d?d.toLowerCase():d)===("string"==typeof e?e.toLowerCase():e)?b.css(c,""):b.css(c,d)}this._convertStyleQuotes(b),this._cleanEmptyStyle(b)}.bind(this))}else if("remove"===a){var h=b.style;f.each(function(a){var b=$R.dom(a);b.css(h,""),this._cleanEmptyStyle(b)}.bind(this))}return e=f.getAll(),!1!==d&&this._restoreSelection(e),e},_applyArgs:function(a){return a=this.params.args?this._apply(this.params.type,this.params.args,!1,!1,a):this._clear(!1,"all",!1,a)},_removeAllAttr:function(a,b){a.each(function(a){var c=["data-redactor-tag","data-redactor-style-cache"];!1===b&&(c.push("style"),c.push("class"));for(var d=a.attributes.length;d-- >0;){var e=a.attributes[d],f=e.name;-1===c.indexOf(f)&&a.removeAttributeNode(e)}})},_restoreSelection:function(a){this._isCurrentBlockOneAndEmpty(a)?this.caret.setStart(a[0]):setTimeout(function(){this.selection.restore()}.bind(this),1)},_convertStyleQuotes:function(a){var b=a.attr("style");b&&a.attr("style",b.replace(/"/g,"'"))}}),$R.add("service","inline",{mixins:["formatter"],init:function(a){this.app=a,this.count=0},format:function(a){if(!this._isFormat())return[];this.type=a.type?a.type:"set",this.tag="string"==typeof a?a:a.tag,this.tag=this.tag.toLowerCase(),this.tag=this.arrangeTag(this.tag),"string"==typeof a?this.args=!1:this.buildArgs(a),this.detector.isIe()||this.editor.disableNonEditables();var b=this.selection.isCollapsed()?this.formatCollapsed():this.formatUncollapsed();return this.detector.isIe()||this.editor.enableNonEditables(),b},_isFormat:function(){var a=this.selection.getCurrent(),b=this.inspector.parse(a),c=b.isComponent()&&!b.isComponentType("table")&&!b.isFigcaption();return!(!1!==a||!this.selection.isAll())||!(!a||b.isPre()||b.isCode()||c)},arrangeTag:function(a){var b=this.opts.replaceTags;for(var c in b)a===c&&(a=b[c]);return a},formatCollapsed:function(){var a,b,c,d,e=[],f=this.selection.getInlineFirst(),g=this.selection.getInlines({all:!0}),h=$R.dom(f);if(f){var i=this.inspector.parse(f);if(this.utils.isEmptyHtml(f.innerHTML))if(f.tagName.toLowerCase()===this.tag)if(this.hasSameArgs(f)){this.caret.setAfter(f),h.remove();var j=this.selection.getElement();this.utils.normalizeTextNodes(j)}else"span"===this.tag?(e=this.applyArgs([f],!1),this.caret.setStart(f)):e=this.insertInline(e);else i.hasParent([this.tag])?(a=h.closest(this.tag),b=a.get(),this.hasSameArgs(b)?(a.unwrap(),
this.caret.setStart(f)):e=this.insertInline(e)):e=this.insertInline(e);else if(f.tagName.toLowerCase()===this.tag)this.hasSameArgs(f)?(d=this.utils.extractHtmlFromCaret(f),c=$R.dom("<"+this.tag+" />"),c=this.utils.cloneAttributes(f,c),h.after(c.append(d)),""===c.html().trim()&&c.remove(),this.caret.setAfter(f)):e=this.insertInline(e);else if(i.hasParent([this.tag]))if(a=h.closest(this.tag),b=a.get(),this.hasSameArgs(b)){d=this.utils.extractHtmlFromCaret(b,b),c=$R.dom("<"+this.tag+" />"),c=this.utils.cloneAttributes(b,c);var k,l,m=0;g=g.reverse();for(var n=0;n<g.length;n++)g[n]!==b&&(l=$R.dom("<"+g[n].tagName.toLowerCase()+">"),0===m?k=l:k.append(l),m++);a.after(c.append(d)),a.after(k),this.caret.setStart(l)}else e=this.insertInline(e);else e=this.insertInline(e)}else e=this.insertInline(e);return e},insertInline:function(a){var b=document.createElement(this.tag);return a=this.insertion.insertNode(b,"start"),this.applyArgs(a,!1)},hasSameArgs:function(a){if(0===a.attributes.length&&!1===this.args)return!0;var b=!0;if(this.args){var c=0;for(var d in this.args){var e=$R.dom(a),f=this.args[d],g=this.utils.toParams(f),h=e.attr(d);if(f)if("style"===d){g=g.trim().replace(/;$/,"");for(var i=this.utils.styleToObj(e.attr("style")),j=g.split(";"),k=0,l=0;l<j.length;l++){var m=j[l].split(":"),n=m[0].trim(),o=m[1].trim();if(-1!==n.search(/color/)){var p=e.css(n);!p||p!==o&&this.utils.rgb2hex(p)!==o||k++}else e.css(n)===o&&k++}k===j.length&&Object.keys(i).length===j.length&&c++}else h===g&&c++;else h&&""!==h||c++}b=c===Object.keys(this.args).length}return b},formatUncollapsed:function(){var a=this.selection.getInlines({all:!0,inside:!0});this.detector.isIe()?this.selection.saveMarkers():this.selection.save(),this._convertTags("u"),this._convertTags("del"),this._convertToStrike(a),this.detector.isIe()?this.selection.restoreMarkers():this.selection.restore(),document.execCommand("strikethrough"),this._clearDecoration(),this.selection.save();var b=this._revertToInlines();b=this.applyArgs(b,!1);for(var c=0;c<b.length;c++){var d=b[c],e=d.tagName.toLowerCase(),f=d.attributes.length;e===this.tag&&0===f&&this.args&&($R.dom(d).unwrap(),b.splice(c,1))}return this.selection.restore(),this._clearEmptyStyle(),b=this._normalizeBlocks(b)},_convertTags:function(a){if(this.tag!==a){this.editor.getElement().find(a).each(function(b){this.utils.replaceToTag(b,"span").addClass("redactor-convertable-"+a)}.bind(this))}},_revertTags:function(a){this.editor.getElement().find("span.redactor-convertable-"+a).each(function(b){var c=this.utils.replaceToTag(b,a);c.removeClass("redactor-convertable-"+a),this.utils.removeEmptyAttr(c,"class")&&c.removeAttr("class")}.bind(this))},_convertToStrike:function(a){for(var b=this.selection.getText().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),c=0;c<a.length;c++){var d=this.arrangeTag(a[c].tagName.toLowerCase()),e=a[c],f=$R.dom(e),g=this.hasSameArgs(e);d===this.tag&&("span"===this.tag&&this._isTextSelected(e,b)?f.addClass("redactor-convertable-apply"):g&&"a"!==this.tag?this._replaceToStrike(f):"span"===this.tag?f.addClass("redactor-unconvertable-apply"):g||f.addClass("redactor-convertable-apply"))}},_replaceToStrike:function(a){a.replaceWith(function(){return $R.dom("<strike>").append(a.contents())})},_revertToInlines:function(){var a=[],b=this.editor.getElement();return"u"!==this.tag&&b.find("u").unwrap(),b.find(".redactor-convertable-u").each(function(b){a.push(b)}.bind(this)),b.find(".redactor-convertable-apply").each(function(b){var c=$R.dom(b);c.find("strike").unwrap(),this._forceRemoveClass(c,"redactor-convertable-apply"),a.push(b)}.bind(this)),b.find("span.redactor-unconvertable-apply").each(function(a){var b=$R.dom(a);this._forceRemoveClass(b,"redactor-unconvertable-apply")}.bind(this)),b.find("strike").each(function(b){var c=this.utils.replaceToTag(b,this.tag);a.push(c.get())}.bind(this)),this._revertTags("u"),this._revertTags("del"),a},_normalizeBlocks:function(a){var b=this.opts.inlineTags,c=this.selection.getBlocks();if(c)for(var d=0;d<c.length;d++)if("PRE"===c[d].tagName){var e=$R.dom(c[d]);e.find(b.join(",")).not(".redactor-selection-marker").each(function(b){-1!==a.indexOf(b)&&(a=this.utils.removeFromArrayByValue(a,b)),$R.dom(b).unwrap()}.bind(this))}return a},_clearDecoration:function(){this.editor.getElement().find(this.opts.inlineTags.join(",")).each(function(a){if("line-through"===a.style.textDecoration||"line-through"===a.style.textDecorationLine){var b=$R.dom(a);b.css("textDecorationLine",""),b.css("textDecoration",""),b.wrap("<strike>")}})},_clearEmptyStyle:function(){for(var a=this.getInlines(),b=0;b<a.length;b++){this._clearEmptyStyleAttr(a[b]);var c=a[b].childNodes;if(c)for(var d=0;d<c.length;d++)this._clearEmptyStyleAttr(c[d])}},_clearEmptyStyleAttr:function(a){3!==a.nodeType&&this.utils.removeEmptyAttr(a,"style")&&(a.removeAttribute("style"),a.removeAttribute("data-redactor-style-cache"))},_forceRemoveClass:function(a,b){a.removeClass(b),this.utils.removeEmptyAttr(a,"class")&&a.removeAttr("class")},_isTextSelected:function(a,b){var c=this.utils.removeInvisibleChars(a.textContent);return b===c||-1!==b.search(new RegExp("^"+this.utils.escapeRegExp(c)+"$"))},getInlines:function(a){return a?this.selection.getInlines({tags:a,all:!0}):this.selection.getInlines({all:!0})},getElements:function(a){return $R.dom(this.getInlines(a))},clearFormat:function(){this.selection.save();for(var a=this.selection.getInlines({all:!0}),b=0;b<a.length;b++){var c=$R.dom(a[b]);this.selection.getInline(a[b])&&c.unwrap()}this.selection.restore()}}),$R.add("service","autoparser",{init:function(a){this.app=a},observe:function(){var a=this.editor.getElement(),b=a.find(".redactor-autoparser-object").each(function(a){var b=$R.dom(a);b.removeClass("redactor-autoparser-object"),""===b.attr("class")&&b.removeAttr("class")});b.length>0&&b.each(function(a){var b,c=!1,d=a.tagName;"A"===d?b="link":"IMG"===d?b="image":"IFRAME"===d&&(b="video"),b&&(c=$R.create(b+".component",this.app,a),this.app.broadcast(b+".inserted",c),this.app.broadcast("autoparse",b,c))}.bind(this))},format:function(a,b){this._isKey(b)&&this._format(b===this.keycodes.ENTER)},parse:function(a){var b=["figure","form","pre","iframe","code","a","img"],c=[],d=0;a=this.cleaner.encodePreCode(a);for(var e=0;e<b.length;e++){var f="img"===b[e]?"<"+b[e]+"[^>]*>":"<"+b[e]+"([\\w\\W]*?)</"+b[e]+">",g=a.match(new RegExp(f,"gi"));if(null!==g)for(var h=0;h<g.length;h++)a=a.replace(g[h],"#####replaceparse"+d+"#####"),c.push(g[h]),d++}if(this.opts.autoparseImages&&a.match(this.opts.regex.imageurl))for(var i=a.match(this.opts.regex.imageurl),e=0;e<i.length;e++)a=a.replace(i[e],'<img class="redactor-autoparser-object" src="'+i[e]+'">');if(this.opts.autoparseVideo&&(a.match(this.opts.regex.youtube)||a.match(this.opts.regex.vimeo))){var j,k;a.match(this.opts.regex.youtube)?(j="//www.youtube.com/embed/$1",k=this.opts.regex.youtube):a.match(this.opts.regex.vimeo)&&(j="//player.vimeo.com/video/$2",k=this.opts.regex.vimeo);var l=this.component.create("video",'<iframe width="500" height="281" src="'+j+'" frameborder="0" allowfullscreen></iframe>');a=a.replace(k,l.get().outerHTML)}for(var e=0;e<b.length;e++){var f="img"===b[e]?"<"+b[e]+"[^>]*>":"<"+b[e]+"([\\w\\W]*?)</"+b[e]+">",g=a.match(new RegExp(f,"gi"));if(null!==g)for(var h=0;h<g.length;h++)a=a.replace(g[h],"#####replaceparse"+d+"#####"),c.push(g[h]),d++}return this.opts.autoparseLinks&&a.match(this.opts.regex.url)&&(a=this._formatLinks(a)),a=this._restoreReplaced(c,a),a=this._restoreReplaced(c,a)},_isKey:function(a){return a===this.keycodes.ENTER||a===this.keycodes.SPACE},_format:function(a){var b=this.selection.getParent(),c=$R.dom(b);if((!b||0===c.closest("figure, pre, code, img, a, iframe").length)&&this.selection.isCollapsed()){var d=this.utils.createInvisibleChar();this.selection.getRange().insertNode(d);var e=this.selection.getCurrent(),f=this.inspector.parse(e),g=$R.dom(e);if(d.parentNode.removeChild(d),e&&3===e.nodeType){var h,i=e.textContent;if(this.opts.autoparseImages&&i.match(this._convertToRegExp(this.opts.regex.imageurl))){var j=f.isList(),k=i.match(this.opts.regex.imageurl),l=j?void 0:"<figure><img></figure>",m=this.component.create("image",l);m.setSrc(k[0]),m.addClass("redactor-autoparser-object"),i=i.replace(k[0],m.get().outerHTML),h="image"}else if(this.opts.autoparseVideo&&(i.match(this._convertToRegExp(this.opts.regex.youtube))||i.match(this._convertToRegExp(this.opts.regex.vimeo)))){var n,o;i.match(this.opts.regex.youtube)?(n="//www.youtube.com/embed/$1",o=this.opts.regex.youtube):i.match(this.opts.regex.vimeo)&&(n="//player.vimeo.com/video/$2",o=this.opts.regex.vimeo);var p=this.component.create("video",'<iframe width="500" height="281" src="'+n+'" frameborder="0" allowfullscreen></iframe>');p.addClass("redactor-autoparser-object"),i=i.replace(o,p.get().outerHTML),h="video"}else this.opts.autoparseLinks&&i.match(this._convertToRegExp(this.opts.regex.url))&&(i=this._formatLinks(i,a),h="link");if(h){a?(this.selection.save(),g.replaceWith(i),this.selection.restore()):g.replaceWith(i);var q=this.editor.getElement(),r=q.find(".redactor-autoparser-object").removeClass("redactor-autoparser-object");if(r="link"===h?$R.create("link.component",this.app,r):r,"link"===h)a||this.caret.setAfter(r),this.app.broadcast("link.inserted",r);else{this.caret.setAfter(r);var s=r.clone();r.remove(),r=this.insertion.insertHtml(s),r=this.component.build(r)}this.app.broadcast("autoparse",h,r)}}}},_formatLinks:function(a,b){for(var c=a.match(this.opts.regex.url),d={},e=0;e<c.length;e++){b&&-1!==c[e].search(/\.$/)&&(c[e]=c[e].replace(/\.$/,""));var f=c[e],g=f,h=null!==f.match(/(https?|ftp):\/\//i)?"":"http://",i=-1!==["/","&","="].indexOf(f.slice(-1))?"":"\\b",j=!1!==this.opts.pasteLinkTarget?' target="'+this.opts.pasteLinkTarget+'"':"";g=g.length>this.opts.linkSize?g.substring(0,this.opts.linkSize)+"...":g,g=-1===g.search("%")?decodeURIComponent(g):g;d["("+f.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+i+")"]='<a href="'+h+f.trim()+'"'+j+' class="redactor-autoparser-object">'+g.trim()+"</a>"}for(var k in d)a=a.replace(new RegExp(k,"g"),d[k]);return a},_restoreReplaced:function(a,b){for(var c=0;c<a.length;c++)b=b.replace("#####replaceparse"+c+"#####",a[c]);return b},_convertToRegExp:function(a){return new RegExp(String(a).replace(/^\//,"").replace(/\/ig$/,"").replace(/\/gi$/,"")+"$","gi")}}),$R.add("service","storage",{init:function(a){this.app=a,this.data=[]},observeImages:function(){if(this.opts.imageObserve){this.editor.getElement().find("[data-image]").each(this._addImage.bind(this))}},observeFiles:function(){this.editor.getElement().find("[data-file]").each(this._addFile.bind(this))},setStatus:function(a,b){this.data[a].status=b},getChanges:function(){var a=this.editor.getElement();for(var b in this.data){var c=this.data[b],d=a.find("[data-"+c.type+'="'+c.id+'"]');this.setStatus(c.id,0!==d.length)}return this.data},add:function(a,b){var c=$R.dom(b),d=c.attr("data-"+a);this.data[d]={type:a,status:!0,node:c.get(),id:c.attr("data-"+a)}},_addImage:function(a){this.add("image",a)},_addFile:function(a){this.add("file",a)}}),$R.add("service","utils",{init:function(a){this.app=a},isEmpty:function(a){var b=!1;return a=$R.dom(a).get(),a&&(b=3===a.nodeType?""===a.textContent.trim().replace(/\n/,""):""===a.innerHTML),b},isEmptyHtml:function(a,b,c){return a=this.removeInvisibleChars(a),a=a.replace(/&nbsp;/gi,""),a=a.replace(/<\/?br\s?\/?>/g,b?"br":""),a=a.replace(/\s/g,""),a=a.replace(/^<p>[^\W\w\D\d]*?<\/p>$/i,""),a=a.replace(/^<div>[^\W\w\D\d]*?<\/div>$/i,""),c&&(a=a.replace(/<ul(.*?[^>])>$/i,"ul"),a=a.replace(/<ol(.*?[^>])>$/i,"ol")),a=a.replace(/<hr(.*?[^>])>$/i,"hr"),a=a.replace(/<iframe(.*?[^>])>$/i,"iframe"),a=a.replace(/<source(.*?[^>])>$/i,"source"),a=a.replace(/<[^\/>][^>]*><\/[^>]+>/gi,""),a=a.replace(/<[^\/>][^>]*><\/[^>]+>/gi,""),""===(a=a.trim())},trimSpaces:function(a){return a=this.removeInvisibleChars(a.trim())},createInvisibleChar:function(){return document.createTextNode(this.opts.markerChar)},searchInvisibleChars:function(a){return a.search(/^\uFEFF$/g)},removeInvisibleChars:function(a){return a.replace(/\uFEFF/g,"")},trimInvisibleChars:function(a){if(this.selection.isCollapsed()){var b=this.selection.getCurrent(),c="left"===a?this.selection.getTextBeforeCaret():this.selection.getTextAfterCaret();if(b&&3===b.nodeType&&0===this.searchInvisibleChars(c))if("left"===a)$R.dom(b).replaceWith(b.textContent.trim());else{var d=this.offset.get();this.offset.set({start:d.start+1,end:d.end+1})}}},buildWrapper:function(a){return $R.dom("<div>").html(a)},getWrapperHtml:function(a){var b=a.html();return a.remove(),b},createTmpContainer:function(a){var b=$R.dom("<div>");return"string"==typeof a?b.html(a):b.append($R.dom(a).clone(!0)),b.get()},createFragment:function(a){for(var b,c,d,e=this.createTmpContainer(a),f=document.createDocumentFragment(),g=[],h=0;b=e.firstChild;){h++;var i=f.appendChild(b);1===h&&(c=i),g.push(i),d=i}return{frag:f,first:c,last:d,nodes:g}},isFragment:function(a){return"object"==typeof a&&a.frag},parseHtml:function(a){var b=this.createTmpContainer(a);return{html:b.innerHTML,nodes:b.childNodes}},splitNode:function(a,b,c,d){b=this.isFragment(b)?b.frag:b;var e;e=d?this.inspector.isInlineTag(a.tagName)?a:this.selection.getInline(a):this.inspector.isBlockTag(a.tagName)?a:this.selection.getBlock(a);var f=$R.dom(e);if(!d&&this.isEmptyHtml(e.innerHTML,!0))return f.after(b),f.remove(),b;var g=f.get().tagName.toLowerCase(),h=this.caret.isEnd(e),i=this.caret.isStart(e);if(!h&&!i){var j=this.extractHtmlFromCaret(d),k=$R.dom("<"+g+" />");k=this.cloneAttributes(e,k),f.after(k.append(j))}if(i)return f.before(b);if(c)return f.append(b);b=f.after(b);var l=f.html();return l=this.removeInvisibleChars(l),l=l.replace(/&nbsp;/gi,""),""===l&&f.remove(),b},extractHtmlFromCaret:function(a,b){var c=this.selection.getRange();if(c&&(b=b||(a?this.selection.getInline():this.selection.getBlock()))){var d=c.cloneRange();return d.selectNodeContents(b),d.setStart(c.endContainer,c.endOffset),d.extractContents()}},createMarkup:function(a){var b=document.createElement(this.opts.markup);this.opts.breakline&&b.setAttribute("data-redactor-tag","br"),$R.dom(a).after(b),this.caret.setStart(b)},createMarkupBefore:function(a){var b=document.createElement(this.opts.markup);this.opts.breakline&&b.setAttribute("data-redactor-tag","br"),$R.dom(a).before(b),this.caret.setEnd(b)},getNode:function(a){var b=$R.dom(a).get(),c=this.editor.getElement().get();return void 0===a?c:b||!1},findSiblings:function(a,b){for(a=$R.dom(a).get(),b="next"===b?"nextSibling":"previousSibling";a=a[b];)if((3!==a.nodeType||""!==a.textContent.trim())&&"BR"!==a.tagName)return a;return!1},getElementsFromHtml:function(a,b,c){var d=document.createElement("div");d.innerHTML=a;var e=d.querySelectorAll(b);return function(a,b){if("number"==typeof this.length&&"function"==typeof a){var c=[];if("object"==typeof this)for(var d=0;d<this.length;d++){if(!(d in this))return;c[d]=a.call(b||this,this[d],d,this)}return c}}.call(e,function(a){var b=a.getAttribute("data-redactor-type");if(!c||!b||b!==c)return a.outerHTML})},getChildNodes:function(a,b,c){a=a&&a.nodeType&&11===a.nodeType?a:$R.dom(a).get();var d=a.childNodes,e=[];if(d)for(var f=0;f<d.length;f++)if(!(!0===c&&3===d[f].nodeType||3===d[f].nodeType&&this.isEmpty(d[f])||(e.push(d[f]),!1===b))){var g=this.getChildNodes(d[f],c);g.length>0&&(e=e.concat(g))}return e},getChildElements:function(a){return this.getChildNodes(a,!0,!0)},getFirstNode:function(a){return this._getFirst(this.getChildNodes(a,!1))},getLastNode:function(a){return this._getLast(this.getChildNodes(a,!1))},getFirstElement:function(a){return this._getFirst(this.getChildNodes(a,!1,!0))},getLastElement:function(a){return this._getLast(this.getChildNodes(a,!1,!0))},replaceToTag:function(a,b){return $R.dom(a).replaceWith(function(a){var c=$R.dom("<"+b+">").append($R.dom(a).contents());if(a.attributes)for(var d=a.attributes,e=0;e<d.length;e++)c.attr(d[e].nodeName,d[e].value);return c})},ucfirst:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},removeFromArrayByValue:function(a,b){for(var c,d=arguments,e=d.length;e>1&&a.length;)for(b=d[--e];-1!==(c=a.indexOf(b));)a.splice(c,1);return a},removeEmptyAttr:function(a,b){var c=$R.dom(a);return void 0===c.attr(b)||null===c.attr(b)||""===c.attr(b)&&(c.removeAttr(b),!0)},cloneAttributes:function(a,b){a=$R.dom(a).get(),b=$R.dom(b);for(var c=a.attributes,d=c.length;d--;){var e=c[d];b.attr(e.name,e.value)}return b},toParams:function(a){if("object"!=typeof a)return a;var b=Object.keys(a);if(!b.length)return"";for(var c="",d=0;d<b.length;d++){var e=b[d];c+=e+":"+a[e]+";"}return c},styleToObj:function(a){var b={};if(a)for(var c=a.replace(/;$/,"").split(";"),d=0;d<c.length;d++){var e=c[d].split(":");b[e[0].trim()]=e[1].trim()}return b},checkProperty:function(a){for(var b=arguments[1]&&Array.isArray(arguments[1])?arguments[1]:[].slice.call(arguments,1),c=0;c<b.length;c++){if(!a||void 0===a[b[c]])return!1;a=a[b[c]]}return a},extendData:function(a,b){for(var c in b)if("elements"===c){var d=$R.dom(b[c]);d.each(function(b){var c=$R.dom(b);if("FORM"===b.tagName){var d=c.serialize(!0);for(var e in d)a=this._setData(a,e,d[e])}else{var f=c.attr("name")?c.attr("name"):c.attr("id");a=this._setData(a,f,c.val())}}.bind(this))}else a=this._setData(a,c,b[c]);return a},_setData:function(a,b,c){return a instanceof FormData?a.append(b,c):a[b]=c,a},normalizeTextNodes:function(a){(a=$R.dom(a).get())&&a.normalize()},isRgb:function(a){return 0===a.search(/^rgb/i)},rgb2hex:function(a){return a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),a&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""},hex2long:function(a){return-1!==a.search(/^#/)&&4===a.length&&(a="#"+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]),a},escapeRegExp:function(a){return a.replace(/[-\/\\^$*~+?.()|[\]{}]/g,"\\$&")},getRandomId:function(){for(var a="",b="abcdefghijklmnopqrstuvwxyz0123456789",c=0;c<12;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a},_getFirst:function(a){return 0!==a.length&&a[0]},_getLast:function(a){return 0!==a.length&&a[a.length-1]}}),$R.add("service","progress",{init:function(a){this.app=a,this.$box=null,this.$bar=null},show:function(){this._is()||this._build(),this.$box.show()},hide:function(){this._is()&&this.animate.start(this.$box,"fadeOut",this._destroy.bind(this))},update:function(a){this.show(),this.$bar.css("width",a+"%")},_is:function(){return null!==this.$box},_build:function(){this.$bar=$R.dom("<span />"),this.$box=$R.dom('<div id="redactor-progress" />'),this.$box.append(this.$bar),this.$body.append(this.$box)},_destroy:function(){this._is()&&this.$box.remove(),this.$box=null,this.$bar=null}}),$R.add("module","starter",{init:function(a){this.app=a,this.opts=a.opts,this.plugin=a.plugin,this.module=a.module},onstart:function(){var a=["element","container","source","editor","statusbar","toolbar"],b=["element","container","source","editor","statusbar","contextbar","input"];this._startStop("start",this.app,a),this._startStop("start",this.module,b)},onstop:function(){var a=["observer","element","container","source","editor","contextbar"];this._startStop("stop",this.module,a)},onenable:function(){var a=["observer","toolbar"],b=this.opts.plugins;this._startStop("start",this.module,a),this._startStop("start",this.plugin,b)},ondisable:function(){var a=["observer","toolbar"],b=this.opts.plugins;this._startStop("stop",this.module,a),this._startStop("stop",this.plugin,b)},_startStop:function(a,b,c){for(var d=0;d<c.length;d++)void 0!==b[c[d]]&&this.app.callInstanceMethod(b[c[d]],a)}}),$R.add("module","element",{init:function(a){this.app=a,this.uuid=a.uuid,this.opts=a.opts,this.namespace=a.namespace,this.element=a.element,this.rootOpts=$R.extend({},!0,$R.options,a.rootOpts)},start:function(){this._build(),this._buildModes(),this._buildMarkup()},stop:function(){this.element.getElement().removeData(this.namespace+"-uuid")},_build:function(){this.element.getElement().data(this.namespace+"-uuid",this.uuid)},_buildModes:function(){var a=this.element.getType();"inline"===a&&this._redefineOptions(this.opts.modes.inline),"div"===a&&this._redefineOptions(this.opts.modes.original),"inline"!==a&&(this._isRootOption("styles")&&this.rootOpts.styles&&(this.opts.styles=!0),this._isRootOption("source")&&!this.rootOpts.source&&(this.opts.showSource=!1))},_buildMarkup:function(){"inline"===this.element.getType()?this.opts.emptyHtml="":this.opts.breakline?(this.opts.markup="div",this.opts.emptyHtml='<div data-redactor-tag="br">'+this.opts.markerChar+"</div>"):this.opts.emptyHtml="<"+this.opts.markup+"></"+this.opts.markup+">"},_redefineOptions:function(a){for(var b in a)this.opts[b]=a[b]},_isRootOption:function(){return void 0!==this.rootOpts.styles}}),$R.add("module","editor",{init:function(a){this.app=a,this.uuid=a.uuid,this.opts=a.opts,this.editor=a.editor,this.source=a.source,this.element=a.element,this.component=a.component,this.container=a.container,this.inspector=a.inspector,this.autoparser=a.autoparser,this.placeholder=!1,this.events=!1},onenable:function(){this.enable()},ondisable:function(){this.disable()},onenablefocus:function(){this._enableFocus()},oncontextmenu:function(a){this.component.setOnEvent(a,!0)},onclick:function(a){this.component.setOnEvent(a)},onkeyup:function(a){this.inspector.parse(a.target).isComponent()||this.component.clearActive()},onenablereadonly:function(){this._enableReadOnly()},ondisablereadonly:function(){this._disableReadOnly()},onautoparseobserve:function(){this.autoparser.observe()},onplaceholder:{build:function(){this._buildPlaceholder()},toggle:function(){this._togglePlacehodler()}},start:function(){this._build(),this._buildEvents(),this._buildOptions(),this._buildAccesibility()},stop:function(){var a=this.editor.getElement(),b=this.container.getElement(),c=["redactor-in","redactor-in-"+this.uuid,"redactor-structure","redactor-placeholder","notranslate"];""!==this.opts.stylesClass&&c.push(this.opts.stylesClass);var d=["redactor-focus","redactor-blur","redactor-over","redactor-styles-on","redactor-styles-off","redactor-toolbar-on","redactor-text-labeled-on","redactor-source-view"];a.removeAttr("spellcheck"),a.removeAttr("dir"),a.removeAttr("contenteditable"),a.removeAttr("placeholder"),a.removeAttr("data-gramm_editor"),a.removeClass(c.join(" ")),b.removeClass(d.join(" ")),this._destroyEvents(),0===a.get().classList.length&&a.removeAttr("class")},enable:function(){var a=this.editor.getElement(),b=this.container.getElement();a.addClass("redactor-in redactor-in-"+this.uuid),a.attr({contenteditable:!0}),this.opts.structure&&a.addClass("redactor-structure"),!this.opts.toolbar||this.opts.air||this.opts.toolbarExternal||b.addClass("redactor-toolbar-on"),this._disableBrowsersEditing()},disable:function(){var a=this.editor.getElement(),b=this.container.getElement();a.removeClass("redactor-in redactor-in-"+this.uuid),a.removeClass("redactor-structure"),a.removeAttr("contenteditable"),b.addClass("redactor-toolbar-on")},_build:function(){var a=this.editor.getElement(),b=this.element.getElement(),c=this.container.getElement();c.addClass("redactor-blur"),this.opts.grammarly||a.attr("data-gramm_editor",!1),this.opts.notranslate&&a.addClass("notranslate"),this.opts.styles?(a.addClass(this.opts.stylesClass),c.addClass("redactor-styles-on")):c.addClass("redactor-styles-off"),this.opts.buttonsTextLabeled&&c.addClass("redactor-text-labeled-on"),this.element.isType("textarea")&&b.before(a)},_buildEvents:function(){this.events=$R.create("editor.events",this.app)},_buildOptions:function(){var a=this.editor.getElement();a.attr("dir",this.opts.direction),this.opts.spellcheck||a.attr("spellcheck",!1),this.opts.tabindex&&a.attr("tabindex",this.opts.tabindex),this.opts.minHeight&&a.css("min-height",this.opts.minHeight),this.opts.maxHeight&&a.css("max-height",this.opts.maxHeight),this.opts.maxWidth&&a.css({"max-width":this.opts.maxWidth,margin:"auto"})},_buildAccesibility:function(){this.editor.getElement().attr({"aria-labelledby":"redactor-voice-"+this.uuid,role:"presentation"})},_buildPlaceholder:function(){this.placeholder=$R.create("editor.placeholder",this.app)},_enableFocus:function(){this.opts.showSource?this._enableFocusSource():this._enableFocusEditor()},_enableFocusSource:function(){var a=this.source.getElement();this.opts.focus?(a.focus(),a.get().setSelectionRange(0,0)):this.opts.focusEnd&&a.focus()},_enableFocusEditor:function(){this.opts.focus?setTimeout(this.editor.startFocus.bind(this.editor),100):this.opts.focusEnd&&setTimeout(this.editor.endFocus.bind(this.editor),100)},_togglePlacehodler:function(){this.placeholder&&this.placeholder.toggle()},_disableBrowsersEditing:function(){try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1),document.execCommand("AutoUrlDetect",!1,!1);var a=this.editor.getElement(),b=a.get();b.addEventListener?b.addEventListener("mscontrolselect",function(a){a.preventDefault()}):b.attachEvent("oncontrolselect",function(a){a.returnValue=!1})}catch(a){}},_destroyEvents:function(){this.events&&this.events.destroy()},_enableReadOnly:function(){var a=this.editor.getElement();this._getEditables(a).removeAttr("contenteditable"),a.removeAttr("contenteditable"),a.addClass("redactor-read-only"),this.events&&this.events.destroy()},_disableReadOnly:function(){var a=this.editor.getElement();this._getEditables(a).attr({contenteditable:!0}),a.removeClass("redactor-read-only"),a.attr({contenteditable:!0}),this._buildEvents()},_getEditables:function(a){return a.find("figcaption, td, th")}}),$R.add("class","editor.placeholder",{init:function(a){this.app=a,this.opts=a.opts,this.editor=a.editor,this.element=a.element,this.build()},build:function(){var a=this.element.getElement(),b=this.editor.getElement();if(!1!==this.opts.placeholder||a.attr("placeholder")){var c=!1!==this.opts.placeholder?this.opts.placeholder:a.attr("placeholder");b.attr("placeholder",c),this.toggle()}},toggle:function(){return this.editor.isEmpty(!0)?this.show():this.hide()},show:function(){this.editor.getElement().addClass("redactor-placeholder")},hide:function(){this.editor.getElement().removeClass("redactor-placeholder")}}),$R.add("class","editor.events",{init:function(a){this.app=a,this.opts=a.opts,this.$doc=a.$doc,this.uuid=a.uuid,this.source=a.source,this.editor=a.editor,this.cleaner=a.cleaner,this.container=a.container,this.insertion=a.insertion,this.inspector=a.inspector,this.selection=a.selection,this.component=a.component,this.blurNamespace=".redactor-blur."+this.uuid,this.eventsList=["paste","click","contextmenu","keydown","keyup","mouseup","touchstart","cut","copy","dragenter","dragstart","drop","dragover","dragleave"],this._init()},destroy:function(){this.editor.getElement().off(".redactor-focus"),this.$doc.off("keyup"+this.blurNamespace+" mousedown"+this.blurNamespace),this._loop("off")},focus:function(a){var b=this.container.getElement();this.editor.isPasting()||b.hasClass("redactor-focus")||(b.addClass("redactor-focus"),b.removeClass("redactor-blur"),this.app.broadcast("observe",a),this.app.broadcast("focus",a),this.isFocused=!0,this.isBlured=!1)},blur:function(a){var b=this.container.getElement(),c=$R.dom(a.target),d=[".redactor-in-"+this.uuid,".redactor-toolbar",".redactor-dropdown",".redactor-context-toolbar","#redactor-modal","#redactor-image-resizer"];this.app.broadcast("originalblur",a),this.app.stopBlur||this.app.isStarted()&&!this.editor.isPasting()&&0===c.closest(d.join(",")).length&&(this.isBlured||b.hasClass("redactor-blur")||(b.removeClass("redactor-focus"),b.addClass("redactor-blur"),this.app.broadcast("blur",a),this.isFocused=!1,this.isBlured=!0))},cut:function(a){var b=this.selection.getCurrent(),c=this.inspector.parse(b);this.app.broadcast("state",a),this.component.isNonEditable(b)&&(this._passSelectionToClipboard(a,c,!0),a.preventDefault())},copy:function(a){var b=this.selection.getCurrent(),c=this.inspector.parse(b);this.app.broadcast("state",a),this.component.isNonEditable(b)&&(this._passSelectionToClipboard(a,c,!1),a.preventDefault())},drop:function(a){if(a=a.originalEvent||a,a.stopPropagation(),this._removeOverClass(),!1===this.opts.dragUpload)return void a.preventDefault();if(this.app.isDragComponentInside()){var b=$R.dom(this.app.getDragComponentInside()),c=b.clone(!0);return this.insertion.insertToPoint(a,c),b.remove(),this.app.setDragComponentInside(!1),this.app.broadcast("state",a),this.app.broadcast("drop",a),this.app.broadcast("image.observe",a),void a.preventDefault()}if(this.app.isDragInside()&&this.opts.input){this.insertion.insertPoint(a);var d=a.dataTransfer,e=d.getData("text/html"),f=this.selection.getRange();if(f){var g=this.selection.getBlocks();f.deleteContents();for(var h=0;h<g.length;h++)""===g[h].innerHTML&&$R.dom(g[h]).remove()}return $R.create("input.paste",this.app,a,!0,e,!0),this.app.broadcast("state",a),this.app.broadcast("drop",a),this.app.setDragInside(!1),void a.preventDefault()}this.app.broadcast("state",a),this.app.broadcast("paste",a,a.dataTransfer),this.app.broadcast("drop",a)},dragenter:function(a){a.preventDefault()},dragstart:function(a){this.app.setDragComponentInside(!1),this.app.setDragInside(!1);var b=this.inspector.parse(a.target);!b.isComponent()||b.isComponentEditable()||b.isFigcaption()?this.selection.is()&&!this.selection.isCollapsed()&&(this.app.setDragInside(!0),this._setDragData(a)):this.app.setDragComponentInside(b.getComponent()),this.app.broadcast("dragstart",a)},dragover:function(a){this.app.broadcast("dragover",a)},dragleave:function(a){this.app.broadcast("dragleave",a)},paste:function(a){this.app.broadcast("paste",a)},contextmenu:function(a){},click:function(a){if(3===a.detail){a.preventDefault();var b=this.selection.getBlock();if(b){var c=document.createRange();c.selectNodeContents(b),this.selection.setRange(c)}}var d=$R.dom(a.target);if(d.hasClass("redactor-in")){var e=d.offset().top,f=parseFloat(d.css("padding-bottom"));e+d.height()-2*f<a.pageY?this.app.broadcast("bottomclick",a):d.hasClass("redactor-placeholder")&&this.editor.startFocus(this.editor)}this.app.broadcast("state",a),this.app.broadcast("click",a)},keydown:function(a){if(this.app.broadcast("state",a),!1===this.app.broadcast("keydown",a))return a.preventDefault()},keyup:function(a){this.app.broadcast("keyup",a)},mouseup:function(a){this.app.broadcast("observe",a),this.app.broadcast("state",a)},touchstart:function(a){this.app.broadcast("observe",a),this.app.broadcast("state",a)},_init:function(){this.editor.getElement().on("focus.redactor-focus click.redactor-focus",this.focus.bind(this)),this.$doc.on("keyup"+this.blurNamespace+" mousedown"+this.blurNamespace,this.blur.bind(this)),this._loop("on")},_removeOverClass:function(){this.editor.getElement().removeClass("over")},_loop:function(a){for(var b=this.editor.getElement(),c=0;c<this.eventsList.length;c++){var d=this.eventsList[c]+".redactor-events",e=this.eventsList[c];b[a](d,this[e].bind(this))}},_passAllToClipboard:function(a){var b=a.clipboardData,c=this.source.getCode();b.setData("text/html",c),b.setData("text/plain",c.toString().replace(/\n$/,""))},_passSelectionToClipboard:function(a,b,c){var d=a.clipboardData,e=b.getComponent(),f=$R.dom(e),g=f.clone();g.find(".redactor-component-caret").remove(),g.removeClass("redactor-component-active"),g.removeAttr("contenteditable"),g.removeAttr("tabindex");var h=g.get().outerHTML;c&&this.component.remove(e),d.setData("text/html",h),d.setData("text/plain",h.toString().replace(/\n$/,""))},_setDragData:function(a){a=a.originalEvent||a;var b=a.dataTransfer;b.effectAllowed="move",b.setData("text/Html",this.selection.getHtml())}}),$R.add("module","container",{init:function(a){this.app=a,this.uuid=a.uuid,this.opts=a.opts,this.lang=a.lang,this.element=a.element,this.container=a.container},start:function(){this._build(),
this._buildAccesibility()},stop:function(){var a=this.element.getElement(),b=this.container.getElement();b.after(a),b.remove(),a.show()},_build:function(){var a=this.element.getElement(),b=this.container.getElement();b.addClass("redactor-box"),b.attr("dir",this.opts.direction),this.element.isType("inline")&&b.addClass("redactor-inline"),a.after(b),b.append(a)},_buildAccesibility:function(){var a=this.container.getElement(),b=$R.dom("<span />");b.addClass("redactor-voice-label"),b.attr({id:"redactor-voice-"+this.uuid,"aria-hidden":!1}),b.html(this.lang.get("accessibility-help-label")),a.prepend(b)}}),$R.add("module","source",{init:function(a){this.app=a,this.uuid=a.uuid,this.opts=a.opts,this.utils=a.utils,this.element=a.element,this.source=a.source,this.editor=a.editor,this.toolbar=a.toolbar,this.cleaner=a.cleaner,this.component=a.component,this.container=a.container,this.autoparser=a.autoparser,this.selection=a.selection,this.syncedHtml=""},onstartcode:function(){var a=this.source.getStartedContent(),b=this.editor.getElement(),c=this.source.getElement();this.opts.autoparse&&this.opts.autoparseStart&&(a=this.autoparser.parse(a));var d=this.cleaner.input(a,!0,!0),e=this.cleaner.output(d);b.html(d),c.val(e),this.syncedHtml=e,this.app.broadcast("placeholder.build"),this.app.broadcast("autoparseobserve"),this.component.executeScripts()},onstartcodeshow:function(){this.show()},ontrytosync:function(){this.sync()},onhardsync:function(){var a=this.editor.getElement(),b=a.html();b=this.app.broadcast("syncBefore",b),b=this.cleaner.output(b),this._syncing(b)},start:function(){this._build(),this._buildClasses()},stop:function(){var a=this.element.getElement(),b=this.source.getElement();a.removeClass("redactor-source redactor-source-open"),b.off("input.redactor-source"),b.removeAttr("data-gramm_editor"),0===b.get().classList.length&&b.removeAttr("class"),this.source.isNameGenerated()||a.removeAttr("name"),this.element.isType("textarea")||b.remove()},getCode:function(){return this.source.getCode()},toggle:function(){if(this.opts.source){return this.source.getElement().hasClass("redactor-source-open")?this.hide():this.show()}},show:function(){if(this.opts.source){var a=this.editor.getElement(),b=this.source.getElement(),c=this.container.getElement(),d=b.val();this.app.isStarted()&&(d=this.app.broadcast("source.open",d));var e=a.height();if(a.hide(),b.height(e),b.val(d.trim()),b.show(),b.addClass("redactor-source-open"),b.on("input.redactor-source-events",this._onChangedSource.bind(this)),b.on("keydown.redactor-source-events",this._onTabKey.bind(this)),b.on("focus.redactor-source-events",this._onFocus.bind(this)),this.opts.source.hasOwnProperty("codemirror")){var f="object"==typeof this.opts.source.codemirror?this.opts.source.codemirror:{},g=void 0!==this.opts.source.codemirrorSrc?this.opts.source.codemirrorSrc:CodeMirror;this.codemirror=g.fromTextArea(b.get(),f),this.codemirror.setSize(null,e),this.codemirror.on("change",function(a,b){a.save()}),this.codemirror.on("change",this._onChangedSource.bind(this))}else c.addClass("redactor-source-view");setTimeout(function(){this._disableButtons(),this._setActiveSourceButton()}.bind(this),100),this.app.isStarted()&&this.app.broadcast("source.opened")}},hide:function(){if(this.opts.source){var a=this.editor.getElement(),b=this.source.getElement(),c=this.container.getElement(),d=b.val();this.opts.source.hasOwnProperty("codemirror")&&(d=this.codemirror.getValue(),this.codemirror.toTextArea()),d=this.cleaner.input(d,!0),d=this.utils.isEmptyHtml(d)?this.opts.emptyHtml:d,d=this.app.broadcast("source.close",d),this._enableButtons(),this._setInactiveSourceButton(),b.hide(),b.removeClass("redactor-source-open"),b.off(".redactor-source-events"),a.show(),a.html(d),c.removeClass("redactor-source-view"),setTimeout(function(){this.editor.startFocus(),this.component.executeScripts()}.bind(this),0),this.app.broadcast("source.closed")}},sync:function(){var a=this,b=this.editor.getElement(),c=b.html();c=this.app.broadcast("syncBefore",c),c=this.cleaner.output(c),this._isSync(c)&&(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){a._syncing(c)},200))},_build:function(){var a=this.source.getElement(),b=this.element.getElement();a.hide(),this.opts.grammarly||a.attr("data-gramm_editor",!1),this.element.isType("textarea")||b.after(a)},_buildClasses:function(){this.source.getElement().addClass("redactor-source")},_syncing:function(a){a=this.app.broadcast("syncing",a),this.source.getElement().val(a),this.app.broadcast("synced",a),this.app.broadcast("changed",a)},_isSync:function(a){return this.syncedHtml!==a&&(this.syncedHtml=a,!0)},_onChangedSource:function(){var a=this.source.getElement(),b=a.val();this.app.broadcast("changed",b),this.app.broadcast("source.changed",b)},_onTabKey:function(a){if(9!==a.keyCode)return!0;a.preventDefault();var b=this.source.getElement(),c=b.get(),d=c.selectionStart;b.val(b.val().substring(0,d)+"    "+b.val().substring(c.selectionEnd)),c.selectionStart=c.selectionEnd=d+4},_onFocus:function(){this.app.broadcast("sourcefocus")},_disableButtons:function(){this.toolbar.disableButtons()},_enableButtons:function(){this.toolbar.enableButtons()},_setActiveSourceButton:function(){var a=this.toolbar.getButton("html");a.enable(),a.setActive()},_setInactiveSourceButton:function(){this.toolbar.getButton("html").setInactive()}}),$R.add("module","observer",{init:function(a){this.app=a,this.editor=a.editor,this.observerUnit=!1},start:function(){if(window.MutationObserver){var a=this.editor.getElement(),b=a.get();this.observerUnit=this._build(b),this.observerUnit.observe(b,{attributes:!0,subtree:!0,childList:!0,characterData:!0,characterDataOldValue:!0})}},stop:function(){this.observerUnit&&this.observerUnit.disconnect()},_build:function(a){var b=this;return new MutationObserver(function(c){b._observe(c[c.length-1],a)})},_observe:function(a,b){this.app.isReadOnly()||"attributes"===a.type&&a.target===b||(this.app.broadcast("observe"),this.app.broadcast("trytosync"),this.app.broadcast("placeholder.toggle"))}}),$R.add("module","clicktoedit",{init:function(a){this.app=a,this.opts=a.opts,this.source=a.source,this.editor=a.editor,this.container=a.container,this.selection=a.selection},onstartclicktoedit:function(){this.start()},onenablereadonly:function(){this._isEnabled()||this.stop()},ondisablereadonly:function(){this._isEnabled()||this.start()},onstop:function(){this.stop()},start:function(){this._build()},stop:function(){this.buttonSave&&this.buttonSave.stop(),this.buttonCancel&&this.buttonCancel.stop(),this._destroy(),this.app.broadcast("disable")},enable:function(){this.app.broadcast("clickStart");var a=this.editor.isEmpty();a||this.selection.saveMarkers(),this._setFocus(),this._destroy(),this.app.broadcast("enable"),this.buttonSave.enable(),this.buttonCancel.enable(),a||this.selection.restoreMarkers(),a&&this.editor.focus(),this.container.getElement().addClass("redactor-clicktoedit-enabled"),this.source.rebuildStartedContent(),this.app.broadcast("startcode"),this.app.broadcast("image.observe")},save:function(a){a&&a.preventDefault();var b=this.source.getCode();this.app.broadcast("disable"),this.app.broadcast("clickSave",b),this.app.broadcast("clickStop"),this.app.broadcast("toolbar.removeexternal"),this._build()},cancel:function(a){a&&a.preventDefault();var b=this.saved;this.editor.getElement().html(b),this.saved="",this.app.broadcast("disable"),this.app.broadcast("clickCancel",b),this.app.broadcast("clickStop"),this.app.broadcast("toolbar.removeexternal"),this._build()},_build:function(){this.buttonSave=$R.create("clicktoedit.button","save",this.app,this),this.buttonCancel=$R.create("clicktoedit.button","cancel",this.app,this),this.buttonSave.stop(),this.buttonCancel.stop();var a=this.editor.getElement(),b=this.container.getElement();a.on("click.redactor-click-to-edit mouseup.redactor-click-to-edit",this.enable.bind(this)),b.addClass("redactor-over"),b.removeClass("redactor-clicktoedit-enabled")},_isEnabled:function(){return this.container.getElement().hasClass("redactor-clicktoedit-enabled")},_destroy:function(){var a=this.editor.getElement(),b=this.container.getElement();a.off(".redactor-click-to-edit"),b.removeClass("redactor-over redactor-clicktoedit-enabled")},_setFocus:function(){this.saved=this.source.getCode(),this.buttonSave.start(),this.buttonCancel.start()}}),$R.add("class","clicktoedit.button",{init:function(a,b,c){this.app=b,this.opts=b.opts,this.toolbar=b.toolbar,this.context=c,this.type=a,this.name="save"===a?"clickToSave":"clickToCancel",this.objected=!1,this.enabled=!1,this.namespace=".redactor-click-to-edit",this._build()},enable:function(){if(this.objected){var a=this.opts[this.name];a.api="module.clicktoedit."+this.type,this.toolbar.addButton(this.type,a),this.enabled=!0}},start:function(){this.objected||(this.$button.off(this.namespace),this.$button.show(),this.$button.on("click"+this.namespace,this.context[this.type].bind(this.context)))},stop:function(){!this.objected&&this.enabled&&this.$button.hide()},_build:function(){this.objected="object"==typeof this.opts[this.name],this.objected||(this.$button=$R.dom(this.opts[this.name]),this.enabled=!0)}}),$R.add("module","statusbar",{init:function(a){this.app=a,this.opts=a.opts,this.element=a.element,this.statusbar=a.statusbar,this.container=a.container},start:function(){if(!this.element.isType("inline")){var a=this.statusbar.getElement(),b=this.container.getElement();a.addClass("redactor-statusbar"),b.append(a)}}}),$R.add("module","contextbar",{init:function(a){this.app=a,this.opts=a.opts,this.uuid=a.uuid,this.$win=a.$win,this.$doc=a.$doc,this.$body=a.$body,this.editor=a.editor,this.toolbar=a.toolbar,this.detector=a.detector,this.$target=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$body},onstop:function(){this.stop()},onenablereadonly:function(){this.stop()},ondisablereadonly:function(){this.start()},oncontextbar:{close:function(){this.close()}},start:function(){if(this.opts.toolbarContext){var a=this.editor.getElement();this._build(),a.on("click.redactor-context mouseup.redactor-context",this.open.bind(this)),this.opts.scrollTarget?$R.dom(this.opts.scrollTarget).on("scroll.redactor-context",this.close.bind(this)):!1!==this.opts.maxHeight&&a.on("scroll.redactor-context",this.close.bind(this))}},stop:function(){this.editor.getElement().off(".redactor-context"),this.$doc.off(".redactor-context"),this.$win.off(".redactor-context"),this.$contextbar&&this.$contextbar.remove(),this.opts.scrollTarget&&$R.dom(this.opts.scrollTarget).off(".redactor-context")},is:function(){return this.$contextbar&&this.$contextbar.hasClass("open")},set:function(a,b,c,d){this.$contextbar.html(""),this.$el=$R.dom(b);for(var e in c){var f=$R.create("contextbar.button",this.app,c[e]);""!==f.html()&&this.$contextbar.append(f)}var g=this._buildPosition(a,this.$el,d);this.$contextbar.css(g),this.$contextbar.show(),this.$contextbar.addClass("open"),this.$doc.on("click.redactor-context mouseup.redactor-context",this.close.bind(this)),this.$win.on("resize.redactor-context",this.close.bind(this))},open:function(a){setTimeout(function(){this.app.broadcast("contextbar",a,this)}.bind(this),0)},close:function(a){if(this.$contextbar){if(a){var b=$R.dom(a.target);if(this.$el&&0!==b.closest(this.$el).length)return}this.$contextbar.hide(),this.$contextbar.removeClass("open"),this.$doc.off(".redactor.context")}},_build:function(){this.$contextbar=$R.dom("<div>"),this.$contextbar.attr("id","redactor-context-toolbar-"+this.uuid),this.$contextbar.attr("dir",this.opts.direction),this.$contextbar.addClass("redactor-context-toolbar"),this.$contextbar.hide(),this.$target.append(this.$contextbar)},_buildPosition:function(a,b,c){var d,e,f=this.toolbar.isTarget(),g=f?b.position():b.offset(),h=b.width(),i=b.height(),j=this.$contextbar.width(),k=this.$contextbar.height(),l=f?this.$target.scrollTop()+this.$doc.scrollTop():this.$doc.scrollTop(),m=this.$target.offset(),n=f?m.left:0,o=f?m.top:0;return c?"top"===c?(d=g.top-k,e=g.left+h/2-j/2):"bottom"===c&&(d=g.top+i,e=g.left+h/2-j/2):(d=a.clientY+l-k,e=a.clientX-j/2),e<0&&(e=0),{top:d-o+"px",left:e-n+"px"}}}),$R.add("class","contextbar.button",{mixins:["dom"],init:function(a,b){this.app=a,this.obj=b,this._init()},_init:function(){if(this.parse("<a>"),"string"!=typeof this.obj.title){var a=this.obj.title.attr("href");this.attr("href",a),-1===a.search(/^#/)&&this.attr("target","_blank"),this.text(this.obj.html||a)}else this.attr("href","#"),this._buildTitle(),this._buildMessage()},_buildTitle:function(){this.html(this.obj.title)},_buildMessage:function(){void 0===this.obj.message&&void 0===this.obj.api||this.on("click",this._toggle.bind(this))},_toggle:function(a){a.preventDefault(),this.obj.message?this.app.broadcast(this.obj.message,this.obj.args):this.obj.api&&this.app.api(this.obj.api,this.obj.args)}}),$R.add("module","toolbar",{init:function(a){this.app=a,this.uuid=a.uuid,this.opts=a.opts,this.utils=a.utils,this.toolbar=a.toolbar,this.buttons=[],this.toolbarModule=!1},onsource:{open:function(){!this.toolbar.isAir()&&this.toolbar.isFixed()&&this.toolbarModule.resetPosition()},opened:function(){this.toolbar.isAir()&&this.toolbarModule&&this.toolbarModule.createSourceHelper(),setTimeout(function(){$R.dom(".re-button-tooltip-"+this.uuid).remove()}.bind(this),100)},close:function(){this.toolbar.isAir()&&this.toolbarModule&&this.toolbarModule.destroySourceHelper()},closed:function(){this.toolbar.is()&&this.opts.air&&this.toolbarModule.openSelected()}},ontoolbar:{removeexternal:function(){!this.opts.air&&this.opts.toolbarExternal&&this.opts.clickToEdit&&$R.dom(this.opts.toolbarExternal).html("")}},onobserve:function(){this.toolbar.is()&&this.toolbar.observe()},onfocus:function(){this._setExternalOnFocus()},onsourcefocus:function(){this._setExternalOnFocus()},onempty:function(){this.toolbar.isFixed()&&this.toolbarModule.resetPosition()},onenablereadonly:function(){this.toolbar.isAir()&&this.toolbarModule.close()},start:function(){this.toolbar.is()&&(this._buildButtons(),this._initToolbar(),this._initButtons())},stop:function(){this.toolbarModule&&this.toolbarModule.stop(),$R.dom(".redactor-dropdown-"+this.uuid).remove()},_buildButtons:function(){this.buttons=this.opts.buttons.concat(),this._buildImageButton(),this._buildFileButton(),this._buildSourceButton(),this._buildAdditionalButtons(),this._buildHiddenButtons()},_buildImageButton:function(){this.opts.imageUpload||this.opts.imageManagerJson||this.utils.removeFromArrayByValue(this.buttons,"image")},_buildFileButton:function(){this.opts.fileUpload||this.utils.removeFromArrayByValue(this.buttons,"file")},_buildSourceButton:function(){this.opts.source||this.utils.removeFromArrayByValue(this.buttons,"html")},_buildAdditionalButtons:function(){0!==this.opts.buttonsAdd.length&&(this.opts.buttonsAdd=this._removeExistButtons(this.opts.buttonsAdd),this.buttons=this.buttons.concat(this.opts.buttonsAdd)),0!==this.opts.buttonsAddFirst.length&&(this.opts.buttonsAddFirst=this._removeExistButtons(this.opts.buttonsAddFirst),this.buttons.unshift(this.opts.buttonsAddFirst));var a,b;if(!1!==this.opts.buttonsAddAfter){a=this.buttons.indexOf(this.opts.buttonsAddAfter.after)+1,b=this.opts.buttonsAddAfter.buttons;for(var c=0;c<b.length;c++)this.buttons.splice(a+c,0,b[c])}if(!1!==this.opts.buttonsAddBefore){a=this.buttons.indexOf(this.opts.buttonsAddBefore.before)+1,b=this.opts.buttonsAddBefore.buttons;for(var c=0;c<b.length;c++)this.buttons.splice(a-(1-c),0,b[c])}},_buildHiddenButtons:function(){if(0!==this.opts.buttonsHide.length)for(var a=this.opts.buttonsHide,b=0;b<a.length;b++)this.utils.removeFromArrayByValue(this.buttons,a[b])},_removeExistButtons:function(a){for(var b=0;b<a.length;b++)-1!==this.opts.buttons.indexOf(a[b])&&this.utils.removeFromArrayByValue(a,a[b]);return a},_setExternalOnFocus:function(){!this.opts.air&&this.opts.toolbarExternal&&this.toolbarModule.setExternal()},_initToolbar:function(){this.toolbarModule=this.opts.air?$R.create("toolbar.air",this.app):$R.create("toolbar.standard",this.app)},_initButtons:function(){this.toolbar.setButtons(this.buttons);for(var a=0;a<this.buttons.length;a++){var b=this.buttons[a];$R.buttons[b]&&this.toolbar.addButton(b,$R.buttons[b],!1,!1,!0)}}}),$R.add("class","toolbar.air",{init:function(a){this.app=a,this.uuid=a.uuid,this.$doc=a.$doc,this.$win=a.$win,this.utils=a.utils,this.editor=a.editor,this.animate=a.animate,this.toolbar=a.toolbar,this.container=a.container,this.inspector=a.inspector,this.selection=a.selection,this.clicks=0,this._init()},stop:function(){this.toolbar.getWrapper().remove(),this.editor.getElement().off(".redactor-air-trigger-"+this.uuid),this.$doc.off(".redactor-air-"+this.uuid),this.$doc.off(".redactor-air-trigger-"+this.uuid),this.toolbar.stopObservers()},createSourceHelper:function(){this.$airHelper=$R.dom("<span>"),this.$airHelper.addClass("redactor-air-helper"),this.$airHelper.html('<i class="re-icon-html"></i>'),this.$airHelper.on("click",function(a){a.preventDefault(),this.app.api("module.source.hide")}.bind(this)),this.container.getElement().append(this.$airHelper)},destroySourceHelper:function(){this.$airHelper&&this.$airHelper.remove()},openSelected:function(){setTimeout(function(){this._isSelection()&&this._open(!1)}.bind(this),0)},close:function(){this.$doc.off(".redactor-air-"+this.uuid);var a=this.toolbar.getElement();a.removeClass("open"),a.hide()},_init:function(){this.toolbar.create();var a=this.toolbar.getWrapper(),b=this.toolbar.getElement(),c=this.editor.getElement(),d=this.container.getElement();a.addClass("redactor-toolbar-wrapper-air"),b.addClass("redactor-air"),b.hide(),a.append(b),d.prepend(a),this.openSelected(),this.$doc.on("mouseup.redactor-air-trigger-"+this.uuid,this._open.bind(this)),c.on("keyup.redactor-air-trigger-"+this.uuid,this._openCmd.bind(this))},_isSelection:function(){return this.selection.is()&&!this.selection.isCollapsed()},_isOpened:function(){return this.toolbar.getElement().hasClass("open")},_open:function(a){var b=!!a&&a.target,c=!!a&&$R.dom(a.target),d=this.inspector.parse(b),e=d.isComponent()&&!d.isComponentType("table"),f=d.isFigcaption(),g=c&&0!==c.closest(".redactor-modal").length,h=a&&0!==c.closest(".re-button").length;if(!(a&&0!==c.closest(".redactor-dropdown").length||h||g||f||e||this.toolbar.isContextBar())&&this._isSelection()){var i=this.selection.getPosition();setTimeout(function(){this.app.isReadOnly()||this._isSelection()&&this._doOpen(i)}.bind(this),1)}},_openCmd:function(){if(this.selection.isAll()){var a=this.toolbar.getElement(),b=this.selection.getPosition();b.top=b.top<20?0:b.top-a.height(),b.height=0,this._doOpen(b)}},_doOpen:function(a){var b=this.toolbar.getWrapper(),c=this.toolbar.getElement(),d=this.container.getElement(),e=d.offset(),f=0,g=this.$win.width(),h=c.width();if(g<a.left+h){f=h-this.selection.getPosition().width}b.css({left:a.left-e.left-f+"px",top:a.top-e.top+a.height+this.$doc.scrollTop()+"px"}),this.app.broadcast("airOpen"),c.addClass("open"),c.show(),this.$doc.on("click.redactor-air-"+this.uuid,this._close.bind(this)),this.$doc.on("keydown.redactor-air-"+this.uuid,this._close.bind(this)),this.app.broadcast("airOpened")},_close:function(a){var b=!!a&&$R.dom(a.target),c=a&&0!==b.closest("[data-dropdown], .redactor-dropdown-not-close").length;(!c&&a&&0!==b.closest(".re-button").length||!c&&this._isOpened())&&(this.app.broadcast("airClose"),this.close(),this.app.broadcast("airClosed"))}}),$R.add("class","toolbar.fixed",{init:function(a){this.app=a,this.uuid=a.uuid,this.opts=a.opts,this.$doc=a.$doc,this.$win=a.$win,this.editor=a.editor,this.toolbar=a.toolbar,this.detector=a.detector,this.container=a.container,this._init()},stop:function(){this.$fixedTarget.off(".redactor-toolbar-"+this.uuid),this.$win.off(".redactor-toolbar-"+this.uuid)},reset:function(){var a=this.toolbar.getElement();this.toolbar.getWrapper().css("height",""),a.removeClass("redactor-toolbar-fixed"),a.css({position:"",top:"",left:"",width:""});var b=this.toolbar.getDropdown();b&&b.updatePosition()},_init:function(){this.$fixedTarget=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$win,this._doFixed(),this.toolbar.isTarget()&&(this.$win.on("scroll.redactor-toolbar-"+this.uuid,this._doFixed.bind(this)),this.$win.on("resize.redactor-toolbar-"+this.uuid,this._doFixed.bind(this))),this.$fixedTarget.on("scroll.redactor-toolbar-"+this.uuid,this._doFixed.bind(this)),this.$fixedTarget.on("resize.redactor-toolbar-"+this.uuid,this._doFixed.bind(this))},_doFixed:function(){var a=this.editor.getElement(),b=this.container.getElement(),c=this.toolbar.getElement(),d=this.toolbar.getWrapper();if(!this.editor.isSourceMode()){if(0===b.parents().filter(function(a){return"none"===getComputedStyle(a,null).display&&a}).length){var e=a.height()<100,f=this.editor.isEmpty();if(e||f)return void this.reset();if(!this.editor.isSourceMode()){var g=c.height(),h=this.toolbar.isTarget()?b.position():b.offset(),i=h.top,j=i+b.height()-60,k=this.$fixedTarget.scrollTop()+this.opts.toolbarFixedTopOffset,l=this.toolbar.isTarget()?this.$fixedTarget.offset().top-this.$win.scrollTop():0;if(this.toolbar.isTarget()&&"fixed"===this.$fixedTarget.css("position")){var m=this.$fixedTarget.hasClass("modal")&&this.$fixedTarget.hasClass("fade"),n=m?b.closest(".modal-dialog").position().top:0;l=this.$fixedTarget.scrollTop()-n}if(k>i&&k<j){var o=this.detector.isDesktop()?"fixed":"absolute";l=this.detector.isDesktop()?l:k-i,this.detector.isMobile()&&(this.fixedScrollTimeout&&clearTimeout(this.fixedScrollTimeout),c.hide(),this.fixedScrollTimeout=setTimeout(function(){c.show()},250)),d.height(g),c.addClass("redactor-toolbar-fixed"),b.hasClass("redactor-box-fullscreen")?c.css({position:o,top:"0px",width:b.width()+"px"}):c.css({position:o,top:l+this.opts.toolbarFixedTopOffset+"px",width:b.width()+"px"});var p=this.toolbar.getDropdown();p&&p.updatePosition(),this.app.broadcast("toolbar.fixed")}else this.reset(),this.app.broadcast("toolbar.unfixed")}}}}}),$R.add("class","toolbar.standard",{init:function(a){this.app=a,this.opts=a.opts,this.uuid=a.uuid,this.$body=a.$body,this.toolbar=a.toolbar,this.container=a.container,this.isExternalMultiple=!1,this.toolbarFixed=!1,this._init()},stop:function(){this.toolbar.getWrapper().remove(),this.toolbarFixed&&this.toolbarFixed.stop(),this.opts.toolbarExternal&&this._findToolbars(),this.toolbar.stopObservers(),this.$body.find(".re-button-tooltip-"+this.uuid).remove()},setExternal:function(){if(this._findToolbars(),this.isExternalMultiple){this.$toolbars.hide();this.$external.find(".redactor-toolbar-external-"+this.uuid).show()}},resetPosition:function(){this.toolbarFixed&&this.toolbarFixed.reset()},_init:function(){if(this._build(),this.opts.toolbarExternal)this._buildExternal();else{this._buildFixed();this.toolbar.getElement().show()}},_build:function(){this.toolbar.create();var a=this.toolbar.getWrapper(),b=this.toolbar.getElement();if(a.addClass("redactor-toolbar-wrapper"),b.addClass("redactor-toolbar"),b.hide(),a.append(b),!this.opts.toolbarExternal){this.container.getElement().prepend(a)}},_buildExternal:function(){if(this._initExternal(),this._findToolbars(),this.isExternalMultiple)this._hideToolbarsExceptFirst();else{this.toolbar.getElement().show()}},_buildFixed:function(){this.opts.toolbarFixed&&(this.toolbarFixed=$R.create("toolbar.fixed",this.app))},_initExternal:function(){var a=this.toolbar.getElement(),b=this.toolbar.getElement();a.addClass("redactor-toolbar-external redactor-toolbar-external-"+this.uuid),this.$external=$R.dom(this.opts.toolbarExternal),this.$external.append(b)},_findToolbars:function(){this.$toolbars=this.$external.find(".redactor-toolbar-external"),this.isExternalMultiple=this.$toolbars.length>1},_hideToolbarsExceptFirst:function(){this.$toolbars.hide(),this.$toolbars.first().show()}}),$R.add("module","line",{init:function(a){this.app=a,this.lang=a.lang,this.component=a.component,this.inspector=a.inspector,this.insertion=a.insertion},oncontextbar:function(a,b){var c=this.inspector.parse(a.target);if(c.isComponentType("line")){var d=c.getComponent(),e={remove:{title:this.lang.get("delete"),api:"module.line.remove",args:d}};b.set(a,d,e,"bottom")}},insert:function(){var a=this.component.create("line");this.insertion.insertRaw(a)},remove:function(a){this.component.remove(a)}}),$R.add("class","line.component",{mixins:["dom","component"],init:function(a,b){return this.app=a,b&&void 0!==b.cmnt?b:this._init(b)},_init:function(a){var b,c;if(void 0!==a){var d=$R.dom(a),e=d.get();"HR"===e.tagName?c=e:"FIGURE"===e.tagName&&(b=e,c=d.find("hr").get())}this._buildWrapper(b),this._buildElement(c),this._initWrapper()},_buildElement:function(a){a?this.$element=$R.dom(a):(this.$element=$R.dom("<hr>"),this.append(this.$element))},_buildWrapper:function(a){a=a||"<figure>",this.parse(a)},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"line",tabindex:"-1",contenteditable:!1})}}),$R.add("module","link",{modals:{link:'<form action="">                 <div class="form-item">                     <label for="modal-link-url">URL <span class="req">*</span></label>                     <input type="text" id="modal-link-url" name="url">                 </div>                 <div class="form-item">                     <label for="modal-link-text">## text ##</label>                     <input type="text" id="modal-link-text" name="text">                 </div>                 <div class="form-item form-item-title">                     <label for="modal-link-title">## title ##</label>                     <input type="text" id="modal-link-title" name="title">                 </div>                 <div class="form-item form-item-target">                     <label class="checkbox">                         <input type="checkbox" name="target"> ## link-in-new-tab ##                     </label>                 </div>             </form>'},init:function(a){this.app=a,this.opts=a.opts,this.lang=a.lang,this.caret=a.caret,this.utils=a.utils,this.inline=a.inline,this.editor=a.editor,this.inspector=a.inspector,this.insertion=a.insertion,this.selection=a.selection,this.isCurrentLink=!1,this.currentText=!1},onmodal:{link:{open:function(a,b){this._setFormData(b,a)},opened:function(a,b){this._setFormFocus(b)},update:function(a,b){var c=b.getData();this._validateData(b,c)&&this._update(c)},insert:function(a,b){var c=b.getData();this._validateData(b,c)&&this._insert(c)},unlink:function(){this._unlink()}}},onbutton:{link:{observe:function(a){this._observeButton(a)}}},ondropdown:{link:{observe:function(a){this._observeUnlink(a),this._observeEdit(a)}}},oncontextbar:function(a,b){var c=this._getCurrent(),d=this.inspector.parse(c);if(d.isLink()||d.isFile()){var e=d.isFile()?d.getFile():d.getLink(),f=$R.dom(e),g=$R.dom("<a>"),h=f.attr("href");g.text(this._truncateText(h)),g.attr("href",h),g.attr("target","_blank");var i={link:{title:g,html:this._truncateText(h)},edit:{title:this.lang.get("edit"),api:"module.link.open"},unlink:{title:this.lang.get("unlink"),api:"module.link.unlink"}};b.set(a,e,i,"bottom")}},open:function(){this.$link=this._buildCurrent(),this.app.api("module.modal.build",this._getModalData())},insert:function(a){this._insert(a)},update:function(a){this._update(a)},unlink:function(){this._unlink()},_observeButton:function(a){var b=this.selection.getCurrent(),c=this.inspector.parse(b);c.isPre()||c.isCode()?a.disable():a.enable()},_observeUnlink:function(a){var b=a.getItem("unlink");0===this._getLinks().length?b.disable():b.enable()},_observeEdit:function(a){var b=this._getCurrent(),c=a.getItem("link"),d=this.inspector.parse(b),e=d.isLink()||d.isFile()?this.lang.get("link-edit"):this.lang.get("link-insert");c.setTitle(e)},_unlink:function(){this.app.api("module.modal.close");var a=[],b=this._getLinks();this.selection.save();for(var c=0;c<b.length;c++){var d=$R.create("link.component",this.app,b[c]);a.push(this.selection.getElement(b[c])),d.unwrap(),this.app.broadcast("link.deleted",d)}this.selection.restore();for(var c=0;c<a.length;c++){var e=a[c]?a[c]:this.editor.getElement();this.utils.normalizeTextNodes(e)}this._resetCurrent()},_update:function(a){this.app.api("module.modal.close");var b=this._getLinks();this._setLinkData(b,a,"updated"),this._resetCurrent(),this.app.broadcast("link.changed",b)},_insert:function(a){this.app.api("module.modal.close");var b=this._getLinks();this._insertSingle(b,a)||(this._removeInSelection(b),this._insertMultiple(a)),this._resetCurrent()},_removeInSelection:function(a){this.selection.save();for(var b=0;b<a.length;b++){var c=$R.create("link.component",this.app,a[b]),d=c.clone();c.unwrap(),this.app.broadcast("link.deleted",d)}this.selection.restore()},_insertMultiple:function(a){var b=this.selection.getRange();b&&this._isCurrentTextChanged(a)&&this._deleteContents(b);var c=this.inline.format({tag:"a"});this._setLinkData(c,a,"inserted")},_insertSingle:function(a,b){var c=this.selection.getInline();if(1===a.length&&a[0].textContext===this.selection.getText()||c&&"A"===c.tagName){var d=$R.create("link.component",this.app,a[0]);return d.setData(b),this.caret.setAfter(d),this.app.broadcast("link.inserted",d),!0}return!1},_setLinkData:function(a,b,c){b.text=""===b.text.trim()?this._truncateText(b.url):b.text;var d=!this.currentText||this.currentText!==b.text;this.selection.save();for(var e=0;e<a.length;e++){var f=$R.create("link.component",this.app,a[e]),g={};b.text&&d&&(g.text=b.text),b.url&&(g.url=b.url),void 0!==b.title&&(g.title=b.title),void 0!==b.target&&(g.target=b.target),f.setData(g),this.app.broadcast("link."+c,f)}setTimeout(this.selection.restore.bind(this.selection),0)},_deleteContents:function(a){var b=this.selection.getHtml(),c=this.utils.parseHtml(b),d=c.nodes[0];if(d&&3!==d.nodeType){var e=d.tagName.toLowerCase(),f=document.createElement(e);this.insertion.insertNode(f,"start")}else a.deleteContents()},_getModalData:function(){var a;return a=this._isLink()?{update:{title:this.lang.get("save")},unlink:{title:this.lang.get("unlink"),type:"danger"},cancel:{title:this.lang.get("cancel")}}:{insert:{title:this.lang.get("insert")},cancel:{title:this.lang.get("cancel")}},{name:"link",title:this._isLink()?this.lang.get("link-edit"):this.lang.get("link-insert"),handle:this._isLink()?"update":"insert",commands:a}},_isLink:function(){return this.currentLink},_isCurrentTextChanged:function(a){return this.currentText&&this.currentText!==a.text},_buildCurrent:function(){var a,b=this._getCurrent(),c=this.inspector.parse(b);if(c.isLink()||c.isFile())this.currentLink=!0,a=c.isFile()?c.getFile():c.getLink(),a=$R.create("link.component",this.app,a);else{this.currentLink=!1,a=$R.create("link.component",this.app);var d={text:this.selection.getText()};a.setData(d)}return a},_getCurrent:function(){return this.selection.getInlinesAllSelected({tags:["a"]})[0]},_getLinks:function(){for(var a=this.selection.getInlines({all:!0,tags:["a"]}),b=[],c=0;c<a.length;c++){var d=this.inspector.parse(a[c]);(d.isLink()||d.isFile())&&b.push(a[c])}return b},_resetCurrent:function(){this.isCurrentLink=!1,this.currentText=!1},_truncateText:function(a){return a&&a.length>this.opts.linkSize?a.substring(0,this.opts.linkSize)+"...":a},_validateData:function(a,b){return""!==b.url.trim()||a.setError("url")},_setFormFocus:function(a){a.getField("url").focus()},_setFormData:function(a,b){var c=this.$link.getData(),d={url:c.url,text:c.text,title:c.title,target:this.opts.linkTarget||c.target};this.opts.linkNewTab||b.find(".form-item-target").hide(),this.opts.linkTitle||b.find(".form-item-title").hide(),a.setData(d),this.currentText=a.getField("text").val()}}),$R.add("class","link.component",{mixins:["dom","component"],init:function(a,b){return this.app=a,this.opts=a.opts,
this.reUrl=/^(?:(?:(?:https?|ftp):)?\/\/)?(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i,b&&void 0!==b.cmnt?b:this._init(b)},setData:function(a){for(var b in a)this._set(b,a[b])},getData:function(){for(var a=["url","text","target","title"],b={},c=0;c<a.length;c++)b[a[c]]=this._get(a[c]);return b},_init:function(a){var b=$R.dom(a);void 0===a?this.parse("<a>"):this.parse(b)},_set:function(a,b){this["_set_"+a](b)},_get:function(a){return this["_get_"+a]()},_get_target:function(){return!!this.attr("target")&&this.attr("target")},_get_url:function(){return this.attr("href")},_get_title:function(){return this.attr("title")},_get_text:function(){return this._getContext().text()},_getContext:function(){return this._findDeepestChild(this).element},_set_target:function(a){!1===a?this.removeAttr("target"):a&&this.attr("target",!0===a?"_blank":a)},_set_text:function(a){this._getContext().html(a)},_set_title:function(a){a&&""!==a?this.attr("title",a):this.removeAttr("title")},_set_url:function(a){this.opts.linkValidation&&(a=this._cleanUrl(a),this._isMailto(a)?a="mailto:"+a.replace("mailto:",""):this._isUrl(a)&&-1===a.search(/^(ftp|https?)/i)&&(a="http://"+a.replace(/(ftp|https?):\/\//i,""))),this.attr("href",a)},_isMailto:function(a){return-1!==a.search("@")&&!1===/(ftp|https?):\/\//i.test(a)},_isUrl:function(a){return this.reUrl.test(a)},_cleanUrl:function(a){return a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),a.trim().replace(/[^\W\w\D\d+&\'@#/%?=~_|!:,.;\(\)]/gi,"")},_findDeepestChild:function(a){var b={depth:0,element:a};return a.children().each(function(c){var d=$R.dom(c);if(c.outerHTML===a.html()){var e=this._findDeepestChild(d);e.depth+1>b.depth&&(b={depth:1+e.depth,element:e.element})}}.bind(this)),b}}),$R.add("module","modal",{init:function(a){this.app=a,this.uuid=a.uuid,this.lang=a.lang,this.$doc=a.$doc,this.$win=a.$win,this.$body=a.$body,this.utils=a.utils,this.editor=a.editor,this.animate=a.animate,this.detector=a.detector,this.selection=a.selection,this.$box=!1,this.$modal=!1,this.selectionMarkers=!1,this.defaults={name:!1,url:!1,title:!1,width:"600px",height:!1,handle:!1,commands:!1}},build:function(a){this._open(a)},close:function(){this._close()},onstop:function(){this.$body.find("#redactor-modal-"+this.uuid).remove(),this.$body.find("#redactor-overlay-"+this.uuid).remove()},stop:function(){this.$box&&(this.$box.remove(),this.$box=!1,this.$modal=!1),this.$overlay&&this.$overlay.remove(),this.$doc.off(".redactor.modal"),this.$win.off(".redactor.modal")},resize:function(){this.$modal.setWidth(this.p.width),this.$modal.updatePosition()},_isOpened:function(){return this.$modal&&this.$modal.hasClass("open")},_open:function(a){this._buildDefaults(a),this.p.url?this._openUrl():this._openTemplate()},_openUrl:function(){$R.ajax.post({url:this.p.url,success:this._doOpen.bind(this)})},_openTemplate:function(){if(void 0!==$R.modals[this.p.name]){var a=this.lang.parse($R.modals[this.p.name]);this._doOpen(a)}},_doOpen:function(a){this.stop(),this.selection.isCollapsed()?(this.selection.save(),this.selectionMarkers=!1):(this.selection.saveMarkers(),this.selectionMarkers=!0),this.detector.isDesktop()||document.activeElement.blur(),this._createModal(a),this._buildModalBox(),this._buildOverlay(),this._buildModal(),this._buildModalForm(),this._buildModalCommands(),this._broadcast("open"),this.$modal.updatePosition(),this._buildModalTabs(),this.animate.start(this.$box,"fadeIn",this._opened.bind(this)),this.animate.start(this.$overlay,"fadeIn")},_opened:function(){this.$modal.addClass("open"),this.$box.on("mousedown.redactor.modal",this._close.bind(this)),this.$doc.on("keyup.redactor.modal",this._handleEscape.bind(this)),this.$win.on("resize.redactor.modal",this.resize.bind(this)),this.$modal.getBody().find("input[type=text],input[type=url],input[type=email]").on("keydown.redactor.modal",this._handleEnter.bind(this)),window.jQuery&&jQuery(document).off("focusin.modal"),this._broadcast("opened")},_close:function(a){if(this.$box&&this._isOpened()){if(a){if(!this._needToClose(a.target))return;a.stopPropagation(),a.preventDefault()}this.selectionMarkers?this.selection.restoreMarkers():this.selection.restore(),this.selectionMarkers=!1,this._broadcast("close"),this.animate.start(this.$box,"fadeOut",this._closed.bind(this)),this.animate.start(this.$overlay,"fadeOut")}},_closed:function(){this.$modal.removeClass("open"),this.$box.off(".redactor.modal"),this.$doc.off(".redactor.modal"),this.$win.off(".redactor.modal"),this._broadcast("closed")},_createModal:function(a){this.$modal=$R.create("modal.element",this.app,a)},_broadcast:function(a){this.app.broadcast("modal."+a,this.$modal,this.$modalForm),this.app.broadcast("modal."+this.p.name+"."+a,this.$modal,this.$modalForm)},_buildDefaults:function(a){this.p=$R.extend({},this.defaults,a)},_buildModalBox:function(){this.$box=$R.dom("<div>"),this.$box.attr("id","redactor-modal-"+this.uuid),this.$box.addClass("redactor-modal-box redactor-animate-hide"),this.$box.html(""),this.$body.append(this.$box)},_buildOverlay:function(){this.$overlay=$R.dom("#redactor-overlay-"+this.uuid),0===this.$overlay.length&&(this.$overlay=$R.dom("<div>"),this.$overlay.attr("id","redactor-overlay-"+this.uuid),this.$overlay.addClass("redactor-overlay redactor-animate-hide"),this.$body.prepend(this.$overlay))},_buildModal:function(){this.$box.append(this.$modal),this.$modal.setTitle(this.p.title),this.$modal.setHeight(this.p.height),this.$modal.setWidth(this.p.width)},_buildModalCommands:function(){if(this.p.commands){var a=this.p.commands,b=this.$modal.getFooter();for(var c in a){var d=$R.dom("<button>");d.html(a[c].title),d.attr("data-command",c),"cancel"===c&&(d.attr("data-action","close"),d.addClass("redactor-button-unstyled")),void 0!==a[c].type&&"danger"===a[c].type&&d.addClass("redactor-button-danger"),d.on("click",this._handleCommand.bind(this)),b.append(d)}}},_buildModalTabs:function(){var a=this.$modal.getBody(),b=a.find(".redactor-modal-tab"),c=a.find(".redactor-modal-tabs");b.length>1&&(c=0===c.length?$R.dom("<div>"):c.html(""),c.addClass("redactor-modal-tabs"),b.each(function(a,b){var d=$R.dom(a),e=$R.dom("<a>");e.attr("href","#"),e.attr("rel",b),e.text(d.attr("data-title")),e.on("click",this._showTab.bind(this)),0===b&&e.addClass("active"),c.append(e)}.bind(this)),a.prepend(c)),1===b.length&&b.show()},_buildModalForm:function(){this.$modalForm=$R.create("modal.form",this.app,this.$modal.getForm())},_showTab:function(a){a.preventDefault();var b=$R.dom(a.target),c=b.attr("rel"),d=this.$modal.getBody(),e=d.find(".redactor-modal-tab");e.hide(),e.eq(c).show(),d.find(".redactor-modal-tabs a").removeClass("active"),b.addClass("active")},_needToClose:function(a){var b=$R.dom(a);return!("close"!==b.attr("data-action")&&!this.$modal.isCloseNode(a)&&0!==b.closest(".redactor-modal").length)},_handleCommand:function(a){var b=$R.dom(a.target).closest("button"),c=b.attr("data-command");"cancel"!==c&&a.preventDefault(),this._broadcast(c)},_handleEnter:function(a){13===a.which&&this.p.handle&&(a.preventDefault(),this._broadcast(this.p.handle))},_handleEscape:function(a){27===a.which&&this._close()}}),$R.add("class","modal.element",{mixins:["dom"],init:function(a,b){this.app=a,this.opts=a.opts,this.$win=a.$win,this._init(b)},getForm:function(){return this.find("form")},getHeader:function(){return this.$modalHeader},getBody:function(){return this.$modalBody},getFooter:function(){return this.$modalFooter},setTitle:function(a){a&&this.$modalHeader.html(a)},setWidth:function(a){a=parseInt(a)>=this.$win.width()?"96%":a,this.css("max-width",a)},setHeight:function(a){!1!==a&&this.$modalBody.css("height",a)},updatePosition:function(){var a=this.width();this.css({left:"50%","margin-left":"-"+a/2+"px"});var b=this.$win.height(),c=this.height(),d=b/2-c/2;c<b&&0!==d&&this.css("margin-top",d+"px")},isCloseNode:function(a){return a===this.$modalClose.get()},_init:function(a){this._build(),this._buildClose(),this._buildHeader(),this._buildBody(),this._buildFooter(),this._buildTemplate(a)},_build:function(){this.parse("<div>"),this.addClass("redactor-modal"),this.attr("dir",this.opts.direction)},_buildClose:function(){this.$modalClose=$R.dom("<span>"),this.$modalClose.addClass("redactor-close"),this.append(this.$modalClose)},_buildHeader:function(){this.$modalHeader=$R.dom("<div>"),this.$modalHeader.addClass("redactor-modal-header"),this.append(this.$modalHeader)},_buildBody:function(){this.$modalBody=$R.dom("<div>"),this.$modalBody.addClass("redactor-modal-body"),this.append(this.$modalBody)},_buildFooter:function(){this.$modalFooter=$R.dom("<div>"),this.$modalFooter.addClass("redactor-modal-footer"),this.append(this.$modalFooter)},_buildTemplate:function(a){this.$modalBody.html(a)}}),$R.add("class","modal.form",{mixins:["dom"],init:function(a,b){this.app=a,this.build(b)},build:function(a){this.parse(a)},getData:function(){var a={};return this.find("[name]").each(function(b){var c=$R.dom(b);a[c.attr("name")]=c.val()}),a},setData:function(a){this.find("[name]").each(function(b){var c=$R.dom(b),d=c.attr("name");a.hasOwnProperty(d)&&(b.type&&"checkbox"===b.type?b.checked=a[d]:c.val(a[d]))})},getField:function(a){return this.find("[name="+a+"]")},setError:function(a){var b=this.getField(a);return b.addClass("error"),b.one(this._getFieldEventName(b.get()),this._clearError),!1},_clearError:function(){return $R.dom(this).removeClass("error")},_getFieldEventName:function(a){return"SELECT"===a.tagName||"checkbox"===a.type||"radio"===a.type?"change":"keyup"}}),$R.add("module","block",{init:function(a){this.app=a,this.block=a.block},format:function(a){var b=this.block.format(a);this.app.broadcast("format","block",b)},clearformat:function(){this.block.clearFormat()},clearstyle:function(){this.block.clearStyle()},clearclass:function(){this.block.clearClass()},clearattr:function(){this.block.clearAttr()},add:function(a,b){this.block.add(a,b)},toggle:function(a,b){this.block.toggle(a,b)},set:function(a,b){this.block.set(a,b)},remove:function(a,b){this.block.remove(a,b)}}),$R.add("module","inline",{init:function(a){this.app=a,this.inline=a.inline},format:function(a){var b=this.inline.format(a);this.app.broadcast("format","inline",b)},clearformat:function(){this.inline.clearFormat()},clearstyle:function(){this.inline.clearStyle()},clearclass:function(){this.inline.clearClass()},clearattr:function(){this.inline.clearAttr()},add:function(a,b){this.inline.add(a,b)},toggle:function(a,b){this.inline.toggle(a,b)},set:function(a,b){this.inline.set(a,b)},remove:function(a,b){this.inline.remove(a,b)}}),$R.add("module","autosave",{init:function(a){this.app=a,this.opts=a.opts,this.utils=a.utils,this.source=a.source},onsynced:function(){this.opts.autosave&&this._send()},_send:function(){var a=this.opts.autosaveName?this.opts.autosaveName:this.source.getName(),b={};b[a]=this.source.getCode(),b=this.utils.extendData(b,this.opts.autosaveData),$R.ajax.post({url:this.opts.autosave,data:b,success:function(c){this._complete(c,a,b)}.bind(this)})},_complete:function(a,b,c){var d=a&&a.error?"autosaveError":"autosave";this.app.broadcast(d,b,c,a)}}),$R.add("module","input",{init:function(a){this.app=a,this.opts=a.opts,this.utils=a.utils,this.editor=a.editor,this.keycodes=a.keycodes,this.element=a.element,this.selection=a.selection,this.insertion=a.insertion,this.inspector=a.inspector,this.autoparser=a.autoparser,this.lastShiftKey=!1},onpaste:function(a,b){if(this.opts.input)return $R.create("input.paste",this.app,a,b)},onkeydown:function(a){if(this.opts.input){var b=a.which;if(!$R.create("input.shortcut",this.app,a).is()){if((a.ctrlKey||a.metaKey)&&!a.altKey&&65===b)return a.preventDefault(),this._selectAll();var c=[this.keycodes.ENTER,this.keycodes.SPACE,this.keycodes.BACKSPACE,this.keycodes.DELETE],d=[this.keycodes.UP,this.keycodes.DOWN,this.keycodes.LEFT,this.keycodes.RIGHT],e=-1!==c.indexOf(b),f=-1!==d.indexOf(b),g=(a.ctrlKey||a.metaKey)&&88===b,h=!a.ctrlKey&&!a.metaKey&&(b>=48&&b<=57||b>=65&&b<=90);if(this.selection.isAll()&&f&&(g||!a.ctrlKey&&!a.metaKey&&!a.altKey&&!a.shiftKey)){if(g)return this.editor.disableNonEditables(),void this.app.broadcast("empty");if(this._isArrowKey(b))return!0;if(e&&a.preventDefault(),this.element.isType("inline")){this.editor.getElement().html(""),this.editor.startFocus()}else this.insertion.set(this.opts.emptyHtml);if(e)return;this.app.broadcast("empty")}return this.opts.autoparse&&this.autoparser.format(a,b),h&&this.selection.hasNonEditable()?void a.preventDefault():b===this.keycodes.ENTER?$R.create("input.enter",this.app,a,b):a.metaKey&&219===b?(a.preventDefault(),void this.app.api("module.list.outdent")):b===this.keycodes.TAB||a.metaKey&&221===b?$R.create("input.tab",this.app,a,b):b===this.keycodes.SPACE?$R.create("input.space",this.app,a,b,this.lastShiftKey):this._isDeleteKey(b)?$R.create("input.delete",this.app,a,b):this._isArrowKey(b)?$R.create("input.arrow",this.app,a,b):void 0}}},onkeyup:function(a){if(this.opts.input){var b=a.which;this.lastShiftKey=a.shiftKey,this.app.broadcast("contextbar.close");if(!$R.create("input.shortcode",this.app,a,b).is()){if(b===this.keycodes.BACKSPACE){var c=this.editor.getElement(),d=this.utils.trimSpaces(c.html());if(d=d.replace(/<br\s?\/?>/g,""),""===(d=d.replace(/<div><\/div>/,"")))return a.preventDefault(),this.editor.setEmpty(),void this.editor.startFocus()}this.editor.isEmpty()&&this.app.broadcast("empty")}}},start:function(){this.opts.shortcutsAdd&&(this.opts.shortcuts=$R.extend({},!0,this.opts.shortcuts,this.opts.shortcutsAdd))},_selectAll:function(){var a,b=this.selection.getCurrent(),c=this.inspector.parse(b);return c.isComponentType("table")?(a=c.getTable(),void this.selection.setAll(a)):c.isComponentType("code")?(a=c.getComponentCodeElement(),void this.selection.setAll(a)):void this.selection.setAll()},_isArrowKey:function(a){return-1!==[this.keycodes.UP,this.keycodes.DOWN,this.keycodes.RIGHT,this.keycodes.LEFT].indexOf(a)},_isDeleteKey:function(a){return a===this.keycodes.BACKSPACE||a===this.keycodes.DELETE}}),$R.add("class","input.arrow",{init:function(a,b,c){this.app=a,this.opts=a.opts,this.utils=a.utils,this.caret=a.caret,this.offset=a.offset,this.marker=a.marker,this.editor=a.editor,this.keycodes=a.keycodes,this.component=a.component,this.inspector=a.inspector,this.selection=a.selection,this.key=c,this._init(b)},_init:function(a){if(!this._isRightLeftKey()||!this._isExitVariable(a)){if(this._isRightDownKey()){if(this._isExitOnDownRight(a))return;if(this._selectComponent(a,"End","next"))return}if(this._isLeftUpKey()){if(this._isExitOnUpLeft(a))return;if(this._selectComponent(a,"Start","prev"))return}this.key===this.keycodes.LEFT?this.utils.trimInvisibleChars("left"):this.key===this.keycodes.RIGHT&&this.utils.trimInvisibleChars("right")}},_isRightDownKey:function(){return-1!==[this.keycodes.DOWN,this.keycodes.RIGHT].indexOf(this.key)},_isLeftUpKey:function(){return-1!==[this.keycodes.UP,this.keycodes.LEFT].indexOf(this.key)},_isRightLeftKey:function(){return-1!==[this.keycodes.RIGHT,this.keycodes.LEFT].indexOf(this.key)},_isExitVariable:function(a){var b=this.selection.getCurrent(),c=this.inspector.parse(b),d=c.getComponent();if(c.isComponentType("variable")&&c.isComponentActive()){a.preventDefault();var e=this.key===this.keycodes.LEFT?"setBefore":"setAfter";return void this.caret[e](d)}},_isExitOnUpLeft:function(a){var b=this.selection.getCurrent(),c=this.selection.getBlock(b),d=this.inspector.parse(b),e=c.previousElementSibling,f=this.caret.isStart(c);if(f&&e&&"TABLE"===e.tagName)return a.preventDefault(),this.caret.setEnd(e),!0;if(d.isFigcaption()){c=d.getFigcaption(),f=this.caret.isStart(c);var g=$R.dom(c).closest(".redactor-component");if(f&&0!==g.length)return a.preventDefault(),this.caret.setEnd(g),!0}else{if(d.isTable()&&f)return a.preventDefault(),this.caret.setEnd(c.previousElementSibling),!0;if(!d.isComponentEditable()&&d.isComponent()&&!d.isComponentType("variable")){var h=d.getComponent();if(!h.previousElementSibling)return a.preventDefault(),this.component.clearActive(),this._exitPrevElement(a,d.getComponent());if(h.previousElementSibling)return a.preventDefault(),this.component.clearActive(),this.caret.setEnd(h.previousElementSibling),!0}}},_isExitOnDownRight:function(a){var b,c,d=this.editor.getElement(),e=this.selection.getCurrent(),f=this.inspector.parse(e),g=this.caret.isEnd();if(f.isTable()){if(b=f.getTable(),(c=this.caret.isEnd(b))||g)return this._exitNextElement(a,f.getComponent())}else if(f.isFigcaption()){if(b=f.getFigcaption(),(c=this.caret.isEnd(b))||g)return this._exitNextElement(a,f.getComponent())}else if(f.isComponentType("code")){var h=f.getComponent(),i=$R.dom(f.getComponentCodeElement()).closest("pre");c=this.caret.isEnd(b);var j=i&&i.get().nextElementSibling;if(c&&!j)return this._exitNextElement(a,h)}else if(f.isPre()||f.isBlockquote()||f.isDl()){if(g){if(f.isPre())return this._exitNextElement(a,f.getPre());if(f.isBlockquote())return this._exitNextElement(a,f.getBlockquote());if(f.isDl())return this._exitNextElement(a,f.getDl())}}else if(f.isList()){var k=$R.dom(e).parents("ul, ol",d).last();if((c=this.caret.isEnd(k))||g)return this._exitNextElement(a,k.get())}else if(f.isComponent()&&!f.isComponentType("variable")&&"span"!==f.getTag())return this.component.clearActive(),this._exitNextElement(a,f.getComponent())},_exitPrevElement:function(a,b){return a.preventDefault(),b.previousElementSibling?this.caret.setEnd(b.previousElementSibling):this.utils.createMarkupBefore(b),!0},_exitNextElement:function(a,b){return a.preventDefault(),b.nextElementSibling?this.caret.setStart(b.nextElementSibling):this.utils.createMarkup(b),!0},_selectComponent:function(a,b,c){var d=this.selection.getCurrent(),e=this.selection.getBlock(d),f=this.utils.findSiblings(d,c),g=this.utils.findSiblings(e,c);f&&this.caret["is"+b](d)?this._selectComponentItem(a,f,b):g&&this.caret["is"+b](e)&&this._selectComponentItem(a,g,b)},_selectComponentItem:function(a,b,c){if(this.component.isNonEditable(b))return a.preventDefault(),this.caret["set"+c](b),!0}}),$R.add("class","input.delete",{init:function(a,b,c){this.app=a,this.opts=a.opts,this.caret=a.caret,this.utils=a.utils,this.editor=a.editor,this.marker=a.marker,this.keycodes=a.keycodes,this.component=a.component,this.inspector=a.inspector,this.selection=a.selection,this.insertion=a.insertion,this.key=c,this._init(b)},_init:function(a){if(!this._removeActiveComponent(a)&&!this._removeAllSelectedTable(a)){if(this.key===this.keycodes.BACKSPACE){var b=this.editor.getElement();if(this.utils.trimSpaces(b.html())===this.opts.emptyHtml)return void a.preventDefault()}if(this._detectVariableOrNonEditable()||this.selection.hasNonEditable())return void a.preventDefault();if(this.selection.isAll())return a.preventDefault(),void this.insertion.set(this.opts.emptyHtml);this.selection.isCollapsed()&&(this.key===this.keycodes.BACKSPACE?this._traverseBackspace(a):this.key===this.keycodes.DELETE&&this._traverseDelete(a)),this.key===this.keycodes.BACKSPACE&&this.utils.trimInvisibleChars("left"),this._removeUnwantedStyles(),this._removeEmptySpans(),this._removeSpanTagsInHeadings(),this._removeInlineTagsInPre()}},_detectVariableOrNonEditable:function(){var a,b=this.selection.getBlock(),c=this.caret.isStart(b),d=this.caret.isEnd(b);if(this.key===this.keycodes.BACKSPACE&&c){if(a=b.previousSibling,this._isNonEditable(a))return!0}else if(this.key===this.keycodes.DELETE&&d&&(a=b.nextSibling,this._isNonEditable(a)))return!0;var e=this.selection.getCurrent(),f=this.caret.isStart(e),g=this.caret.isEnd(e),h=""===this.selection.getTextBeforeCaret().trim(),i=""===this.selection.getTextAfterCaret().trim();if(this.key===this.keycodes.BACKSPACE&&f&&!h){if(a=e.previousSibling,this._isVariable(a))return this.caret.setEnd(a),!0;if(this._isNonEditable(a))return!0}else if(this.key===this.keycodes.DELETE&&g&&!i){if(a=e.nextSibling,this._isVariable(a))return this.caret.setStart(a),!0;if(this._isNonEditable(a))return!0}},_isVariable:function(a){return 0!==$R.dom(a).closest('[data-redactor-type="variable"]').length},_isNonEditable:function(a){return 0!==$R.dom(a).closest(".non-editable").length},_getBlock:function(){var a=this.editor.getElement(),b=this.selection.getBlock(),c=this.inspector.parse(b);return b=c.isList()?$R.dom(b).parents("ul, ol",a).last().get():b,b=c.isDl()?c.getDl():b,b=c.isTable()?c.getTable():b},_traverseDelete:function(a){var b,c,d,e=this.selection.getCurrent(),f=this.inspector.parse(e);if(f.isFigcaption()){if(b=f.getFigcaption(),c=this.caret.isEnd(b))return void a.preventDefault()}else if(f.isComponentType("code")&&(b=f.getComponent(),c=this.caret.isEnd(b)))return void a.preventDefault();b=this._getBlock();var g=this.utils.findSiblings(b,"next");if(g){c=this.caret.isEnd(b);var h=this.inspector.parse(g),i="P"===g.tagName||"DIV"===g.tagName;if(c&&h.isComponentEditable())return a.preventDefault(),void this.component.remove(g,!1);if(c&&h.isComponent())return a.preventDefault(),this.caret.setStart(g),void(this.utils.isEmptyHtml(b.innerHTML)&&$R.dom(b).remove());if(c&&h.isList()){var j=$R.dom(b);if(d=$R.dom(g),f.isList())return a.preventDefault(),j.append(d),void d.unwrap();var k=d.children("li").first(),l=k.find("ul, ol");if(0!==l.length)return a.preventDefault(),d.prepend(l),l.unwrap(),j.append(k),void k.unwrap()}else if(c&&!f.isList()&&!f.isTable()&&i&&!this.utils.isEmptyHtml(b.innerHTML)){a.preventDefault();var m=$R.dom(b);return d=$R.dom(g),m.append(d),void d.unwrap()}}},_traverseBackspace:function(a){var b,c,d,e,f=this.selection.getCurrent(),g=this.inspector.parse(f);if(g.isFigcaption()){if(b=g.getFigcaption(),c=this.caret.isStart(b))return void a.preventDefault()}else if(g.isComponentType("code")&&(b=g.getComponent(),(c=this.caret.isStart(b))&&b.previousElementSibling))return a.preventDefault(),this.caret.setEnd(b.previousElementSibling),!0;b=this._getBlock();var h=this.utils.findSiblings(b,"prev");if(!h)return void setTimeout(this._replaceBlock.bind(this),1);c=this.caret.isStart(b);var i=this.inspector.parse(h),j="P"===h.tagName||"DIV"===h.tagName;if(c&&i.isComponentEditable())return a.preventDefault(),void this.component.remove(h,!1);if(c&&i.isComponent())return a.preventDefault(),this.caret.setStart(h),void(this.utils.isEmptyHtml(b.innerHTML)&&$R.dom(b).remove());if(c&&g.isList())if(a.preventDefault(),e=$R.dom(b),d=$R.dom(h),i.isList())e.children("li").first().prepend(this.marker.build("start")),d.append(e),e.unwrap(),this.selection.restoreMarkers();else{var k=e.children("li").first(),l=k.get(),m=k.find("ul, ol"),n=this.utils.replaceToTag(l,this.opts.markup);this.opts.breakline&&n.attr("data-redactor-tag","br"),e.before(n),this.caret.setStart(n),0!==m.length&&(e.prepend(m),m.unwrap())}else if(c&&j){if(a.preventDefault(),this.utils.isEmpty(h))return d=$R.dom(h),void d.remove();var o=this.utils.createInvisibleChar(),p=$R.dom(b);return d=$R.dom(h),this.caret.setEnd(d),p.prepend(o),d.append(p.contents()),void p.remove()}},_replaceBlock:function(){var a=this.selection.getBlock(),b=$R.dom(a);if("p"===this.opts.markup&&a&&this._isNeedToReplaceBlock(a)){var c=document.createElement(this.opts.markup);b.replaceWith(c),this.caret.setStart(c)}this.opts.breakline&&a&&"DIV"===a.tagName&&b.attr("data-redactor-tag","br")},_isNeedToReplaceBlock:function(a){return"DIV"===a.tagName&&this.utils.isEmptyHtml(a.innerHTML)},_removeActiveComponent:function(a){var b=this.selection.getCurrent(),c=this.inspector.parse(b),d=c.getComponent();if(c.isComponent()&&this.component.isActive(d))return a.preventDefault(),this.component.remove(d),!0},_removeAllSelectedTable:function(a){var b=this.selection.getCurrent(),c=this.inspector.parse(b),d=c.getTable();if(d&&this.selection.isAll(d))return a.preventDefault(),this.component.remove(d),!0},_removeUnwantedStyles:function(){var a=this.editor.getElement();setTimeout(function(){a.find("*[style]").not("img, figure, iframe, [data-redactor-style-cache], [data-redactor-span]").removeAttr("style")},0)},_removeEmptySpans:function(){var a=this.editor.getElement();setTimeout(function(){a.find("span").each(function(a){0===a.attributes.length&&$R.dom(a).replaceWith(a.childNodes)})},0)},_removeSpanTagsInHeadings:function(){var a=this.editor.getElement();setTimeout(function(){a.find("h1, h2, h3, h4, h5, h6").each(function(a){var b=$R.dom(a);0===b.closest("figure").length&&b.find("span").not(".redactor-component, .non-editable, .redactor-selection-marker, [data-redactor-style-cache], [data-redactor-span]").unwrap()})},1)},_removeInlineTagsInPre:function(){var a=this.editor.getElement(),b=this.opts.inlineTags;setTimeout(function(){a.find("pre").each(function(a){var c=$R.dom(a);0===c.closest("figure").length&&c.find(b.join(",")).not("code, .redactor-selection-marker").unwrap()})},1)}}),$R.add("class","input.enter",{init:function(a,b){this.app=a,this.opts=a.opts,this.utils=a.utils,this.caret=a.caret,this.editor=a.editor,this.insertion=a.insertion,this.selection=a.selection,this.inspector=a.inspector,this._init(b)},_init:function(a){return this.opts.enterKey?!1===this.app.broadcast("enter",a)?a.preventDefault():this.selection.hasNonEditable()?void a.preventDefault():a.ctrlKey||a.shiftKey?this._insertBreak(a):void(this._isExit(a)||this._traverse(a)):this._disable(a)},_disable:function(a){a.preventDefault();var b=this.selection.getRange();b&&!b.collapsed&&b.deleteContents()},_insertBreak:function(a){a.preventDefault();var b=this.selection.getCurrent(),c=this.inspector.parse(b);c.isComponent()&&!c.isComponentEditable()||c.isCode()||(c.isPre()?this.insertion.insertNewline():this.insertion.insertBreakLine())},_isExit:function(a){var b=this.editor.getElement(),c=this.selection.getBlock(),d=this.inspector.parse(c),e=this.caret.isEnd(c),f=this.selection.getCurrent(),g=f.previousSibling;if(d.isBlockquote()){var h=e&&this._isExitableBlock(c,"P"),i=e&&this._isExitableDblBreak(g);if(h||i)return this._exitFromElement(a,i?g:c,d.getBlockquote())}else if(!d.isComponentType("code")&&d.isPre()){if(e){var j=c.innerHTML;if(j=this.utils.removeInvisibleChars(j),null!==j.match(/(\n\n\n)$/))return $R.dom(g.previousSibling.previousSibling).remove(),this._exitFromElement(a,g,c)}}else if(d.isDl()){if(e&&this._isExitableBlock(c,"DT"))return this._exitFromElement(a,c,d.getDl())}else if(d.isList()){var k=$R.dom(f).parents("ul, ol",b).last();if((e=this.caret.isEnd(k))&&this._isExitableBlock(c,"LI"))return this._exitFromElement(a,c,k)}else if(d.isComponent()&&d.isComponentActive()&&!d.isFigcaption()&&!d.isComponentEditable())return this._exitFromElement(a,!1,d.getComponent())},_isExitableDblBreak:function(a){var b=!!a&&a.nextSibling;if(b){var c=this.utils.removeInvisibleChars(b.textContent);return 3===b.nodeType&&""===c.trim()}},_isExitableBlock:function(a,b){return a&&a.tagName===b&&this.utils.isEmptyHtml(a.innerHTML)},_exitFromElement:function(a,b,c){return a.preventDefault(),b&&$R.dom(b).remove(),this.utils.createMarkup(c),!0},_exitNextElement:function(a,b){return a.preventDefault(),b.nextSibling?this.caret.setStart(b.nextSibling):this.utils.createMarkup(b),!0},_traverse:function(a){var b=this.selection.getCurrent(),c=this.selection.isText(),d=this.selection.getBlock(),e=this.inspector.parse(b),f=!!d&&d.tagName.toLowerCase(),g=$R.dom(b).closest("[data-redactor-type=variable]");if(0!==g.length&&this.caret.setAfter(g),e.isPre())return a.preventDefault(),this.insertion.insertNewline();if(!e.isBlockquote()){if(e.isFigcaption()){d=e.getFigcaption();var h=this.caret.isEnd(d),i=this.caret.isEnd();return h||i?this._exitNextElement(a,e.getComponent()):void a.preventDefault()}return e.isDl()?(a.preventDefault(),this._traverseDl(b)):this.opts.breakline&&"div"===f?void setTimeout(this._replaceBlock.bind(this),1):c?(a.preventDefault(),this.insertion.insertBreakLine()):void setTimeout(this._replaceBlock.bind(this),1)}return(d=this.selection.getBlock(b))&&"BLOCKQUOTE"===d.tagName?(a.preventDefault(),this.insertion.insertBreakLine()):void 0},_traverseDl:function(a){var b=this.selection.getBlock(a),c=this.inspector.parse(b),d=c.getTag(),e=$R.dom(b),f=e.get().nextSibling||!1,g=$R.dom(f),h=f&&g.is("dd"),i=f&&g.is("dt"),j=this.caret.isEnd(b);if("dt"===d&&!h&&j){var k=document.createElement("dd");return e.after(k),void this.caret.setStart(k)}if("dd"===d&&!i&&j){var l=document.createElement("dt");return e.after(l),void this.caret.setStart(l)}return this.insertion.insertBreakLine()},_replaceBlock:function(){var a=this.selection.getBlock(),b=$R.dom(a);if("p"===this.opts.markup&&a&&this._isNeedToReplaceBlock(a)){var c=document.createElement(this.opts.markup);b.replaceWith(c),this.caret.setStart(c)}else if(a)if(this.utils.isEmptyHtml(a.innerHTML))this._clearBlock(b,a);else{var d=this.utils.getFirstNode(a);d&&"BR"===d.tagName&&($R.dom(d).remove(),this.caret.setStart(a))}a&&this._isNeedToCleanBlockStyle(a)&&this.opts.cleanOnEnter&&b.removeAttr("class style"),this.opts.breakline&&a&&"DIV"===a.tagName&&b.attr("data-redactor-tag","br")},_clearBlock:function(a,b){(this.opts.cleanInlineOnEnter||"<br>"===b.innerHTML)&&a.html(""),this.caret.setStart(b)},_isNeedToReplaceBlock:function(a){return"DIV"===a.tagName&&this.utils.isEmptyHtml(a.innerHTML)},_isNeedToCleanBlockStyle:function(a){return"P"===a.tagName&&this.utils.isEmptyHtml(a.innerHTML)}}),$R.add("class","input.paste",{init:function(a,b,c,d,e){this.app=a,this.opts=a.opts,this.editor=a.editor,this.cleaner=a.cleaner,this.container=a.container,this.inspector=a.inspector,this.insertion=a.insertion,this.selection=a.selection,this.autoparser=a.autoparser,this.pasteHtml=d,this.pointInserted=e,this.dataTransfer=c,this._init(b)},_init:function(a){var b=this.dataTransfer||a.clipboardData,c=this.selection.getCurrent(),d=this.inspector.parse(c);if(this.dropPasted=this.dataTransfer,this.isRawCode=d.isPre()||d.isCode(),this.editor.enablePasting(),this.editor.saveScroll(),this.dropPasted||this.selection.saveMarkers(),this.isRawCode||!b){var e;return e=this.isRawCode||b||!window.clipboardData?b.getData("text/plain"):window.clipboardData.getData("text"),a.preventDefault(),void this._insert(a,e)}if(this.pasteHtml)a.preventDefault(),this._insert(a,this.pasteHtml);else{var f=b.getData("URL"),g=this._isPlainText(b)?b.getData("text/plain"):b.getData("text/html");if(g=f&&""!==f?f:g,null!==b.files&&b.files.length>0&&""===g){for(var h=[],i=0;i<b.files.length;i++){var j=b.files[i]||b.items[i].getAsFile();j&&h.push(j)}if(h.length>0)return a.preventDefault(),void this._insertFiles(a,h)}a.preventDefault(),this._insert(a,g)}},_isPlainText:function(a){var b=a.getData("text/plain"),c=a.getData("text/html");if(!b||!c)return null!==b;var d=document.createElement("div");return d.innerHTML=c,d.textContent===b?!d.querySelector(":not(meta)"):void 0},_restoreSelection:function(){this.editor.restoreScroll(),this.editor.disablePasting(),this.dropPasted||this.selection.restoreMarkers()},_insert:function(a,b){var c=this.app.broadcast("pasteBefore",b);if(b=void 0===c?b:c,b=b.trim(),b=this.isRawCode?b:this.cleaner.paste(b),b=b.trim(),b=this.isRawCode?this.cleaner.encodePhpCode(b):b,c=this.app.broadcast("pasting",b),b=void 0===c?b:c,this._restoreSelection(),this.opts.input){var d=[];if(this.isRawCode){var e=document.createTextNode(b);d=this.insertion.insertNode(e,"after"),this.app.broadcast("pasted",d)}else this.opts.autoparse&&this.opts.autoparsePaste&&(b=this.autoparser.parse(b)),d=this.dropPasted?this.insertion.insertToPoint(a,b,this.pointInserted):this.insertion.insertHtml(b),this.app.broadcast("pasted",d),this.app.broadcast("autoparseobserve")}},_insertFiles:function(a,b){this._restoreSelection()
;var c=-1!==this.opts.imageTypes.indexOf(b[0].type),d=void 0===this.dropPasted;c?this.app.broadcast("dropimage",a,b,d):this.app.broadcast("dropfile",a,b,d)}}),$R.add("class","input.shortcode",{init:function(a,b,c){this.app=a,this.opts=a.opts,this.utils=a.utils,this.marker=a.marker,this.keycodes=a.keycodes,this.selection=a.selection,this.worked=!1,c===this.keycodes.SPACE&&this._init()},is:function(){return this.worked},_init:function(){var a=this.selection.getCurrent();if(a&&3===a.nodeType){var b=this.utils.removeInvisibleChars(a.textContent),c=this.opts.shortcodes;for(var d in c){var e=new RegExp("^"+this.utils.escapeRegExp(d));if(null!==b.match(e)&&void 0!==c[d].format)return this._format(c[d].format,a,e)}}},_format:function(a,b,c){b=this.marker.insert("start").previousSibling;var d=b.textContent;d=this.utils.trimSpaces(d),d=d.replace(c,""),b.textContent=d;var e="ul"===a||"ol"===a?"module.list.toggle":"module.block.format";this.app.api(e,a),this.selection.restoreMarkers(),this.worked=!0}}),$R.add("class","input.shortcut",{init:function(a,b){this.app=a,this.opts=a.opts,this.worked=!1,this.hotkeys={8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},this.hotkeysShiftNums={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},this._init(b)},is:function(){return this.worked},_init:function(a){if(!1===this.opts.shortcuts)return void(!a.ctrlKey&&!a.metaKey||66!==a.which&&73!==a.which||a.preventDefault());for(var b in this.opts.shortcuts)this._build(a,b,this.opts.shortcuts[b])},_build:function(a,b,c){for(var d=b.split(","),e=d.length,f=0;f<e;f++)"string"==typeof d[f]&&this._handler(a,d[f].trim(),c)},_handler:function(a,b,c){b=b.toLowerCase().split(" ");for(var d=this.hotkeys[a.keyCode],e=String.fromCharCode(a.which).toLowerCase(),f="",g={},h=["meta","ctrl","alt","shift"],i=0;i<h.length;i++){var j=h[i];a[j+"Key"]&&d!==j&&(f+=j+"+")}d&&(g[f+d]=!0),e&&(g[f+e]=!0,g[f+this.hotkeysShiftNums[e]]=!0,"shift+"===f&&(g[this.hotkeysShiftNums[e]]=!0));for(var k=b.length,i=0;i<k;i++)if(g[b[i]])return a.preventDefault(),this.worked=!0,void(c.message?(this.app.broadcast(c.message,c.args),this.app.broadcast("buffer.trigger")):c.api&&(this.app.api(c.api,c.args),this.app.broadcast("buffer.trigger")))}}),$R.add("class","input.space",{init:function(a,b,c,d){this.app=a,this.keycodes=a.keycodes,this.insertion=a.insertion,this.selection=a.selection,this.key=c,this.lastShiftKey=d,this._init(b)},_init:function(a){return this.selection.hasNonEditable()?void a.preventDefault():this.lastShiftKey||this.key!==this.keycodes.SPACE||!a.ctrlKey&&!a.shiftKey||a.metaKey?void 0:(a.preventDefault(),void this.insertion.insertChar("&nbsp;"))}}),$R.add("class","input.tab",{init:function(a,b){this.app=a,this.opts=a.opts,this.inspector=a.inspector,this.insertion=a.insertion,this.selection=a.selection,this._init(b)},_init:function(a){if(this.opts.tabKey){if(!1===this.app.broadcast("tab",a))return a.preventDefault();this._traverse(a)}},_traverse:function(a){var b=this.selection.getCurrent(),c=this.inspector.parse(b);return!c.isComponent()&&a.shiftKey?this._insertHardTab(a,4):c.isList()?(a.preventDefault(),this.app.api("module.list.indent")):c.isPre()||c.isComponentType("code")&&!c.isFigcaption()?this._tabCode(a):!1!==this.opts.tabAsSpaces?this._insertHardTab(a,this.opts.tabAsSpaces):void 0},_insertHardTab:function(a,b){a.preventDefault();var c=document.createTextNode(Array(b+1).join(" "));return this.insertion.insertNode(c,"end")},_tabCode:function(a){a.preventDefault();var b=this.opts.preSpaces?document.createTextNode(Array(this.opts.preSpaces+1).join(" ")):document.createTextNode("\t");return this.insertion.insertNode(b,"end")}}),$R.add("module","upload",{init:function(a){this.app=a,this.opts=a.opts,this.lang=a.lang,this.utils=a.utils,this.editor=a.editor,this.progress=a.progress,this.defaults={event:!1,element:!1,name:!1,files:!1,url:!1,data:!1,paramName:!1}},build:function(a){this.p=$R.extend(this.defaults,a),this.$el=$R.dom(this.p.element),"INPUT"===this.$el.get().tagName?this._buildInput():this._buildBox()},send:function(a){this.p=$R.extend(this.defaults,a),this.$uploadbox=this.editor.getElement(),this._send(this.p.event,this.p.files)},complete:function(a,b){this._complete(a,b)},_buildInput:function(){this.box=!1,this.prefix="",this.$uploadbox=$R.dom('<div class="upload-redactor-box" />'),this.$el.hide(),this.$el.after(this.$uploadbox),this.opts.multipleUpload?this.$el.attr("multiple","multiple"):this.$el.removeAttr("multiple"),"file"!==this.p.name&&this.$el.attr("accept","image/*"),this._buildPlaceholder(),this._buildEvents()},_buildBox:function(){this.box=!0,this.prefix="box-",this.$uploadbox=this.$el,this.$uploadbox.attr("ondragstart","return false;"),this.$uploadbox.on("drop.redactor.upload",this._onDropBox.bind(this)),this.$uploadbox.on("dragover.redactor.upload",this._onDragOver.bind(this)),this.$uploadbox.on("dragleave.redactor.upload",this._onDragLeave.bind(this))},_buildPlaceholder:function(){this.$placeholder=$R.dom('<div class="upload-redactor-placeholder" />'),this.$placeholder.html(this.lang.get("upload-label")),this.$uploadbox.append(this.$placeholder)},_buildEvents:function(){this.$el.on("change.redactor.upload",this._onChange.bind(this)),this.$uploadbox.on("click.redactor.upload",this._onClick.bind(this)),this.$uploadbox.on("drop.redactor.upload",this._onDrop.bind(this)),this.$uploadbox.on("dragover.redactor.upload",this._onDragOver.bind(this)),this.$uploadbox.on("dragleave.redactor.upload",this._onDragLeave.bind(this))},_onClick:function(a){a.preventDefault(),this.$el.click()},_onChange:function(a){this._send(a,this.$el.get().files)},_onDrop:function(a){a.preventDefault(),this._clear(),this._setStatusDrop(),this._send(a)},_onDragOver:function(a){return a.preventDefault(),this._setStatusHover(),!1},_onDragLeave:function(a){return a.preventDefault(),this._removeStatusHover(),!1},_onDropBox:function(a){a.preventDefault(),this._clear(),this._setStatusDrop(),this._send(a)},_removeStatusHover:function(){this.$uploadbox.removeClass("upload-redactor-"+this.prefix+"hover")},_setStatusDrop:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"drop")},_setStatusHover:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"hover")},_setStatusError:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"error")},_setStatusSuccess:function(){this.$uploadbox.addClass("upload-redactor-"+this.prefix+"success")},_clear:function(){for(var a=["drop","hover","error","success"],b=0;b<a.length;b++)this.$uploadbox.removeClass("upload-redactor-"+this.prefix+a[b]);this.$uploadbox.removeAttr("ondragstart")},_send:function(a,b){a=a.originalEvent||a,b=b||a.dataTransfer.files;var c=new FormData,d=this._getUploadParam();c=this._buildData(d,b,c),c=this.utils.extendData(c,this.p.data),!1!==this.app.broadcast("upload.start",a,c,b)&&this._sendData(c,b,a)},_sendData:function(a,b,c){if(this.progress.show(),"function"==typeof this.p.url){var d=this.p.url(a,b,c,this);d instanceof Promise||this._complete(d,c)}else $R.ajax.post({url:this.p.url,data:a,before:function(a){return this.app.broadcast("upload.beforeSend",a)}.bind(this),success:function(a){this._complete(a,c)}.bind(this)})},_getUploadParam:function(){return this.p.paramName?this.p.paramName:"file"},_buildData:function(a,b,c){if(1===b.length)c.append(a+"[]",b[0]);else if(b.length>1&&!1!==this.opts.multipleUpload)for(var d=0;d<b.length;d++)c.append(a+"[]",b[d]);return c},_complete:function(a,b){this._clear(),this.progress.hide(),a&&a.error?(this._setStatusError(),this.app.broadcast("upload."+this.p.name+".error",a,b),this.app.broadcast("upload.error",a)):(this._setStatusSuccess(),this.app.broadcast("upload."+this.p.name+".complete",a,b),this.app.broadcast("upload.complete",a),setTimeout(this._clear.bind(this),500))}}),$R.add("class","code.component",{mixins:["dom","component"],init:function(a,b){return this.app=a,b&&void 0!==b.cmnt?b:this._init(b)},_init:function(a){var b;if(void 0!==a){var c=$R.dom(a),d=c.closest("figure");0!==d.length?this.parse(d):(this.parse("<figure>"),this.append(a)),b=this.find("pre code, pre").last()}else b=$R.dom("<pre>"),this.parse("<figure>"),this.append(b);this._initElement(b),this._initWrapper()},_initElement:function(a){a.attr({tabindex:"-1",contenteditable:!0})},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"code",tabindex:"-1",contenteditable:!1})}}),$R.add("module","form",{init:function(a){this.app=a,this.lang=a.lang,this.component=a.component,this.inspector=a.inspector},onform:{remove:function(a){this._remove(a)}},oncontextbar:function(a,b){var c=this.inspector.parse(a.target);if(c.isComponentType("form")){var d=c.getComponent(),e={remove:{title:this.lang.get("delete"),api:"module.form.remove",args:d}};b.set(a,d,e,"top")}},_remove:function(a){this.component.remove(a)}}),$R.add("class","form.component",{mixins:["dom","component"],init:function(a,b){return this.app=a,this.utils=a.utils,b&&void 0!==b.cmnt?b:this._init(b)},_init:function(a){if(void 0!==a){if(0!==$R.dom(a).closest("form").length){var b=this.utils.replaceToTag(a,"figure");this.parse(b)}else this.parse("<figure>"),this.append(a)}else this.parse("<figure>");this._initWrapper()},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"form",tabindex:"-1",contenteditable:!1})}}),$R.add("module","image",{modals:{image:'<div class="redactor-modal-tab redactor-modal-tab-upload" data-title="## upload ##"><form action="">                 <input type="file" name="file">             </form></div>',imageedit:'<div class="redactor-modal-group">                 <div id="redactor-modal-image-preview" class="redactor-modal-side"></div>                 <form action="" class="redactor-modal-area">                     <div class="form-item">                         <label for="modal-image-title"> ## title ##</label>                         <input type="text" id="modal-image-title" name="title" />                     </div>                     <div class="form-item form-item-caption">                         <label for="modal-image-caption">## caption ##</label>                         <input type="text" id="modal-image-caption" name="caption" aria-label="## caption ##" />                     </div>                     <div class="form-item form-item-align">                         <label>## image-position ##</label>                         <select name="align" aria-label="## image-position ##">                             <option value="none">## none ##</option>                             <option value="left">## left ##</option>                             <option value="center">## center ##</option>                             <option value="right">## right ##</option>                         </select>                     </div>                     <div class="form-item form-item-link">                         <label for="modal-image-url">## link ##</label>                         <input type="text" id="modal-image-url" name="url" aria-label="## link ##" />                     </div>                     <div class="form-item form-item-link">                         <label class="checkbox"><input type="checkbox" name="target" aria-label="## link-in-new-tab ##"> ## link-in-new-tab ##</label>                     </div>                 </form>             </div>'},init:function(a){this.app=a,this.opts=a.opts,this.lang=a.lang,this.caret=a.caret,this.utils=a.utils,this.editor=a.editor,this.storage=a.storage,this.component=a.component,this.inspector=a.inspector,this.insertion=a.insertion,this.selection=a.selection,this.justResized=!1},oninsert:function(){this._observeImages()},onstarted:function(){this.storage.observeImages(),this.opts.imageResizable&&(this.resizer=$R.create("image.resize",this.app)),this._observeImages()},ondropimage:function(a,b,c){if(this.opts.imageUpload){var d={url:this.opts.imageUpload,event:!c&&a,files:b,name:"imagedrop",data:this.opts.imageData,paramName:this.opts.imageUploadParam};this.app.api("module.upload.send",d)}},onstop:function(){this.resizer&&this.resizer.stop()},onbottomclick:function(){this.insertion.insertToEnd(this.editor.getLastNode(),"image")},onimageresizer:{stop:function(){this.resizer&&this.resizer.hide()}},onsource:{open:function(){this.resizer&&this.resizer.hide()},closed:function(){this._observeImages(),this.resizer&&this.resizer.rebuild()}},onupload:{complete:function(){this._observeImages()},image:{complete:function(a){this._insert(a)},error:function(a){this._uploadError(a)}},imageedit:{complete:function(a){this._change(a)},error:function(a){this._uploadError(a)}},imagedrop:{complete:function(a,b){this._insert(a,b)},error:function(a){this._uploadError(a)}},imagereplace:{complete:function(a){this._change(a,!1)},error:function(a){this._uploadError(a)}}},onmodal:{image:{open:function(a,b){this._setUpload(a,b)}},imageedit:{open:function(a,b){this._setFormData(a,b)},opened:function(a,b){this._setFormFocus(b)},remove:function(){this._remove(this.$image)},save:function(a,b){this._save(a,b)}}},onimage:{observe:function(){this._observeImages()},resized:function(){this.justResized=!0}},oncontextbar:function(a,b){if(this.justResized)return void(this.justResized=!1);var c=this.selection.getCurrent(),d=this.inspector.parse(c),e=$R.dom(c).closest("img");if(!d.isFigcaption()&&d.isComponentType("image")||0!==e.length){var f=0!==e.length?e.get():d.getComponent(),g={edit:{title:this.lang.get("edit"),api:"module.image.open"},remove:{title:this.lang.get("delete"),api:"module.image.remove",args:f}};b.set(a,f,g)}},open:function(){this.$image=this._getCurrent(),this.app.api("module.modal.build",this._getModalData())},insert:function(a){this._insert(a)},remove:function(a){this._remove(a)},_getModalData:function(){return this._isImage()&&this.opts.imageEditable?{name:"imageedit",width:"800px",title:this.lang.get("edit"),handle:"save",commands:{save:{title:this.lang.get("save")},remove:{title:this.lang.get("delete"),type:"danger"},cancel:{title:this.lang.get("cancel")}}}:{name:"image",title:this.lang.get("image")}},_isImage:function(){return this.$image},_getCurrent:function(){var a=this.selection.getCurrent(),b=this.inspector.parse(a),c=$R.dom(a).closest("img");return 0!==c.length?this.component.create("image",c):!(!b.isComponentType("image")||!b.isComponentActive())&&this.component.create("image",b.getComponent())},_insert:function(a,b){if(this.app.api("module.modal.close"),Array.isArray(a)){for(var c={},d=0;d<a.length;d++)c=$R.extend(c,a[d]);a=c}else"string"==typeof a&&(a={file:{url:a}});if("object"==typeof a){var e=0;for(var f in a)"object"==typeof a[f]&&e++;e>1?this._insertMultiple(a,b):this._insertSingle(a,b)}},_insertSingle:function(a,b){for(var c in a)if("object"==typeof a[c]){var d=this._createImageAndStore(a[c]),e=b?this.insertion.insertToPoint(b,d,!1,!1):this.insertion.insertHtml(d,!1);this._removeSpaceBeforeFigure(e[0]),this.component.setActive(e[0]),this.app.broadcast("image.uploaded",e[0],a)}},_insertMultiple:function(a,b){var c,d=0,e=[];for(var f in a)if("object"==typeof a[f]){d++;var g=this._createImageAndStore(a[f]);if(1===d)e=b?this.insertion.insertToPoint(b,g,!1,!1):this.insertion.insertHtml(g,!1);else{var h=$R.dom(e[0]);h.after(g),e=[g.get()],this.app.broadcast("image.inserted",g)}c=e[0],this._removeSpaceBeforeFigure(e[0]),this.app.broadcast("image.uploaded",e[0],a)}this.component.setActive(c)},_createImageAndStore:function(a){var b=this.component.create("image");return b.addClass("redactor-uploaded-figure"),b.setData({src:a.url,id:a.id?a.id:this.utils.getRandomId()}),this.storage.add("image",b.getElement()),b},_removeSpaceBeforeFigure:function(a){if(a){var b=a.previousSibling,c=a.nextSibling,d=$R.dom(b),e=$R.dom(c);this.opts.breakline&&(c&&"br"===e.attr("data-redactor-tag")&&e.find("br").first().remove(),b&&"br"===d.attr("data-redactor-tag")&&d.find("br").last().remove()),b&&(this._removeInvisibleSpace(b),this._removeInvisibleSpace(b.previousSibling))}},_removeInvisibleSpace:function(a){a&&3===a.nodeType&&-1!==this.utils.searchInvisibleChars(a.textContent)&&a.parentNode.removeChild(a)},_save:function(a,b){var c=b.getData(),d={title:c.title};this.opts.imageLink&&(d.link={url:c.url,target:c.target}),this.opts.imageCaption&&(d.caption=c.caption),this.opts.imagePosition&&(d.align=c.align),this.$image.setData(d),this.resizer&&this.resizer.rebuild(),this.app.broadcast("image.changed",this.$image),this.app.api("module.modal.close")},_change:function(a,b){if("string"==typeof a&&(a={file:{url:a}}),"object"==typeof a){var c;for(var d in a)if("object"==typeof a[d]){c=$R.dom("<img>"),c.attr("src",a[d].url),this.$image.changeImage(a[d]),this.app.broadcast("image.changed",this.$image,a),this.app.broadcast("image.uploaded",this.$image,a),this.app.broadcast("hardsync");break}!1!==b&&c.on("load",function(){this.$previewBox.html(c)}.bind(this))}},_uploadError:function(a){this.app.broadcast("image.uploadError",a)},_remove:function(a){this.app.api("module.modal.close"),this.component.remove(a)},_observeImages:function(){var a=this.editor.getElement(),b=this;a.find("img").each(function(a){var c=$R.dom(a);c.off(".drop-to-replace"),c.on("dragover.drop-to-replace dragenter.drop-to-replace",function(a){a.preventDefault()}),c.on("drop.drop-to-replace",function(a){if(!b.app.isDragComponentInside())return b._setReplaceUpload(a,c)})})},_setFormData:function(a,b){this._buildPreview(a),this._buildPreviewUpload();var c=this.$image.getData(),d={title:c.title};this.opts.imageCaption?d.caption=c.caption:a.find(".form-item-caption").hide(),this.opts.imagePosition?d.align=c.align:a.find(".form-item-align").hide(),this.opts.imageLink?c.link&&(d.url=c.link.url,c.link.target&&(d.target=!0)):a.find(".form-item-link").hide(),b.setData(d)},_setFormFocus:function(a){a.getField("title").focus()},_setReplaceUpload:function(a,b){if(a=a.originalEvent||a,a.stopPropagation(),a.preventDefault(),this.opts.imageUpload){this.$image=this.component.create("image",b);var c={url:this.opts.imageUpload,files:a.dataTransfer.files,name:"imagereplace",data:this.opts.imageData,paramName:this.opts.imageUploadParam};this.app.api("module.upload.send",c)}},_setUpload:function(a,b){if(!this.opts.imageUpload){a.getBody().find(".redactor-modal-tab-upload").remove()}var c={url:this.opts.imageUpload,element:b.getField("file"),name:"image",data:this.opts.imageData,paramName:this.opts.imageUploadParam};this.app.api("module.upload.build",c)},_buildPreview:function(a){this.$preview=a.find("#redactor-modal-image-preview");var b=this.$image.getData(),c=$R.dom("<img>");c.attr("src",b.src),this.$previewBox=$R.dom("<div>"),this.$previewBox.append(c),this.$preview.html(""),this.$preview.append(this.$previewBox)},_buildPreviewUpload:function(){if(this.opts.imageUpload){var a=$R.dom('<div class="desc">');a.html(this.lang.get("upload-change-label")),this.$preview.append(a);var b={url:this.opts.imageUpload,element:this.$previewBox,name:"imageedit",data:this.opts.imageData,paramName:this.opts.imageUploadParam};this.app.api("module.upload.build",b)}}}),$R.add("class","image.component",{mixins:["dom","component"],init:function(a,b){return this.app=a,this.opts=a.opts,this.selection=a.selection,b&&void 0!==b.cmnt?b:this._init(b)},setData:function(a){for(var b in a)this._set(b,a[b])},getData:function(){for(var a=["src","title","caption","align","link","id"],b={},c=0;c<a.length;c++)b[a[c]]=this._get(a[c]);return b},getElement:function(){return this.$element},changeImage:function(a){this.$element.attr("src",a.url)},_init:function(a){var b=$R.dom(a),c=b.closest("figure");void 0===a?(this.$element=$R.dom("<img>"),this.parse("<figure>"),this.append(this.$element)):0===c.length?(this.parse("<figure>"),this.$element=b,this.$element.wrap(this)):(this.parse(c),this.$element=this.find("img")),this._initWrapper()},_set:function(a,b){this["_set_"+a](b)},_get:function(a){return this["_get_"+a]()},_set_src:function(a){this.$element.attr("src",a)},_set_id:function(a){this.opts.imageObserve&&this.$element.attr("data-image",a)},_set_title:function(a){a=a.trim().replace(/(<([^>]+)>)/gi,""),""===a?this.$element.removeAttr("alt"):this.$element.attr("alt",a)},_set_caption:function(a){var b=this.find("figcaption");return 0===b.length&&(b=$R.dom("<figcaption>"),b.attr("contenteditable","true"),this.append(b)),""===a?b.remove():b.html(a),b},_set_align:function(a){var b="",c="",d="",e=this,f=this.find("img"),g=this.find("figcaption");if("object"==typeof this.opts.imagePosition){var h=this.opts.imagePosition;for(var i in h)e.removeClass(h[i]);var j=void 0!==h[a]&&h[a];j&&e.addClass(j)}else{var k=f.width();switch(a){case"left":b="left",c="0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin+" 0";break;case"right":b="right",c="0 0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin;break;case"center":d="center"}e.css({float:b,width:k+"px",maxWidth:k+"px",margin:c,"text-align":d}),e.attr("rel",e.attr("style")),"none"===a&&(e.css("max-width",""),e.css("width","")),"center"===a?(e.css("max-width",""),e.css("width",""),g.css("text-align","center")):g.css("text-align","")}},_set_link:function(a){var b=this._findLink();return""===a.url?void(b&&b.unwrap()):(b||(b=$R.dom("<a>"),this.$element.wrap(b)),b.attr("href",a.url),a.target?b.attr("target",!0===a.target?"_blank":a.target):b.removeAttr("target"),b)},_get_src:function(){return this.$element.attr("src")},_get_id:function(){return this.$element.attr("data-image")},_get_title:function(){var a=this.$element.attr("alt");return a||""},_get_caption:function(){var a=this.find("figcaption");return 0===a.length?"":a.html()},_get_align:function(){var a="";if("object"==typeof this.opts.imagePosition){a="none";var b=this.opts.imagePosition;for(var c in b)if(this.hasClass(b[c])){a=c;break}}else a="center"===this.css("text-align")?"center":this.css("float");return a},_get_link:function(){var a=this._findLink();if(a){var b=!!a.attr("target");return{url:a.attr("href"),target:b}}},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"image",tabindex:"-1",contenteditable:!1})},_findLink:function(){var a=this.find("a").filter(function(a){return 0===$R.dom(a).closest("figcaption").length});return 0!==a.length&&a}}),$R.add("class","image.resize",{init:function(a){this.app=a,this.$doc=a.$doc,this.$win=a.$win,this.$body=a.$body,this.editor=a.editor,this.toolbar=a.toolbar,this.inspector=a.inspector,this.$target=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$body,this._init()},rebuild:function(){this._setResizerPosition()},hide:function(){this.$target.find("#redactor-image-resizer").remove()},stop:function(){this.editor.getElement().off(".redactor.image-resize"),this.$doc.off(".redactor.image-resize"),this.$win.off("resize.redactor.image-resize"),this.hide()},_init:function(){this.editor.getElement().on("click.redactor.image-resize",this._build.bind(this)),this.$win.on("resize.redactor.image-resize",this._setResizerPosition.bind(this))},_build:function(a){this.$target.find("#redactor-image-resizer").remove();var b=this.inspector.parse(a.target),c=this.editor.getElement();b.isComponentType("image")&&(this.$resizableBox=c,this.$resizableImage=$R.dom(b.getImageElement()),this.$resizer=$R.dom("<span>"),this.$resizer.attr("id","redactor-image-resizer"),this.$target.append(this.$resizer),this._setResizerPosition(),this.$resizer.on("mousedown touchstart",this._set.bind(this)))},_setResizerPosition:function(){if(this.$resizer){var a=this.toolbar.isTarget(),b=this.$target.offset(),c=a?7-b.top+this.$target.scrollTop():7,d=a?7-b.left:7,e=this.$resizableImage.offset(),f=this.$resizableImage.width(),g=this.$resizableImage.height(),h=this.$resizer.width(),i=this.$resizer.height();this.$resizer.css({top:Math.round(e.top+g-i+c)+"px",left:Math.round(e.left+f-h+d)+"px"})}},_set:function(a){a.preventDefault(),this.resizeHandle={x:a.pageX,y:a.pageY,el:this.$resizableImage,$figure:this.$resizableImage.closest("figure"),ratio:this.$resizableImage.width()/this.$resizableImage.height(),h:this.$resizableImage.height()},a=a.originalEvent||a,a.targetTouches&&(this.resizeHandle.x=a.targetTouches[0].pageX,this.resizeHandle.y=a.targetTouches[0].pageY),this.app.broadcast("contextbar.close"),this.app.broadcast("image.resize",this.$resizableImage),this._start()},_start:function(){this.$doc.on("mousemove.redactor.image-resize touchmove.redactor.image-resize",this._move.bind(this)),this.$doc.on("mouseup.redactor.image-resize touchend.redactor.image-resize",this._stop.bind(this))},_stop:function(){this.$doc.off(".redactor.image-resize"),this.app.broadcast("image.resized",this.$resizableImage)},_move:function(a){a.preventDefault(),a=a.originalEvent||a;var b=this.resizeHandle.h;a.targetTouches?b+=a.targetTouches[0].pageY-this.resizeHandle.y:b+=a.pageY-this.resizeHandle.y;var c=b*this.resizeHandle.ratio;c=Math.round(c),(b=Math.round(b))<20||c<100||this._getResizableBoxWidth()<=c||(0!==this.resizeHandle.$figure.length&&""!==this.resizeHandle.$figure.css("max-width")&&this.resizeHandle.$figure.css("max-width",c+"px"),this.resizeHandle.el.attr({width:c,height:b}),this.resizeHandle.el.width(c),this.resizeHandle.el.height(b),this._setResizerPosition())},_getResizableBoxWidth:function(){return this.$resizableBox.width()-parseInt(this.$resizableBox.css("padding-left"))-parseInt(this.$resizableBox.css("padding-right"))}}),$R.add("module","file",{modals:{file:'<div class="redactor-modal-tab" data-title="## upload ##"><form action="">                 <div class="form-item form-item-title">                     <label for="modal-file-title"> ## filename ## <span class="desc">(## optional ##)</span></label>                     <input type="text" id="modal-file-title" name="title" />                 </div>                 <input type="file" name="file">             </form></div>'},init:function(a){this.app=a,this.opts=a.opts,this.lang=a.lang,this.caret=a.caret,this.utils=a.utils,this.storage=a.storage,this.component=a.component,this.inspector=a.inspector,this.insertion=a.insertion,this.selection=a.selection},onstarted:function(){this.storage.observeFiles()},ondropfile:function(a,b,c){if(this.opts.fileUpload){var d={url:this.opts.fileUpload,event:!c&&a,files:b,name:"filedrop",data:this.opts.fileData};this.app.api("module.upload.send",d)}},onmodal:{file:{open:function(a,b){this._setFormData(a,b),this._setUpload(b)},opened:function(a,b){this._setFormFocus(b),this.$form=b}}},onupload:{file:{complete:function(a){this._insert(a)},error:function(a){this._uploadError(a)}},filedrop:{complete:function(a,b){this._insert(a,b)},error:function(a){this._uploadError(a)}}},open:function(){this._open()},insert:function(a){this._insert(a)},remove:function(a){this._remove(a)},_open:function(){this.app.api("module.modal.build",this._getModalData())},_getModalData:function(){return{name:"file",title:this.lang.get("file")}},_insert:function(a,b){if(this.app.api("module.modal.close"),"object"==typeof a){if(Array.isArray(a)){for(var c={},d=0;d<a.length;d++)c=$R.extend(c,a[d]);a=c}Object.keys(a).length>1?this._insertMultiple(a,b):this._insertSingle(a,b),this.$form=!1}},_insertSingle:function(a,b){var c=[];for(var d in a){var e=this._createFileAndStore(a[d]);c=this.opts.fileAttachment?this._insertAsAttachment(e):b?this.insertion.insertToPoint(b,e):this.insertion.insertRaw(e),this.app.broadcast("file.uploaded",c[0],a)}},_insertMultiple:function(a,b){var c,d=0,e=[];for(var f in a){d++;var g=this._createFileAndStore(a[f]);if(this.opts.fileAttachment)e=this._insertAsAttachment(g,a);else if(1===d)e=b?this.insertion.insertToPoint(b,g):this.insertion.insertRaw(g);else{var h=$R.dom(e[0]);h.after(g).after(" "),e=[g.get()],this.app.broadcast("file.inserted",g)}c=g,this.app.broadcast("file.uploaded",e[0],a)}this.opts.fileAttachment||this.caret.setAfter(c)},_insertAsAttachment:function(a,b){var c=$R.dom(this.opts.fileAttachment),d=a.wrapAttachment();c.append(d);var e=[d.get()];return this.app.broadcast("file.appended",e[0],b),e},_createFileAndStore:function(a){var b=!!this.$form&&this.$form.getData(),c=a.name?a.name:a.url,d=!this.opts.fileAttachment&&b&&""!==b.title?b.title:this._truncateUrl(c),e=this.component.create("file");return e.attr("href",a.url),e.attr("data-file",a.id?a.id:this.utils.getRandomId()),e.attr("data-name",a.name),e.html(d),this.storage.add("file",e),e},_remove:function(a){this.selection.save();var b=this.component.create("file",a);!1!==this.app.broadcast("file.delete",b)?(b.unwrap(),this.selection.restore(),this.app.broadcast("file.deleted",b)):this.selection.restore()},_truncateUrl:function(a){return-1!==a.search(/^http/)&&a.length>20?a.substring(0,20)+"...":a},_setUpload:function(a){var b={url:this.opts.fileUpload,element:a.getField("file"),name:"file",data:this.opts.fileData,paramName:this.opts.fileUploadParam};this.app.api("module.upload.build",b)},_setFormData:function(a,b){this.opts.fileAttachment?a.find(".form-item-title").hide():b.setData({title:this.selection.getText()})},_setFormFocus:function(a){a.getField("title").focus()},_uploadError:function(a){this.app.broadcast("file.uploadError",a)}}),$R.add("class","file.component",{mixins:["dom","component"],init:function(a,b){return this.app=a,this.opts=a.opts,b&&void 0!==b.cmnt?b:this._init(b)},wrapAttachment:function(){return this.$wrapper=$R.dom('<span class="redactor-file-item">'),this.$remover=$R.dom('<span class="redactor-file-remover">'),this.$remover.html("&times;"),this.$remover.on("click",this.removeAttachment.bind(this)),this.$wrapper.append(this),this.$wrapper.append(this.$remover),this.$wrapper},removeAttachment:function(a){a.preventDefault(),!1!==this.app.broadcast("file.delete",this,this.$wrapper)&&(this.$wrapper.remove(),this.app.broadcast("file.deleted",this),this.app.broadcast("file.removeAttachment",this))},_init:function(a){if(void 0===a)this.parse("<a>");else{var b=$R.dom(a).closest("a");this.parse(b)}}}),$R.add("module","buffer",{init:function(a){this.app=a,this.opts=a.opts,this.editor=a.editor,this.offset=a.offset,this.keycodes=a.keycodes,this.selection=a.selection,this.state=!1,this.passed=!1,this.keyPressed=!1,this.undoStorage=[],this.redoStorage=[]},onkeydown:function(a){this._listen(a)},onsyncing:function(){this.keyPressed||this.trigger(),this.keyPressed=!1},onbuffer:{trigger:function(){this.trigger()}},onstate:function(a,b,c){a&&(a.ctrlKey||a.metaKey)||a&&(this._isUndo(a)||this._isRedo(a))||(this.passed=!1,this._saveState(b,c))},onenable:function(){this.clear()},clear:function(){this.state=!1,this.undoStorage=[],this.redoStorage=[]},undo:function(){this._getUndo()},redo:function(){this._getRedo()},trigger:function(){this.state&&!1===this.passed&&this._setUndo()},_saveState:function(a,b){var c=this.editor.getElement();this.state={html:a||c.html(),offset:b||this.offset.get()}},_listen:function(a){var b=a.which,c=a.ctrlKey||a.metaKey,d=c||a.shiftKey||a.altKey,e=[this.keycodes.SPACE,this.keycodes.ENTER,this.keycodes.BACKSPACE,this.keycodes.DELETE,this.keycodes.TAB,this.keycodes.LEFT,this.keycodes.RIGHT,this.keycodes.UP,this.keycodes.DOWN];return this._isUndo(a)?(a.preventDefault(),void this.undo()):this._isRedo(a)?(a.preventDefault(),void this.redo()):(c||-1===e.indexOf(b)?!c||88!==b&&67!==b||(d=!0,this.trigger()):(d=!0,this.trigger()),d||this._hasUndo()||this.trigger(),void(this.keyPressed=!0))},_isUndo:function(a){var b=a.which
;return(a.ctrlKey||a.metaKey)&&90===b&&!a.shiftKey&&!a.altKey},_isRedo:function(a){var b=a.which;return(a.ctrlKey||a.metaKey)&&(90===b&&a.shiftKey||89===b&&!a.shiftKey)&&!a.altKey},_setUndo:function(){var a=this.undoStorage[this.undoStorage.length-1];void 0!==a&&a[0]===this.state.html||(this.undoStorage.push([this.state.html,this.state.offset]),this._removeOverStorage())},_setRedo:function(){var a=this.editor.getElement(),b=this.offset.get(),c=a.html();this.redoStorage.push([c,b]),this.redoStorage=this.redoStorage.slice(0,this.opts.bufferLimit)},_getUndo:function(){if(this._hasUndo()){this.passed=!0;var a=this.editor.getElement(),b=this.undoStorage.pop();this._setRedo(),a.html(b[0]),this.offset.set(b[1]),this.selection.restore(),this.app.broadcast("undo",b[0],b[1])}},_getRedo:function(){if(this._hasRedo()){this.passed=!0;var a=this.editor.getElement(),b=this.redoStorage.pop();this._setUndo(),a.html(b[0]),this.offset.set(b[1]),this.app.broadcast("redo",b[0],b[1])}},_removeOverStorage:function(){this.undoStorage.length>this.opts.bufferLimit&&(this.undoStorage=this.undoStorage.slice(0,this.undoStorage.length-this.opts.bufferLimit))},_hasUndo:function(){return 0!==this.undoStorage.length},_hasRedo:function(){return 0!==this.redoStorage.length}}),$R.add("module","list",{init:function(a){this.app=a,this.uuid=a.uuid,this.opts=a.opts,this.utils=a.utils,this.block=a.block,this.toolbar=a.toolbar,this.inspector=a.inspector,this.selection=a.selection},onbutton:{list:{observe:function(a){this._observeButton(a)}}},ondropdown:{list:{observe:function(a){this._observeDropdown(a)}}},toggle:function(a){var b=this._getBlocks(),c=this.selection.getBlock(),d=$R.dom(c).parents("ul, ol",".redactor-in-"+this.uuid).last();return 0===b.length&&0!==d.length&&(b=[d.get()]),!c||"TD"!==c.tagName&&"TH"!==c.tagName||(b=this.block.format("div")),this.selection.saveMarkers(),b=0!==b.length&&this._isUnformat(a,b)?this._unformat(a,b):this._format(a,b),this.selection.restoreMarkers(),b},indent:function(){var a=this.selection.isCollapsed(),b=this.selection.getCurrent(),c=this.inspector.parse(b),d=!!c.isList()&&c.getListItem(),e=$R.dom(d),f=e.prevElement(),g=f.get();if(a&&d&&g&&"LI"===g.tagName){this.selection.saveMarkers(),f=$R.dom(g);var h=f.children("ul, ol"),i=e.closest("ul, ol");if(0!==h.length)h.append(e);else{var j=i.get().tagName.toLowerCase(),k=$R.dom("<"+j+">");k.append(e),f.append(k)}this.selection.restoreMarkers()}},outdent:function(){var a=this.selection.isCollapsed(),b=this.selection.getCurrent(),c=this.inspector.parse(b),d=!!c.isList()&&c.getListItem(),e=$R.dom(d);if(a&&d){var f,g,h,i,j=e.parent(),k=j.closest("li",".redactor-in-"+this.uuid),l=e.prevElement(),m=e.nextElement(),n=l.get(),o=m.get(),p=!1===n,q=!1!==n&&!1!==o,r=!p&&!1===o;if(this.selection.saveMarkers(),0!==k.length)if(q){f=this._getAllNext(e.get()),h=$R.dom("<"+j.get().tagName.toLowerCase()+">");for(var s=0;s<f.length;s++)h.append(f[s]);k.after(e),e.append(h)}else k.after(e),0===j.children().length?j.remove():p&&e.append(j);else{var t=this._createUnformatContainer(e),u=t.find("ul, ol").first();if(p)j.before(t);else if(r)j.after(t);else if(q){h=$R.dom("<"+j.get().tagName.toLowerCase()+">"),f=this._getAllNext(e.get());for(var s=0;s<f.length;s++)h.append(f[s]);j.after(t),t.after(h)}0!==u.length&&(i=t.nextElement(),g=i.get(),g&&g.tagName===j.get().tagName?($R.dom(g).prepend(u),u.unwrap()):t.after(u)),e.remove()}this.selection.restoreMarkers()}},_getAllNext:function(a){for(var b=[];a;){if(!(a=$R.dom(a).nextElement().get()))return b;b.push(a)}return b},_isUnformat:function(a,b){for(var c=0,d=0;d<b.length;d++)if(3!==b[d].nodeType){var e=b[d].tagName.toLowerCase();e!==a&&"figure"!==e||c++}return c===b.length},_format:function(a,b){var c=["p","div","blockquote","pre","h1","h2","h3","h4","h5","h6","ul","ol"],d=this._uniteBlocks(b,c),e=[];for(var f in d){for(var g=d[f],h=this._createList(a,d[f]),i=0;i<g.length;i++){var j;if(3===g[i].nodeType||"UL"!==g[i].tagName&&"OL"!==g[i].tagName)j=this._createListItem(g[i]),this.utils.normalizeTextNodes(j),h.append(j);else{var k=$R.dom(g[i]);j=k.contents(),h.append(j),this.utils.isEmpty(k)&&k.remove()}}e.push(h.get())}return e},_uniteBlocks:function(a,b){for(var c=0,d={0:[]},e=!1,f=0;f<a.length;f++){var g=$R.dom(a[f]),h=g.closest("th, td");0!==h.length?(h.get()!==e&&(c++,d[c]=[]),this._isUniteBlock(a[f],b)&&d[c].push(a[f])):this._isUniteBlock(a[f],b)?d[c].push(a[f]):(c++,d[c]=[]),e=h.get()}return d},_isUniteBlock:function(a,b){return 3===a.nodeType||-1!==b.indexOf(a.tagName.toLowerCase())},_createList:function(a,b){var c=b[b.length-1],d=$R.dom(c),e=$R.dom("<"+a+">");return d.after(e),e},_createListItem:function(a){var b=$R.dom("<li>");if(3===a.nodeType)b.append(a);else{var c=$R.dom(a);b.append(c.contents()),c.remove()}return b},_unformat:function(a,b){if(1===b.length){var c=$R.dom(b[0]),d=c.find("li"),e=this.selection.getNodes({tags:["li"]}),f=this.selection.getBlock(),g=$R.dom(f).closest("li");if(0===e.length&&0!==g.length&&(e=[g.get()]),e.length===d.length)return this._unformatEntire(b[0]);var h=this._getItemsPosition(d,e);if("Top"===h)return this._unformatAtSide("before",e,c);if("Bottom"===h)return e.reverse(),this._unformatAtSide("after",e,c);if("Middle"===h){var i=$R.dom(e[e.length-1]),j=!1,k=!1,l=$R.dom("<"+c.get().tagName.toLowerCase()+">");d.each(function(a){if(j){var b=$R.dom(a);0!==b.closest(".redactor-split-item").length||!1!==k&&0!==b.closest(k).length||b.addClass("redactor-split-item"),k=b}a===i.get()&&(j=!0)}),d.filter(".redactor-split-item").each(function(a){$R.dom(a).removeClass("redactor-split-item"),l.append(a)}),c.after(l),e.reverse();for(var m=0;m<e.length;m++){var n=$R.dom(e[m]),o=this._createUnformatContainer(n);c.after(o),o.find("ul, ol").remove(),n.remove()}return}}else for(var m=0;m<b.length;m++)3!==b[m].nodeType&&b[m].tagName.toLowerCase()===a&&this._unformatEntire(b[m])},_unformatEntire:function(a){var b=$R.dom(a);b.find("li").each(function(a){var c=$R.dom(a),d=this._createUnformatContainer(c);c.remove(),b.before(d)}.bind(this)),b.remove()},_unformatAtSide:function(a,b,c){for(var d=0;d<b.length;d++){var e=$R.dom(b[d]),f=this._createUnformatContainer(e);c[a](f);var g=f.find("ul, ol").first();e.append(g),g.each(function(a){var c=$R.dom(a),e=c.closest("li");e.get()===b[d]&&(c.unwrap(),e.addClass("r-unwrapped"))}),this.utils.isEmptyHtml(e.html())&&e.remove()}c.find(".r-unwrapped").each(function(a){var b=$R.dom(a);""===b.html().trim()?b.remove():b.removeClass("r-unwrapped")})},_getItemsPosition:function(a,b){var c="Middle",d=b[0],e=b[b.length-1],f=a.first().get(),g=a.last().get();return f===d&&g!==e?c="Top":f!==d&&g===e&&(c="Bottom"),c},_createUnformatContainer:function(a){var b=$R.dom("<"+this.opts.markup+">");return this.opts.breakline&&b.attr("data-redactor-tag","br"),b.append(a.contents()),b},_getBlocks:function(){return this.selection.getBlocks({first:!0})},_observeButton:function(){var a=this.selection.getCurrent(),b=this.inspector.parse(a),c=b.isPre()||b.isCode()||b.isFigcaption();this._observeButtonsList(c,["lists","ul","ol","outdent","indent"]);var d=this.toolbar.getButton("outdent"),e=this.toolbar.getButton("indent");this._observeIndent(e,d)},_observeDropdown:function(a){var b=a.getItem("outdent"),c=a.getItem("indent");this._observeIndent(c,b)},_observeIndent:function(a,b){var c=this.selection.isCollapsed(),d=this.selection.getCurrent(),e=this.inspector.parse(d),f=!!e.isList()&&e.getListItem(),g=$R.dom(f),h=g.prevElement(),i=h.get(),j=c&&f&&i&&"LI"===i.tagName;b&&(f&&c?b.enable():b.disable()),a&&(f&&j?a.enable():a.disable())},_observeButtonsList:function(a,b){for(var c=0;c<b.length;c++){var d=this.toolbar.getButton(b[c]);d&&(a?d.disable():d.enable())}}}),$R.add("class","video.component",{mixins:["dom","component"],init:function(a,b){return this.app=a,b&&void 0!==b.cmnt?b:this._init(b)},_init:function(a){if(void 0!==a){var b=$R.dom(a),c=b.closest("figure");0!==c.length?this.parse(c):(this.parse("<figure>"),this.append(a))}else this.parse("<figure>");this._initWrapper()},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"video",tabindex:"-1",contenteditable:!1})}}),$R.add("class","widget.component",{mixins:["dom","component"],init:function(a,b){return this.app=a,b&&void 0!==b.cmnt?b:this._init(b)},getData:function(){return{html:this._getHtml()}},_init:function(a){if(void 0!==a){var b=$R.dom(a),c=b.closest("figure");0!==c.length?this.parse(c):(this.parse("<figure>"),this.html(a))}else this.parse("<figure>");this._initWrapper()},_getHtml:function(){var a=$R.dom("<div>");return a.html(this.html()),a.find(".redactor-component-caret").remove(),a.html()},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"widget",tabindex:"-1",contenteditable:!1})}}),window.Redactor=window.$R=$R,window.addEventListener("load",function(){$R("[data-redactor]")}),"object"==typeof module&&module.exports&&(module.exports=Redactor,module.exports.Redactor=Redactor)}(),Redactor.add("plugin","alignment",{translations:{en:{align:"Align","align-left":"Align Left","align-center":"Align Center","align-right":"Align Right","align-justify":"Align Justify"}},init:function(a){this.app=a,this.opts=a.opts,this.lang=a.lang,this.block=a.block,this.toolbar=a.toolbar},start:function(){var a={};a.left={title:this.lang.get("align-left"),api:"plugin.alignment.set",args:"left"},a.center={title:this.lang.get("align-center"),api:"plugin.alignment.set",args:"center"},a.right={title:this.lang.get("align-right"),api:"plugin.alignment.set",args:"right"},a.justify={title:this.lang.get("align-justify"),api:"plugin.alignment.set",args:"justify"};var b=this.toolbar.addButton("alignment",{title:this.lang.get("align")});b.setIcon('<i class="re-icon-alignment"></i>'),b.setDropdown(a)},set:function(a){if("left"===a&&"ltr"===this.opts.direction)return this._remove();var b={style:{"text-align":a}};this.block.toggle(b)},_remove:function(){this.block.remove({style:"text-align"})}}),Redactor.add("plugin","counter",{translations:{en:{words:"words",chars:"chars"}},init:function(a){this.app=a,this.lang=a.lang,this.utils=a.utils,this.editor=a.editor,this.statusbar=a.statusbar},start:function(){this.editor.getElement().on("keyup.redactor-plugin-counter",this.count.bind(this)),this.count()},stop:function(){this.editor.getElement().off(".redactor-plugin-counter"),this.statusbar.remove("words"),this.statusbar.remove("chars")},count:function(){var a=0,b=0,c=0,d=this.editor.getElement().html();if(""!==(d=this._clean(d))){var e=d.split(/\s+/),f=d.match(/\s/g);a=e?e.length:0,c=f?f.length:0,b=d.length}var g={words:a,characters:b,spaces:c};this.app.broadcast("counter",g),this.statusbar.add("words",this.lang.get("words")+": "+g.words),this.statusbar.add("chars",this.lang.get("chars")+": "+g.characters)},_clean:function(a){return a=(a=(a=(a=(a=(a=(a=a.replace(/<\/(.*?)>/gi," ")).replace(/<(.*?)>/gi,"")).replace(/\t/gi,"")).replace(/\n/gi," ")).replace(/\r/gi," ")).replace(/&nbsp;/g,"1")).trim(),a=this.utils.removeInvisibleChars(a)}}),function(a){a.add("plugin","filesafe",{modals:{filesafe:'<div id="filesafe-react-client">                  </div>'},translations:{en:{filesafe:"FileSafe","filesafe-label":"Please, type some text"}},init:function(a){this.app=a,this.filesafe=window.filesafe_params,this.lang=a.lang,this.toolbar=a.toolbar,this.insertion=a.insertion},onmodal:{filesafe:{opened:function(a,b){const c=document.getElementById("filesafe-react-client");this.filesafe.embed.FilesafeEmbed.renderInElement(c,this.filesafe.client)},closed:function(){const a=document.getElementById("filesafe-react-client");this.filesafe.embed.FilesafeEmbed.unload(a)}}},start:function(){var a={title:"FileSafe",api:"plugin.filesafe.open"};this.toolbar.addButton("filesafe",a).setIcon('<i class="re-icon-clips"></i>')},open:function(){var a={title:this.lang.get("filesafe"),width:"600px",height:"500px",name:"filesafe",commands:{}};this.app.api("module.modal.build",a)}})}(Redactor),function(a){a.add("plugin","fontcolor",{translations:{en:{fontcolor:"Text Color",text:"Text",highlight:"Highlight"}},init:function(a){this.app=a,this.opts=a.opts,this.lang=a.lang,this.inline=a.inline,this.toolbar=a.toolbar,this.selection=a.selection,this.colors=this.opts.fontcolors?this.opts.fontcolors:["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"]},onfontcolor:{set:function(a,b){this._set(a,b)},remove:function(a){this._remove(a)}},start:function(){var a={title:this.lang.get("fontcolor")},b=this._buildDropdown();this.$button=this.toolbar.addButton("fontcolor",a),this.$button.setIcon('<i class="re-icon-fontcolor"></i>'),this.$button.setDropdown(b)},_buildDropdown:function(){var b=a.dom('<div class="redactor-dropdown-cells">');return this.$selector=this._buildSelector(),this.$selectorText=this._buildSelectorItem("text",this.lang.get("text")),this.$selectorText.addClass("active"),this.$selectorBack=this._buildSelectorItem("back",this.lang.get("highlight")),this.$selector.append(this.$selectorText),this.$selector.append(this.$selectorBack),this.$pickerText=this._buildPicker("textcolor"),this.$pickerBack=this._buildPicker("backcolor"),b.append(this.$selector),b.append(this.$pickerText),b.append(this.$pickerBack),this._buildSelectorEvents(),b.width(242),b},_buildSelector:function(){var b=a.dom("<div>");return b.addClass("redactor-dropdown-selector"),b},_buildSelectorItem:function(b,c){var d=a.dom("<span>");return d.attr("rel",b).html(c),d.addClass("redactor-dropdown-not-close"),d},_buildSelectorEvents:function(){this.$selectorText.on("mousedown",function(a){a.preventDefault(),this.$selector.find("span").removeClass("active"),this.$pickerBack.hide(),this.$pickerText.show(),this.$selectorText.addClass("active")}.bind(this)),this.$selectorBack.on("mousedown",function(a){a.preventDefault(),this.$selector.find("span").removeClass("active"),this.$pickerText.hide(),this.$pickerBack.show(),this.$selectorBack.addClass("active")}.bind(this))},_buildPicker:function(b){function c(b){b.preventDefault();var c=a.dom(b.target);g._set(c.data("rule"),c.attr("rel"))}for(var d=a.dom('<div class="re-dropdown-box-'+b+'">'),e="backcolor"==b?"background-color":"color",f=this.colors.length,g=this,h=0;h<f;h++){var i=this.colors[h],j=a.dom("<span>");j.attr({rel:i,"data-rule":e}),j.css({"background-color":i,"font-size":0,border:"2px solid #fff",width:"22px",height:"22px"}),j.on("mousedown",c),d.append(j)}var k=a.dom("<a>");return k.attr({href:"#"}),k.css({display:"block",clear:"both",padding:"8px 5px","font-size":"12px","line-height":1}),k.html(this.lang.get("none")),k.on("click",function(a){a.preventDefault(),g._remove(e)}),d.append(k),"backcolor"==b&&d.hide(),d},_set:function(a,b){var c={};c[a]=b;var d={tag:"span",style:c,type:"toggle"};this.inline.format(d)},_remove:function(a){this.inline.remove({style:a})}})}(Redactor),Redactor.add("plugin","fontfamily",{translations:{en:{fontfamily:"Font","remove-font-family":"Remove Font Family"}},init:function(a){this.app=a,this.opts=a.opts,this.lang=a.lang,this.inline=a.inline,this.toolbar=a.toolbar,this.fonts=this.opts.fontfamily?this.opts.fontfamily:["Arial","Helvetica","Georgia","Times New Roman","Monospace"]},start:function(){for(var a={},b=0;b<this.fonts.length;b++){var c=this.fonts[b];a[b]={title:c.replace(/'/g,""),api:"plugin.fontfamily.set",args:c}}a.remove={title:this.lang.get("remove-font-family"),api:"plugin.fontfamily.remove"};var d=this.toolbar.addButton("fontfamily",{title:this.lang.get("fontfamily")});d.setIcon('<i class="re-icon-fontfamily"></i>'),d.setDropdown(a)},set:function(a){var b={tag:"span",style:{"font-family":a},type:"toggle"};this.inline.format(b)},remove:function(){this.inline.remove({style:"font-family"})}}),Redactor.add("plugin","fontsize",{translations:{en:{size:"Size","remove-size":"Remove Font Size"}},init:function(a){this.app=a,this.lang=a.lang,this.inline=a.inline,this.toolbar=a.toolbar,this.sizes=[10,11,12,14,16,18,20,24,28,30]},start:function(){for(var a={},b=0;b<this.sizes.length;b++){var c=this.sizes[b];a[b]={title:c+"px",api:"plugin.fontsize.set",args:c}}a.remove={title:this.lang.get("remove-size"),api:"plugin.fontsize.remove"};var d=this.toolbar.addButton("fontsize",{title:this.lang.get("size")});d.setIcon('<i class="re-icon-fontsize"></i>'),d.setDropdown(a)},set:function(a){var b={tag:"span",style:{"font-size":a+"px"},type:"toggle"};this.inline.format(b)},remove:function(){this.inline.remove({style:"font-size"})}}),function(a){a.add("plugin","imagemanager",{translations:{en:{choose:"Choose"}},init:function(a){this.app=a,this.lang=a.lang,this.opts=a.opts},onmodal:{image:{open:function(a,b){this.opts.imageManagerJson&&this._load(a)}}},_load:function(b){var c=b.getBody();this.$box=a.dom("<div>"),this.$box.attr("data-title",this.lang.get("choose")),this.$box.addClass("redactor-modal-tab"),this.$box.hide(),this.$box.css({overflow:"auto",height:"300px","line-height":1}),c.append(this.$box),a.ajax.get({url:this.opts.imageManagerJson,success:this._parse.bind(this)})},_parse:function(b){for(var c in b){var d=b[c];if("object"==typeof d){var e=a.dom("<img>"),f=d.thumb?d.thumb:d.url;e.attr("src",f),e.attr("data-params",encodeURI(JSON.stringify(d))),e.css({width:"96px",height:"72px",margin:"0 4px 2px 0",cursor:"pointer"}),e.on("click",this._insert.bind(this)),this.$box.append(e)}}},_insert:function(b){b.preventDefault();var c=a.dom(b.target),d=JSON.parse(decodeURI(c.attr("data-params")));this.app.api("module.image.insert",{image:d})}})}(Redactor),Redactor.add("plugin","inlinestyle",{translations:{en:{style:"Style"}},init:function(a){this.app=a,this.lang=a.lang,this.toolbar=a.toolbar,this.styles={marked:{title:"Marked",args:"mark"},code:{title:"Code",args:"code"},variable:{title:"Variable",args:"var"},shortcut:{title:"Shortcut",args:"kbd"},sup:{title:"Superscript",args:"sup"},sub:{title:"Subscript",args:"sub"}}},start:function(){var a={};for(var b in this.styles){var c=this.styles[b];a[b]={title:c.title,api:"module.inline.format",args:c.args}}var d=this.toolbar.addButtonAfter("format","inline",{title:this.lang.get("style")});d.setIcon('<i class="re-icon-inline"></i>'),d.setDropdown(a)}}),function(a){a.add("plugin","specialchars",{translations:{en:{specialchars:"Special Characters"}},init:function(a){this.app=a,this.lang=a.lang,this.toolbar=a.toolbar,this.insertion=a.insertion,this.chars=["&lsquo;","&rsquo;","&ldquo;","&rdquo;","&ndash;","&mdash;","&divide;","&hellip;","&trade;","&bull;","&rarr;","&asymp;","$","&euro;","&cent;","&pound;","&yen;","&iexcl;","&curren;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&raquo;","&not;","&reg;","&macr;","&deg;","&sup1;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&ordm;","&frac14;","&frac12;","&frac34;","&iquest;","&Agrave;","&Aacute;","&Acirc;","&Atilde;","&Auml;","&Aring;","&AElig;","&Ccedil;","&Egrave;","&Eacute;","&Ecirc;","&Euml;","&Igrave;","&Iacute;","&Icirc;","&Iuml;","&ETH;","&Ntilde;","&Ograve;","&Oacute;","&Ocirc;","&Otilde;","&Ouml;","&times;","&Oslash;","&Ugrave;","&Uacute;","&Ucirc;","&Uuml;","&Yacute;","&THORN;","&szlig;","&agrave;","&aacute;","&acirc;","&atilde;","&auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&ouml;","&oslash;","&ugrave;","&uacute;","&ucirc;","&uuml;","&yacute;","&thorn;","&yuml;","&OElig;","&oelig;","&#372;","&#374","&#373","&#375;"]},start:function(){var a={title:this.lang.get("specialchars")},b=this._buildDropdown();this.$button=this.toolbar.addButton("specialchars",a),this.$button.setIcon('<i class="re-icon-specialcharacters"></i>'),this.$button.setDropdown(b)},_set:function(a){this.insertion.insertChar(a)},_buildDropdown:function(){function b(b){b.preventDefault();var d=a.dom(b.target);c._set(d.data("char"))}for(var c=this,d=a.dom('<div class="redactor-dropdown-cells">'),e=0;e<this.chars.length;e++){var f=a.dom("<a>");f.attr({href:"#","data-char":this.chars[e]}),f.css({"line-height":"32px",width:"32px",height:"32px"}),f.html(this.chars[e]),f.on("click",b),d.append(f)}return d}})}(Redactor),function(a){a.add("plugin","table",{translations:{en:{table:"Table","insert-table":"Insert table","insert-row-above":"Insert row above","insert-row-below":"Insert row below","insert-column-left":"Insert column left","insert-column-right":"Insert column right","add-head":"Add head","delete-head":"Delete head","delete-column":"Delete column","delete-row":"Delete row","delete-table":"Delete table"}},init:function(a){this.app=a,this.lang=a.lang,this.opts=a.opts,this.caret=a.caret,this.editor=a.editor,this.toolbar=a.toolbar,this.component=a.component,this.inspector=a.inspector,this.insertion=a.insertion,this.selection=a.selection},ondropdown:{table:{observe:function(a){this._observeDropdown(a)}}},onbottomclick:function(){this.insertion.insertToEnd(this.editor.getLastNode(),"table")},start:function(){var a={observe:"table","insert-table":{title:this.lang.get("insert-table"),api:"plugin.table.insert"},"insert-row-above":{title:this.lang.get("insert-row-above"),classname:"redactor-table-item-observable",api:"plugin.table.addRowAbove"},"insert-row-below":{title:this.lang.get("insert-row-below"),classname:"redactor-table-item-observable",api:"plugin.table.addRowBelow"},"insert-column-left":{title:this.lang.get("insert-column-left"),classname:"redactor-table-item-observable",api:"plugin.table.addColumnLeft"},"insert-column-right":{title:this.lang.get("insert-column-right"),classname:"redactor-table-item-observable",api:"plugin.table.addColumnRight"},"add-head":{title:this.lang.get("add-head"),classname:"redactor-table-item-observable",api:"plugin.table.addHead"},"delete-head":{title:this.lang.get("delete-head"),classname:"redactor-table-item-observable",api:"plugin.table.deleteHead"},"delete-column":{title:this.lang.get("delete-column"),classname:"redactor-table-item-observable",api:"plugin.table.deleteColumn"},"delete-row":{title:this.lang.get("delete-row"),classname:"redactor-table-item-observable",api:"plugin.table.deleteRow"},"delete-table":{title:this.lang.get("delete-table"),classname:"redactor-table-item-observable",api:"plugin.table.deleteTable"}},b={title:this.lang.get("table")},c=this.toolbar.addButtonBefore("link","table",b);c.setIcon('<i class="re-icon-table"></i>'),c.setDropdown(a)},insert:function(){for(var a=this.component.create("table"),b=0;b<2;b++)a.addRow(3);a=this.insertion.insertHtml(a),this.caret.setStart(a)},addRowAbove:function(){var a=this._getComponent();if(a){var b=this.selection.getCurrent(),c=a.addRowTo(b,"before");this.caret.setStart(c)}},addRowBelow:function(){var a=this._getComponent();if(a){var b=this.selection.getCurrent(),c=a.addRowTo(b,"after");this.caret.setStart(c)}},addColumnLeft:function(){var a=this._getComponent();if(a){var b=this.selection.getCurrent();this.selection.save(),a.addColumnTo(b,"left"),this.selection.restore()}},addColumnRight:function(){var a=this._getComponent();if(a){var b=this.selection.getCurrent();this.selection.save(),a.addColumnTo(b,"right"),this.selection.restore()}},addHead:function(){var a=this._getComponent();a&&(this.selection.save(),a.addHead(),this.selection.restore())},deleteHead:function(){var b=this._getComponent();if(b){var c=this.selection.getCurrent();0!==a.dom(c).closest("thead").length?(b.removeHead(),this.caret.setStart(b)):(this.selection.save(),b.removeHead(),this.selection.restore())}},deleteColumn:function(){var b=this._getComponent();if(b){var c=this.selection.getCurrent(),d=a.dom(c).closest("td, th"),e=d.nextElement().get(),f=d.prevElement().get();b.removeColumn(c),e?this.caret.setStart(e):f?this.caret.setEnd(f):this.deleteTable()}},deleteRow:function(){var b=this._getComponent();if(b){var c=this.selection.getCurrent(),d=a.dom(c).closest("tr"),e=d.nextElement().get(),f=d.prevElement().get();b.removeRow(c),e?this.caret.setStart(e):f?this.caret.setEnd(f):this.deleteTable()}},deleteTable:function(){var a=this._getTable();a&&this.component.remove(a)},_getTable:function(){var a=this.selection.getCurrent(),b=this.inspector.parse(a);if(b.isTable())return b.getTable()},_getComponent:function(){var a=this.selection.getCurrent(),b=this.inspector.parse(a);if(b.isTable()){var c=b.getTable();return this.component.create("table",c)}},_observeDropdown:function(a){var b=this._getTable(),c=a.getItemsByClass("redactor-table-item-observable"),d=a.getItem("insert-table");b?(this._observeItems(c,"enable"),d.disable()):(this._observeItems(c,"disable"),d.enable())},_observeItems:function(a,b){for(var c=0;c<a.length;c++)a[c][b]()}})}(Redactor),function(a){a.add("class","table.component",{mixins:["dom","component"],init:function(a,b){return this.app=a,b&&void 0!==b.cmnt?b:this._init(b)},addHead:function(){this.removeHead();var b=this.$element.find("tr").first().children("td, th").length,c=a.dom("<thead>"),d=this._buildRow(b,"<th>");c.append(d),this.$element.prepend(c)},addRow:function(a){var b=this._buildRow(a);return this.$element.append(b),b},addRowTo:function(a,b){return this._addRowTo(a,b)},addColumnTo:function(b,c){var d=a.dom(b),e=d.closest("tr"),f=d.closest("td, th"),g=0;e.find("td, th").each(function(a,b){a===f.get()&&(g=b)}),this.$element.find("tr").each(function(b){var d=a.dom(b).find("td, th").get(g),e=a.dom(d),f=e.clone();f.html('<div data-redactor-tag="tbr"></div>'),"right"===c?e.after(f):e.before(f)})},removeHead:function(){var a=this.$element.find("thead");0!==a.length&&a.remove()},removeRow:function(b){a.dom(b).closest("tr").remove()},removeColumn:function(b){var c=a.dom(b),d=c.closest("tr"),e=c.closest("td, th"),f=0;d.find("td, th").each(function(a,b){a===e.get()&&(f=b)}),this.$element.find("tr").each(function(b){var c=a.dom(b).find("td, th").get(f);a.dom(c).remove()})},_init:function(b){var c,d;if(void 0!==b){var e=a.dom(b),f=e.get(),g=e.closest("figure");0!==g.length?d=(c=g).find("table").get():"TABLE"===f.tagName&&(d=f)}this._buildWrapper(c),this._buildElement(d),this._initWrapper()},_addRowTo:function(b,c){var d=a.dom(b).closest("tr");if(0!==d.length){var e=d.children("td, th").length,f=this._buildRow(e);return d[c](f),f}},_buildRow:function(b,c){c=c||"<td>";for(var d=a.dom("<tr>"),e=0;e<b;e++){var f=a.dom(c);f.attr("contenteditable",!0),f.html('<div data-redactor-tag="tbr"></div>'),d.append(f)}return d},_buildElement:function(b){b?this.$element=a.dom(b):(this.$element=a.dom("<table>"),this.append(this.$element))},_buildWrapper:function(a){a=a||"<figure>",this.parse(a)},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"table",tabindex:"-1",contenteditable:!1}),this.app.detector.isIe()&&this.removeAttr("contenteditable")}})}(Redactor),function(a){a.add("plugin","textdirection",{translations:{en:{"change-text-direction":"RTL-LTR","left-to-right":"Left to Right","right-to-left":"Right to Left"}},init:function(a){this.app=a,this.lang=a.lang,this.block=a.block,this.toolbar=a.toolbar,this.selection=a.selection},start:function(){var a={};a.ltr={title:this.lang.get("left-to-right"),api:"plugin.textdirection.set",args:"ltr"},a.rtl={title:this.lang.get("right-to-left"),api:"plugin.textdirection.set",args:"rtl"};var b=this.toolbar.addButton("textdirection",{title:this.lang.get("change-text-direction")});b.setIcon('<i class="re-icon-textdirection"></i>'),b.setDropdown(a)},set:function(b){var c=this.selection.getBlock();if(c&&"LI"===c.tagName){var d=a.dom(c).parents("ul, ol",".redactor-in").last();this.block.add({attr:{dir:b}},!1,d)}else this.block.add({attr:{dir:b}})}})}(Redactor),Redactor.add("plugin","textexpander",{init:function(a){this.app=a,this.opts=a.opts,this.utils=a.utils,this.editor=a.editor,this.marker=a.marker,this.keycodes=a.keycodes,this.selection=a.selection},start:function(){this.opts.textexpander&&this.editor.getElement().on("keyup.redactor-plugin-textexpander",this._expand.bind(this))},stop:function(){this.editor.getElement().off(".redactor-plugin-textexpander")},_expand:function(a){if(a.which===this.keycodes.SPACE)for(var b=this.opts.textexpander.length,c=0;c<b;c++){var d=this.opts.textexpander[c],e=new RegExp(this.utils.escapeRegExp(d[0])+"\\s$"),f=this.selection.getTextBeforeCaret(d[0].length+1).replace(/\s$/,"");if(d[0]===f)return this._replaceSelection(e,d[1])}},_replaceSelection:function(a,b){var c=this.marker.insert("start").previousSibling,d=c.textContent;d=(d=d.replace(/&nbsp;/," ")).replace(a,b),c.textContent=d,this.selection.restoreMarkers()}}),!function(a){a.add("plugin","variable",{translations:{en:{change:"Change",variable:"Variable","variable-select":"Please, select a variable"}},modals:{variable:""},init:function(a){this.app=a,this.lang=a.lang,this.opts=a.opts,this.toolbar=a.toolbar,this.component=a.component,this.insertion=a.insertion,this.inspector=a.inspector,this.selection=a.selection},onmodal:{variable:{open:function(a,b){this._build(a)}}},oncontextbar:function(a,b){var c=this.inspector.parse(a.target);if(c.isComponentType("variable")){var d=c.getComponent(),e={change:{title:this.lang.get("change"),api:"plugin.variable.open",args:d},remove:{title:this.lang.get("delete"),api:"plugin.variable.remove",args:d}};b.set(a,d,e,"bottom")}},start:function(){if(this.opts.variables){var a={title:this.lang.get("variable"),api:"plugin.variable.open"};this.toolbar.addButton("variable",a).setIcon('<i class="re-icon-variable"></i>')}},open:function(){var a={title:this.lang.get("variable"),width:"600px",name:"variable"};this.$currentItem=this._getCurrent(),this.app.api("module.modal.build",a)},insert:function(a){this.app.api("module.modal.close");var b=a.attr("data-type"),c=this.component.create("variable");c.html(b),this.insertion.insertRaw(c)},remove:function(a){this.component.remove(a)},_getCurrent:function(){var a=this.selection.getCurrent(),b=this.inspector.parse(a);if(b.isComponentType("variable"))return this.component.build(b.getComponent())},_build:function(a){var b=a.getBody(),c=this._buildLabel(),d=this._buildList();this._buildItems(d),b.html(""),b.append(c),b.append(d)},_buildLabel:function(){var b=a.dom("<label>");return b.html(this.lang.parse("## variable-select ##:")),b},_buildList:function(){var b=a.dom("<ul>");return b.addClass("redactor-variables-list"),b},_buildItems:function(b){for(var c=this._getCurrentType(),d=this.opts.variables,e=0;e<d.length;e++){var f=d[e].trim(),g=a.dom("<li>"),h=a.dom("<span>");h.attr("data-type",f),h.html(f),h.on("click",this._toggle.bind(this)),c===f&&h.addClass("redactor-variables-item-selected"),g.append(h),b.append(g)}},_getCurrentType:function(){return!!this.$currentItem&&this.$currentItem.getData().type},_toggle:function(b){var c=a.dom(b.target);this.app.api("plugin.variable.insert",c)}})}(Redactor),Redactor.add("class","variable.component",{mixins:["dom","component"],init:function(a,b){return this.app=a,this.utils=a.utils,b&&void 0!==b.cmnt?b:this._init(b)},getData:function(){return{type:this._getType()}},_init:function(a){a=a||"<span>",this.parse(a),this._initWrapper()},_getType:function(){var a=this.text().trim();return this.utils.removeInvisibleChars(a)},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"variable",tabindex:"-1",contenteditable:!1})}}); !function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=6)}([function(e,t,n){"use strict";e.exports=n(8)},function(e,t,n){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,u,s=r(e),l=1;l<arguments.length;l++){n=Object(arguments[l]);for(var c in n)a.call(n,c)&&(s[c]=n[c]);if(i){u=i(n);for(var f=0;f<u.length;f++)o.call(n,u[f])&&(s[u[f]]=n[u[f]])}}return s}},function(e,t,n){"use strict";function r(e){return function(){return e}}var i=function(){};i.thatReturns=r,i.thatReturnsFalse=r(!1),i.thatReturnsTrue=r(!0),i.thatReturnsNull=r(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(e){return e},e.exports=i},function(e,t,n){"use strict";e.exports=n(24)},function(e,t,n){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,u,s=r(e),l=1;l<arguments.length;l++){n=Object(arguments[l]);for(var c in n)a.call(n,c)&&(s[c]=n[c]);if(i){u=i(n);for(var f=0;f<u.length;f++)o.call(n,u[f])&&(s[u[f]]=n[u[f]])}}return s}},function(e,t){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,n){(function(t){var n,n;!function(t){e.exports=t()}(function(){return function(){function e(t,r,i){function a(u,s){if(!r[u]){if(!t[u]){var l="function"==typeof n&&n;if(!s&&l)return n(u,!0);if(o)return o(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var f=r[u]={exports:{}};t[u][0].call(f.exports,function(e){return a(t[u][1][e]||e)},f,f.exports,e,t,r,i)}return r[u].exports}for(var o="function"==typeof n&&n,u=0;u<i.length;u++)a(i[u]);return a}return e}()({1:[function(e,n,r){(function(e){function t(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,a){try{var o=t[i](a),u=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=o||function(e,t){var n={},r=n.lib={},i=function(){},a=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-i%4*8&255)<<24-(r+i)%4*8;else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),u=n.enc={},s=u.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-r%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(n,t/2)}},l=u.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(n,t)}},c=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,a=this.blockSize,u=i/(4*a),u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0);if(t=u*a,i=e.min(4*t,i),t){for(var s=0;s<t;s+=a)this._doProcessBlock(r,s);s=r.splice(0,t),n.sigBytes-=i}return new o.init(s,i)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=f.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=n.algo={};return n}(Math);!function(){var e=o,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,o=0;4>o&&i+.75*o<n;o++)e.push(r.charAt(a>>>6*(3-o)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,r=this._map,i=r.charAt(64);i&&-1!=(i=e.indexOf(i))&&(n=i);for(var i=[],a=0,o=0;o<n;o++)if(o%4){var u=r.indexOf(e.charAt(o-1))<<o%4*2,s=r.indexOf(e.charAt(o))>>>6-o%4*2;i[a>>>2]|=(u|s)<<24-a%4*8,a++}return t.create(i,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,n,r,i,a,o){return((e=e+(t&n|~t&r)+i+o)<<a|e>>>32-a)+t}function n(e,t,n,r,i,a,o){return((e=e+(t&r|n&~r)+i+o)<<a|e>>>32-a)+t}function r(e,t,n,r,i,a,o){return((e=e+(t^n^r)+i+o)<<a|e>>>32-a)+t}function i(e,t,n,r,i,a,o){return((e=e+(n^(t|~r))+i+o)<<a|e>>>32-a)+t}for(var a=o,u=a.lib,s=u.WordArray,l=u.Hasher,u=a.algo,c=[],f=0;64>f;f++)c[f]=4294967296*e.abs(e.sin(f+1))|0;u=u.MD5=l.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,a){for(var o=0;16>o;o++){var u=a+o,s=e[u];e[u]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}var o=this._hash.words,u=e[a+0],s=e[a+1],l=e[a+2],f=e[a+3],p=e[a+4],d=e[a+5],h=e[a+6],m=e[a+7],v=e[a+8],y=e[a+9],g=e[a+10],b=e[a+11],k=e[a+12],w=e[a+13],x=e[a+14],S=e[a+15],E=o[0],C=o[1],_=o[2],T=o[3],E=t(E,C,_,T,u,7,c[0]),T=t(T,E,C,_,s,12,c[1]),_=t(_,T,E,C,l,17,c[2]),C=t(C,_,T,E,f,22,c[3]),E=t(E,C,_,T,p,7,c[4]),T=t(T,E,C,_,d,12,c[5]),_=t(_,T,E,C,h,17,c[6]),C=t(C,_,T,E,m,22,c[7]),E=t(E,C,_,T,v,7,c[8]),T=t(T,E,C,_,y,12,c[9]),_=t(_,T,E,C,g,17,c[10]),C=t(C,_,T,E,b,22,c[11]),E=t(E,C,_,T,k,7,c[12]),T=t(T,E,C,_,w,12,c[13]),_=t(_,T,E,C,x,17,c[14]),C=t(C,_,T,E,S,22,c[15]),E=n(E,C,_,T,s,5,c[16]),T=n(T,E,C,_,h,9,c[17]),_=n(_,T,E,C,b,14,c[18]),C=n(C,_,T,E,u,20,c[19]),E=n(E,C,_,T,d,5,c[20]),T=n(T,E,C,_,g,9,c[21]),_=n(_,T,E,C,S,14,c[22]),C=n(C,_,T,E,p,20,c[23]),E=n(E,C,_,T,y,5,c[24]),T=n(T,E,C,_,x,9,c[25]),_=n(_,T,E,C,f,14,c[26]),C=n(C,_,T,E,v,20,c[27]),E=n(E,C,_,T,w,5,c[28]),T=n(T,E,C,_,l,9,c[29]),_=n(_,T,E,C,m,14,c[30]),C=n(C,_,T,E,k,20,c[31]),E=r(E,C,_,T,d,4,c[32]),T=r(T,E,C,_,v,11,c[33]),_=r(_,T,E,C,b,16,c[34]),C=r(C,_,T,E,x,23,c[35]),E=r(E,C,_,T,s,4,c[36]),T=r(T,E,C,_,p,11,c[37]),_=r(_,T,E,C,m,16,c[38]),C=r(C,_,T,E,g,23,c[39]),E=r(E,C,_,T,w,4,c[40]),T=r(T,E,C,_,u,11,c[41]),_=r(_,T,E,C,f,16,c[42]),C=r(C,_,T,E,h,23,c[43]),E=r(E,C,_,T,y,4,c[44]),T=r(T,E,C,_,k,11,c[45]),_=r(_,T,E,C,S,16,c[46]),C=r(C,_,T,E,l,23,c[47]),E=i(E,C,_,T,u,6,c[48]),T=i(T,E,C,_,m,10,c[49]),_=i(_,T,E,C,x,15,c[50]),C=i(C,_,T,E,d,21,c[51]),E=i(E,C,_,T,k,6,c[52]),T=i(T,E,C,_,f,10,c[53]),_=i(_,T,E,C,g,15,c[54]),C=i(C,_,T,E,s,21,c[55]),E=i(E,C,_,T,v,6,c[56]),T=i(T,E,C,_,S,10,c[57]),_=i(_,T,E,C,h,15,c[58]),C=i(C,_,T,E,w,21,c[59]),E=i(E,C,_,T,p,6,c[60]),T=i(T,E,C,_,b,10,c[61]),_=i(_,T,E,C,l,15,c[62]),C=i(C,_,T,E,y,21,c[63]);o[0]=o[0]+E|0,o[1]=o[1]+C|0,o[2]=o[2]+_|0,o[3]=o[3]+T|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var a=e.floor(r/4294967296);for(n[15+(i+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),n[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),t=this._hash,n=t.words,r=0;4>r;r++)i=n[r],n[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e}}),a.MD5=l._createHelper(u),a.HmacMD5=l._createHmacHelper(u)}(Math),function(){var e=o,t=e.lib,n=t.Base,r=t.WordArray,t=e.algo,i=t.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=n.hasher.create(),a=r.create(),o=a.words,u=n.keySize,n=n.iterations;o.length<u;){s&&i.update(s);var s=i.update(e).finalize(t);i.reset();for(var l=1;l<n;l++)s=i.finalize(s),i.reset();a.concat(s)}return a.sigBytes=4*u,a}});e.EvpKDF=function(e,t,n){return i.create(n).compute(e,t)}}(),o.lib.Cipher||function(e){var t=o,n=t.lib,r=n.Base,i=n.WordArray,a=n.BufferedBlockAlgorithm,u=t.enc.Base64,s=t.algo.EvpKDF,l=n.Cipher=a.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return("string"==typeof n?m:h).encrypt(e,t,n,r)},decrypt:function(t,n,r){return("string"==typeof n?m:h).decrypt(e,t,n,r)}}}});n.StreamCipher=l.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=t.mode={},f=function(e,t,n){var r=this._iv;r?this._iv=void 0:r=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=r[i]},p=(n.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();p.Encryptor=p.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;f.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),p.Decryptor=p.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=e.slice(t,t+r);n.decryptBlock(e,t),f.call(this,e,t,r),this._prevBlock=i}}),c=c.CBC=p,p=(t.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,n=n-e.sigBytes%n,r=n<<24|n<<16|n<<8|n,a=[],o=0;o<n;o+=4)a.push(r);n=i.create(a,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},n.BlockCipher=l.extend({cfg:l.cfg.extend({mode:c,padding:p}),reset:function(){l.reset.call(this);var e=this.cfg,t=e.iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var d=n.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),c=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return e=e.salt,(e?i.create([1398893684,1701076831]).concat(e).concat(t):t).toString(u)},parse:function(e){e=u.parse(e);var t=e.words;if(1398893684==t[0]&&1701076831==t[1]){var n=i.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return d.create({ciphertext:e,salt:n})}},h=n.SerializableCipher=r.extend({cfg:r.extend({format:c}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r);return t=i.finalize(t),i=i.cfg,d.create({ciphertext:t,key:n,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),t=(t.kdf={}).OpenSSL={execute:function(e,t,n,r){return r||(r=i.random(8)),e=s.create({keySize:t+n}).compute(e,r),n=i.create(e.words.slice(t),4*n),e.sigBytes=4*t,d.create({key:e,iv:n,salt:r})}},m=n.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:t}),encrypt:function(e,t,n,r){return r=this.cfg.extend(r),n=r.kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,e=h.encrypt.call(this,e,t,n.key,r),e.mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,h.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=o,t=e.lib.BlockCipher,n=e.algo,r=[],i=[],a=[],u=[],s=[],l=[],c=[],f=[],p=[],d=[],h=[],m=0;256>m;m++)h[m]=128>m?m<<1:m<<1^283;for(var v=0,y=0,m=0;256>m;m++){var g=y^y<<1^y<<2^y<<3^y<<4,g=g>>>8^255&g^99;r[v]=g,i[g]=v;var b=h[v],k=h[b],w=h[k],x=257*h[g]^16843008*g;a[v]=x<<24|x>>>8,u[v]=x<<16|x>>>16,s[v]=x<<8|x>>>24,l[v]=x,x=16843009*w^65537*k^257*b^16843008*v,c[g]=x<<24|x>>>8,f[g]=x<<16|x>>>16,p[g]=x<<8|x>>>24,d[g]=x,v?(v=b^h[h[h[w^b]]],y^=h[h[y]]):v=y=1}var S=[0,1,2,4,8,16,32,64,128,27,54],n=n.AES=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes/4,e=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],a=0;a<e;a++)if(a<n)i[a]=t[a];else{var o=i[a-1];a%n?6<n&&4==a%n&&(o=r[o>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[255&o]):(o=o<<8|o>>>24,o=r[o>>>24]<<24|r[o>>>16&255]<<16|r[o>>>8&255]<<8|r[255&o],o^=S[a/n|0]<<24),i[a]=i[a-n]^o}for(t=this._invKeySchedule=[],n=0;n<e;n++)a=e-n,o=n%4?i[a]:i[a-4],t[n]=4>n||4>=a?o:c[r[o>>>24]]^f[r[o>>>16&255]]^p[r[o>>>8&255]]^d[r[255&o]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,u,s,l,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,f,p,d,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,a,o,u){for(var s=this._nRounds,l=e[t]^n[0],c=e[t+1]^n[1],f=e[t+2]^n[2],p=e[t+3]^n[3],d=4,h=1;h<s;h++)var m=r[l>>>24]^i[c>>>16&255]^a[f>>>8&255]^o[255&p]^n[d++],v=r[c>>>24]^i[f>>>16&255]^a[p>>>8&255]^o[255&l]^n[d++],y=r[f>>>24]^i[p>>>16&255]^a[l>>>8&255]^o[255&c]^n[d++],p=r[p>>>24]^i[l>>>16&255]^a[c>>>8&255]^o[255&f]^n[d++],l=m,c=v,f=y;m=(u[l>>>24]<<24|u[c>>>16&255]<<16|u[f>>>8&255]<<8|u[255&p])^n[d++],v=(u[c>>>24]<<24|u[f>>>16&255]<<16|u[p>>>8&255]<<8|u[255&l])^n[d++],y=(u[f>>>24]<<24|u[p>>>16&255]<<16|u[l>>>8&255]<<8|u[255&c])^n[d++],p=(u[p>>>24]<<24|u[l>>>16&255]<<16|u[c>>>8&255]<<8|u[255&f])^n[d++],e[t]=m,e[t+1]=v,e[t+2]=y,e[t+3]=p},keySize:8});e.AES=t._createHelper(n)}();var o=o||function(e,t){var n={},r=n.lib={},i=function(){},a=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-i%4*8&255)<<24-(r+i)%4*8;else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),u=n.enc={},s=u.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-r%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(n,t/2)}},l=u.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(n,t)}},c=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,a=this.blockSize,u=i/(4*a),u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0);if(t=u*a,i=e.min(4*t,i),t){for(var s=0;s<t;s+=a)this._doProcessBlock(r,s);s=r.splice(0,t),n.sigBytes-=i}return new o.init(s,i)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=f.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=n.algo={};return n}(Math);!function(e){for(var t=o,n=t.lib,r=n.WordArray,i=n.Hasher,n=t.algo,a=[],u=[],s=function(e){return 4294967296*(e-(0|e))|0},l=2,c=0;64>c;){var f;e:{f=l;for(var p=e.sqrt(f),d=2;d<=p;d++)if(!(f%d)){f=!1;break e}f=!0}f&&(8>c&&(a[c]=s(e.pow(l,.5))),u[c]=s(e.pow(l,1/3)),c++),l++}var h=[],n=n.SHA256=i.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],l=n[5],c=n[6],f=n[7],p=0;64>p;p++){if(16>p)h[p]=0|e[t+p];else{var d=h[p-15],m=h[p-2];h[p]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[p-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+h[p-16]}d=f+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&c)+u[p]+h[p],m=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&a^i&a),f=c,c=l,l=s,s=o+d|0,o=a,a=i,i=r,r=d+m|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+c|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(n),t.HmacSHA256=i._createHmacHelper(n)}(Math),function(){var e=o,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,i=4*r;n.sigBytes>i&&(n=e.finalize(n)),n.clamp();for(var a=this._oKey=n.clone(),o=this._iKey=n.clone(),u=a.words,s=o.words,l=0;l<r;l++)u[l]^=1549556828,s[l]^=909522486;a.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}();var o=o||function(e,t){var n={},r=n.lib={},i=function(){},a=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-i%4*8&255)<<24-(r+i)%4*8;else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),u=n.enc={},s=u.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-r%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(n,t/2)}},l=u.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(n,t)}},c=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,a=this.blockSize,u=i/(4*a),u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0);if(t=u*a,i=e.min(4*t,i),t){for(var s=0;s<t;s+=a)this._doProcessBlock(r,s);s=r.splice(0,t),n.sigBytes-=i}return new o.init(s,i)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=f.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=n.algo={};return n}(Math);!function(e){var t=o,n=t.lib,r=n.Base,i=n.WordArray,t=t.x64={};t.Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),t.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var a=e[r];n.push(a.high),n.push(a.low)}return i.create(n,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,i=0;i<n;i++)t[i]=t[i].clone();return e}})}(),function(){function e(){return i.create.apply(i,arguments)}for(var t=o,n=t.lib.Hasher,r=t.x64,i=r.Word,a=r.WordArray,r=t.algo,u=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],s=[],l=0;80>l;l++)s[l]=e();r=r.SHA512=n.extend({_doReset:function(){this._hash=new a.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],a=n[2],o=n[3],l=n[4],c=n[5],f=n[6],n=n[7],p=r.high,d=r.low,h=i.high,m=i.low,v=a.high,y=a.low,g=o.high,b=o.low,k=l.high,w=l.low,x=c.high,S=c.low,E=f.high,C=f.low,_=n.high,T=n.low,P=p,I=d,R=h,F=m,O=v,D=y,M=g,N=b,A=k,L=w,j=x,U=S,B=E,H=C,z=_,W=T,K=0;80>K;K++){var V=s[K];if(16>K)var $=V.high=0|e[t+2*K],q=V.low=0|e[t+2*K+1];else{var $=s[K-15],q=$.high,Q=$.low,$=(q>>>1|Q<<31)^(q>>>8|Q<<24)^q>>>7,Q=(Q>>>1|q<<31)^(Q>>>8|q<<24)^(Q>>>7|q<<25),J=s[K-2],q=J.high,Y=J.low,J=(q>>>19|Y<<13)^(q<<3|Y>>>29)^q>>>6,Y=(Y>>>19|q<<13)^(Y<<3|q>>>29)^(Y>>>6|q<<26),q=s[K-7],G=q.high,X=s[K-16],Z=X.high,X=X.low,q=Q+q.low,$=$+G+(q>>>0<Q>>>0?1:0),q=q+Y,$=$+J+(q>>>0<Y>>>0?1:0),q=q+X,$=$+Z+(q>>>0<X>>>0?1:0);V.high=$,V.low=q}var G=A&j^~A&B,X=L&U^~L&H,V=P&R^P&O^R&O,ee=I&F^I&D^F&D,Q=(P>>>28|I<<4)^(P<<30|I>>>2)^(P<<25|I>>>7),J=(I>>>28|P<<4)^(I<<30|P>>>2)^(I<<25|P>>>7),Y=u[K],te=Y.high,ne=Y.low,Y=W+((L>>>14|A<<18)^(L>>>18|A<<14)^(L<<23|A>>>9)),Z=z+((A>>>14|L<<18)^(A>>>18|L<<14)^(A<<23|L>>>9))+(Y>>>0<W>>>0?1:0),Y=Y+X,Z=Z+G+(Y>>>0<X>>>0?1:0),Y=Y+ne,Z=Z+te+(Y>>>0<ne>>>0?1:0),Y=Y+q,Z=Z+$+(Y>>>0<q>>>0?1:0),q=J+ee,V=Q+V+(q>>>0<J>>>0?1:0),z=B,W=H,B=j,H=U,j=A,U=L,L=N+Y|0,A=M+Z+(L>>>0<N>>>0?1:0)|0,M=O,N=D,O=R,D=F,R=P,F=I,I=Y+q|0,P=Z+V+(I>>>0<Y>>>0?1:0)|0}d=r.low=d+I,r.high=p+P+(d>>>0<I>>>0?1:0),m=i.low=m+F,i.high=h+R+(m>>>0<F>>>0?1:0),y=a.low=y+D,a.high=v+O+(y>>>0<D>>>0?1:0),b=o.low=b+N,o.high=g+M+(b>>>0<N>>>0?1:0),w=l.low=w+L,l.high=k+A+(w>>>0<L>>>0?1:0),S=c.low=S+U,c.high=x+j+(S>>>0<U>>>0?1:0),C=f.low=C+H,f.high=E+B+(C>>>0<H>>>0?1:0),T=n.low=T+W,n.high=_+z+(T>>>0<W>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),t.SHA512=n._createHelper(r),t.HmacSHA512=n._createHmacHelper(r)}(),function(){var e=o,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,i=4*r;n.sigBytes>i&&(n=e.finalize(n)),n.clamp();for(var a=this._oKey=n.clone(),o=this._iKey=n.clone(),u=a.words,s=o.words,l=0;l<r;l++)u[l]^=1549556828,s[l]^=909522486;a.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}();var o=o||function(e,t){var n={},r=n.lib={},i=function(){},a=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-i%4*8&255)<<24-(r+i)%4*8;else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),u=n.enc={},s=u.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-r%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(n,t/2)}},l=u.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(n,t)}},c=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,a=this.blockSize,u=i/(4*a),u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0);if(t=u*a,i=e.min(4*t,i),t){for(var s=0;s<t;s+=a)this._doProcessBlock(r,s);s=r.splice(0,t),n.sigBytes-=i}return new o.init(s,i)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=f.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=n.algo={};return n}(Math);!function(){var e=o,t=e.lib,n=t.WordArray,r=t.Hasher,i=[],t=e.algo.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],a=n[1],o=n[2],u=n[3],s=n[4],l=0;80>l;l++){if(16>l)i[l]=0|e[t+l];else{var c=i[l-3]^i[l-8]^i[l-14]^i[l-16];i[l]=c<<1|c>>>31}c=(r<<5|r>>>27)+s+i[l],c=20>l?c+(1518500249+(a&o|~a&u)):40>l?c+(1859775393+(a^o^u)):60>l?c+((a&o|a&u|o&u)-1894007588):c+((a^o^u)-899497514),s=u,u=o,o=a<<30|a>>>2,a=r,r=c}n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+o|0,n[3]=n[3]+u|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=r._createHelper(t),e.HmacSHA1=r._createHmacHelper(t)}(),function(){var e=o,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,i=4*r;n.sigBytes>i&&(n=e.finalize(n)),n.clamp();for(var a=this._oKey=n.clone(),o=this._iKey=n.clone(),u=a.words,s=o.words,l=0;l<r;l++)u[l]^=1549556828,s[l]^=909522486;a.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=o,t=e.lib,n=t.Base,r=t.WordArray,t=e.algo,i=t.HMAC,a=t.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:t.SHA1,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,a=i.create(n.hasher,e),o=r.create(),u=r.create([1]),s=o.words,l=u.words,c=n.keySize,n=n.iterations;s.length<c;){var f=a.update(t).finalize(u);a.reset();for(var p=f.words,d=p.length,h=f,m=1;m<n;m++){h=a.finalize(h),a.reset();for(var v=h.words,y=0;y<d;y++)p[y]^=v[y]}o.concat(f),l[0]++}return o.sigBytes=4*c,o}});e.PBKDF2=function(e,t,n){return a.create(n).compute(e,t)}}();var o=o||function(e,t){var n={},r=n.lib={},i=function(){},a=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-i%4*8&255)<<24-(r+i)%4*8;else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),u=n.enc={},s=u.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-r%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(n,t/2)}},l=u.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(n,t)}},c=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,a=this.blockSize,u=i/(4*a),u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0);if(t=u*a,i=e.min(4*t,i),t){for(var s=0;s<t;s+=a)this._doProcessBlock(r,s);s=r.splice(0,t),n.sigBytes-=i}return new o.init(s,i)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=f.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=n.algo={};return n}(Math);!function(){var e=o,t=e.lib,n=t.WordArray,r=t.Hasher,i=[],t=e.algo.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],a=n[1],o=n[2],u=n[3],s=n[4],l=0;80>l;l++){if(16>l)i[l]=0|e[t+l];else{var c=i[l-3]^i[l-8]^i[l-14]^i[l-16];i[l]=c<<1|c>>>31}c=(r<<5|r>>>27)+s+i[l],c=20>l?c+(1518500249+(a&o|~a&u)):40>l?c+(1859775393+(a^o^u)):60>l?c+((a&o|a&u|o&u)-1894007588):c+((a^o^u)-899497514),s=u,u=o,o=a<<30|a>>>2,a=r,r=c}n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+o|0,n[3]=n[3]+u|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=r._createHelper(t),e.HmacSHA1=r._createHmacHelper(t)}(),Object.defineProperty(r,"__esModule",{value:!0});var u,s=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=r.SFAlertManager=function(){function e(){a(this,e)}return c(e,[{key:"alert",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){window.alert(t.text),e()}));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"confirm",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){window.confirm(t.text)?e():n()}));case 1:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),p=r.SFAuthManager=function(){function e(t,n,r,i){a(this,e),e.DidSignOutEvent="DidSignOutEvent",e.WillSignInEvent="WillSignInEvent",e.DidSignInEvent="DidSignInEvent",this.httpManager=n,this.storageManager=t,this.alertManager=r||new f,this.$timeout=i||setTimeout.bind(window),this.eventHandlers=[]}return c(e,[{key:"addEventHandler",value:function(e){return this.eventHandlers.push(e),e}},{key:"removeEventHandler",value:function(e){_.pull(this.eventHandlers,e)}},{key:"notifyEvent",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=this.eventHandlers[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){(0,a.value)(e,t||{})}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}}},{key:"saveKeys",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._keys=t,e.next=3,this.storageManager.setItem("mk",t.mk);case 3:return e.next=5,this.storageManager.setItem("ak",t.ak);case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"signout",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this._keys=null,this._authParams=null,!n){t.next=6;break}return t.abrupt("return",this.storageManager.clearAllData().then(function(){r.notifyEvent(e.DidSignOutEvent)}));case 6:this.notifyEvent(e.DidSignOutEvent);case 7:case"end":return t.stop()}},t,this)}));return t}()},{key:"keys",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._keys){e.next=11;break}return e.next=3,this.storageManager.getItem("mk");case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return e.t0=t,e.next=9,this.storageManager.getItem("ak");case 9:e.t1=e.sent,this._keys={mk:e.t0,ak:e.t1};case 11:return e.abrupt("return",this._keys);case 12:case"end":return e.stop()}},e,this)}));return e}()},{key:"getAuthParams",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._authParams){e.next=5;break}return e.next=3,this.storageManager.getItem("auth_params");case 3:t=e.sent,this._authParams=JSON.parse(t);case 5:if(!this._authParams||this._authParams.version){e.next=9;break}return e.next=8,this.defaultProtocolVersion();case 8:this._authParams.version=e.sent;case 9:return e.abrupt("return",this._authParams);case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"defaultProtocolVersion",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.keys();case 2:if(!(t=e.sent)||!t.ak){e.next=7;break}return e.abrupt("return","002");case 7:return e.abrupt("return","001");case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"protocolVersion",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAuthParams();case 2:if(!(t=e.sent)||!t.version){e.next=5;break}return e.abrupt("return",t.version);case 5:return e.abrupt("return",this.defaultProtocolVersion());case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"getAuthParamsForEmail",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r){var i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,a){var o=t+"/auth/params";i.httpManager.getAbsolute(o,_.merge({email:n},r),function(t){e(t)},function(t){console.error("Error getting auth params",t),"object"!==(void 0===t?"undefined":l(t))&&(t={error:{message:"A server error occurred while trying to sign in. Please try again."}}),e(t)})}));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.locked=!1}},{key:"isLocked",value:function(){return 1==this.locked}},{key:"unlockAndResolve",value:function(e,t){this.unlock(),e(t)}},{key:"login",value:function(){function t(e,t,r,i,a){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n,r,a,o,u){var s=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=i(regeneratorRuntime.mark(function t(c,f){var p,d,h,m,v,y,g,b,k,w,x,S,E;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.keys();case 2:if(null==(p=t.sent)){t.next=6;break}return c({error:{message:"Cannot log in because already signed in."}}),t.abrupt("return");case 6:if(!s.isLocked()){t.next=9;break}return c({error:{message:"Login already in progress."}}),t.abrupt("return");case 9:return s.lock(),s.notifyEvent(e.WillSignInEvent),t.next=13,s.getAuthParamsForEmail(n,r,u);case 13:if(d=t.sent,d.identifier=r,!d.error){t.next=18;break}return s.unlockAndResolve(c,d),t.abrupt("return");case 18:if(d&&d.pw_cost){t.next=21;break}return s.unlockAndResolve(c,{error:{message:"Invalid email or password."}}),t.abrupt("return");case 21:if(SFJS.supportedVersions().includes(d.version)){t.next=25;break}return h=SFJS.isVersionNewerThanLibraryVersion(d.version)?"This version of the application does not support your newer account type. Please upgrade to the latest version of Standard Notes to sign in.":"The protocol version associated with your account is outdated and no longer supported by this application. Please visit standardnotes.org/help/security for more information.",s.unlockAndResolve(c,{error:{message:h}}),t.abrupt("return");case 25:if(!SFJS.isProtocolVersionOutdated(d.version)){t.next=32;break}return m="The encryption version for your account, "+d.version+", is outdated and requires upgrade. You may proceed with login, but are advised to perform a security update using the web or desktop application. Please visit standardnotes.org/help/security for more information.",v=!1,t.next=30,s.alertManager.confirm({title:"Update Needed",text:m,confirmButtonText:"Sign In"}).catch(function(){s.unlockAndResolve(c,{error:{}}),v=!0});case 30:if(!v){t.next=32;break}return t.abrupt("return");case 32:if(SFJS.supportsPasswordDerivationCost(d.pw_cost)){t.next=36;break}return y="Your account was created on a platform with higher security capabilities than this browser supports. If we attempted to generate your login keys here, it would take hours. Please use a browser with more up to date security capabilities, like Google Chrome or Firefox, to log in.",s.unlockAndResolve(c,{error:{message:y}}),t.abrupt("return");case 36:if(g=SFJS.costMinimumForVersion(d.version),!(d.pw_cost<g)){t.next=41;break}return b="Unable to login due to insecure password parameters. Please visit standardnotes.org/help/security for more information.",s.unlockAndResolve(c,{error:{message:b}}),t.abrupt("return");case 41:if(!o){t.next=47;break}if(k=SFJS.version(),d.version===k){t.next=47;break}return w="Strict sign in refused server sign in parameters. The latest security version is "+k+", but your account is reported to have version "+d.version+". If you'd like to proceed with sign in anyway, please disable strict sign in and try again.",s.unlockAndResolve(c,{error:{message:w}}),t.abrupt("return");case 47:return t.next=49,SFJS.crypto.computeEncryptionKeysForUser(a,d);case 49:x=t.sent,S=n+"/auth/sign_in",E=_.merge({password:x.pw,email:r},u),s.httpManager.postAbsolute(S,E,function(){var t=i(regeneratorRuntime.mark(function t(i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.handleAuthResponse(i,r,n,d,x);case 2:s.notifyEvent(e.DidSignInEvent),s.$timeout(function(){return s.unlockAndResolve(c,i)});case 4:case"end":return t.stop()}},t,s)}));return function(e){return t.apply(this,arguments)}}(),function(e){console.error("Error logging in",e),"object"!==(void 0===e?"undefined":l(e))&&(e={error:{message:"A server error occurred while trying to sign in. Please try again."}}),s.$timeout(function(){return s.unlockAndResolve(c,e)})});case 53:case"end":return t.stop()}},t,s)}));return function(e,n){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t,this)}));return t}()},{key:"register",value:function(e,t,n){var r=this;return new Promise(function(){var a=i(regeneratorRuntime.mark(function a(o,u){var s,c,f,p,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!r.isLocked()){a.next=3;break}return o({error:{message:"Register already in progress."}}),a.abrupt("return");case 3:return r.lock(),a.next=6,SFJS.crypto.generateInitialKeysAndAuthParamsForUser(t,n);case 6:s=a.sent,c=s.keys,f=s.authParams,p=e+"/auth",d=_.merge({password:c.pw,email:t},f),r.httpManager.postAbsolute(p,d,function(){var n=i(regeneratorRuntime.mark(function n(i){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.handleAuthResponse(i,t,e,f,c);case 2:r.unlockAndResolve(o,i);case 3:case"end":return n.stop()}},n,r)}));return function(e){return n.apply(this,arguments)}}(),function(e){console.error("Registration error",e),"object"!==(void 0===e?"undefined":l(e))&&(e={error:{message:"A server error occurred while trying to register. Please try again."}}),r.unlockAndResolve(o,e)});case 12:case"end":return a.stop()}},a,r)}));return function(e,t){return a.apply(this,arguments)}}())}},{key:"changePassword",value:function(){function e(e,n,r,i,a){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,a,o){var u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=i(regeneratorRuntime.mark(function e(s,c){var f,p,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!u.isLocked()){e.next=3;break}return s({error:{message:"Change password already in progress."}}),e.abrupt("return");case 3:u.lock(),f=a.pw,p=t+"/auth/change_pw",d=_.merge({new_password:f,current_password:r},o),u.httpManager.postAbsolute(p,d,function(){var e=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.handleAuthResponse(t,n,null,o,a);case 2:u.unlockAndResolve(s,t);case 3:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),function(e){"object"!==(void 0===e?"undefined":l(e))&&(e={error:{message:"Something went wrong while changing your password. Your password was not changed. Please try again."}}),u.unlockAndResolve(s,e)});case 8:case"end":return e.stop()}},e,u)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleAuthResponse",value:function(){function e(e,n,r,i,a){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=3;break}return e.next=3,this.storageManager.setItem("server",r);case 3:return this._authParams=i,e.next=6,this.storageManager.setItem("auth_params",JSON.stringify(i));case 6:return e.next=8,this.storageManager.setItem("jwt",t.token);case 8:return e.abrupt("return",this.saveKeys(a));case 9:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),d="undefined"!=typeof window?window:void 0!==e?e:null,h=r.SFHttpManager=function(){function e(t){a(this,e),this.$timeout=t||setTimeout.bind(d)}return c(e,[{key:"setJWTRequestHandler",value:function(e){this.jwtRequestHandler=e}},{key:"setAuthHeadersForRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.jwtRequestHandler();case 2:n=e.sent,n&&t.setRequestHeader("Authorization","Bearer "+n);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"postAbsolute",value:function(){function e(e,n,r,i){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.httpRequest("post",t,n,r,i));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"patchAbsolute",value:function(){function e(e,n,r,i){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.httpRequest("patch",t,n,r,i));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"getAbsolute",value:function(){function e(e,n,r,i){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.httpRequest("get",t,n,r,i));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"httpRequest",value:function(){function e(e,n,r,i,a){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,a,o){var u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=i(regeneratorRuntime.mark(function e(i,s){var l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=new XMLHttpRequest,l.onreadystatechange=function(){if(4==l.readyState){var e=l.responseText;if(e)try{e=JSON.parse(e)}catch(e){}l.status>=200&&l.status<=299?u.$timeout(function(){a(e),i(e)}):(console.error("Request error:",e),u.$timeout(function(){o(e,l.status),s(e)}))}},"get"==t&&Object.keys(r).length>0&&(n+=u.formatParams(r)),l.open(t,n,!0),e.next=6,u.setAuthHeadersForRequest(l);case 6:l.setRequestHeader("Content-type","application/json"),"post"==t||"patch"==t?l.send(JSON.stringify(r)):l.send();case 8:case"end":return e.stop()}},e,u)}));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"formatParams",value:function(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}}]),e}(),m=r.SFMigrationManager=function(){function e(t,n,r,o){var u=this;a(this,e),this.modelManager=t,this.syncManager=n,this.storageManager=r,this.completionHandlers=[],this.loadMigrations();var s=!1,l=o.addEventHandler(function(e){e==p.DidSignInEvent&&(s=!0)});this.syncManager.addEventHandler(function(){var e=i(regeneratorRuntime.mark(function e(t,n){var r,i,a,c,f,p,d,h,m,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r="local-data-loaded"==t,i="sync:completed"==t,!r&&!i){e.next=40;break}if(r?u.receivedLocalDataEvent=!0:i&&(u.receivedSyncCompletedEvent=!0),!u.receivedLocalDataEvent||!u.receivedSyncCompletedEvent){e.next=40;break}if(!s){e.next=39;break}return s=!1,o.removeEventHandler(l),e.next=10,u.getCompletedMigrations();case 10:a=e.sent.slice(),c=!0,f=!1,p=void 0,e.prev=14,d=a[Symbol.iterator]();case 16:if(c=(h=d.next()).done){e.next=25;break}return m=h.value,e.next=20,u.migrationForEncodedName(m);case 20:v=e.sent,v.runOnlyOnce||_.pull(u._completed,m);case 22:c=!0,e.next=16;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(14),f=!0,p=e.t0;case 31:e.prev=31,e.prev=32,!c&&d.return&&d.return();case 34:if(e.prev=34,!f){e.next=37;break}throw p;case 37:return e.finish(34);case 38:return e.finish(31);case 39:u.runPendingMigrations();case 40:case"end":return e.stop()}},e,u,[[14,27,31,39],[32,,34,38]])}));return function(t,n){return e.apply(this,arguments)}}())}return c(e,[{key:"addCompletionHandler",value:function(e){this.completionHandlers.push(e)}},{key:"removeCompletionHandler",value:function(e){_.pull(this.completionHandlers,e)}},{key:"migrationForEncodedName",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.decode(t);case 2:return n=e.sent,e.abrupt("return",this.migrations.find(function(e){return e.name==n}));case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"loadMigrations",value:function(){this.migrations=this.registeredMigrations()}},{key:"registeredMigrations",value:function(){}},{key:"runPendingMigrations",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r,i,a,o,u,s,l,c,f,p,d,h,m,v,y,g,b,k,w,x,S,E,C,_,T,P,I;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPendingMigrations();case 2:for(t=e.sent,n=!0,r=!1,i=void 0,e.prev=6,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)u=o.value,u.items=[];e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),r=!0,i=e.t0;case 14:e.prev=14,e.prev=15,!n&&a.return&&a.return();case 17:if(e.prev=17,!r){e.next=20;break}throw i;case 20:return e.finish(17);case 21:return e.finish(14);case 22:s=!0,l=!1,c=void 0,e.prev=25,f=this.modelManager.allNondummyItems[Symbol.iterator]();case 27:if(s=(p=f.next()).done){e.next=51;break}for(d=p.value,h=!0,m=!1,v=void 0,e.prev=32,y=t[Symbol.iterator]();!(h=(g=y.next()).done);h=!0)u=g.value,d.content_type==u.content_type&&u.items.push(d);e.next=40;break;case 36:e.prev=36,e.t1=e.catch(32),m=!0,v=e.t1;case 40:e.prev=40,e.prev=41,!h&&y.return&&y.return();case 43:if(e.prev=43,!m){e.next=46;break}throw v;case 46:return e.finish(43);case 47:return e.finish(40);case 48:s=!0,e.next=27;break;case 51:e.next=57;break;case 53:e.prev=53,e.t2=e.catch(25),l=!0,c=e.t2;case 57:e.prev=57,e.prev=58,!s&&f.return&&f.return();case 60:if(e.prev=60,!l){e.next=63;break}throw c;case 63:return e.finish(60);case 64:return e.finish(57);case 65:b=!0,k=!1,w=void 0,e.prev=68,x=t[Symbol.iterator]();case 70:if(b=(S=x.next()).done){e.next=81;break}if(u=S.value,!(u.items&&u.items.length>0||u.customHandler)){e.next=77;break}return e.next=75,this.runMigration(u,u.items);case 75:e.next=78;break;case 77:this.markMigrationCompleted(u);case 78:b=!0,e.next=70;break;case 81:e.next=87;break;case 83:e.prev=83,e.t3=e.catch(68),k=!0,w=e.t3;case 87:e.prev=87,e.prev=88,!b&&x.return&&x.return();case 90:if(e.prev=90,!k){e.next=93;break}throw w;case 93:return e.finish(90);case 94:return e.finish(87);case 95:for(E=!0,C=!1,_=void 0,e.prev=98,T=this.completionHandlers[Symbol.iterator]();!(E=(P=T.next()).done);E=!0)(I=P.value)();e.next=106;break;case 102:e.prev=102,e.t4=e.catch(98),C=!0,_=e.t4;case 106:e.prev=106,e.prev=107,!E&&T.return&&T.return();case 109:if(e.prev=109,!C){e.next=112;break}throw _;case 112:return e.finish(109);case 113:return e.finish(106);case 114:case"end":return e.stop()}},e,this,[[6,10,14,22],[15,,17,21],[25,53,57,65],[32,36,40,48],[41,,43,47],[58,,60,64],[68,83,87,95],[88,,90,94],[98,102,106,114],[107,,109,113]])}));return e}()},{key:"encode",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.btoa(t));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"decode",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.atob(t));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"getCompletedMigrations",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._completed){e.next=5;break}return e.next=3,this.storageManager.getItem("migrations");case 3:t=e.sent,this._completed=t?JSON.parse(t):[];case 5:return e.abrupt("return",this._completed);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"getPendingMigrations",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r,i,a,o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompletedMigrations();case 2:t=e.sent,n=[],r=!0,i=!1,a=void 0,e.prev=7,o=this.migrations[Symbol.iterator]();case 9:if(r=(u=o.next()).done){e.next=22;break}return s=u.value,e.t0=t,e.next=14,this.encode(s.name);case 14:if(e.t1=e.sent,e.t2=e.t0.indexOf.call(e.t0,e.t1),e.t3=-1,e.t2!=e.t3){e.next=19;break}n.push(s);case 19:r=!0,e.next=9;break;case 22:e.next=28;break;case 24:e.prev=24,e.t4=e.catch(7),i=!0,a=e.t4;case 28:e.prev=28,e.prev=29,!r&&o.return&&o.return();case 31:if(e.prev=31,!i){e.next=34;break}throw a;case 34:return e.finish(31);case 35:return e.finish(28);case 36:return e.abrupt("return",n);case 37:case"end":return e.stop()}},e,this,[[7,24,28,36],[29,,31,35]])}));return e}()},{key:"markMigrationCompleted",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCompletedMigrations();case 2:return n=e.sent,e.t0=n,e.next=6,this.encode(t.name);case 6:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),this.storageManager.setItem("migrations",JSON.stringify(n)),t.running=!1;case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"runMigration",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.running){e.next=2;break}return e.abrupt("return");case 2:if(console.log("Running migration:",t.name),t.running=!0,!t.customHandler){e.next=8;break}return e.abrupt("return",t.customHandler().then(function(){r.markMigrationCompleted(t)}));case 8:return e.abrupt("return",t.handler(n).then(function(){r.markMigrationCompleted(t)}));case 9:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),v=r.SFModelManager=function(){function e(t){a(this,e),e.MappingSourceRemoteRetrieved="MappingSourceRemoteRetrieved",e.MappingSourceRemoteSaved="MappingSourceRemoteSaved",e.MappingSourceLocalSaved="MappingSourceLocalSaved",e.MappingSourceLocalRetrieved="MappingSourceLocalRetrieved",e.MappingSourceComponentRetrieved="MappingSourceComponentRetrieved",e.MappingSourceDesktopInstalled="MappingSourceDesktopInstalled",e.MappingSourceRemoteActionRetrieved="MappingSourceRemoteActionRetrieved",e.MappingSourceFileImport="MappingSourceFileImport",e.isMappingSourceRetrieved=function(t){return[e.MappingSourceRemoteRetrieved,e.MappingSourceComponentRetrieved,e.MappingSourceRemoteActionRetrieved].includes(t)},this.$timeout=t||setTimeout.bind(window),this.itemSyncObservers=[],this.itemsPendingRemoval=[],this.items=[],this.itemsHash={},this.missedReferences={},this.uuidChangeObservers=[]}return c(e,[{key:"handleSignout",value:function(){this.items.length=0,this.itemsHash={},this.itemsPendingRemoval.length=0,this.missedReferences={}}},{key:"addModelUuidChangeObserver",value:function(e,t){this.uuidChangeObservers.push({id:e,callback:t})}},{key:"notifyObserversOfUuidChange",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=this.uuidChangeObservers[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){a.value.callback(e,t)}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}}},{key:"alternateUUIDForItem",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r,i,a,o,u,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.createItem(n,!0),t.next=3,SFJS.crypto.generateUUID();case 3:for(r.uuid=t.sent,r.informReferencesOfUUIDChange(n.uuid,r.uuid),this.informModelsOfUUIDChangeForItem(r,n.uuid,r.uuid),i=!0,a=!1,o=void 0,t.prev=9,u=n.referencingObjects[Symbol.iterator]();!(i=(s=u.next()).done);i=!0)l=s.value,l.setIsNoLongerBeingReferencedBy(n),n.setIsNoLongerBeingReferencedBy(l),l.addItemAsRelationship(r),l.setDirty(!0);t.next=17;break;case 13:t.prev=13,t.t0=t.catch(9),a=!0,o=t.t0;case 17:t.prev=17,t.prev=18,!i&&u.return&&u.return();case 20:if(t.prev=20,!a){t.next=23;break}throw o;case 23:return t.finish(20);case 24:return t.finish(17);case 25:return this.resolveReferencesForItem(r),console.log(n.uuid,"--\x3e",r.uuid),n.deleted=!0,n.content.references=[],n.setDirty(!1),this.mapResponseItemsToLocalModels([n],e.MappingSourceLocalSaved),this.addItem(r),r.setDirty(!0),this.notifyObserversOfUuidChange(n,r),t.abrupt("return",r);case 35:case"end":return t.stop()}},t,this,[[9,13,17,25],[18,,20,24]])}));return t}()},{key:"informModelsOfUUIDChangeForItem",value:function(e,t,n){var r=!0,i=!1,a=void 0;try{for(var o,u=this.items[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){o.value.potentialItemOfInterestHasChangedItsUUID(e,t,n)}}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}}},{key:"didSyncModelsOffline",value:function(t){this.notifySyncObserversOfModels(t,e.MappingSourceLocalSaved)}},{key:"mapResponseItemsToLocalModels",value:function(e,t,n){return this.mapResponseItemsToLocalModelsWithOptions({items:e,source:t,sourceKey:n})}},{key:"mapResponseItemsToLocalModelsOmittingFields",value:function(e,t,n,r){return this.mapResponseItemsToLocalModelsWithOptions({items:e,omitFields:t,source:n,sourceKey:r})}},{key:"mapResponseItemsToLocalModelsWithOptions",value:function(e){var t=e.items,n=e.omitFields,r=e.source,i=e.sourceKey,a=(e.options,[]),o=[],u=[],l=!0,c=!1,f=void 0;try{for(var p,d=t[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var h=p.value;if(h){var m=!h.content&&!h.errorDecrypting;if(!(!h.content_type||!h.uuid)&&!m||h.deleted){if(Array.isArray(n)){var v=!0,y=!1,g=void 0;try{for(var b,k=n[Symbol.iterator]();!(v=(b=k.next()).done);v=!0){delete h[b.value]}}catch(e){y=!0,g=e}finally{try{!v&&k.return&&k.return()}finally{if(y)throw g}}}var w=this.findItem(h.uuid);if(w&&(w.updateFromJSON(h),w.dummy=!1),this.itemsPendingRemoval.includes(h.uuid))_.pull(this.itemsPendingRemoval,h.uuid);else{var x=h.content_type||w&&w.content_type;if(!(this.acceptableContentTypes&&!this.acceptableContentTypes.includes(x))){var S=!1;if(1==h.deleted){if(!h.dirty){w&&(u.push(w),this.removeItemLocally(w));continue}S=!0}w||(w=this.createItem(h,!0)),this.addItem(w,S),w.errorDecrypting||u.push(w),a.push(w),o.push(h)}}}else console.error("Server response item is corrupt:",h)}}}catch(e){c=!0,f=e}finally{try{!l&&d.return&&d.return()}finally{if(c)throw f}}var E=!0,C=!1,T=void 0;try{for(var P,I=o.entries()[Symbol.iterator]();!(E=(P=I.next()).done);E=!0){var R=P.value,F=s(R,2),O=F[0],D=F[1],M=a[O];D.content&&this.resolveReferencesForItem(M),M.didFinishSyncing()}}catch(e){C=!0,T=e}finally{try{!E&&I.return&&I.return()}finally{if(C)throw T}}var N=this.popMissedReferenceStructsForObjects(o),A=!0,L=!1,j=void 0;try{for(var U,B=N[Symbol.iterator]();!(A=(U=B.next()).done);A=!0){var H=U.value;!function(e){var t=a.find(function(t){return t.uuid==e.reference_uuid});if(t){e.for_item.addItemAsRelationship(t)}}(H)}}catch(e){L=!0,j=e}finally{try{!A&&B.return&&B.return()}finally{if(L)throw j}}return this.notifySyncObserversOfModels(u,r,i),a}},{key:"missedReferenceBuildKey",value:function(e,t){return e+":"+t}},{key:"popMissedReferenceStructsForObjects",value:function(e){if(!e||0==e.length)return[];var t=[],n=[],r=e.map(function(e){return e.uuid}),i=r[0].length,a=Object.keys(this.missedReferences),o=!0,u=!1,s=void 0;try{for(var l,c=a[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;r.includes(f.substring(0,i))&&(t.push(this.missedReferences[f]),n.push(f))}}catch(e){u=!0,s=e}finally{try{!o&&c.return&&c.return()}finally{if(u)throw s}}var p=!0,d=!1,h=void 0;try{for(var m,v=n[Symbol.iterator]();!(p=(m=v.next()).done);p=!0){var y=m.value;delete this.missedReferences[y]}}catch(e){d=!0,h=e}finally{try{!p&&v.return&&v.return()}finally{if(d)throw h}}return t}},{key:"resolveReferencesForItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.errorDecrypting){var n=e.contentObject;if(e.updateLocalRelationships(),n.references){var r=n.references.slice(),i=r.map(function(e){return e.uuid}),a=this.findItems(i,!0),o=!0,u=!1,l=void 0;try{for(var c,f=a.entries()[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){var p=c.value,d=s(p,2),h=d[0],m=d[1];if(m)e.addItemAsRelationship(m),t&&m.setDirty(!0);else{var v=i[h],y=this.missedReferenceBuildKey(v,e.uuid);if(!this.missedReferences[y]){var g={reference_uuid:v,for_item:e};this.missedReferences[y]=g}}}}catch(e){u=!0,l=e}finally{try{!o&&f.return&&f.return()}finally{if(u)throw l}}}}}},{key:"notifySyncObserversOfModels",value:function(e,t,n){var r=this,i=this.itemSyncObservers.sort(function(e,t){return e.priority<t.priority?-1:1}),a=!0,o=!1,u=void 0;try{for(var s,l=i[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;!function(i){var a=i.types.includes("*")?e:e.filter(function(e){return i.types.includes(e.content_type)}),o=[],u=[],s=!0,l=!1,c=void 0;try{for(var f,p=a[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var d=f.value;d.deleted?u.push(d):o.push(d)}}catch(e){l=!0,c=e}finally{try{!s&&p.return&&p.return()}finally{if(l)throw c}}a.length>0&&r._callSyncObserverCallbackWithTimeout(i,a,o,u,t,n)}(c)}}catch(e){o=!0,u=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw u}}}},{key:"_callSyncObserverCallbackWithTimeout",value:function(e,t,n,r,i,a){this.$timeout(function(){e.callback(t,n,r,i,a)})}},{key:"createItem",value:function(t,n){var r=e.ContentTypeClassMapping&&e.ContentTypeClassMapping[t.content_type];r||(r=x);var i=new r(t);return n||this.notifySyncObserversOfModels([i],e.MappingSourceLocalSaved),i}},{key:"createConflictedItem",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,SFJS.crypto.generateUUID();case 2:return n=e.sent,t=_.merge(t,{uuid:n}),r=this.createItem(t,!0),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"addConflictedItem",value:function(e,t){this.addItem(e);var n=!0,r=!1,i=void 0;try{for(var a,o=t.referencingObjects[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;u.addItemAsRelationship(e),u.setDirty(!0)}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}this.resolveReferencesForItem(e),e.content.conflict_of=t.uuid,e.setDirty(!0)}},{key:"duplicateItem",value:function(e){var t=new e.constructor({content:e.content});t.created_at=e.created_at,t.content_type=e.content_type,this.addItem(t);var n=!0,r=!1,i=void 0;try{for(var a,o=e.referencingObjects[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;u.addItemAsRelationship(t),u.setDirty(!0)}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}return this.resolveReferencesForItem(t),t.setDirty(!0),t}},{key:"addItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.addItems([e],t)}},{key:"addItems",value:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach(function(e){t.itemsHash[e.uuid]||(t.itemsHash[e.uuid]=e,t.items.push(e))})}},{key:"addItemSyncObserver",value:function(e,t,n){this.addItemSyncObserverWithPriority({id:e,types:t,callback:n,priority:1})}},{key:"addItemSyncObserverWithPriority",value:function(e){var t=e.id,n=e.priority,r=e.types,i=e.callback;Array.isArray(r)||(r=[r]),this.itemSyncObservers.push({id:t,types:r,priority:n,callback:i})}},{key:"removeItemSyncObserver",value:function(e){_.remove(this.itemSyncObservers,_.find(this.itemSyncObservers,{id:e}))}},{key:"getDirtyItems",value:function(){return this.items.filter(function(e){return 1==e.dirty&&!e.dummy&&(!e.errorDecrypting||e.deleted)})}},{key:"clearDirtyItems",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.setDirty(!1)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}},{key:"setItemToBeDeleted",value:function(e){e.deleted=!0,e.dummy||e.setDirty(!0),this.removeAndDirtyAllRelationshipsForItem(e)}},{key:"removeAndDirtyAllRelationshipsForItem",value:function(e){if(!e.errorDecrypting){var t=!0,n=!1,r=void 0;try{for(var i,a=e.content.references[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=this.findItem(o.uuid);u&&(e.removeItemAsRelationship(u),u.hasRelationshipWithItem(e)&&(u.removeItemAsRelationship(e),u.setDirty(!0)))}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}var s=!0,l=!1,c=void 0;try{for(var f,p=e.referencingObjects[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var d=f.value;d.removeItemAsRelationship(e),d.setDirty(!0)}}catch(e){l=!0,c=e}finally{try{!s&&p.return&&p.return()}finally{if(l)throw c}}e.referencingObjects=[]}},{key:"setAllItemsDirty",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.allItems,n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){a.value.setDirty(!0,e)}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}}},{key:"removeItemLocally",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_.remove(this.items,{uuid:t.uuid}),delete this.itemsHash[t.uuid],t.isBeingRemovedLocally(),this.itemsPendingRemoval.push(t.uuid);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"allItemsMatchingTypes",value:function(e){return this.allItems.filter(function(t){return(_.includes(e,t.content_type)||_.includes(e,"*"))&&!t.dummy})}},{key:"invalidItems",value:function(){return this.allItems.filter(function(e){return e.errorDecrypting})}},{key:"validItemsForContentType",value:function(e){return this.allItems.filter(function(t){return t.content_type==e&&!t.errorDecrypting})}},{key:"findItem",value:function(e){return this.itemsHash[e]}},{key:"findItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=this.itemsHash[s];(l||t)&&n.push(l)}}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}},{key:"itemsMatchingPredicate",value:function(e){return this.itemsMatchingPredicates([e])}},{key:"itemsMatchingPredicates",value:function(e){return this.filterItemsWithPredicates(this.allItems,e)}},{key:"filterItemsWithPredicates",value:function(e,t){return e.filter(function(e){var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(!e.satisfiesPredicate(u))return!1}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}return!0})}},{key:"importItems",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r,i,a,o,u,s,l,c,f,p,d,h,m,v,y,g;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=[],i=!0,a=!1,o=void 0,t.prev=4,u=n[Symbol.iterator]();case 6:if(i=(s=u.next()).done){t.next=21;break}if(l=s.value,!(c=this.findItem(l.uuid))||c.errorDecrypting){t.next=16;break}return t.next=12,this.createConflictedItem(l);case 12:f=t.sent,l.deleted||c.isItemContentEqualWith(f)||(this.addConflictedItem(f,c),r.push(f)),t.next=18;break;case 16:r.push(l),c&&c.errorDecrypting&&(c.errorDecrypting=!1);case 18:i=!0,t.next=6;break;case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(4),a=!0,o=t.t0;case 27:t.prev=27,t.prev=28,!i&&u.return&&u.return();case 30:if(t.prev=30,!a){t.next=33;break}throw o;case 33:return t.finish(30);case 34:return t.finish(27);case 35:for(p=this.mapResponseItemsToLocalModels(r,e.MappingSourceFileImport),d=!0,h=!1,m=void 0,t.prev=39,v=p[Symbol.iterator]();!(d=(y=v.next()).done);d=!0)g=y.value,g.setDirty(!0,!0),g.deleted=!1;t.next=47;break;case 43:t.prev=43,t.t1=t.catch(39),h=!0,m=t.t1;case 47:t.prev=47,t.prev=48,!d&&v.return&&v.return();case 50:if(t.prev=50,!h){t.next=53;break}throw m;case 53:return t.finish(50);case 54:return t.finish(47);case 55:return t.abrupt("return",p);case 56:case"end":return t.stop()}},t,this,[[4,23,27,35],[28,,30,34],[39,43,47,55],[48,,50,54]])}));return t}()},{key:"getAllItemsJSONData",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getJSONDataForItems(this.allItems,t,n,r));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"getJSONDataForItems",value:function(){function e(e,n,r,i){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t.map(function(e){return new S(e,n,r).paramsForExportFile()})).then(function(e){if(i&&0==e.length)return null;var t={items:e};return n&&(t.auth_params=r),JSON.stringify(t,null,2)}));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"computeDataIntegrityHash",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.allNondummyItems.sort(function(e,t){return t.updated_at-e.updated_at}),n=t.map(function(e){return e.updatedAtTimestamp()}),r=n.join(","),e.next=6,SFJS.crypto.sha256(r);case 6:return i=e.sent,e.abrupt("return",i);case 10:return e.prev=10,e.t0=e.catch(0),console.error("Error computing data integrity hash",e.t0),e.abrupt("return",null);case 14:case"end":return e.stop()}},e,this,[[0,10]])}));return e}()},{key:"allItems",get:function(){return this.items.slice()}},{key:"allNondummyItems",get:function(){return this.items.filter(function(e){return!e.dummy})}}]),e}(),y=r.SFPrivilegesManager=function(){function e(t,n,r){a(this,e),this.modelManager=t,this.syncManager=n,this.singletonManager=r,this.loadPrivileges(),e.CredentialAccountPassword="CredentialAccountPassword",e.CredentialLocalPasscode="CredentialLocalPasscode",e.ActionManageExtensions="ActionManageExtensions",e.ActionManageBackups="ActionManageBackups",e.ActionViewProtectedNotes="ActionViewProtectedNotes",e.ActionManagePrivileges="ActionManagePrivileges",e.ActionManagePasscode="ActionManagePasscode",e.ActionDeleteNote="ActionDeleteNote",e.SessionExpiresAtKey="SessionExpiresAtKey",e.SessionLengthKey="SessionLengthKey",e.SessionLengthNone=0,e.SessionLengthFiveMinutes=300,e.SessionLengthOneHour=3600,e.SessionLengthOneWeek=604800,this.availableActions=[e.ActionViewProtectedNotes,e.ActionDeleteNote,e.ActionManagePasscode,e.ActionManageBackups,e.ActionManageExtensions,e.ActionManagePrivileges],this.availableCredentials=[e.CredentialAccountPassword,e.CredentialLocalPasscode],this.sessionLengths=[e.SessionLengthNone,e.SessionLengthFiveMinutes,e.SessionLengthOneHour,e.SessionLengthOneWeek,e.SessionLengthIndefinite]}return c(e,[{key:"setDelegate",value:function(e){this.delegate=e}},{key:"getAvailableActions",value:function(){return this.availableActions}},{key:"getAvailableCredentials",value:function(){return this.availableCredentials}},{key:"netCredentialsForAction",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r,i,a,o,u,s,l,c,f,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getPrivileges();case 2:t.t0=n,r=t.sent.getCredentialsForAction(t.t0),i=[],a=!0,o=!1,u=void 0,t.prev=8,s=r[Symbol.iterator]();case 10:if(a=(l=s.next()).done){t.next=27;break}if((c=l.value)!=e.CredentialAccountPassword){t.next=19;break}return t.next=15,this.delegate.isOffline();case 15:f=t.sent,f||i.push(c),t.next=24;break;case 19:if(c!=e.CredentialLocalPasscode){t.next=24;break}return t.next=22,this.delegate.hasLocalPasscode();case 22:p=t.sent,p&&i.push(c);case 24:a=!0,t.next=10;break;case 27:t.next=33;break;case 29:t.prev=29,t.t1=t.catch(8),o=!0,u=t.t1;case 33:t.prev=33,t.prev=34,!a&&s.return&&s.return();case 36:if(t.prev=36,!o){t.next=39;break}throw u;case 39:return t.finish(36);case 40:return t.finish(33);case 41:return t.abrupt("return",i);case 42:case"end":return t.stop()}},t,this,[[8,29,33,41],[34,,36,40]])}));return t}()},{key:"loadPrivileges",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.loadPromise){e.next=2;break}return e.abrupt("return",this.loadPromise);case 2:return this.loadPromise=new Promise(function(e,n){var r=C.contentType(),a=new E("content_type","=",r);t.singletonManager.registerSingleton([a],function(n){t.privileges=n,e(n)},function(){var n=i(regeneratorRuntime.mark(function n(i){var a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=new C({content_type:r}),SFJS.crypto.generateUUIDSync){n.next=4;break}return n.next=4,a.initUUID();case 4:t.modelManager.addItem(a),a.setDirty(!0),t.syncManager.sync(),i(a),e(a);case 9:case"end":return n.stop()}},n,t)}));return function(e){return n.apply(this,arguments)}}())}),e.abrupt("return",this.loadPromise);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"getPrivileges",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.privileges){e.next=4;break}return e.abrupt("return",this.privileges);case 4:return e.abrupt("return",this.loadPrivileges());case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"displayInfoForCredential",value:function(t){var n={};return n[e.CredentialAccountPassword]={label:"Account Password",prompt:"Please enter your account password."},n[e.CredentialLocalPasscode]={label:"Local Passcode",prompt:"Please enter your local passcode."},n[t]}},{key:"displayInfoForAction",value:function(t){var n={};return n[e.ActionManageExtensions]={label:"Manage Extensions"},n[e.ActionManageBackups]={label:"Download/Import Backups"},n[e.ActionViewProtectedNotes]={label:"View Protected Notes"},n[e.ActionManagePrivileges]={label:"Manage Privileges"},n[e.ActionManagePasscode]={label:"Manage Passcode"},n[e.ActionDeleteNote]={label:"Delete Notes"},n[t]}},{key:"getSessionLengthOptions",value:function(){return[{value:e.SessionLengthNone,label:"Don't Remember"},{value:e.SessionLengthFiveMinutes,label:"5 Minutes"},{value:e.SessionLengthOneHour,label:"1 Hour"},{value:e.SessionLengthOneWeek,label:"1 Week"}]}},{key:"setSessionLength",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=function(e){var t=new Date;return t.setSeconds(t.getSeconds()+e),t},i=r(n),t.abrupt("return",Promise.all([this.delegate.saveToStorage(e.SessionExpiresAtKey,JSON.stringify(i)),this.delegate.saveToStorage(e.SessionLengthKey,JSON.stringify(n))]));case 3:case"end":return t.stop()}},t,this)}));return t}()},{key:"clearSession",value:function(){function t(){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.setSessionLength(e.SessionLengthNone));case 1:case"end":return t.stop()}},t,this)}));return t}()},{key:"getSelectedSessionLength",value:function(){function t(){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.delegate.getFromStorage(e.SessionLengthKey);case 2:if(!(n=t.sent)){t.next=7;break}return t.abrupt("return",JSON.parse(n));case 7:return t.abrupt("return",e.SessionLengthNone);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"getSessionExpirey",value:function(){function t(){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.delegate.getFromStorage(e.SessionExpiresAtKey);case 2:if(!(n=t.sent)){t.next=7;break}return t.abrupt("return",new Date(JSON.parse(n)));case 7:return t.abrupt("return",new Date);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"actionHasPrivilegesConfigured",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netCredentialsForAction(t);case 2:return e.t0=e.sent.length,e.abrupt("return",e.t0>0);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"actionRequiresPrivilege",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSessionExpirey();case 2:if(!((n=e.sent)>new Date)){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,this.netCredentialsForAction(t);case 7:return r=e.sent,e.abrupt("return",r.length>0);case 9:case"end":return e.stop()}},e,this)}));return e}()},{key:"savePrivileges",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPrivileges();case 2:t=e.sent,t.setDirty(!0),this.syncManager.sync();case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"authenticateAction",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,u,s,l,c,f,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.netCredentialsForAction(t);case 2:r=e.sent,i=[],a=[],o=!0,u=!1,s=void 0,e.prev=7,l=r[Symbol.iterator]();case 9:if(o=(c=l.next()).done){e.next=18;break}return f=c.value,e.next=13,this._verifyAuthenticationParameters(f,n[f]);case 13:p=e.sent,p?i.push(f):a.push(f);case 15:o=!0,e.next=9;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(7),u=!0,s=e.t0;case 24:e.prev=24,e.prev=25,!o&&l.return&&l.return();case 27:if(e.prev=27,!u){e.next=30;break}throw s;case 30:return e.finish(27);case 31:return e.finish(24);case 32:return e.abrupt("return",{success:0==a.length,successfulCredentials:i,failedCredentials:a});case 33:case"end":return e.stop()}},e,this,[[7,20,24,32],[25,,27,31]])}));return e}()},{key:"_verifyAuthenticationParameters",value:function(){function t(e,t){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n,r){var a,o,u=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=function(){var e=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.delegate.verifyAccountPassword(t));case 1:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.delegate.verifyLocalPasscode(t));case 1:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}(),n!=e.CredentialAccountPassword){t.next=6;break}return t.abrupt("return",a(r));case 6:if(n!=e.CredentialLocalPasscode){t.next=8;break}return t.abrupt("return",o(r));case 8:case"end":return t.stop()}},t,this)}));return t}()}]),e}(),g=r.SFSessionHistoryManager=function(){function e(t,n,r,i,o){var u=this;a(this,e),this.modelManager=t,this.storageManager=n,this.$timeout=o||setTimeout.bind(window),this.keyRequestHandler=r,this.loadFromDisk().then(function(){u.modelManager.addItemSyncObserver("session-history",i,function(e,t,n,r,i){var a=!0,o=!1,s=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value;try{u.addHistoryEntryForItem(f)}catch(e){console.log("Caught exception while trying to add item history entry",e)}}}catch(e){o=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(o)throw s}}})})}return c(e,[{key:"encryptionParams",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.keyRequestHandler());case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"addHistoryEntryForItem",value:function(e){var t=this,n={uuid:e.uuid,content_type:e.content_type,updated_at:e.updated_at,content:e.content},r=this.historySession.addEntryForItem(n);this.autoOptimize&&this.historySession.optimizeHistoryForItem(e),r&&this.diskEnabled&&(this.diskTimeout&&(this.$timeout.hasOwnProperty("cancel")?this.$timeout.cancel(this.diskTimeout):clearTimeout(this.diskTimeout)),this.diskTimeout=this.$timeout(function(){t.saveToDisk()},2e3))}},{key:"historyForItem",value:function(e){return this.historySession.historyForItem(e)}},{key:"clearHistoryForItem",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.historySession.clearItemHistory(t),e.abrupt("return",this.saveToDisk());case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"clearAllHistory",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.historySession.clearAllHistory(),e.abrupt("return",this.storageManager.removeItem("sessionHistory_revisions"));case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"toggleDiskSaving",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.diskEnabled=!this.diskEnabled,!this.diskEnabled){e.next=6;break}this.storageManager.setItem("sessionHistory_persist",JSON.stringify(!0)),this.saveToDisk(),e.next=8;break;case 6:return this.storageManager.setItem("sessionHistory_persist",JSON.stringify(!1)),e.abrupt("return",this.storageManager.removeItem("sessionHistory_revisions"));case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"saveToDisk",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.diskEnabled){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.encryptionParams();case 4:t=e.sent,n=new S(this.historySession,t.keys,t.auth_params),n.paramsForSync().then(function(e){r.storageManager.setItem("sessionHistory_revisions",JSON.stringify(e))});case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"loadFromDisk",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storageManager.getItem("sessionHistory_persist");case 2:return t=e.sent,t&&(this.diskEnabled=JSON.parse(t)),e.next=6,this.storageManager.getItem("sessionHistory_revisions");case 6:if(!(n=e.sent)){e.next=18;break}return n=JSON.parse(n),e.next=11,this.encryptionParams();case 11:return r=e.sent,e.next=14,SFJS.itemTransformer.decryptItem(n,r.keys);case 14:i=new T(n),this.historySession=i,e.next=19;break;case 18:this.historySession=new T;case 19:return e.next=21,this.storageManager.getItem("sessionHistory_autoOptimize");case 21:a=e.sent,this.autoOptimize=!a||JSON.parse(a);case 23:case"end":return e.stop()}},e,this)}));return e}()},{key:"toggleAutoOptimize",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.autoOptimize=!this.autoOptimize,this.autoOptimize?this.storageManager.setItem("sessionHistory_autoOptimize",JSON.stringify(!0)):this.storageManager.setItem("sessionHistory_autoOptimize",JSON.stringify(!1));case 2:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),b=r.SFSingletonManager=function(){function e(t,n){var r=this;a(this,e),this.syncManager=n,this.modelManager=t,this.singletonHandlers=[],t.addItemSyncObserverWithPriority({id:"sf-singleton-manager",types:"*",priority:-1,callback:function(){r.resolveSingletons(t.allNondummyItems,null,!0)}}),n.addEventHandler(function(e,n){if("local-data-loaded"==e)r.resolveSingletons(t.allNondummyItems,null,!0),r.initialDataLoaded=!0;else if("sync:completed"==e){if(!r.initialDataLoaded)return;r.resolveSingletons(n.retrievedItems,n.savedItems)}}),t.addModelUuidChangeObserver("singleton-manager",function(e,t){var n=!0,i=!1,a=void 0;try{for(var o,u=r.singletonHandlers[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;s.singleton&&E.ItemSatisfiesPredicates(t,s.predicates)&&(s.singleton=null,r.resolveSingletons([t]))}}catch(e){i=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw a}}})}return c(e,[{key:"registerSingleton",value:function(e,t,n){this.singletonHandlers.push({predicates:e,resolutionCallback:t,createBlock:n})}},{key:"resolveSingletons",value:function(e,t,n){var r=this;e=e||[],t=t||[];var i=!0,a=!1,o=void 0;try{for(var u,s=this.singletonHandlers[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;!function(i){var a=i.predicates.slice(),o=r.modelManager.filterItemsWithPredicates(e,a),u=function(){i.createBlock&&(i.pendingCreateBlockCallback=!0,i.createBlock(function(e){i.singleton=e,i.pendingCreateBlockCallback=!1,i.resolutionCallback&&i.resolutionCallback(e)}))},s=r.modelManager.filterItemsWithPredicates(t,a).length;if(o.length>0||s>0){var l=r.modelManager.itemsMatchingPredicates(a);if(l.length>=2){var c=l.sort(function(e,t){return e.errorDecrypting?1:t.errorDecrypting?-1:e.created_at<t.created_at?-1:1}),f=c[0],p=c.slice(1,c.length),d=!0,h=!1,m=void 0;try{for(var v,y=p[Symbol.iterator]();!(d=(v=y.next()).done);d=!0){var g=v.value;r.modelManager.setItemToBeDeleted(g)}}catch(e){h=!0,m=e}finally{try{!d&&y.return&&y.return()}finally{if(h)throw m}}r.syncManager.sync(),i.singleton=f,i.resolutionCallback&&i.resolutionCallback(f)}else if(1==l.length){var b=l[0];b.errorDecrypting?(r.modelManager.setItemToBeDeleted(b),u()):i.singleton&&i.singleton===b||(i.singleton=b,i.resolutionCallback&&i.resolutionCallback(b))}}else i.singleton||n||i.pendingCreateBlockCallback||u()}(l)}}catch(e){a=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(a)throw o}}}}]),e}(),k=r.SFStorageManager=function(){function e(){a(this,e)}return c(e,[{key:"setItem",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"getItem",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"removeItem",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"clear",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"getAllModels",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"saveModel",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveModels([t]));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"saveModels",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"deleteModel",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"clearAllModels",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"clearAllData",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this.clear(),this.clearAllModels()]));case 1:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),w=r.SFSyncManager=function(){function e(t,n,r,i,o){a(this,e),e.KeyRequestLoadLocal="KeyRequestLoadLocal",e.KeyRequestSaveLocal="KeyRequestSaveLocal",e.KeyRequestLoadSaveAccount="KeyRequestLoadSaveAccount",this.httpManager=r,this.modelManager=t,this.storageManager=n,this.$interval=o||setInterval.bind(window),this.$timeout=i||setTimeout.bind(window),this.syncStatus={},this.syncStatusObservers=[],this.eventHandlers=[],this.PerSyncItemUploadLimit=100,this.MajorDataChangeThreshold=15,this.MaxDiscordanceBeforeOutOfSync=5,this.syncDiscordance=0,this.outOfSync=!1}return c(e,[{key:"handleServerIntegrityHash",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&0!=t.length){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,this.modelManager.computeDataIntegrityHash();case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",!0);case 7:if(n===t){e.next=13;break}return this.syncDiscordance++,this.syncDiscordance>=this.MaxDiscordanceBeforeOutOfSync&&(this.outOfSync||(this.outOfSync=!0,this.notifyEvent("enter-out-of-sync"))),e.abrupt("return",!1);case 13:return this.outOfSync&&(this.outOfSync=!1,this.notifyEvent("exit-out-of-sync")),this.syncDiscordance=0,e.abrupt("return",!0);case 16:case"end":return e.stop()}},e,this)}));return e}()},{key:"isOutOfSync",value:function(){return this.outOfSync}},{key:"getServerURL",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storageManager.getItem("server");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=window._default_sf_server;case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"getSyncURL",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getServerURL();case 2:return e.t0=e.sent,e.abrupt("return",e.t0+"/items/sync");case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"registerSyncStatusObserver",value:function(e){var t={key:new Date,callback:e};return this.syncStatusObservers.push(t),t}},{key:"removeSyncStatusObserver",value:function(e){_.pull(this.syncStatusObservers,e)}},{key:"syncStatusDidChange",value:function(){var e=this;this.syncStatusObservers.forEach(function(t){t.callback(e.syncStatus)})}},{key:"addEventHandler",value:function(e){return this.eventHandlers.push(e),e}},{key:"removeEventHandler",value:function(e){_.pull(this.eventHandlers,e)}},{key:"notifyEvent",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=this.eventHandlers[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){(0,a.value)(e,t||{})}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}}},{key:"setKeyRequestHandler",value:function(e){this.keyRequestHandler=e}},{key:"getActiveKeyInfo",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.keyRequestHandler(t));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"initialDataLoaded",value:function(){return this._initialDataLoaded}},{key:"loadLocalItems",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.storageManager.getAllModels().then(function(t){t=t.sort(function(e,t){var n=new Date(t.updated_at)-new Date(e.updated_at),i=r.contentTypeLoadPriority,a=0,o=0;return i&&(a=i.indexOf(e.content_type),o=i.indexOf(t.content_type),-1==a&&(a=i.length),-1==o&&(o=i.length)),a==o?n:a<o?-1:1});var o=t.length,u=0,s=[],l=function(){var c=i(regeneratorRuntime.mark(function i(){var c,f;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return c=t.slice(u,u+a),i.next=3,r.handleItemsResponse(c,null,v.MappingSourceLocalRetrieved,e.KeyRequestLoadLocal);case 3:if(f=i.sent,s.push(f),!((u+=c.length)<o)){i.next=10;break}return i.abrupt("return",new Promise(function(e,t){r.$timeout(function(){r.notifyEvent("local-data-incremental-load"),n&&n(u,o),l().then(e)})}));case 10:r.notifyEvent("local-data-loaded"),r._initialDataLoaded=!0;case 12:case"end":return i.stop()}},i,r)}));return function(){return c.apply(this,arguments)}}();return l()}));case 1:case"end":return t.stop()}},t,this)}));return t}()},{key:"writeItemsToLocalStorage",value:function(){function t(e,t){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n,r){var a=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=i(regeneratorRuntime.mark(function t(o,u){var s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=n.length){t.next=3;break}return o(),t.abrupt("return");case 3:return t.next=5,a.getActiveKeyInfo(e.KeyRequestSaveLocal);case 5:s=t.sent,Promise.all(n.map(function(){var e=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new S(t,s.keys,s.auth_params),e.next=3,n.paramsForLocalStorage();case 3:return n=e.sent,r&&delete n.dirty,e.abrupt("return",n);case 6:case"end":return e.stop()}},e,a)}));return function(t){return e.apply(this,arguments)}}())).then(function(e){a.storageManager.saveModels(e).then(function(){a.syncStatus.localError&&(a.syncStatus.localError=null,a.syncStatusDidChange()),o()}).catch(function(e){console.error("Error writing items",e),a.syncStatus.localError=e,a.syncStatusDidChange(),u()})}).catch(function(e){u(e)});case 7:case"end":return t.stop()}},t,a)}));return function(e,n){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t,this)}));return t}()},{key:"syncOffline",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,u,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=!0,r=!1,i=void 0,e.prev=3,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)u=o.value,u.updated_at=new Date;e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),r=!0,i=e.t0;case 11:e.prev=11,e.prev=12,!n&&a.return&&a.return();case 14:if(e.prev=14,!r){e.next=17;break}throw i;case 17:return e.finish(14);case 18:return e.finish(11);case 19:return e.abrupt("return",this.writeItemsToLocalStorage(t,!0).then(function(e){var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;u.deleted&&s.modelManager.removeItemLocally(u)}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}return s.notifyEvent("sync:completed",{savedItems:t}),s.modelManager.didSyncModelsOffline(t),{saved_items:t}}));case 20:case"end":return e.stop()}},e,this,[[3,7,11,19],[12,,14,18]])}));return e}()},{key:"markAllItemsDirtyAndSaveOffline",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,u,s,l,c,f,p,d,h,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.modelManager.allNondummyItems.filter(function(e){return!e.errorDecrypting}).slice(),!t){e.next=28;break}r=!0,i=!1,a=void 0,e.prev=5,o=n[Symbol.iterator]();case 7:if(r=(u=o.next()).done){e.next=14;break}return s=u.value,e.next=11,this.modelManager.alternateUUIDForItem(s);case 11:r=!0,e.next=7;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),i=!0,a=e.t0;case 20:e.prev=20,e.prev=21,!r&&o.return&&o.return();case 23:if(e.prev=23,!i){e.next=26;break}throw a;case 26:return e.finish(23);case 27:return e.finish(20);case 28:for(l=this.modelManager.allNondummyItems,c=!0,f=!1,p=void 0,e.prev=32,d=l[Symbol.iterator]();!(c=(h=d.next()).done);c=!0)m=h.value,m.setDirty(!0);e.next=40;break;case 36:e.prev=36,e.t1=e.catch(32),f=!0,p=e.t1;case 40:e.prev=40,e.prev=41,!c&&d.return&&d.return();case 43:if(e.prev=43,!f){e.next=46;break}throw p;case 46:return e.finish(43);case 47:return e.finish(40);case 48:return e.abrupt("return",this.writeItemsToLocalStorage(l,!1));case 49:case"end":return e.stop()}},e,this,[[5,16,20,28],[21,,23,27],[32,36,40,48],[41,,43,47]])}));return e}()},{key:"setSyncToken",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._syncToken=t,e.next=3,this.storageManager.setItem("syncToken",t);case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"getSyncToken",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._syncToken){e.next=4;break}return e.next=3,this.storageManager.getItem("syncToken");case 3:this._syncToken=e.sent;case 4:return e.abrupt("return",this._syncToken);case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"setCursorToken",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cursorToken=t,!t){e.next=6;break}return e.next=4,this.storageManager.setItem("cursorToken",t);case 4:e.next=8;break;case 6:return e.next=8,this.storageManager.removeItem("cursorToken");case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"getCursorToken",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cursorToken){e.next=4;break}return e.next=3,this.storageManager.getItem("cursorToken");case 3:this._cursorToken=e.sent;case 4:return e.abrupt("return",this._cursorToken);case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"clearQueuedCallbacks",value:function(){this._queuedCallbacks=[]}},{key:"callQueuedCallbacks",value:function(e){var t=this.queuedCallbacks;if(t.length){var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){(0,a.value)(e)}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}this.clearQueuedCallbacks()}}},{key:"beginCheckingIfSyncIsTakingTooLong",value:function(){this.syncStatus.checker&&this.stopCheckingIfSyncIsTakingTooLong(),this.syncStatus.checker=this.$interval(function(){(new Date-this.syncStatus.syncStart)/1e3>5&&(this.notifyEvent("sync:taking-too-long"),this.stopCheckingIfSyncIsTakingTooLong())}.bind(this),500)}},{key:"stopCheckingIfSyncIsTakingTooLong",value:function(){this.$interval.hasOwnProperty("cancel")?this.$interval.cancel(this.syncStatus.checker):clearInterval(this.syncStatus.checker),this.syncStatus.checker=null}},{key:"lockSyncing",value:function(){this.syncLocked=!0}},{key:"unlockSyncing",value:function(){this.syncLocked=!1}},{key:"sync",value:function(){function t(){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(){var n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=i(regeneratorRuntime.mark(function t(i,a){var o,u,s,l,c,f,p,d,h,m,v,y,g;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.syncLocked){t.next=4;break}return console.log("Sync Locked, Returning;"),i(),t.abrupt("return");case 4:if(r||(r={}),o=n.modelManager.getDirtyItems(),u=o.filter(function(e){return e.dirtyCount>0&&(e.dirtyCount=0,!0)}),!n.syncStatus.syncOpInProgress||r.force){t.next=14;break}return n.repeatOnCompletion=!0,n.queuedCallbacks.push(i),t.next=12,n.writeItemsToLocalStorage(u,!1);case 12:return console.log("Sync op in progress; returning."),t.abrupt("return");case 14:return t.next=16,n.getActiveKeyInfo(e.KeyRequestLoadSaveAccount);case 16:if(s=t.sent,!s.offline){t.next=20;break}return n.syncOffline(o).then(function(e){n.modelManager.clearDirtyItems(o),i(e)}).catch(function(e){n.notifyEvent("sync-exception",e)}),t.abrupt("return");case 20:return l=n.syncStatus.needsMoreSync,n.syncStatus.syncOpInProgress=!0,n.syncStatus.syncStart=new Date,n.beginCheckingIfSyncIsTakingTooLong(),c=n.PerSyncItemUploadLimit,f=o.slice(0,c),f.length<o.length?n.syncStatus.needsMoreSync=!0:n.syncStatus.needsMoreSync=!1,l||(n.syncStatus.total=o.length,n.syncStatus.current=0),n.syncStatus.current>n.syncStatus.total&&(n.syncStatus.total=n.syncStatus.current),n.syncStatusDidChange(),t.next=32,n.writeItemsToLocalStorage(u,!1);case 32:return r.onPreSyncSave&&r.onPreSyncSave(),n.allRetreivedItems||(n.allRetreivedItems=[]),n.allSavedItems||(n.allSavedItems=[]),p={},p.limit=150,r.performIntegrityCheck&&(p.compute_integrity=!0),t.prev=38,t.next=41,Promise.all(f.map(function(e){var t=new S(e,s.keys,s.auth_params);return t.additionalFields=r.additionalFields,t.paramsForSync()})).then(function(e){p.items=e});case 41:t.next=46;break;case 43:t.prev=43,t.t0=t.catch(38),n.notifyEvent("sync-exception",t.t0);case 46:for(d=!0,h=!1,m=void 0,t.prev=49,v=f[Symbol.iterator]();!(d=(y=v.next()).done);d=!0)g=y.value,g.dirtyCount=0;t.next=57;break;case 53:t.prev=53,t.t1=t.catch(49),h=!0,m=t.t1;case 57:t.prev=57,t.prev=58,!d&&v.return&&v.return();case 60:if(t.prev=60,!h){t.next=63;break}throw m;case 63:return t.finish(60);case 64:return t.finish(57);case 65:return t.next=67,n.getSyncToken();case 67:return p.sync_token=t.sent,t.next=70,n.getCursorToken();case 70:return p.cursor_token=t.sent,t.prev=71,t.t2=n.httpManager,t.next=75,n.getSyncURL();case 75:t.t3=t.sent,t.t4=p,t.t5=function(e){n.handleSyncSuccess(f,e,r).then(function(){i(e)}).catch(function(e){console.log("Caught sync success exception:",e),n.handleSyncError(null,null,o).then(function(e){i(e)})})},t.t6=function(e,t){n.handleSyncError(e,t,o).then(function(e){i(e)})},t.t2.postAbsolute.call(t.t2,t.t3,t.t4,t.t5,t.t6),t.next=85;break;case 82:t.prev=82,t.t7=t.catch(71),console.log("Sync exception caught:",t.t7);case 85:case"end":return t.stop()}},t,n,[[38,43],[49,53,57,65],[58,,60,64],[71,82]])}));return function(e,n){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t,this)}));return t}()},{key:"handleSyncSuccess",value:function(){function t(e,t,r){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n,r,i){var a,o,u,s,l,c,f,p,d,h,m,y,g,b,k=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(a=[],o=!0,u=!1,s=void 0,t.prev=4,l=n[Symbol.iterator]();!(o=(c=l.next()).done);o=!0)f=c.value,0==f.dirtyCount&&a.push(f);t.next=12;break;case 8:t.prev=8,t.t0=t.catch(4),u=!0,s=t.t0;case 12:t.prev=12,t.prev=13,!o&&l.return&&l.return();case 15:if(t.prev=15,!u){t.next=18;break}throw s;case 18:return t.finish(15);case 19:return t.finish(12);case 20:return this.modelManager.clearDirtyItems(a),this.syncStatus.error=null,p=this.allSavedItems.map(function(e){return e.uuid}),r.retrieved_items=r.retrieved_items.filter(function(e){return!p.includes(e.uuid)}),t.next=26,this.handleItemsResponse(r.retrieved_items,null,v.MappingSourceRemoteRetrieved,e.KeyRequestLoadSaveAccount);case 26:return d=t.sent,this.allRetreivedItems=this.allRetreivedItems.concat(d),this.syncStatus.retrievedCount=this.allRetreivedItems.length,h=["content","auth_hash"],t.next=32,this.handleItemsResponse(r.saved_items,h,v.MappingSourceRemoteSaved,e.KeyRequestLoadSaveAccount);case 32:return m=t.sent,this.allSavedItems=this.allSavedItems.concat(m),y=r.unsaved,t.next=37,this.handleUnsavedItemsResponse(y);case 37:return t.next=39,this.writeItemsToLocalStorage(m,!1);case 39:return t.next=41,this.writeItemsToLocalStorage(d,!1);case 41:if(this.syncStatus.syncOpInProgress=!1,this.syncStatus.current+=n.length,this.syncStatusDidChange(),this.setSyncToken(r.sync_token),this.setCursorToken(r.cursor_token),this.stopCheckingIfSyncIsTakingTooLong(),!r.integrity_hash||r.cursor_token){t.next=52;break}return t.next=50,this.handleServerIntegrityHash(r.integrity_hash);case 50:g=t.sent,g||this.syncDiscordance<this.MaxDiscordanceBeforeOutOfSync&&(this.repeatOnCompletion=!0);case 52:return t.next=54,this.getCursorToken();case 54:if(!(b=t.sent)&&!this.syncStatus.needsMoreSync){t.next=59;break}return t.abrupt("return",new Promise(function(e,t){setTimeout(function(){this.sync(i).then(e)}.bind(k),10)}));case 59:if(!this.repeatOnCompletion){t.next=64;break}return this.repeatOnCompletion=!1,t.abrupt("return",new Promise(function(e,t){setTimeout(function(){this.sync(i).then(e)}.bind(k),10)}));case 64:return this.syncStatus.retrievedCount=0,this.syncStatusDidChange(),(this.allRetreivedItems.length>=this.majorDataChangeThreshold||m.length>=this.majorDataChangeThreshold||y.length>=this.majorDataChangeThreshold)&&this.notifyEvent("major-data-change"),this.callQueuedCallbacks(r),this.notifyEvent("sync:completed",{retrievedItems:this.allRetreivedItems,savedItems:this.allSavedItems,unsavedItems:y}),this.allRetreivedItems=[],this.allSavedItems=[],t.abrupt("return",r);case 72:case"end":return t.stop()}},t,this,[[4,8,12,20],[13,,15,19]])}));return t}()},{key:"handleSyncError",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Sync error: ",t),401==n&&this.notifyEvent("sync-session-invalid"),t?"string"==typeof t&&(t={error:{message:t}}):t={error:{message:"Could not connect to server."}},this.syncStatus.syncOpInProgress=!1,this.syncStatus.error=t.error,this.syncStatusDidChange(),this.writeItemsToLocalStorage(r,!1),this.modelManager.didSyncModelsOffline(r),this.stopCheckingIfSyncIsTakingTooLong(),this.notifyEvent("sync:error",t.error),this.callQueuedCallbacks({error:"Sync error"}),e.abrupt("return",t);case 12:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleItemsResponse",value:function(){function e(e,n,r,i){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getActiveKeyInfo(i);case 2:return a=e.sent.keys,e.next=5,SFJS.itemTransformer.decryptMultipleItems(t,a);case 5:return o=this.modelManager.mapResponseItemsToLocalModelsOmittingFields(t,n,r),u=o.filter(function(e){var t=e.errorDecryptingValueChanged;return e.errorDecryptingValueChanged=!1,t}),u.length>0&&this.writeItemsToLocalStorage(u,!1),e.abrupt("return",o);case 9:case"end":return e.stop()}},e,this)}));return e}()},{key:"refreshErroredItems",value:function(){function t(){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.modelManager.allNondummyItems.filter(function(e){return 1==e.errorDecrypting}),!(n.length>0)){t.next=3;break}return t.abrupt("return",this.handleItemsResponse(n,null,v.MappingSourceLocalRetrieved,e.KeyRequestLoadSaveAccount));case 3:case"end":return t.stop()}},t,this)}));return t}()},{key:"handleUnsavedItemsResponse",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r,i,a,o,u,s,l,c,f,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=n.length){t.next=2;break}return t.abrupt("return");case 2:console.log("Handle Conflicted Items:",n),r=!0,i=!1,a=void 0,t.prev=6,o=n[Symbol.iterator]();case 8:if(r=(u=o.next()).done){t.next=35;break}return s=u.value,l=s.item,t.t0=SFJS.itemTransformer,t.t1=[l],t.next=15,this.getActiveKeyInfo(e.KeyRequestLoadSaveAccount);case 15:return t.t2=t.sent.keys,t.next=18,t.t0.decryptMultipleItems.call(t.t0,t.t1,t.t2);case 18:if(c=this.modelManager.findItem(l.uuid)){t.next=21;break}return t.abrupt("continue",32);case 21:if(f=s.error,"uuid_conflict"!==f.tag){t.next=27;break}return t.next=25,this.modelManager.alternateUUIDForItem(c);case 25:t.next=32;break;case 27:if("sync_conflict"!==f.tag){t.next=32;break}return t.next=30,this.modelManager.createConflictedItem(l);case 30:p=t.sent,l.deleted||c.isItemContentEqualWith(p)||this.modelManager.addConflictedItem(p,c);case 32:r=!0,t.next=8;break;case 35:t.next=41;break;case 37:t.prev=37,t.t3=t.catch(6),i=!0,a=t.t3;case 41:t.prev=41,t.prev=42,!r&&o.return&&o.return();case 44:if(t.prev=44,!i){t.next=47;break}throw a;case 47:return t.finish(44);case 48:return t.finish(41);case 49:this.sync(null,{additionalFields:["created_at","updated_at"]});case 50:case"end":return t.stop()}},t,this,[[6,37,41,49],[42,,44,48]])}));return t}()},{key:"stateless_downloadAllItems",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(){var r=i(regeneratorRuntime.mark(function r(a,o){var u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return u={limit:n.limit||500,sync_token:n.syncToken,cursor_token:n.cursorToken,content_type:n.contentType,event:n.event},r.prev=1,r.t0=t.httpManager,r.next=5,t.getSyncURL();case 5:r.t1=r.sent,r.t2=u,r.t3=function(){var r=i(regeneratorRuntime.mark(function r(i){var o,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.retrievedItems||(n.retrievedItems=[]),o=i.retrieved_items,r.next=4,t.getActiveKeyInfo(e.KeyRequestLoadSaveAccount);case 4:return u=r.sent.keys,r.next=7,SFJS.itemTransformer.decryptMultipleItems(o,u);case 7:n.retrievedItems=n.retrievedItems.concat(o.map(function(e){return t.modelManager.createItem(e,!0)})),n.syncToken=i.sync_token,n.cursorToken=i.cursor_token,n.cursorToken?t.stateless_downloadAllItems(n).then(a):a(n.retrievedItems);case 11:case"end":return r.stop()}},r,t)}));return function(e){return r.apply(this,arguments)}}(),r.t4=function(e,t){o(e)},r.t0.postAbsolute.call(r.t0,r.t1,r.t2,r.t3,r.t4),r.next=16;break;case 12:r.prev=12,r.t5=r.catch(1),console.log("Download all items exception caught:",r.t5),o(r.t5);case 16:case"end":return r.stop()}},r,t,[[1,12]])}));return function(e,t){return r.apply(this,arguments)}}())}},{key:"resolveOutOfSync",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.stateless_downloadAllItems({event:"resolve-out-of-sync"}).then(function(){var e=i(regeneratorRuntime.mark(function e(n){var r,i,a,o,u,s,l,c,f,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=[],i=!0,a=!1,o=void 0,e.prev=4,u=n[Symbol.iterator]();case 6:if(i=(s=u.next()).done){e.next=20;break}if(l=s.value,!(c=t.modelManager.findItem(l.uuid))){e.next=16;break}if(!(f=!l.isItemContentEqualWith(c))){e.next=16;break}return e.next=14,t.modelManager.createConflictedItem(c,c);case 14:p=e.sent,t.modelManager.addConflictedItem(p,c);case 16:r.push(l);case 17:i=!0,e.next=6;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(4),a=!0,o=e.t0;case 26:e.prev=26,e.prev=27,!i&&u.return&&u.return();case 29:if(e.prev=29,!a){e.next=32;break}throw o;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return t.modelManager.mapResponseItemsToLocalModelsWithOptions({items:r,source:v.MappingSourceRemoteRetrieved}),e.next=37,t.writeItemsToLocalStorage(t.modelManager.allNondummyItems);case 37:return e.abrupt("return",t.sync({performIntegrityCheck:!0}));case 38:case"end":return e.stop()}},e,t,[[4,22,26,34],[27,,29,33]])}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"handleSignout",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._syncToken=null,this._cursorToken=null,this._queuedCallbacks=[],this.syncStatus={};case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"clearSyncToken",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._syncToken=null,this._cursorToken=null,e.abrupt("return",this.storageManager.removeItem("syncToken"));case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"queuedCallbacks",get:function(){return this._queuedCallbacks||(this._queuedCallbacks=[]),this._queuedCallbacks}}]),e}(),x=r.SFItem=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.content={},this.referencingObjects=[],this.updateFromJSON(t),this.uuid||"undefined"!=typeof SFJS&&SFJS.crypto.generateUUIDSync&&(this.uuid=SFJS.crypto.generateUUIDSync()),"object"!==l(this.content)||this.content.references||(this.content.references=[])}return c(e,[{key:"initUUID",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.uuid){e.next=4;break}return e.next=3,SFJS.crypto.generateUUID();case 3:this.uuid=e.sent;case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"updateFromJSON",value:function(t){if(t){this.created_at=t.created_at,this.updated_at=t.updated_at,this.deleted=t.deleted,this.uuid=t.uuid,this.enc_item_key=t.enc_item_key,this.auth_hash=t.auth_hash,this.auth_params=t.auth_params;var n=["errorDecrypting","dirty","dirtyCount","dummy"],r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;void 0!==t[s]&&(this[s]=t[s])}}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}if(this.content_type||(this.content_type=t.content_type),t.errorDecrypting)this.content=t.content;else try{var l="string"==typeof t.content?JSON.parse(t.content):t.content;e.deepMerge(this.contentObject,l)}catch(e){console.log("Error while updating item from json",e)}this.created_at?(this.created_at=new Date(this.created_at),this.updated_at=new Date(this.updated_at)):(this.created_at=new Date,this.updated_at=new Date),this._client_updated_at=null,t.content?this.mapContentToLocalProperties(this.contentObject):1==t.deleted&&this.handleDeletedContent()}}},{key:"mapContentToLocalProperties",value:function(e){}},{key:"createContentJSONFromProperties",value:function(){var t=this.structureParams();return e.deepMerge(this.contentObject,t),t}},{key:"structureParams",value:function(){return this.getContentCopy()}},{key:"handleDeletedContent",value:function(){}},{key:"setDirty",value:function(e,t){this.dirty=e,this.dirtyCount||(this.dirtyCount=0),e?this.dirtyCount++:this.dirtyCount=0,e&&!t?this.client_updated_at=new Date:this.hasRawClientUpdatedAtValue()||(this.client_updated_at=new Date(this.updated_at))}},{key:"updateLocalRelationships",value:function(){}},{key:"addItemAsRelationship",value:function(e){if(e.setIsBeingReferencedBy(this),!this.hasRelationshipWithItem(e)){var t=this.content.references||[];t.push({uuid:e.uuid,content_type:e.content_type}),this.content.references=t}}},{key:"removeItemAsRelationship",value:function(e){e.setIsNoLongerBeingReferencedBy(this),this.removeReferenceWithUuid(e.uuid)}},{key:"setIsBeingReferencedBy",value:function(e){_.find(this.referencingObjects,{uuid:e.uuid})||this.referencingObjects.push(e)}},{key:"setIsNoLongerBeingReferencedBy",value:function(e){_.remove(this.referencingObjects,{uuid:e.uuid}),this.hasRelationshipWithItem(e)&&(this.removeReferenceWithUuid(e.uuid),this.setDirty(!0))}},{key:"removeReferenceWithUuid",value:function(e){var t=this.content.references||[];t=t.filter(function(t){return t.uuid!=e}),this.content.references=t}},{key:"hasRelationshipWithItem",value:function(e){return null!=this.content.references.find(function(t){return t.uuid==e.uuid})}},{key:"isBeingRemovedLocally",value:function(){}},{key:"didFinishSyncing",value:function(){}},{key:"informReferencesOfUUIDChange",value:function(e,t){}},{key:"potentialItemOfInterestHasChangedItsUUID",value:function(e,t,n){var r=!0,i=!1,a=void 0;try{for(var o,u=this.content.references[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;s.uuid==t&&(s.uuid=n,this.setDirty(!0))}}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}}},{key:"doNotEncrypt",value:function(){return!1}},{key:"setDomainDataItem",value:function(e,t,n){if(!n)return void console.error("SFItem.AppDomain needs to be set.");if(!this.errorDecrypting){this.content.appData||(this.content.appData={});var r=this.content.appData[n];r||(r={}),r[e]=t,this.content.appData[n]=r}}},{key:"getDomainDataItem",value:function(e,t){if(!t)return void console.error("SFItem.AppDomain needs to be set.");if(!this.errorDecrypting){this.content.appData||(this.content.appData={});var n=this.content.appData[t];return n?n[e]:null}}},{key:"setAppDataItem",value:function(t,n){this.setDomainDataItem(t,n,e.AppDomain)}},{key:"getAppDataItem",value:function(t){return this.getDomainDataItem(t,e.AppDomain)}},{key:"hasRawClientUpdatedAtValue",value:function(){return null!=this.getAppDataItem("client_updated_at")}},{key:"keysToIgnoreWhenCheckingContentEquality",value:function(){return[]}},{key:"appDataKeysToIgnoreWhenCheckingContentEquality",value:function(){return["client_updated_at"]}},{key:"getContentCopy",value:function(){return JSON.parse(JSON.stringify(this.content))}},{key:"isItemContentEqualWith",value:function(t){var n=function(e,t){if(!e)return e;var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){delete e[a.value]}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}return e},r=this.getContentCopy();r.appData&&n(r.appData[e.AppDomain],this.appDataKeysToIgnoreWhenCheckingContentEquality()),r=n(r,this.keysToIgnoreWhenCheckingContentEquality());var i=t.getContentCopy();return i.appData&&n(i.appData[e.AppDomain],t.appDataKeysToIgnoreWhenCheckingContentEquality()),i=n(i,t.keysToIgnoreWhenCheckingContentEquality()),JSON.stringify(r)===JSON.stringify(i)}},{key:"satisfiesPredicate",value:function(e){return E.ItemSatisfiesPredicate(this,e)}},{key:"createdAtString",value:function(){return this.dateToLocalizedString(this.created_at)}},{key:"updatedAtString",value:function(){return this.dateToLocalizedString(this.client_updated_at)}},{key:"updatedAtTimestamp",value:function(){return this.updated_at.getTime()}},{key:"dateToLocalizedString",value:function(e){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){if(!u){var t=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language;u=new Intl.DateTimeFormat(t,{year:"numeric",month:"short",day:"2-digit",weekday:"long",hour:"2-digit",minute:"2-digit"})}return u.format(e)}return e.toDateString()+" "+e.toLocaleTimeString()}},{key:"contentObject",get:function(){if(this.errorDecrypting)return this.content;if(!this.content)return this.content={},this.content;if(null!==this.content&&"object"===l(this.content))return this.content;try{var e=JSON.parse(this.content);return this.content=e,this.content}catch(e){return console.log("Error parsing json",e,this),this.content={},this.content}}},{key:"pinned",get:function(){return this.getAppDataItem("pinned")}},{key:"archived",get:function(){return this.getAppDataItem("archived")}},{key:"locked",get:function(){return this.getAppDataItem("locked")}},{key:"displayName",get:function(){return"Item"}},{key:"client_updated_at",get:function(){if(!this._client_updated_at){var e=this.getAppDataItem("client_updated_at");this._client_updated_at=e?new Date(e):new Date(this.updated_at)}return this._client_updated_at},set:function(e){this._client_updated_at=e,this.setAppDataItem("client_updated_at",e)}}],[{key:"deepMerge",value:function(e,t){function n(e,t){if(_.isArray(e))return t}return _.mergeWith(e,t,n),e}}]),e}(),S=r.SFItemParams=function(){function e(t,n,r){if(a(this,e),this.item=t,this.keys=n,this.auth_params=r,this.keys&&!this.auth_params)throw"SFItemParams.auth_params must be supplied if supplying keys.";if(this.auth_params&&!this.auth_params.version)throw"SFItemParams.auth_params is missing version"}return c(e,[{key:"paramsForExportFile",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.additionalFields=["updated_at"],this.forExportFile=!0,!t){e.next=6;break}return e.abrupt("return",this.__params());case 6:return e.next=8,this.__params();case 8:return n=e.sent,e.abrupt("return",_.omit(n,["deleted"]));case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"paramsForExtension",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.paramsForExportFile());case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"paramsForLocalStorage",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.additionalFields=["updated_at","dirty","errorDecrypting"],this.forExportFile=!0,e.abrupt("return",this.__params());case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"paramsForSync",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.__params());case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"__params",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={uuid:this.item.uuid,content_type:this.item.content_type,deleted:this.item.deleted,created_at:this.item.created_at},this.item.errorDecrypting){e.next=23;break}if(n=this.item.doNotEncrypt()&&!this.forExportFile,!this.keys||n){e.next=11;break}return e.next=6,SFJS.itemTransformer.encryptItem(this.item,this.keys,this.auth_params);case 6:r=e.sent,_.merge(t,r),"001"!==this.auth_params.version&&(t.auth_hash=null),e.next=21;break;case 11:if(!this.forExportFile){e.next=15;break}e.t0=this.item.createContentJSONFromProperties(),e.next=19;break;case 15:return e.next=17,SFJS.crypto.base64(JSON.stringify(this.item.createContentJSONFromProperties()));case 17:e.t1=e.sent,e.t0="000"+e.t1;case 19:t.content=e.t0,this.forExportFile||(t.enc_item_key=null,t.auth_hash=null);case 21:e.next=26;break;case 23:t.content=this.item.content,t.enc_item_key=this.item.enc_item_key,t.auth_hash=this.item.auth_hash;case 26:return this.additionalFields&&_.merge(t,_.pick(this.item,this.additionalFields)),e.abrupt("return",t);case 28:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),E=r.SFPredicate=function(){function e(t,n,r){a(this,e),this.keypath=t,this.operator=n,this.value=r,e.IsRecursiveOperator(this.operator)&&(this.value=this.value.map(e.fromArray))}return c(e,null,[{key:"fromArray",value:function(t){return new e(t[0],t[1],t[2])}},{key:"ObjectSatisfiesPredicate",value:function(t,n){if(Array.isArray(n)&&(n=this.fromArray(n)),e.IsRecursiveOperator(n.operator)){if("and"===n.operator){var r=!0,i=!1,a=void 0;try{for(var o,u=n.value[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(!this.ObjectSatisfiesPredicate(t,s))return!1}}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return!0}if("or"===n.operator){var l=!0,c=!1,f=void 0;try{for(var p,d=n.value[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var s=p.value;if(this.ObjectSatisfiesPredicate(t,s))return!0}}catch(e){c=!0,f=e}finally{try{!l&&d.return&&d.return()}finally{if(c)throw f}}return!1}}var h=n.value;"string"==typeof h&&h.includes(".ago")&&(h=this.DateFromString(h));var m=n.keypath.split(".").reduce(function(e,t){return e&&e[t]},t),v=[!1,"",null,void 0,NaN];if(void 0==m)return"!="==n.operator?!v.includes(n.value):v.includes(n.value);if("="==n.operator)return Array.isArray(m)?JSON.stringify(m)==JSON.stringify(h):m==h;if("!="==n.operator)return Array.isArray(m)?JSON.stringify(m)!=JSON.stringify(h):m!==h;if("<"==n.operator)return m<h;if(">"==n.operator)return m>h;if("<="==n.operator)return m<=h;if(">="==n.operator)return m>=h;if("startsWith"==n.operator)return m.startsWith(h);if("in"==n.operator)return-1!=h.indexOf(m);if("includes"==n.operator)return this.resolveIncludesPredicate(m,h);if("matches"==n.operator){return new RegExp(h).test(m)}return!1}},{key:"resolveIncludesPredicate",value:function(t,n){if("string"==typeof n)return t.includes(n);var r;r=Array.isArray(n)?e.fromArray(n):n;var i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;if(this.ObjectSatisfiesPredicate(l,r))return!0}}catch(e){a=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(a)throw o}}return!1}},{key:"ItemSatisfiesPredicate",value:function(t,n){return Array.isArray(n)&&(n=e.fromArray(n)),this.ObjectSatisfiesPredicate(t,n)}},{key:"ItemSatisfiesPredicates",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(!this.ItemSatisfiesPredicate(e,u))return!1}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}return!0}},{key:"DateFromString",value:function(e){var t=e.split("."),n=t[1],r=new Date,i=parseInt(t[0]);return"days"==n?r.setDate(r.getDate()-i):"hours"==n&&r.setHours(r.getHours()-i),r}},{key:"IsRecursiveOperator",value:function(e){return["and","or"].includes(e)}}]),e}(),C=r.SFPrivileges=function(e){function r(e){a(this,r);var n=t(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return n.content.desktopPrivileges||(n.content.desktopPrivileges={}),n}return n(r,e),c(r,null,[{key:"contentType",value:function(){return"SN|Privileges"}}]),c(r,[{key:"setCredentialsForAction",value:function(e,t){this.content.desktopPrivileges[e]=t}},{key:"getCredentialsForAction",value:function(e){return this.content.desktopPrivileges[e]||[]}},{key:"toggleCredentialForAction",value:function(e,t){this.isCredentialRequiredForAction(e,t)?this.removeCredentialForAction(e,t):this.addCredentialForAction(e,t)}},{key:"removeCredentialForAction",value:function(e,t){_.pull(this.content.desktopPrivileges[e],t)}},{key:"addCredentialForAction",value:function(e,t){var n=this.getCredentialsForAction(e);n.push(t),this.setCredentialsForAction(e,n)}},{key:"isCredentialRequiredForAction",value:function(e,t){return this.getCredentialsForAction(e).includes(t)}}]),r}(x),T=r.SFHistorySession=function(e){function r(e){a(this,r);var n=t(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return n.content.itemUUIDToItemHistoryMapping||(n.content.itemUUIDToItemHistoryMapping={}),Object.keys(n.content.itemUUIDToItemHistoryMapping).forEach(function(e){var t=n.content.itemUUIDToItemHistoryMapping[e];n.content.itemUUIDToItemHistoryMapping[e]=new P(t)}),n}return n(r,e),c(r,[{key:"addEntryForItem",value:function(e){return this.historyForItem(e).addHistoryEntryForItem(e)}},{key:"historyForItem",value:function(e){var t=this.content.itemUUIDToItemHistoryMapping[e.uuid];return t||(t=this.content.itemUUIDToItemHistoryMapping[e.uuid]=new P),t}},{key:"clearItemHistory",value:function(e){this.historyForItem(e).clear()}},{key:"clearAllHistory",value:function(){this.content.itemUUIDToItemHistoryMapping={}}},{key:"optimizeHistoryForItem",value:function(e){var t=this.historyForItem(e);t.entries.length>r.LargeItemEntryAmountThreshold&&t.optimize()}}]),r}(x);T.LargeItemEntryAmountThreshold=60;var P=r.SFItemHistory=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(a(this,e),this.entries||(this.entries=[]),t.entries){var n=!0,r=!1,i=void 0;try{for(var o,u=t.entries[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value,l=this.createEntryForItem(s.item);l.setPreviousEntry(this.getLastEntry()),this.entries.push(l)}}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}}}return c(e,[{key:"createEntryForItem",value:function(t){var n=e.HistoryEntryClassMapping&&e.HistoryEntryClassMapping[t.content_type];return n||(n=I),new n(t)}},{key:"getLastEntry",value:function(){return this.entries[this.entries.length-1]}},{key:"addHistoryEntryForItem",value:function(e){var t=this.createEntryForItem(e),n=this.getLastEntry();if(t.setPreviousEntry(n),!t.isSameAsEntry(n))return this.entries.push(t),t}},{key:"clear",value:function(){this.entries.length=0}},{key:"optimize",value:function(){var t=this,n=[],r=function(t){return t.deltaSize()>e.LargeEntryDeltaThreshold},i=function(e,i,a){if(a)n.push(e);else{var i=n.indexOf(e);-1!==i&&n.splice(i,1)}if(a&&r(e)&&-1==e.operationVector()){var o=t.entries[i-1];o&&n.push(o)}};this.entries.forEach(function(e,n){if(0==n||n==t.entries.length-1)i(e,n,!0);else{var a=r(e);i(e,n,a)}}),this.entries=this.entries.filter(function(e,t){return-1!==n.indexOf(e)})}}]),e}();P.LargeEntryDeltaThreshold=15;var I=r.SFItemHistoryEntry=function(){function e(t){a(this,e),this.item=x.deepMerge({},t),this.defaultContentKeyToDiffOn="text",this.textCharDiffLength=0,"string"==typeof this.item.updated_at&&(this.item.updated_at=new Date(this.item.updated_at))}return c(e,[{key:"setPreviousEntry",value:function(e){this.hasPreviousEntry=null!=e,this.item.content[this.defaultContentKeyToDiffOn]&&(this.textCharDiffLength=e?this.item.content[this.defaultContentKeyToDiffOn].length-e.item.content[this.defaultContentKeyToDiffOn].length:this.item.content[this.defaultContentKeyToDiffOn].length)}},{key:"operationVector",value:function(){return void 0!=this.textCharDiffLength?this.hasPreviousEntry&&0!=this.textCharDiffLength?this.textCharDiffLength<0?-1:1:0:1}},{key:"deltaSize",value:function(){return void 0!=this.textCharDiffLength?Math.abs(this.textCharDiffLength):1}},{key:"isSameAsEntry",value:function(e){if(!e)return!1;var t=new x(this.item),n=new x(e.item);return t.isItemContentEqualWith(n)}}]),e}(),d="undefined"!=typeof window?window:void 0!==e?e:null,R=r.SFAbstractCrypto=function(){function e(){a(this,e),this.DefaultPBKDF2Length=768}return c(e,[{key:"generateUUIDSync",value:function(){var e=d.crypto||d.msCrypto;if(e){var t=new Uint32Array(4);e.getRandomValues(t);var n=-1;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){n++;var r=t[n>>3]>>n%8*4&15;return("x"==e?r:3&r|8).toString(16)})}var r=(new Date).getTime();return d.performance&&"function"==typeof d.performance.now&&(r+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==e?t:3&t|8).toString(16)})}},{key:"generateUUID",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.generateUUIDSync());case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"decryptText",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=a.ciphertextToAuth,s=a.contentCiphertext,l=a.encryptionKey,c=a.iv,f=a.authHash,p=a.authKey,d=arguments[1];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!d||f){e.next=3;break}return console.error("Auth hash is required."),e.abrupt("return");case 3:if(!f){e.next=10;break}return e.next=6,this.hmac256(u,p);case 6:if(t=e.sent,f===t){e.next=10;break}return console.error("Auth hash does not match, returning null."),e.abrupt("return",null);case 10:return n=o.enc.Hex.parse(l),r=o.enc.Hex.parse(c||""),i=o.AES.decrypt(s,n,{iv:r,mode:o.mode.CBC,padding:o.pad.Pkcs7}),e.abrupt("return",i.toString(o.enc.Utf8));case 14:case"end":return e.stop()}},e,this)}));return e}()},{key:"encryptText",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r){var i,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.enc.Hex.parse(n),a=o.enc.Hex.parse(r||""),u=o.AES.encrypt(t,i,{iv:a,mode:o.mode.CBC,padding:o.pad.Pkcs7}),e.abrupt("return",u.toString());case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"generateRandomKey",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.lib.WordArray.random(t/8).toString());case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"generateItemEncryptionKey",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=512,n=1,e.next=4,this.generateRandomKey(t);case 4:return r=e.sent,e.next=7,this.generateRandomKey(t);case 7:return i=e.sent,e.abrupt("return",this.pbkdf2(i,r,n,t));case 9:case"end":return e.stop()}},e,this)}));return e}()},{key:"firstHalfOfKey",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.substring(0,t.length/2));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"secondHalfOfKey",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.substring(t.length/2,t.length));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"base64",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d.btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)})));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"base64Decode",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d.atob(t));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"sha256",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.SHA256(t).toString());case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"hmac256",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.enc.Hex.parse(n),i=o.enc.Utf8.parse(t),a=o.HmacSHA256(i,r).toString(),e.abrupt("return",a);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"generateSalt",value:function(){function e(e,n,r,i){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sha256([t,"SF",n,r,i].join(":"));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"generateSymmetricKeyPair",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r,i,a,o,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=u.password,l=u.pw_salt,c=u.pw_cost;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pbkdf2(s,l,c,this.DefaultPBKDF2Length);case 2:return t=e.sent,n=t.length,r=n/3,i=t.slice(0,r),a=t.slice(r,2*r),o=t.slice(2*r,3*r),e.abrupt("return",[i,a,o]);case 9:case"end":return e.stop()}},e,this)}));return e}()},{key:"computeEncryptionKeysForUser",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("003"!=n.version){e.next=9;break}if(n.identifier){e.next=4;break}return console.error("authParams is missing identifier."),e.abrupt("return");case 4:return e.next=6,this.generateSalt(n.identifier,n.version,n.pw_cost,n.pw_nonce);case 6:r=e.sent,e.next=10;break;case 9:r=n.pw_salt;case 10:return e.abrupt("return",this.generateSymmetricKeyPair({password:t,pw_salt:r,pw_cost:n.pw_cost}).then(function(e){return{pw:e[0],mk:e[1],ak:e[2]}}));case 11:case"end":return e.stop()}},e,this)}));return e}()},{key:"generateInitialKeysAndAuthParamsForUser",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.SFJS.version,i=this.SFJS.defaultPasswordGenerationCost,e.next=4,this.generateRandomKey(256);case 4:return a=e.sent,e.next=7,this.generateSalt(t,r,i,a);case 7:return o=e.sent,e.abrupt("return",this.generateSymmetricKeyPair({password:n,pw_salt:o,pw_cost:i}).then(function(e){var n={pw_nonce:a,pw_cost:i,identifier:t,version:r};return{keys:{pw:e[0],mk:e[1],ak:e[2]},authParams:n}}));case 9:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),F=r.SFCryptoJS=function(e){function r(){return a(this,r),t(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return n(r,e),c(r,[{key:"pbkdf2",value:function(){function e(e,n,r,i){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={keySize:i/32,hasher:o.algo.SHA512,iterations:r},e.abrupt("return",o.PBKDF2(t,n,a).toString());case 2:case"end":return e.stop()}},e,this)}));return e}()}]),r}(R),d="undefined"!=typeof window?window:void 0!==e?e:null,O=d.crypto?d.crypto.subtle:null,D=r.SFCryptoWeb=function(e){function r(){return a(this,r),t(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return n(r,e),c(r,[{key:"pbkdf2",value:function(){function e(e,n,r,i){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.webCryptoImportKey(t,"PBKDF2",["deriveBits"]);case 2:if(a=e.sent){e.next=6;break}return console.log("Key is null, unable to continue"),e.abrupt("return",null);case 6:return e.abrupt("return",this.webCryptoDeriveBits(a,n,r,i));case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"generateRandomKey",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!0,e.abrupt("return",O.generateKey({name:"AES-CBC",length:t},n,["encrypt","decrypt"]).then(function(e){return O.exportKey("raw",e).then(function(){var e=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.arrayBufferToHexString(new Uint8Array(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.error("Error exporting key",e)})}).catch(function(e){console.error("Error generating key",e)}));case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"generateItemEncryptionKey",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=256,e.abrupt("return",Promise.all([this.generateRandomKey(t),this.generateRandomKey(t)]).then(function(e){return e.join("")}));case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"encryptText",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r){var a,o,u,s,l,c=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return e.next=3,this.hexStringToArrayBuffer(r);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=new ArrayBuffer(16);case 7:return a=e.t0,o={name:"AES-CBC",iv:a},e.next=11,this.hexStringToArrayBuffer(n);case 11:return u=e.sent,e.next=14,this.webCryptoImportKey(u,o.name,["encrypt"]);case 14:return s=e.sent,e.next=17,this.stringToArrayBuffer(t);case 17:return l=e.sent,e.abrupt("return",crypto.subtle.encrypt(o,s,l).then(function(){var e=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.arrayBufferToBase64(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,c)}));return function(t){return e.apply(this,arguments)}}()));case 19:case"end":return e.stop()}},e,this)}));return e}()},{key:"decryptText",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r,a,o,u,s=this,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=l.ciphertextToAuth,f=l.contentCiphertext,p=l.encryptionKey,d=l.iv,h=l.authHash,m=l.authKey,v=arguments[1];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!v||h){e.next=3;break}return console.error("Auth hash is required."),e.abrupt("return");case 3:if(!h){e.next=10;break}return e.next=6,this.hmac256(c,m);case 6:if(t=e.sent,h===t){e.next=10;break}return console.error("Auth hash does not match, returning null. "+h+" != "+t),e.abrupt("return",null);case 10:if(!d){e.next=16;break}return e.next=13,this.hexStringToArrayBuffer(d);case 13:e.t0=e.sent,e.next=17;break;case 16:e.t0=new ArrayBuffer(16);case 17:return n=e.t0,r={name:"AES-CBC",iv:n},e.next=21,this.hexStringToArrayBuffer(p);case 21:return a=e.sent,e.next=24,this.webCryptoImportKey(a,r.name,["decrypt"]);case 24:return o=e.sent,e.next=27,this.base64ToArrayBuffer(f);case 27:return u=e.sent,e.abrupt("return",crypto.subtle.decrypt(r,o,u).then(function(){var e=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.arrayBufferToString(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,s)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.error("Error decrypting:",e)}));case 29:case"end":return e.stop()}},e,this)}));return e}()},{key:"webCryptoImportKey",value:function(){function e(e,n,r,i){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=6;break}return e.next=3,this.stringToArrayBuffer(t);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=t;case 7:return a=e.t0,e.abrupt("return",O.importKey("raw",a,{name:n,hash:i},!1,r).then(function(e){return e}).catch(function(e){return console.error(e),null}));case 9:case"end":return e.stop()}},e,this)}));return e}()},{key:"webCryptoDeriveBits",value:function(){function e(e,n,r,i){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,a){var o,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.stringToArrayBuffer(n);case 2:return e.t0=e.sent,e.t1=r,e.t2={name:"SHA-512"},o={name:"PBKDF2",salt:e.t0,iterations:e.t1,hash:e.t2},e.abrupt("return",O.deriveBits(o,t,a).then(function(){var e=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.arrayBufferToHexString(new Uint8Array(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){return console.error(e),null}));case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"stringToArrayBuffer",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){var r=new Blob([t]),i=new FileReader;i.onload=function(t){e(t.target.result)},i.readAsArrayBuffer(r)}));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"arrayBufferToString",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){var r=new Blob([t]),i=new FileReader;i.onload=function(t){e(t.target.result)},i.readAsText(r)}));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"arrayBufferToHexString",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=new Uint8Array(t),r="",a=0;a<n.byteLength;a++)i=n[a].toString(16),i.length<2&&(i="0"+i),r+=i;return e.abrupt("return",r);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"hexStringToArrayBuffer",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=[],r=0;r<t.length;r+=2)n.push(parseInt(t.substr(r,2),16));return e.abrupt("return",new Uint8Array(n));case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"base64ToArrayBuffer",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.base64Decode(t);case 2:for(n=e.sent,r=n.length,i=new Uint8Array(r),a=0;a<r;a++)i[a]=n.charCodeAt(a);return e.abrupt("return",i.buffer);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"arrayBufferToBase64",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){var r=new Blob([t],{type:"application/octet-binary"}),i=new FileReader;i.onload=function(t){var n=t.target.result;e(n.substr(n.indexOf(",")+1))},i.readAsDataURL(r)}));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"hmac256",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){var r,a,o,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.hexStringToArrayBuffer(n);case 2:return r=e.sent,e.next=5,this.webCryptoImportKey(r,"HMAC",["sign"],{name:"SHA-256"});case 5:return a=e.sent,e.next=8,this.stringToArrayBuffer(t);case 8:return o=e.sent,e.abrupt("return",crypto.subtle.sign({name:"HMAC"},a,o).then(function(){var e=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.arrayBufferToHexString(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,u)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.error("Error computing hmac",e)}));case 10:case"end":return e.stop()}},e,this)}));return e}()}]),r}(R),M=r.SFItemTransformer=function(){function e(t){a(this,e),this.crypto=t}return c(e,[{key:"_private_encryptString",value:function(){function e(e,n,r,i,a){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,u,s,l,c,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("001"!==a.version){e.next=7;break}return e.next=3,this.crypto.encryptText(t,n,null);case 3:u=e.sent,o=a.version+u,e.next=21;break;case 7:return e.next=9,this.crypto.generateRandomKey(128);case 9:return s=e.sent,e.next=12,this.crypto.encryptText(t,n,s);case 12:return u=e.sent,l=[a.version,i,s,u].join(":"),e.next=16,this.crypto.hmac256(l,r);case 16:return c=e.sent,e.next=19,this.crypto.base64(JSON.stringify(a));case 19:f=e.sent,o=[a.version,c,i,s,u,f].join(":");case 21:return e.abrupt("return",o);case 22:case"end":return e.stop()}},e,this)}));return e}()},{key:"encryptItem",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,u,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={},e.next=3,this.crypto.generateItemEncryptionKey();case 3:if(a=e.sent,"001"!==r.version){e.next=10;break}return e.next=7,this.crypto.encryptText(a,n.mk,null);case 7:i.enc_item_key=e.sent,e.next=13;break;case 10:return e.next=12,this._private_encryptString(a,n.mk,n.ak,t.uuid,r);case 12:i.enc_item_key=e.sent;case 13:return e.next=15,this.crypto.firstHalfOfKey(a);case 15:return o=e.sent,e.next=18,this.crypto.secondHalfOfKey(a);case 18:return u=e.sent,e.next=21,this._private_encryptString(JSON.stringify(t.createContentJSONFromProperties()),o,u,t.uuid,r);case 21:if(s=e.sent,"001"!==r.version){e.next=27;break}return e.next=25,this.crypto.hmac256(s,u);case 25:l=e.sent,i.auth_hash=l;case 27:return i.content=s,e.abrupt("return",i);case 29:case"end":return e.stop()}},e,this)}));return e}()},{key:"encryptionComponentsFromString",value:function(e,t,n){var r=e.substring(0,3);if("001"===r)return{contentCiphertext:e.substring(3,e.length),encryptionVersion:r,ciphertextToAuth:e,iv:null,authHash:null,encryptionKey:t,authKey:n};var i=e.split(":");return{encryptionVersion:i[0],authHash:i[1],uuid:i[2],iv:i[3],contentCiphertext:i[4],authParams:i[5],ciphertextToAuth:[i[0],i[2],i[3],i[4]].join(":"),encryptionKey:t,authKey:n}}},{key:"decryptItem",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,u,s,l,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t.content){e.next=2;break}return e.abrupt("return");case 2:if(!t.content.startsWith("000")){e.next=14;break}return e.prev=3,e.t0=JSON,e.next=7,this.crypto.base64Decode(t.content.substring(3,t.content.length));case 7:e.t1=e.sent,t.content=e.t0.parse.call(e.t0,e.t1),e.next=13;break;case 11:e.prev=11,e.t2=e.catch(3);case 13:return e.abrupt("return");case 14:if(t.enc_item_key){e.next=17;break}return console.log("Missing item encryption key, skipping decryption."),e.abrupt("return");case 17:if(r=t.enc_item_key,i=!0,r.startsWith("002")||r.startsWith("003")||(r="001"+r,i=!1),a=this.encryptionComponentsFromString(r,n.mk,n.ak),!a.uuid||a.uuid===t.uuid){e.next=26;break}return console.error("Item key params UUID does not match item UUID"),t.errorDecrypting||(t.errorDecryptingValueChanged=!0),t.errorDecrypting=!0,e.abrupt("return");case 26:return e.next=28,this.crypto.decryptText(a,i);case 28:if(o=e.sent){e.next=34;break}return console.log("Error decrypting item",t),t.errorDecrypting||(t.errorDecryptingValueChanged=!0),t.errorDecrypting=!0,e.abrupt("return");case 34:return e.next=36,this.crypto.firstHalfOfKey(o);case 36:return u=e.sent,e.next=39,this.crypto.secondHalfOfKey(o);case 39:return s=e.sent,l=this.encryptionComponentsFromString(t.content,u,s),e.prev=41,e.t3=JSON,e.next=45,this.crypto.base64Decode(l.authParams);case 45:e.t4=e.sent,t.auth_params=e.t3.parse.call(e.t3,e.t4),e.next=51;break;case 49:e.prev=49,e.t5=e.catch(41);case 51:if(!l.uuid||l.uuid===t.uuid){e.next=55;break}return t.errorDecrypting||(t.errorDecryptingValueChanged=!0),t.errorDecrypting=!0,e.abrupt("return");case 55:return l.authHash||(l.authHash=t.auth_hash),e.next=58,this.crypto.decryptText(l,!0);case 58:c=e.sent,c?(1==t.errorDecrypting&&(t.errorDecryptingValueChanged=!0),t.errorDecrypting=!1,t.content=c):(t.errorDecrypting||(t.errorDecryptingValueChanged=!0),t.errorDecrypting=!0);case 60:case"end":return e.stop()}},e,this,[[3,11],[41,49]])}));return e}()},{key:"decryptMultipleItems",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r){var a,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){var e=i(regeneratorRuntime.mark(function e(t){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(1!=t.deleted||null!=t.content){e.next=4;break}return e.abrupt("return");case 4:if(!(i="string"==typeof t.content||t.content instanceof String)){e.next=19;break}return e.prev=6,e.next=9,o.decryptItem(t,n);case 9:e.next=19;break;case 11:if(e.prev=11,e.t0=e.catch(6),t.errorDecrypting||(t.errorDecryptingValueChanged=!0),t.errorDecrypting=!0,!r){e.next=17;break}throw e.t0;case 17:return console.error("Error decrypting item",t,e.t0),e.abrupt("return");case 19:case"end":return e.stop()}},e,o,[[6,11]])}));return function(t){return e.apply(this,arguments)}}(),e.abrupt("return",Promise.all(t.map(function(e){return a(e)})));case 2:case"end":return e.stop()}},e,this)}));return e}()}]),e}(),d="undefined"!=typeof window?window:void 0!==e?e:null,N=r.StandardFile=function(){function e(t){if(a(this,e),d){!("undefined"!=typeof document&&document.documentMode||/Edge/.test(navigator.userAgent))&&d.crypto&&d.crypto.subtle?this.crypto=new D:this.crypto=new F}t&&(this.crypto=t),this.itemTransformer=new M(this.crypto),this.crypto.SFJS={version:this.version(),defaultPasswordGenerationCost:this.defaultPasswordGenerationCost()}}return c(e,[{key:"version",value:function(){return"003"}},{key:"supportsPasswordDerivationCost",value:function(e){return!(e>5e3)||this.crypto instanceof D}},{key:"supportedVersions",value:function(){return["001","002","003"]}},{key:"isVersionNewerThanLibraryVersion",value:function(e){var t=this.version();return parseInt(e)>parseInt(t)}},{key:"isProtocolVersionOutdated",value:function(e){var t={"001":Date.parse("2018-01-01"),"002":Date.parse("2020-01-01")},n=t[e];return!!n&&new Date>n}},{key:"costMinimumForVersion",value:function(e){return{"001":3e3,"002":3e3,"003":11e4}[e]}},{key:"defaultPasswordGenerationCost",value:function(){return this.costMinimumForVersion(this.version())}}]),e}();if(d)try{d.StandardFile=N,d.SFJS=new N,d.SFCryptoWeb=D,d.SFCryptoJS=F,d.SFItemTransformer=M,d.SFModelManager=v,d.SFItem=x,d.SFItemParams=S,d.SFHttpManager=h,d.SFStorageManager=k,d.SFSyncManager=w,d.SFAuthManager=p,d.SFMigrationManager=m,d.SFAlertManager=f,d.SFPredicate=E,d.SFHistorySession=T,d.SFSessionHistoryManager=g,d.SFItemHistory=P,d.SFItemHistoryEntry=I,d.SFPrivilegesManager=y,d.SFPrivileges=C,d.SFSingletonManager=b}catch(e){console.log("Exception while exporting window variables",e)}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)})}).call(t,n(3))},function(e,t){!function(t){"use strict";function n(e,t,n,r){var a=t&&t.prototype instanceof i?t:i,o=Object.create(a.prototype),u=new d(r||[]);return o._invoke=l(e,n,u),o}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function i(){}function a(){}function o(){}function u(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function s(e){function t(n,i,a,o){var u=r(e[n],e,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==typeof l&&g.call(l,"__await")?Promise.resolve(l.__await).then(function(e){t("next",e,a,o)},function(e){t("throw",e,a,o)}):Promise.resolve(l).then(function(e){s.value=e,a(s)},o)}o(u.arg)}function n(e,n){function r(){return new Promise(function(r,i){t(e,n,r,i)})}return i=i?i.then(r,r):r()}var i;this._invoke=n}function l(e,t,n){var i=C;return function(a,o){if(i===T)throw new Error("Generator is already running");if(i===P){if("throw"===a)throw o;return m()}for(n.method=a,n.arg=o;;){var u=n.delegate;if(u){var s=c(u,n);if(s){if(s===I)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===C)throw i=P,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=T;var l=r(e,t,n);if("normal"===l.type){if(i=n.done?P:_,l.arg===I)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=P,n.method="throw",n.arg=l.arg)}}}function c(e,t){var n=e.iterator[t.method];if(n===v){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=v,c(e,t),"throw"===t.method))return I;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return I}var i=r(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,I;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=v),t.delegate=null,I):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,I)}function f(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function p(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function d(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(f,this),this.reset(!0)}function h(e){if(e){var t=e[k];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(g.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=v,t.done=!0,t};return r.next=r}}return{next:m}}function m(){return{value:v,done:!0}}var v,y=Object.prototype,g=y.hasOwnProperty,b="function"==typeof Symbol?Symbol:{},k=b.iterator||"@@iterator",w=b.asyncIterator||"@@asyncIterator",x=b.toStringTag||"@@toStringTag",S="object"==typeof e,E=t.regeneratorRuntime;if(E)return void(S&&(e.exports=E));E=t.regeneratorRuntime=S?e.exports:{},E.wrap=n;var C="suspendedStart",_="suspendedYield",T="executing",P="completed",I={},R={};R[k]=function(){return this};var F=Object.getPrototypeOf,O=F&&F(F(h([])));O&&O!==y&&g.call(O,k)&&(R=O);var D=o.prototype=i.prototype=Object.create(R);a.prototype=D.constructor=o,o.constructor=a,o[x]=a.displayName="GeneratorFunction",E.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},E.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,x in e||(e[x]="GeneratorFunction")),e.prototype=Object.create(D),e},E.awrap=function(e){return{__await:e}},u(s.prototype),s.prototype[w]=function(){return this},E.AsyncIterator=s,E.async=function(e,t,r,i){var a=new s(n(e,t,r,i));return E.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},u(D),D[x]="Generator",D[k]=function(){return this},D.toString=function(){return"[object Generator]"},E.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},E.values=h,d.prototype={constructor:d,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=v,this.done=!1,this.delegate=null,this.method="next",this.arg=v,this.tryEntries.forEach(p),!e)for(var t in this)"t"===t.charAt(0)&&g.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=v)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return a.type="throw",a.arg=e,n.next=t,r&&(n.method="next",n.arg=v),!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var o=g.call(i,"catchLoc"),u=g.call(i,"finallyLoc");if(o&&u){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&g.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,I):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),I},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),p(n),I}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;p(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:h(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=v),I}}}(function(){return this}()||Function("return this")())},function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){function o(e){r(s,i,a,o,u,"next",e)}function u(e){r(s,i,a,o,u,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return p});var l=n(1),c=(n.n(l),n(5)),f=(n.n(c),n(0)),p=(n.n(f),function(){function e(t){a(this,e),this.componentManager=t,this.updateObservers=[],this.items=[]}return u(e,[{key:"getPlatform",value:function(){return this.componentManager.platform}},{key:"getEnvironment",value:function(){return this.componentManager.environment}},{key:"isMobile",value:function(){return"mobile"==this.getEnvironment()}},{key:"addEventHandler",value:function(e){var t={id:Math.random,callback:e};return this.updateObservers.push(t),t}},{key:"removeUpdateObserver",value:function(e){this.updateObservers.splice(this.updateObservers.indexOf(e),1)}},{key:"notifyObserversOfEvent",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.updateObservers[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.callback(e)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"filterItems",value:function(e){return this.items.filter(function(t){return t.content_type==e})}},{key:"getFileDescriptors",value:function(){return this.filterItems(e.FileDescriptorContentTypeKey)}},{key:"beginStreamingFiles",value:function(){var t=this,n=[e.FileDescriptorContentTypeKey,e.FileSafeCredentialsContentType,e.FileSafeIntegrationContentTypeKey];this.componentManager.streamItems(n,function(e){t.handleStreamItemsMessage(e)})}},{key:"handleStreamItemsMessage",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r,i,a,o,u,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,i=!1,a=void 0,t.prev=3,o=n[Symbol.iterator]();case 5:if(r=(u=o.next()).done){t.next=18;break}if(s=u.value,s=new f.SFItem(s),!s.deleted){t.next=11;break}return this.removeItemFromItems(s),t.abrupt("continue",15);case 11:if(!s.isMetadataUpdate){t.next=13;break}return t.abrupt("continue",15);case 13:l=this.indexOfItem(s),l>=0?this.items[l]=s:this.items.push(s);case 15:r=!0,t.next=5;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(3),i=!0,a=t.t0;case 24:t.prev=24,t.prev=25,r||null==o.return||o.return();case 27:if(t.prev=27,!i){t.next=30;break}throw a;case 30:return t.finish(27);case 31:return t.finish(24);case 32:this.notifyObserversOfEvent(e.BridgeEventReceivedItems);case 33:case"end":return t.stop()}},t,this,[[3,20,24,32],[25,,27,31]])}));return t}()},{key:"indexOfItem",value:function(e){for(var t in this.items)if(this.items[t].uuid==e.uuid)return t;return-1}},{key:"removeItemFromItems",value:function(e){this.items=this.items.filter(function(t){return t.uuid!==e.uuid})}},{key:"createItem",value:function(e,t){this.createItems([e],t)}},{key:"createItems",value:function(e,t){this.componentManager.createItems(e,function(e){t&&t(e.map(function(e){return new f.SFItem(e)}))})}},{key:"saveItem",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveItems([t]));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"saveItems",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,i){r.componentManager.saveItems(n,function(n){t(n),r.notifyObserversOfEvent(e.BridgeEventSavedItem)})}));case 1:case"end":return t.stop()}},t)}));return t}()},{key:"indexOfItem",value:function(e){for(var t in this.items)if(this.items[t].uuid==e.uuid)return t;return-1}},{key:"deleteItem",value:function(e,t){this.deleteItems([e],t)}},{key:"deleteItems",value:function(e,t){this.componentManager.deleteItems(e,t)}},{key:"removeItemFromItems",value:function(e){this.items=this.items.filter(function(t){return t.uuid!==e.uuid})}}]),e}());s(p,"FileItemContentTypeKey","SN|FileSafe|File"),s(p,"FileSafeCredentialsContentType","SN|FileSafe|Credentials"),s(p,"FileDescriptorContentTypeKey","SN|FileSafe|FileMetadata"),s(p,"FileSafeIntegrationContentTypeKey","SN|FileSafe|Integration"),s(p,"BridgeEventLoadedCredentials","BridgeEventLoadedCredentials"),s(p,"BridgeEventReceivedItems","BridgeEventReceivedItems"),s(p,"BridgeEventSavedItem","BridgeEventSavedItem")},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){function o(e){r(s,i,a,o,u,"next",e)}function u(e){r(s,i,a,o,u,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"default",function(){return m});var s=n(2),l=n(7),c=n(8),f=n(9),p=n(10),d=n(12),h=n(0),m=(n.n(h),function(){function e(t){var n=this,r=t.componentManager;a(this,e),this.dataChangeObservers=[],this.newFileDescriptorHandlers=[],this.extensionBridge=new s.a(r),this.extensionBridge.addEventHandler(function(e){n.notifyObservers()}),this.relayManager=new l.a,this.integrationManager=new c.a(this.extensionBridge),this.credentialManager=new f.a({extensionBridge:this.extensionBridge,onCredentialLoad:function(){n.relayManager.setCredentials(n.credentialManager.getDefaultCredentials())}}),this.fileManager=new p.a(this.extensionBridge,this.relayManager,this.integrationManager,this.credentialManager),this.extensionBridge.beginStreamingFiles()}return u(e,null,[{key:"getSFItemClass",value:function(){return h.SFItem}}]),u(e,[{key:"addNewFileDescriptorHandler",value:function(e){this.newFileDescriptorHandlers.push(e)}},{key:"notifyObservers",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.dataChangeObservers[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"addDataChangeObserver",value:function(e){return this.dataChangeObservers.push(e),e}},{key:"removeDataChangeObserver",value:function(e){this.dataChangeObservers=this.dataChangeObservers.filter(function(t){return t!=e})}},{key:"setCurrentNote",value:function(e){this.currentNote=e,this.notifyObservers()}},{key:"getAllFileDescriptors",value:function(){return this.fileManager.getAllFileDescriptors()}},{key:"findFileDescriptor",value:function(e){return this.fileManager.findFileDescriptor(e)}},{key:"fileDescriptorsForCurrentNote",value:function(){return this.fileManager.fileDescriptorsForNote(this.currentNote)}},{key:"fileDescriptorsForNote",value:function(e){return this.fileManager.fileDescriptorsForNote(e)}},{key:"fileDescriptorsEncryptedWithCredential",value:function(e){return this.fileManager.fileDescriptorsEncryptedWithCredential(e)}},{key:"deleteFileFromDescriptor",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fileManager.deleteFileFromDescriptor(t));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"uploadFile",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,u,s,l,c,f,p,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.fileItem,r=t.inputFileName,i=t.fileType,a=t.credential,o=t.note,o||(o=this.currentNote),e.next=4,this.fileManager.uploadFile({fileItem:n,inputFileName:r,fileType:i,credential:a,note:o});case 4:if(!(u=e.sent)){e.next=25;break}for(s=!0,l=!1,c=void 0,e.prev=9,f=this.newFileDescriptorHandlers[Symbol.iterator]();!(s=(p=f.next()).done);s=!0)(d=p.value)(u);e.next=17;break;case 13:e.prev=13,e.t0=e.catch(9),l=!0,c=e.t0;case 17:e.prev=17,e.prev=18,s||null==f.return||f.return();case 20:if(e.prev=20,!l){e.next=23;break}throw c;case 23:return e.finish(20);case 24:return e.finish(17);case 25:return e.abrupt("return",u);case 26:case"end":return e.stop()}},e,this,[[9,13,17,25],[18,,20,24]])}));return e}()},{key:"encryptAndUploadJavaScriptFileObject",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){var a=new FileReader;a.onload=function(){var r=i(regeneratorRuntime.mark(function r(i){var a,o,u,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=i.target.result,o=a,r.next=4,SFJS.crypto.arrayBufferToBase64(o);case 4:return u=r.sent,r.next=7,n.encryptAndUploadData({base64Data:u,inputFileName:t.name,fileType:t.type});case 7:s=r.sent,e(s);case 9:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}(),a.readAsArrayBuffer(t)}));case 1:case"end":return e.stop()}},e)}));return e}()},{key:"encryptAndUploadData",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,a,o,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.base64Data,r=t.inputFileName,a=t.fileType,o=this.getDefaultCredentials(),e.abrupt("return",this.encryptFile({data:n,inputFileName:r,fileType:a,credential:o}).then(function(){var e=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u.uploadFile({fileItem:t,inputFileName:r,fileType:a,credential:o}).catch(function(e){console.error("filesafe-js | error uploading file:",e)}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"downloadFileFromDescriptor",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fileManager.downloadFileFromDescriptor(t));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"encryptFile",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,r=t.inputFileName,i=t.fileType,a=t.credential,e.abrupt("return",this.fileManager.encryptFile({data:n,inputFileName:r,fileType:i,credential:a}));case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"decryptFile",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.fileDescriptor,r=t.fileItem,i=t.credential,e.abrupt("return",this.fileManager.decryptFile({fileDescriptor:n,fileItem:r,credential:i}));case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"downloadBase64Data",value:function(e){var t=e.base64Data,n=e.fileName,r=e.fileType;d.a.downloadData(d.a.base64toBinary(t),n,r)}},{key:"createTemporaryFileUrl",value:function(e){var t=e.base64Data,n=e.dataType;return d.a.tempUrlForData(d.a.base64toBinary(t),n)}},{key:"revokeTempUrl",value:function(e){d.a.revokeTempUrl(e)}},{key:"createNewCredentials",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.credentialManager.createNewCredentials());case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"numberOfFilesEncryptedWithCredential",value:function(e){return this.fileManager.fileDescriptorsEncryptedWithCredential(e).length}},{key:"credentialForFileDescriptor",value:function(e){return this.credentialManager.credentialForFileDescriptor(e)}},{key:"getAllCredentials",value:function(){return this.credentialManager.getAllCredentials()}},{key:"getDefaultCredentials",value:function(){return this.credentialManager.getDefaultCredentials()}},{key:"setCredentialAsDefault",value:function(e){return this.credentialManager.setCredentialAsDefault(e)}},{key:"deleteCredential",value:function(e){return this.credentialManager.deleteCredential(e)}},{key:"saveCredential",value:function(e){return this.credentialManager.saveCredential(e)}},{key:"getAllIntegrations",value:function(){return this.integrationManager.integrations}},{key:"integrationForFileDescriptor",value:function(e){return this.integrationManager.integrationForFileDescriptor(e)}},{key:"saveIntegrationFromCode",value:function(e){return this.integrationManager.saveIntegrationFromCode(e)}},{key:"getDefaultIntegration",value:function(){return this.integrationManager.getDefaultIntegration()}},{key:"setIntegrationAsDefault",value:function(e){return this.integrationManager.setIntegrationAsDefault(e)}},{key:"deleteIntegration",value:function(e){return this.integrationManager.deleteIntegration(e)}},{key:"displayStringForIntegration",value:function(e){return this.integrationManager.displayStringForIntegration(e)}},{key:"base64toBinary",value:function(e){return d.a.base64toBinary(e)}},{key:"isMobile",value:function(){return this.extensionBridge.isMobile()}},{key:"getEnvironment",value:function(){return this.extensionBridge.getEnvironment()}},{key:"getPlatform",value:function(){return this.extensionBridge.getPlatform()}},{key:"copyTextToClipboard",value:function(e){return d.a.copyTextToClipboard(e)}}]),e}())},function(e,t,n){(function(e,r){var i;(function(){function a(e,t){return e.set(t[0],t[1]),e}function o(e,t){return e.add(t),e}function u(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function s(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););}function l(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}function c(e,t){return!(null==e||!e.length)&&-1<v(e,t,0)}function f(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function p(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function d(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)n=t(n,e[r],r,e);return n}function h(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function m(e,t,n){var r=e.length;for(n+=-1;++n<r;)if(t(e[n],n,e))return n;return-1}function v(e,t,n){if(t===t)e:{--n;for(var r=e.length;++n<r;)if(e[n]===t){e=n;break e}e=-1}else e=m(e,y,n);return e}function y(e){return e!==e}function g(e){return function(t){return null==t?pt:t[e]}}function b(e,t){return f(t,function(t){return e[t]})}function k(e,t){return e.has(t)}function w(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function x(e){var t=Object;return function(n){return e(t(n))}}function S(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function E(){}function C(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function T(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function P(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new T;++t<n;)this.add(e[t])}function I(e){this.size=(this.__data__=new _(e)).size}function R(e,t){var n=Bn(e),r=!n&&Un(e),i=!n&&!r&&Hn(e),a=!n&&!r&&!i&&zn(e);if(n=n||r||i||a){for(var r=e.length,o=String,u=-1,s=Array(r);++u<r;)s[u]=o(u);r=s}else r=[];var l,o=r.length;for(l in e)!t&&!Wt.call(e,l)||n&&("length"==l||i&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Te(l,o))||r.push(l);return r}function F(e,t,n){(n===pt||Ue(e[t],n))&&(n!==pt||t in e)||A(e,t,n)}function O(e,t,n){var r=e[t];Wt.call(e,t)&&Ue(r,n)&&(n!==pt||t in e)||A(e,t,n)}function D(e,t){for(var n=e.length;n--;)if(Ue(e[n][0],t))return n;return-1}function M(e,t){return e&&le(t,nt(t),e)}function N(e,t){return e&&le(t,rt(t),e)}function A(e,t,n){"__proto__"==t&&an?an(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function L(e,t,n,r,i,a){var o,u=1&t,l=2&t,c=4&t;if(n&&(o=i?n(e,r,i,a):n(e)),o!==pt)return o;if(!Ke(e))return e;if(r=Bn(e)){if(o=Se(e),!u)return se(e,o)}else{var f=Mn(e),p="[object Function]"==f||"[object GeneratorFunction]"==f;if(Hn(e))return ae(e,u);if("[object Object]"==f||"[object Arguments]"==f||p&&!i){if(o=l||p?{}:Ee(e),!u)return l?fe(e,N(o,e)):ce(e,M(o,e))}else{if(!Pt[f])return i?e:{};o=Ce(e,f,L,u)}}if(a||(a=new I),i=a.get(e))return i;a.set(e,o);var l=c?l?ge:ye:l?rt:nt,d=r?pt:l(e);return s(d||e,function(r,i){d&&(i=r,r=e[i]),O(o,i,L(r,t,n,i,e,a))}),o}function j(e,t){var n=[];return Pn(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function U(e,t,n,r,i){var a=-1,o=e.length;for(n||(n=_e),i||(i=[]);++a<o;){var u=e[a];0<t&&n(u)?1<t?U(u,t-1,n,r,i):p(i,u):r||(i[i.length]=u)}return i}function B(e,t){t=ie(t,e);for(var n=0,r=t.length;null!=e&&n<r;)e=e[Oe(t[n++])];return n&&n==r?e:pt}function H(e,t,n){return t=t(e),Bn(e)?t:p(t,n(e))}function z(e){if(null==e)e=e===pt?"[object Undefined]":"[object Null]";else if(rn&&rn in Object(e)){var t=Wt.call(e,rn),n=e[rn];try{e[rn]=pt;var r=!0}catch(e){}var i=Vt.call(e);r&&(t?e[rn]=n:delete e[rn]),e=i}else e=Vt.call(e);return e}function W(e){return Ve(e)&&"[object Arguments]"==z(e)}function K(e,t,n,r,i){if(e===t)t=!0;else if(null==e||null==t||!Ve(e)&&!Ve(t))t=e!==e&&t!==t;else e:{var a=Bn(e),o=Bn(t),u=a?"[object Array]":Mn(e),s=o?"[object Array]":Mn(t),u="[object Arguments]"==u?"[object Object]":u,s="[object Arguments]"==s?"[object Object]":s,l="[object Object]"==u,o="[object Object]"==s;if((s=u==s)&&Hn(e)){if(!Hn(t)){t=!1;break e}a=!0,l=!1}if(s&&!l)i||(i=new I),t=a||zn(e)?he(e,t,n,r,K,i):me(e,t,u,n,r,K,i);else{if(!(1&n)&&(a=l&&Wt.call(e,"__wrapped__"),u=o&&Wt.call(t,"__wrapped__"),a||u)){e=a?e.value():e,t=u?t.value():t,i||(i=new I),t=K(e,t,n,r,i);break e}if(s)t:if(i||(i=new I),a=1&n,u=ye(e),o=u.length,s=ye(t).length,o==s||a){for(l=o;l--;){var c=u[l];if(!(a?c in t:Wt.call(t,c))){t=!1;break t}}if((s=i.get(e))&&i.get(t))t=s==t;else{s=!0,i.set(e,t),i.set(t,e);for(var f=a;++l<o;){var c=u[l],p=e[c],d=t[c];if(r)var h=a?r(d,p,c,t,e,i):r(p,d,c,e,t,i);if(h===pt?p!==d&&!K(p,d,n,r,i):!h){s=!1;break}f||(f="constructor"==c)}s&&!f&&(n=e.constructor,r=t.constructor,n!=r&&"constructor"in e&&"constructor"in t&&!("function"==typeof n&&n instanceof n&&"function"==typeof r&&r instanceof r)&&(s=!1)),i.delete(e),i.delete(t),t=s}}else t=!1;else t=!1}}return t}function V(e,t){var n=t.length,r=n;if(null==e)return!r;for(e=Object(e);n--;){var i=t[n];if(i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++n<r;){var i=t[n],a=i[0],o=e[a],u=i[1];if(i[2]){if(o===pt&&!(a in e))return!1}else if(i=new I,void 0===pt?!K(u,o,3,void 0,i):1)return!1}return!0}function $(e){return Ve(e)&&We(e.length)&&!!Tt[z(e)]}function q(e){return"function"==typeof e?e:null==e?ot:"object"==typeof e?Bn(e)?Y(e[0],e[1]):J(e):lt(e)}function Q(e,t){var n=-1,r=Be(e)?Array(e.length):[];return Pn(e,function(e,i,a){r[++n]=t(e,i,a)}),r}function J(e){var t=we(e);return 1==t.length&&t[0][2]?Re(t[0][0],t[0][1]):function(n){return n===e||V(n,t)}}function Y(e,t){return Pe(e)&&t===t&&!Ke(t)?Re(Oe(e),t):function(n){var r=et(n,e);return r===pt&&r===t?tt(n,e):K(t,r,3)}}function G(e,t,n,r,i){e!==t&&In(t,function(a,o){if(Ke(a)){i||(i=new I);var u=i,s=e[o],l=t[o],c=u.get(l);if(c)F(e,o,c);else{var c=r?r(s,l,o+"",e,t,u):pt,f=c===pt;if(f){var p=Bn(l),d=!p&&Hn(l),h=!p&&!d&&zn(l),c=l;p||d||h?Bn(s)?c=s:He(s)?c=se(s):d?(f=!1,c=ae(l,!0)):h?(f=!1,c=ue(l,!0)):c=[]:$e(l)||Un(l)?(c=s,Un(s)?c=Xe(s):(!Ke(s)||n&&ze(s))&&(c=Ee(l))):f=!1}f&&(u.set(l,c),G(c,l,n,r,u),u.delete(l)),F(e,o,c)}}else u=r?r(e[o],a,o+"",e,t,i):pt,u===pt&&(u=a),F(e,o,u)},rt)}function X(e,t){return Z(e,t,function(t,n){return tt(e,n)})}function Z(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],u=B(e,o);if(n(u,o)){var s=a,o=ie(o,e);if(Ke(s))for(var o=ie(o,s),l=-1,c=o.length,f=c-1;null!=s&&++l<c;){var p=Oe(o[l]),d=u;if(l!=f){var h=s[p],d=pt;d===pt&&(d=Ke(h)?h:Te(o[l+1])?[]:{})}O(s,p,d),s=s[p]}}}return a}function ee(e){return function(t){return B(t,e)}}function te(e){return Nn(Fe(e,void 0,ot),e+"")}function ne(e){if("string"==typeof e)return e;if(Bn(e))return f(e,ne)+"";if(Qe(e))return _n?_n.call(e):"";var t=e+"";return"0"==t&&1/e==-dt?"-0":t}function re(e,t){t=ie(t,e);var n;if(2>t.length)n=e;else{n=t;var r=0,i=-1,a=-1,o=n.length;for(0>r&&(r=-r>o?0:o+r),i=i>o?o:i,0>i&&(i+=o),o=r>i?0:i-r>>>0,r>>>=0,i=Array(o);++a<o;)i[a]=n[a+r];n=B(e,i)}null==(e=n)||delete e[Oe(Ae(t))]}function ie(e,t){return Bn(e)?e:Pe(e,t)?[e]:An(Ze(e))}function ae(e,t){if(t)return e.slice();var n=e.length,n=Gt?Gt(n):new e.constructor(n);return e.copy(n),n}function oe(e){var t=new e.constructor(e.byteLength);return new Yt(t).set(new Yt(e)),t}function ue(e,t){return new e.constructor(t?oe(e.buffer):e.buffer,e.byteOffset,e.length)}function se(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function le(e,t,n){var r=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var o=t[i],u=pt;u===pt&&(u=e[o]),r?A(n,o,u):O(n,o,u)}return n}function ce(e,t){return le(e,On(e),t)}function fe(e,t){return le(e,Dn(e),t)}function pe(e){return te(function(t,n){var r,i=-1,a=n.length,o=1<a?n[a-1]:pt,u=2<a?n[2]:pt,o=3<e.length&&"function"==typeof o?(a--,o):pt;if(r=u){r=n[0];var s=n[1];if(Ke(u)){var l=typeof s;r=!!("number"==l?Be(u)&&Te(s,u.length):"string"==l&&s in u)&&Ue(u[s],r)}else r=!1}for(r&&(o=3>a?pt:o,a=1),t=Object(t);++i<a;)(u=n[i])&&e(t,u,i,o);return t})}function de(e){return $e(e)?pt:e}function he(e,t,n,r,i,a){var o=1&n,u=e.length,s=t.length;if(u!=s&&!(o&&s>u))return!1;if((s=a.get(e))&&a.get(t))return s==t;var s=-1,l=!0,c=2&n?new P:pt;for(a.set(e,t),a.set(t,e);++s<u;){var f=e[s],p=t[s];if(r)var d=o?r(p,f,s,t,e,a):r(f,p,s,e,t,a);if(d!==pt){if(d)continue;l=!1;break}if(c){if(!h(t,function(e,t){if(!k(c,t)&&(f===e||i(f,e,n,r,a)))return c.push(t)})){l=!1;break}}else if(f!==p&&!i(f,p,n,r,a)){l=!1;break}}return a.delete(e),a.delete(t),l}function me(e,t,n,r,i,a,o){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!a(new Yt(e),new Yt(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return Ue(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var u=w;case"[object Set]":if(u||(u=S),e.size!=t.size&&!(1&r))break;return(n=o.get(e))?n==t:(r|=2,o.set(e,t),t=he(u(e),u(t),r,i,a,o),o.delete(e),t);case"[object Symbol]":if(Cn)return Cn.call(e)==Cn.call(t)}return!1}function ve(e){return Nn(Fe(e,pt,Ne),e+"")}function ye(e){return H(e,nt,On)}function ge(e){return H(e,rt,Dn)}function be(){var e=E.iteratee||ut,e=e===ut?q:e;return arguments.length?e(arguments[0],arguments[1]):e}function ke(e,t){var n=e.__data__,r=typeof t;return("string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?n["string"==typeof t?"string":"hash"]:n.map}function we(e){for(var t=nt(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,i===i&&!Ke(i)]}return t}function xe(e,t){var n=null==e?pt:e[t];return(!Ke(n)||Kt&&Kt in n?0:(ze(n)?qt:Et).test(De(n)))?n:pt}function Se(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&Wt.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Ee(e){return"function"!=typeof e.constructor||Ie(e)?{}:Tn(Xt(e))}function Ce(e,t,n,r){var i=e.constructor;switch(t){case"[object ArrayBuffer]":return oe(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return t=r?oe(e.buffer):e.buffer,new e.constructor(t,e.byteOffset,e.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ue(e,r);case"[object Map]":return t=r?n(w(e),1):w(e),d(t,a,new e.constructor);case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return t=new e.constructor(e.source,wt.exec(e)),t.lastIndex=e.lastIndex,t;case"[object Set]":return t=r?n(S(e),1):S(e),d(t,o,new e.constructor);case"[object Symbol]":return Cn?Object(Cn.call(e)):{}}}function _e(e){return Bn(e)||Un(e)||!!(nn&&e&&e[nn])}function Te(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||_t.test(e))&&-1<e&&0==e%1&&e<t}function Pe(e,t){if(Bn(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Qe(e))||vt.test(e)||!mt.test(e)||null!=t&&e in Object(t)}function Ie(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Bt)}function Re(e,t){return function(n){return null!=n&&n[e]===t&&(t!==pt||e in Object(n))}}function Fe(e,t,n){return t=cn(t===pt?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=cn(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];for(i=-1,a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(o),u(e,this,a)}}function Oe(e){if("string"==typeof e||Qe(e))return e;var t=e+"";return"0"==t&&1/e==-dt?"-0":t}function De(e){if(null!=e){try{return zt.call(e)}catch(e){}return e+""}return""}function Me(e,t,n){var r=null==e?0:e.length;return r?(n=null==n?0:Ye(n),0>n&&(n=cn(r+n,0)),m(e,be(t,3),n)):-1}function Ne(e){return(null==e?0:e.length)?U(e,1):[]}function Ae(e){var t=null==e?0:e.length;return t?e[t-1]:pt}function Le(e,t){var n;if(e&&e.length&&t&&t.length){n=t;var r=v,i=-1,a=n.length;for(e===n&&(n=se(n));++i<a;)for(var o=0,u=n[i];-1<(o=r(e,u,o,void 0));)e!==e&&tn.call(e,o,1),tn.call(e,o,1);n=e}else n=e;return n}function je(e,t){function n(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;return a.has(i)?a.get(i):(r=e.apply(this,r),n.cache=a.set(i,r)||a,r)}if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");return n.cache=new(je.Cache||T),n}function Ue(e,t){return e===t||e!==e&&t!==t}function Be(e){return null!=e&&We(e.length)&&!ze(e)}function He(e){return Ve(e)&&Be(e)}function ze(e){return!!Ke(e)&&("[object Function]"==(e=z(e))||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e)}function We(e){return"number"==typeof e&&-1<e&&0==e%1&&9007199254740991>=e}function Ke(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ve(e){return null!=e&&"object"==typeof e}function $e(e){return!(!Ve(e)||"[object Object]"!=z(e))&&(null===(e=Xt(e))||"function"==typeof(e=Wt.call(e,"constructor")&&e.constructor)&&e instanceof e&&zt.call(e)==$t)}function qe(e){return"string"==typeof e||!Bn(e)&&Ve(e)&&"[object String]"==z(e)}function Qe(e){return"symbol"==typeof e||Ve(e)&&"[object Symbol]"==z(e)}function Je(e){return e?(e=Ge(e),e===dt||e===-dt?1.7976931348623157e308*(0>e?-1:1):e===e?e:0):0===e?e:0}function Ye(e){e=Je(e);var t=e%1;return e===e?t?e-t:e:0}function Ge(e){if("number"==typeof e)return e;if(Qe(e))return ht;if(Ke(e)&&(e="function"==typeof e.valueOf?e.valueOf():e,e=Ke(e)?e+"":e),"string"!=typeof e)return 0===e?e:+e;e=e.replace(bt,"");var t=St.test(e);return t||Ct.test(e)?Rt(e.slice(2),t?2:8):xt.test(e)?ht:+e}function Xe(e){return le(e,rt(e))}function Ze(e){return null==e?"":ne(e)}function et(e,t,n){return e=null==e?pt:B(e,t),e===pt?n:e}function tt(e,t){var n;if(n=null!=e){n=e;var r;r=ie(t,n);for(var i=-1,a=r.length,o=!1;++i<a;){var u=Oe(r[i]);if(!(o=null!=n&&null!=n&&u in Object(n)))break;n=n[u]}o||++i!=a?n=o:(a=null==n?0:n.length,n=!!a&&We(a)&&Te(u,a)&&(Bn(n)||Un(n)))}return n}function nt(e){if(Be(e))e=R(e);else if(Ie(e)){var t,n=[];for(t in Object(e))Wt.call(e,t)&&"constructor"!=t&&n.push(t);e=n}else e=ln(e);return e}function rt(e){if(Be(e))e=R(e,!0);else if(Ke(e)){var t,n=Ie(e),r=[];for(t in e)("constructor"!=t||!n&&Wt.call(e,t))&&r.push(t);e=r}else{if(t=[],null!=e)for(n in Object(e))t.push(n);e=t}return e}function it(e){return null==e?[]:b(e,nt(e))}function at(e){return function(){return e}}function ot(e){return e}function ut(e){return q("function"==typeof e?e:L(e,1))}function st(){}function lt(e){return Pe(e)?g(Oe(e)):ee(e)}function ct(){return[]}function ft(){return!1}var pt,dt=1/0,ht=NaN,mt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vt=/^\w*$/,yt=/^\./,gt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bt=/^\s+|\s+$/g,kt=/\\(\\)?/g,wt=/\w*$/,xt=/^[-+]0x[0-9a-f]+$/i,St=/^0b[01]+$/i,Et=/^\[object .+?Constructor\]$/,Ct=/^0o[0-7]+$/i,_t=/^(?:0|[1-9]\d*)$/,Tt={};Tt["[object Float32Array]"]=Tt["[object Float64Array]"]=Tt["[object Int8Array]"]=Tt["[object Int16Array]"]=Tt["[object Int32Array]"]=Tt["[object Uint8Array]"]=Tt["[object Uint8ClampedArray]"]=Tt["[object Uint16Array]"]=Tt["[object Uint32Array]"]=!0,Tt["[object Arguments]"]=Tt["[object Array]"]=Tt["[object ArrayBuffer]"]=Tt["[object Boolean]"]=Tt["[object DataView]"]=Tt["[object Date]"]=Tt["[object Error]"]=Tt["[object Function]"]=Tt["[object Map]"]=Tt["[object Number]"]=Tt["[object Object]"]=Tt["[object RegExp]"]=Tt["[object Set]"]=Tt["[object String]"]=Tt["[object WeakMap]"]=!1;var Pt={};Pt["[object Arguments]"]=Pt["[object Array]"]=Pt["[object ArrayBuffer]"]=Pt["[object DataView]"]=Pt["[object Boolean]"]=Pt["[object Date]"]=Pt["[object Float32Array]"]=Pt["[object Float64Array]"]=Pt["[object Int8Array]"]=Pt["[object Int16Array]"]=Pt["[object Int32Array]"]=Pt["[object Map]"]=Pt["[object Number]"]=Pt["[object Object]"]=Pt["[object RegExp]"]=Pt["[object Set]"]=Pt["[object String]"]=Pt["[object Symbol]"]=Pt["[object Uint8Array]"]=Pt["[object Uint8ClampedArray]"]=Pt["[object Uint16Array]"]=Pt["[object Uint32Array]"]=!0,Pt["[object Error]"]=Pt["[object Function]"]=Pt["[object WeakMap]"]=!1;var It,Rt=parseInt,Ft="object"==typeof e&&e&&e.Object===Object&&e,Ot="object"==typeof self&&self&&self.Object===Object&&self,Dt=Ft||Ot||Function("return this")(),Mt="object"==typeof t&&t&&!t.nodeType&&t,Nt=Mt&&"object"==typeof r&&r&&!r.nodeType&&r,At=Nt&&Nt.exports===Mt,Lt=At&&Ft.process;e:{try{It=Lt&&Lt.binding&&Lt.binding("util");break e}catch(a){}It=void 0}var jt=It&&It.isTypedArray,Ut=Array.prototype,Bt=Object.prototype,Ht=Dt["__core-js_shared__"],zt=Function.prototype.toString,Wt=Bt.hasOwnProperty,Kt=function(){var e=/[^.]+$/.exec(Ht&&Ht.keys&&Ht.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Vt=Bt.toString,$t=zt.call(Object),qt=RegExp("^"+zt.call(Wt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Qt=At?Dt.Buffer:pt,Jt=Dt.Symbol,Yt=Dt.Uint8Array,Gt=Qt?Qt.a:pt,Xt=x(Object.getPrototypeOf),Zt=Object.create,en=Bt.propertyIsEnumerable,tn=Ut.splice,nn=Jt?Jt.isConcatSpreadable:pt,rn=Jt?Jt.toStringTag:pt,an=function(){try{var e=xe(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),on=Math.floor,un=Object.getOwnPropertySymbols,sn=Qt?Qt.isBuffer:pt,ln=x(Object.keys),cn=Math.max,fn=Math.min,pn=Date.now,dn=xe(Dt,"DataView"),hn=xe(Dt,"Map"),mn=xe(Dt,"Promise"),vn=xe(Dt,"Set"),yn=xe(Dt,"WeakMap"),gn=xe(Object,"create"),bn=De(dn),kn=De(hn),wn=De(mn),xn=De(vn),Sn=De(yn),En=Jt?Jt.prototype:pt,Cn=En?En.valueOf:pt,_n=En?En.toString:pt,Tn=function(){function e(){}return function(t){return Ke(t)?Zt?Zt(t):(e.prototype=t,t=new e,e.prototype=pt,t):{}}}();C.prototype.clear=function(){this.__data__=gn?gn(null):{},this.size=0},C.prototype.delete=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e},C.prototype.get=function(e){var t=this.__data__;return gn?(e=t[e],"__lodash_hash_undefined__"===e?pt:e):Wt.call(t,e)?t[e]:pt},C.prototype.has=function(e){var t=this.__data__;return gn?t[e]!==pt:Wt.call(t,e)},C.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=gn&&t===pt?"__lodash_hash_undefined__":t,this},_.prototype.clear=function(){this.__data__=[],this.size=0},_.prototype.delete=function(e){var t=this.__data__;return!(0>(e=D(t,e))||(e==t.length-1?t.pop():tn.call(t,e,1),--this.size,0))},_.prototype.get=function(e){var t=this.__data__;return e=D(t,e),0>e?pt:t[e][1]},_.prototype.has=function(e){return-1<D(this.__data__,e)},_.prototype.set=function(e,t){var n=this.__data__,r=D(n,e);return 0>r?(++this.size,n.push([e,t])):n[r][1]=t,this},T.prototype.clear=function(){this.size=0,this.__data__={hash:new C,map:new(hn||_),string:new C}},T.prototype.delete=function(e){return e=ke(this,e).delete(e),this.size-=e?1:0,e},T.prototype.get=function(e){return ke(this,e).get(e)},T.prototype.has=function(e){return ke(this,e).has(e)},T.prototype.set=function(e,t){var n=ke(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},P.prototype.add=P.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},P.prototype.has=function(e){return this.__data__.has(e)},I.prototype.clear=function(){this.__data__=new _,this.size=0},I.prototype.delete=function(e){var t=this.__data__;return e=t.delete(e),this.size=t.size,e},I.prototype.get=function(e){return this.__data__.get(e)},I.prototype.has=function(e){return this.__data__.has(e)},I.prototype.set=function(e,t){var n=this.__data__;if(n instanceof _){var r=n.__data__;if(!hn||199>r.length)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new T(r)}return n.set(e,t),this.size=n.size,this};var Pn=function(e,t){return function(t,n){if(null==t)return t;if(!Be(t))return e(t,n);for(var r=t.length,i=-1,a=Object(t);++i<r&&!1!==n(a[i],i,a););return t}}(function(e,t){return e&&In(e,t,nt)}),In=function(e){return function(e,t,n){var r=-1,i=Object(e);n=n(e);for(var a=n.length;a--;){var o=n[++r];if(!1===t(i[o],o,i))break}return e}}(),Rn=an?function(e,t){return an(e,"toString",{configurable:!0,enumerable:!1,value:at(t),writable:!0})}:ot,Fn=vn&&1/S(new vn([,-0]))[1]==dt?function(e){return new vn(e)}:st,On=un?function(e){return null==e?[]:(e=Object(e),l(un(e),function(t){return en.call(e,t)}))}:ct,Dn=un?function(e){for(var t=[];e;)p(t,On(e)),e=Xt(e);return t}:ct,Mn=z;(dn&&"[object DataView]"!=Mn(new dn(new ArrayBuffer(1)))||hn&&"[object Map]"!=Mn(new hn)||mn&&"[object Promise]"!=Mn(mn.resolve())||vn&&"[object Set]"!=Mn(new vn)||yn&&"[object WeakMap]"!=Mn(new yn))&&(Mn=function(e){var t=z(e);if(e=(e="[object Object]"==t?e.constructor:pt)?De(e):"")switch(e){case bn:return"[object DataView]";case kn:return"[object Map]";case wn:return"[object Promise]";case xn:return"[object Set]";case Sn:return"[object WeakMap]"}return t});var Nn=function(e){var t=0,n=0;return function(){var r=pn(),i=16-(r-n);if(n=r,0<i){if(800<=++t)return arguments[0]}else t=0;return e.apply(pt,arguments)}}(Rn),An=function(e){e=je(e,function(e){return 500===t.size&&t.clear(),e});var t=e.cache;return e}(function(e){var t=[];return yt.test(e)&&t.push(""),e.replace(gt,function(e,n,r,i){t.push(r?i.replace(kt,"$1"):n||e)}),t}),Ln=te(Le),jn=function(e){return function(t,n,r){var i=Object(t);if(!Be(t)){var a=be(n,3);t=nt(t),n=function(e){return a(i[e],e,i)}}return n=e(t,n,r),-1<n?i[a?t[n]:n]:pt}}(Me);je.Cache=T;var Un=W(function(){return arguments}())?W:function(e){return Ve(e)&&Wt.call(e,"callee")&&!en.call(e,"callee")},Bn=Array.isArray,Hn=sn||ft,zn=jt?function(e){return function(t){return e(t)}}(jt):$,Wn=pe(function(e,t,n){G(e,t,n)}),Kn=pe(function(e,t,n,r){G(e,t,n,r)}),Vn=ve(function(e,t){var n={};if(null==e)return n;var r=!1;t=f(t,function(t){return t=ie(t,e),r||(r=1<t.length),t}),le(e,ge(e),n),r&&(n=L(n,7,de));for(var i=t.length;i--;)re(n,t[i]);return n}),$n=ve(function(e,t){return null==e?{}:X(e,t)});E.constant=at,E.filter=function(e,t){return(Bn(e)?l:j)(e,be(t,3))},E.flatten=Ne,E.iteratee=ut,E.keys=nt,E.keysIn=rt,E.map=function(e,t){return(Bn(e)?f:Q)(e,be(t,3))},E.memoize=je,E.merge=Wn,E.mergeWith=Kn,E.omit=Vn,E.pick=$n,E.property=lt,E.pull=Ln,E.pullAll=Le,E.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],a=e.length;for(t=be(t,3);++r<a;){var o=e[r];t(o,r,e)&&(n.push(o),i.push(r))}for(r=e?i.length:0,a=r-1;r--;)if(o=i[r],r==a||o!==u){var u=o;Te(o)?tn.call(e,o,1):re(e,o)}return n},E.toPlainObject=Xe,E.uniq=function(e){if(e&&e.length)e:{var t=-1,n=c,r=e.length,i=!0,a=[],o=a;if(200<=r){if(n=Fn(e)){e=S(n);break e}i=!1,n=k,o=new P}else o=a;t:for(;++t<r;){var u=e[t],s=u,u=0!==u?u:0;if(i&&s===s){for(var l=o.length;l--;)if(o[l]===s)continue t;a.push(u)}else n(o,s,void 0)||(o!==a&&o.push(s),a.push(u))}e=a}else e=[];return e},E.values=it,E.cloneDeep=function(e){return L(e,5)},E.eq=Ue,E.find=jn,E.findIndex=Me,E.get=et,E.hasIn=tt,E.identity=ot,E.includes=function(e,t,n,r){return e=Be(e)?e:it(e),n=n&&!r?Ye(n):0,r=e.length,0>n&&(n=cn(r+n,0)),qe(e)?n<=r&&-1<e.indexOf(t,n):!!r&&-1<v(e,t,n)},E.isArguments=Un,E.isArray=Bn,E.isArrayLike=Be,E.isArrayLikeObject=He,E.isBuffer=Hn,E.isFunction=ze,E.isLength=We,E.isObject=Ke,E.isObjectLike=Ve,E.isPlainObject=$e,E.isString=qe,E.isSymbol=Qe,E.isTypedArray=zn,E.last=Ae,E.stubArray=ct,E.stubFalse=ft,E.noop=st,E.sortedIndexBy=function(e,t,n){n=be(n,2),t=n(t);for(var r=0,i=null==e?0:e.length,a=t!==t,o=null===t,u=Qe(t),s=t===pt;r<i;){var l=on((r+i)/2),c=n(e[l]),f=c!==pt,p=null===c,d=c===c,h=Qe(c);(a?d:s?d&&f:o?d&&f&&!p:u?d&&f&&!p&&!h:p||h?0:c<t)?r=l+1:i=l}return fn(i,4294967294)},E.toFinite=Je,E.toInteger=Ye,E.toNumber=Ge,E.toString=Ze,E.VERSION="4.17.4",Dt._=E,void 0!==(i=function(){return E}.call(t,n,t,r))&&(r.exports=i)}).call(this)}).call(t,n(3),n(6)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){function o(e){r(s,i,a,o,u,"next",e)}function u(e){r(s,i,a,o,u,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",function(){return c});var s=n(1),l=(n.n(s),n(0)),c=(n.n(l),function(){function e(){a(this,e),this.httpManger=new l.SFHttpManager,this.httpManger.setJWTRequestHandler(function(){})}return u(e,[{key:"setCredentials",value:function(e){this.credentials=e}},{key:"uploadFile",value:function(){function e(e,n,r){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r){var i,a,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="".concat(r.content.relayUrl,"/integrations/save-item"),a={file:{name:t,item:n},source:r.content.source,authorization:r.content.authorization},e.abrupt("return",new Promise(function(e,t){o.httpManger.postAbsolute(i,a,function(t){e(t.metadata)},function(e){var n=e.error;n||(n={message:"File upload failed."}),console.log("Upload error response",n),t(n)})}));case 3:case"end":return e.stop()}},e)}));return e}()},{key:"downloadFile",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){var r,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(n.content.relayUrl,"/integrations/download-item"),i={metadata:t.content.serverMetadata,authorization:n.content.authorization},e.abrupt("return",new Promise(function(e,t){a.httpManger.postAbsolute(r,i,function(t){e(t)},function(e){var n=e.error;console.log("Download error response",e),t(n)})}));case 3:case"end":return e.stop()}},e)}));return e}()},{key:"deleteFile",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){var r,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(n.content.relayUrl,"/integrations/delete-item"),i={metadata:t.content.serverMetadata,authorization:n.content.authorization},e.abrupt("return",new Promise(function(e,t){a.httpManger.postAbsolute(r,i,function(t){e(t)},function(e){var n=e.error;console.log("Download error response",e),t(n)})}));case 3:case"end":return e.stop()}},e)}));return e}()}]),e}())},function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){function o(e){r(s,i,a,o,u,"next",e)}function u(e){r(s,i,a,o,u,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",function(){return f});var s=n(1),l=(n.n(s),n(0)),c=(n.n(l),n(2)),f=function(){function e(t){a(this,e),this.extensionBridge=t}return u(e,[{key:"integrationForFileDescriptor",value:function(e){return this.integrations.find(function(t){return e.content.serverMetadata&&t.content.source==e.content.serverMetadata.source})}},{key:"parseIntegrationCode",value:function(e){var t=atob(e),n=JSON.parse(t);return n.rawCode=e,n}},{key:"saveIntegrationFromCode",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.parseIntegrationCode(t),0==this.integrations.length&&(n.isDefaultUploadSource=!0),r=this.createAndSaveIntegrationObject(n),e.abrupt("return",r);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"createAndSaveIntegrationObject",value:function(e){var t=new l.SFItem({content_type:c.a.FileSafeIntegrationContentTypeKey,content:e});return this.extensionBridge.createItems([t]),t}},{key:"getDefaultIntegration",value:function(){return this.integrations.find(function(e){return e.content.isDefaultUploadSource})}},{key:"setIntegrationAsDefault",value:function(e){var t=[e],n=this.getDefaultIntegration();n&&(n.content.isDefaultUploadSource=!1,t.push(n)),e.content.isDefaultUploadSource=!0,this.extensionBridge.saveItems(t)}},{key:"displayStringForIntegration",value:function(e){var t=e.content.source.split("_"),n="",r=0,i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;n+=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}(l),r<t.length-1&&(n+=" "),r++}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return n}},{key:"deleteIntegration",value:function(e){var t=this,n=e.content.isDefaultUploadSource;this.extensionBridge.deleteItem(e,function(r){if(r.deleted&&n&&t.integrations.length>0){var i=!0,a=!1,o=void 0;try{for(var u,s=t.integrations[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;if(l!=e){t.setIntegrationAsDefault(l);break}}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}})}},{key:"integrations",get:function(){return this.extensionBridge.filterItems(c.a.FileSafeIntegrationContentTypeKey)}}]),e}()},function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){function o(e){r(s,i,a,o,u,"next",e)}function u(e){r(s,i,a,o,u,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return p});var l=n(1),c=(n.n(l),n(0)),f=(n.n(c),n(2)),p=function(){function e(t){var n=this,r=t.extensionBridge,i=t.onCredentialLoad;a(this,e),s(this,"getDefaultCredentials",function(){var e=n.credentials.find(function(e){return e.content.isDefault});return!e&&n.credentials.length>0&&(e=n.credentials[0]),e}),s(this,"setCredentialAsDefault",function(e){var t=n.getDefaultCredentials();t&&(t.content.isDefault=!1),e.content.isDefault=!0,n.extensionBridge.saveItems([t,e])}),s(this,"deleteCredential",function(e){n.extensionBridge.deleteItem(e)}),this.extensionBridge=r,this.onCredentialLoad=i,this.credentials=[],this.extensionBridge.addEventHandler(function(e){e==f.a.BridgeEventReceivedItems&&n.reloadCredentials()})}return u(e,[{key:"reloadCredentials",value:function(){this.credentials=[];var e=this.extensionBridge.filterItems(f.a.FileSafeCredentialsContentType);if(0!=e.length){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.credentials.find(function(e){return e.uuid==o.uuid})||this.credentials.push(o)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.onCredentialLoad(),this.credentials.length>0&&this.didLoadCredentials()}}},{key:"createNewCredentials",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t,n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=256,e.next=3,SFJS.crypto.generateRandomKey(t);case 3:return n=e.sent,e.next=6,SFJS.crypto.generateRandomKey(t);case 6:return r=e.sent,e.next=9,SFJS.crypto.generateInitialKeysAndAuthParamsForUser(n,r);case 9:return i=e.sent,i.isDefault=0==this.credentials.length,a=new c.SFItem({content_type:f.a.FileSafeCredentialsContentType,content:i}),this.extensionBridge.saveItem(a),this.didLoadCredentials(),e.abrupt("return",a);case 15:case"end":return e.stop()}},e,this)}));return e}()},{key:"didLoadCredentials",value:function(){this.extensionBridge.notifyObserversOfEvent(f.a.BridgeEventLoadedCredentials)}},{key:"credentialForFileDescriptor",value:function(e){return this.credentials.find(function(t){return e.content.references.find(function(e){return e.uuid==t.uuid})})}},{key:"getAllCredentials",value:function(){return this.credentials}},{key:"saveCredential",value:function(e){this.extensionBridge.saveItem(e)}}]),e}()},function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){function o(e){r(s,i,a,o,u,"next",e)}function u(e){r(s,i,a,o,u,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",function(){return h});var l=n(1),c=(n.n(l),n(0)),f=(n.n(c),n(11)),p=n.n(f),d=n(2),h=function(){function e(t,n,r,i){a(this,e),this.extensionBridge=t,this.relayManager=n,this.integrationManager=r,this.credentialManager=i}return u(e,[{key:"getAllFileDescriptors",value:function(){return this.extensionBridge.getFileDescriptors()}},{key:"fileDescriptorsForNote",value:function(e){return e?this.extensionBridge.getFileDescriptors().filter(function(t){return t.hasRelationshipWithItem(e)}):[]}},{key:"findFileDescriptor",value:function(e){return this.extensionBridge.getFileDescriptors().find(function(t){return t.uuid==e})}},{key:"fileDescriptorsEncryptedWithCredential",value:function(e){return this.extensionBridge.getFileDescriptors().filter(function(t){return t.content.references.find(function(t){return t.uuid==e.uuid})})}},{key:"deleteFileFromDescriptor",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){n.extensionBridge.deleteItems([t],function(r){if(r.deleted){var i=n.integrationManager.integrationForFileDescriptor(t);i&&n.relayManager.deleteFile(t,i).then(function(t){e()})}else e(r)})}));case 1:case"end":return e.stop()}},e)}));return e}()},{key:"uploadFile",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,u,s,l,f=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.fileItem,r=t.inputFileName,i=t.fileType,a=t.credential,o=t.note,u=this.integrationManager.getDefaultIntegration(),s=r.split(".")[1],l="".concat(n.uuid,".sf.json"),e.abrupt("return",new Promise(function(e,t){var s=new p.a;s.addEventListener("message",function(n){var u=n.data;if(u.error)return console.log("Error uploading file",u.error),void t(u.error);var s=new c.SFItem({content_type:d.a.FileDescriptorContentTypeKey,content:{serverMetadata:n.data.metadata,fileName:r,fileType:i}});o&&s.addItemAsRelationship(o),s.addItemAsRelationship(a),f.extensionBridge.createItem(s,function(t){e(t[0])})});var h={outputFileName:l,fileItem:n,integration:u,operation:"upload",credentials:f.credentialManager.getDefaultCredentials()};s.postMessage(h)}));case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"downloadFileFromDescriptor",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.integrationManager.integrationForFileDescriptor(t)){e.next=6;break}throw r=t.content.serverMetadata,r?alert("Unable to find integration named '".concat(r.source,"'.")):alert("Unable to find integration for this file."),"Unable to find integration";case 6:return e.abrupt("return",this.relayManager.downloadFile(t,n).then(function(e){return e.items[0]}));case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"encryptFile",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,r=t.inputFileName,i=t.fileType,a=t.credential,e.abrupt("return",new Promise(function(e,t){var o=new p.a;o.addEventListener("message",function(t){e(t.data.fileItem)}),o.postMessage({operation:"encrypt",keys:a.content.keys,authParams:a.content.authParams,contentType:d.a.FileItemContentTypeKey,fileData:n,fileName:r,fileType:i})}));case 2:case"end":return e.stop()}},e)}));return e}()},{key:"decryptFile",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.fileDescriptor,r=t.fileItem,i=t.credential,i||(i=this.credentialManager.credentialForFileDescriptor(n)),e.abrupt("return",new Promise(function(e,t){var n=new p.a;n.addEventListener("message",function(n){var r=n.data;if(r.error)return void t(r.error);e(r)}),n.postMessage({operation:"decrypt",keys:i.content.keys,item:r})}));case 3:case"end":return e.stop()}},e,this)}));return e}()}]),e}();s(h,"FileItemContentTypeKey","SN|FileSafe|File"),s(h,"FileDescriptorContentTypeKey","SN|FileSafe|FileMetadata")},function(e,t,n){e.exports=function(){return new Worker(n.p+"filesafe-js/EncryptionWorker.js")}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return o});var o=function(){function e(){r(this,e)}return a(e,null,[{key:"base64toBinary",value:function(e){for(var t=atob(e),n=[],r=0;r<t.length;r++)n.push(t.charCodeAt(r));return new Uint8Array(n)}},{key:"downloadData",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=document.createElement("a");a.setAttribute("download",t);var o=this.tempUrlForData(e,n);a.href=o,a.setAttribute("target","_blank"),i?window.location.href=a.href:(document.body.appendChild(a),a.click(),a.remove()),setTimeout(function(){r.revokeTempUrl(o)},500)}},{key:"tempUrlForData",value:function(e,t){return window.URL.createObjectURL(new Blob([e],{type:t||"text/json"}))}},{key:"revokeTempUrl",value:function(e){window.URL.revokeObjectURL(e)}},{key:"copyTextToClipboard",value:function(e){if(window.clipboardData&&window.clipboardData.setData)return clipboardData.setData("Text",e);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var t;try{t=document.createElement("textarea"),t.setAttribute("readonly",!0),t.setAttribute("contenteditable",!0),t.style.position="fixed",t.value=e,document.body.appendChild(t),t.focus(),t.select();var n=document.createRange();n.selectNodeContents(t);var r=window.getSelection();r.removeAllRanges(),r.addRange(n),t.setSelectionRange(0,t.value.length),document.execCommand("copy")}catch(e){console.error(e),null}finally{document.body.removeChild(t)}}}}]),e}()}])},function(e,t,n){n(7),e.exports=n(30)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n.n(r),a=n(9),o=n.n(a),u=n(21);o.a.render(i.a.createElement(u.a,null),document.body)},function(e,t,n){"use strict";function r(e,t,n,r,i,a,o,u){if(!e){if(e=void 0,void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[n,r,i,a,o,u],l=0;e=Error(t.replace(/%s/g,function(){return s[l++]})),e.name="Invariant Violation"}throw e.framesToPop=1,e}}function i(e){for(var t=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=0;i<t;i++)n+="&args[]="+encodeURIComponent(arguments[i+1]);r(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}function a(e,t,n){this.props=e,this.context=t,this.refs=A,this.updater=n||N}function o(){}function u(e,t,n){this.props=e,this.context=t,this.refs=A,this.updater=n||N}function s(e,t,n){var r=void 0,i={},a=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)U.call(t,r)&&!B.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var s=Array(u),l=0;l<u;l++)s[l]=arguments[l+2];i.children=s}if(e&&e.defaultProps)for(r in u=e.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:x,type:e,key:a,ref:o,props:i,_owner:j.current}}function l(e,t){return{$$typeof:x,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function c(e){return"object"==typeof e&&null!==e&&e.$$typeof===x}function f(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}function p(e,t,n,r){if(z.length){var i=z.pop();return i.result=e,i.keyPrefix=t,i.func=n,i.context=r,i.count=0,i}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function d(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>z.length&&z.push(e)}function h(e,t,n,r){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var o=!1;if(null===e)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case x:case S:o=!0}}if(o)return n(r,e,""===t?"."+v(e,0):t),1;if(o=0,t=""===t?".":t+":",Array.isArray(e))for(var u=0;u<e.length;u++){a=e[u];var s=t+v(a,u);o+=h(a,s,n,r)}else if(null===e||"object"!=typeof e?s=null:(s=M&&e[M]||e["@@iterator"],s="function"==typeof s?s:null),"function"==typeof s)for(e=s.call(e),u=0;!(a=e.next()).done;)a=a.value,s=t+v(a,u++),o+=h(a,s,n,r);else"object"===a&&(n=""+e,i("31","[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return o}function m(e,t,n){return null==e?0:h(e,"",t,n)}function v(e,t){return"object"==typeof e&&null!==e&&null!=e.key?f(e.key):t.toString(36)}function y(e,t){e.func.call(e.context,t,e.count++)}function g(e,t,n){var r=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?b(e,r,n,function(e){return e}):null!=e&&(c(e)&&(e=l(e,i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(H,"$&/")+"/")+n)),r.push(e))}function b(e,t,n,r,i){var a="";null!=n&&(a=(""+n).replace(H,"$&/")+"/"),t=p(t,a,r,i),m(e,g,t),d(t)}/** @license React v16.6.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var k=n(1),w="function"==typeof Symbol&&Symbol.for,x=w?Symbol.for("react.element"):60103,S=w?Symbol.for("react.portal"):60106,E=w?Symbol.for("react.fragment"):60107,C=w?Symbol.for("react.strict_mode"):60108,_=w?Symbol.for("react.profiler"):60114,T=w?Symbol.for("react.provider"):60109,P=w?Symbol.for("react.context"):60110,I=w?Symbol.for("react.concurrent_mode"):60111,R=w?Symbol.for("react.forward_ref"):60112,F=w?Symbol.for("react.suspense"):60113,O=w?Symbol.for("react.memo"):60115,D=w?Symbol.for("react.lazy"):60116,M="function"==typeof Symbol&&Symbol.iterator,N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A={};a.prototype.isReactComponent={},a.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&i("85"),this.updater.enqueueSetState(this,e,t,"setState")},a.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},o.prototype=a.prototype;var L=u.prototype=new o;L.constructor=u,k(L,a.prototype),L.isPureReactComponent=!0;var j={current:null,currentDispatcher:null},U=Object.prototype.hasOwnProperty,B={key:!0,ref:!0,__self:!0,__source:!0},H=/\/+/g,z=[],W={Children:{map:function(e,t,n){if(null==e)return e;var r=[];return b(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;t=p(null,null,t,n),m(e,y,t),d(t)},count:function(e){return m(e,function(){return null},null)},toArray:function(e){var t=[];return b(e,t,null,function(e){return e}),t},only:function(e){return c(e)||i("143"),e}},createRef:function(){return{current:null}},Component:a,PureComponent:u,createContext:function(e,t){return void 0===t&&(t=null),e={$$typeof:P,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider={$$typeof:T,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:R,render:e}},lazy:function(e){return{$$typeof:D,_ctor:e,_status:-1,_result:null}},memo:function(e,t){return{$$typeof:O,type:e,compare:void 0===t?null:t}},Fragment:E,StrictMode:C,Suspense:F,createElement:s,cloneElement:function(e,t,n){(null===e||void 0===e)&&i("267",e);var r=void 0,a=k({},e.props),o=e.key,u=e.ref,s=e._owner;if(null!=t){void 0!==t.ref&&(u=t.ref,s=j.current),void 0!==t.key&&(o=""+t.key);var l=void 0;e.type&&e.type.defaultProps&&(l=e.type.defaultProps);for(r in t)U.call(t,r)&&!B.hasOwnProperty(r)&&(a[r]=void 0===t[r]&&void 0!==l?l[r]:t[r])}if(1===(r=arguments.length-2))a.children=n;else if(1<r){l=Array(r);for(var c=0;c<r;c++)l[c]=arguments[c+2];a.children=l}return{$$typeof:x,type:e.type,key:o,ref:u,props:a,_owner:s}},createFactory:function(e){var t=s.bind(null,e);return t.type=e,t},isValidElement:c,version:"16.6.3",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:j,assign:k}};W.unstable_ConcurrentMode=I,W.unstable_Profiler=_;var K={default:W},V=K&&W||K;e.exports=V.default||V},function(e,t,n){"use strict";function r(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}r(),e.exports=n(10)},function(e,t,n){"use strict";function r(e){for(var t=arguments.length-1,n="Minified React error #"+e+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+e,r=0;r<t;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);throw t=Error(n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."),t.name="Invariant Violation",t.framesToPop=1,t}function i(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function a(){if(Pt)for(var e in It){var t=It[e],n=Pt.indexOf(e);if(-1<n||r("96",e),!Rt.plugins[n]){t.extractEvents||r("97",e),Rt.plugins[n]=t,n=t.eventTypes;for(var i in n){var a=void 0,u=n[i],s=t,l=i;Rt.eventNameDispatchConfigs.hasOwnProperty(l)&&r("99",l),Rt.eventNameDispatchConfigs[l]=u;var c=u.phasedRegistrationNames;if(c){for(a in c)c.hasOwnProperty(a)&&o(c[a],s,l);a=!0}else u.registrationName?(o(u.registrationName,s,l),a=!0):a=!1;a||r("98",i,e)}}}}function o(e,t,n){Rt.registrationNameModules[e]&&r("100",e),Rt.registrationNameModules[e]=t,Rt.registrationNameDependencies[e]=t.eventTypes[n].dependencies}function u(e,t){return(e&t)===t}function s(e){for(var t;t=e._renderedComponent;)e=t;return e}function l(e,t){e=s(e),e._hostNode=t,t[Vt]=e}function c(e,t){if(!(e._flags&Wt.hasCachedChildNodes)){var n=e._renderedChildren;t=t.firstChild;var i;e:for(i in n)if(n.hasOwnProperty(i)){var a=n[i],o=s(a)._domID;if(0!==o){for(;null!==t;t=t.nextSibling){var u=t,c=o;if(u.nodeType===Bt&&u.getAttribute(zt)===""+c||u.nodeType===Ht&&u.nodeValue===" react-text: "+c+" "||u.nodeType===Ht&&u.nodeValue===" react-empty: "+c+" "){l(a,t);continue e}}r("32",o)}}e._flags|=Wt.hasCachedChildNodes}}function f(e){if(e[Vt])return e[Vt];for(var t=[];!e[Vt];){if(t.push(e),!e.parentNode)return null;e=e.parentNode}var n=e[Vt];if(n.tag===jt||n.tag===Ut)return n;for(;e&&(n=e[Vt]);e=t.pop()){var r=n;t.length&&c(n,e)}return r}function p(e){if("function"==typeof e.getName)return e.getName();if("number"==typeof e.tag){if("string"==typeof(e=e.type))return e;if("function"==typeof e)return e.displayName||e.name}return null}function d(e){var t=e;if(e.alternate)for(;t.return;)t=t.return;else{if((t.effectTag&nn)!==tn)return 1;for(;t.return;)if(t=t.return,(t.effectTag&nn)!==tn)return 1}return t.tag===Xt?2:3}function h(e){2!==d(e)&&r("188")}function m(e){var t=e.alternate;if(!t)return t=d(e),3===t&&r("188"),1===t?null:e;for(var n=e,i=t;;){var a=n.return,o=a?a.alternate:null;if(!a||!o)break;if(a.child===o.child){for(var u=a.child;u;){if(u===n)return h(a),e;if(u===i)return h(a),t;u=u.sibling}r("188")}if(n.return!==i.return)n=a,i=o;else{u=!1;for(var s=a.child;s;){if(s===n){u=!0,n=a,i=o;break}if(s===i){u=!0,i=a,n=o;break}s=s.sibling}if(!u){for(s=o.child;s;){if(s===n){u=!0,n=o,i=a;break}if(s===i){u=!0,i=o,n=a;break}s=s.sibling}u||r("189")}}n.alternate!==i&&r("190")}return n.tag!==Xt&&r("188"),n.stateNode.current===n?e:t}function v(e,t,n,r,i,a,o,u,s){an._hasCaughtError=!1,an._caughtError=null;var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(e){an._caughtError=e,an._hasCaughtError=!0}}function y(){if(an._hasRethrowError){var e=an._rethrowError;throw an._rethrowError=null,an._hasRethrowError=!1,e}}function g(e,t,n,r){t=e.type||"unknown-event",e.currentTarget=un.getNodeFromInstance(r),on.invokeGuardedCallbackAndCatchFirstError(t,n,void 0,e),e.currentTarget=null}function b(e){if(e=sn.getInstanceFromNode(e))if("number"==typeof e.tag){ln&&"function"==typeof ln.restoreControlledState||r("194");var t=sn.getFiberCurrentPropsFromNode(e.stateNode);ln.restoreControlledState(e.stateNode,e.type,t)}else"function"!=typeof e.restoreControlledState&&r("195"),e.restoreControlledState()}function k(e,t,n,r,i,a){return e(t,n,r,i,a)}function w(e,t){return e(t)}function x(e,t){return w(e,t)}function S(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===mn?e.parentNode:e}function E(e){var t=e.targetInst;do{if(!t){e.ancestors.push(t);break}var n=t;if("number"==typeof n.tag){for(;n.return;)n=n.return;n=n.tag!==vn?null:n.stateNode.containerInfo}else{for(;n._hostParent;)n=n._hostParent;n=qt.getNodeFromInstance(n).parentNode}if(!n)break;e.ancestors.push(t),t=qt.getClosestInstanceFromNode(n)}while(t);for(n=0;n<e.ancestors.length;n++)t=e.ancestors[n],gn._handleTopLevel(e.topLevelType,t,e.nativeEvent,S(e.nativeEvent))}function C(e,t){return null==t&&r("30"),null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function _(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}function T(e,t){e&&(sn.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e))}function P(e){return T(e,!0)}function I(e){return T(e,!1)}function R(e,t,n){switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":return!(!n.disabled||"button"!==t&&"input"!==t&&"select"!==t&&"textarea"!==t);default:return!1}}function F(e,t){if(!vt.canUseDOM||t&&!("addEventListener"in document))return!1;t="on"+e;var n=t in document;return n||(n=document.createElement("div"),n.setAttribute(t,"return;"),n="function"==typeof n[t]),!n&&_t&&"wheel"===e&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}function O(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n["ms"+e]="MS"+t,n["O"+e]="o"+t.toLowerCase(),n}function D(e){if(Sn[e])return Sn[e];if(!xn[e])return e;var t,n=xn[e];for(t in n)if(n.hasOwnProperty(t)&&t in En)return Sn[e]=n[t];return""}function M(e){return Object.prototype.hasOwnProperty.call(e,Pn)||(e[Pn]=Tn++,_n[e[Pn]]={}),_n[e[Pn]]}function N(e){return!!Bn.hasOwnProperty(e)||!Un.hasOwnProperty(e)&&(jn.test(e)?Bn[e]=!0:(Un[e]=!0,!1))}function A(){return null}function L(e){var t="";return mt.Children.forEach(e,function(e){null==e||"string"!=typeof e&&"number"!=typeof e||(t+=e)}),t}function j(e,t,n){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r)}else{for(n=""+n,t=null,r=0;r<e.length;r++){if(e[r].value===n)return void(e[r].selected=!0);null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function U(e,t){t&&(Xn[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML)&&r("137",e,""),null!=t.dangerouslySetInnerHTML&&(null!=t.children&&r("60"),"object"==typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML||r("61")),null!=t.style&&"object"!=typeof t.style&&r("62",""))}function B(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){var t=B(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"function"==typeof n.get&&"function"==typeof n.set)return Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:!0,get:function(){return n.get.call(this)},set:function(e){r=""+e,n.set.call(this,e)}}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}function z(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function W(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===rr)return void(n.nodeValue=t)}e.textContent=t}function K(e,t){ur(t,e.nodeType===ar||e.nodeType===or?e:e.ownerDocument)}function V(e,t){return e!==Or&&e!==Fr||t!==Or&&t!==Fr?e===Rr&&t!==Rr?-255:e!==Rr&&t===Rr?255:e-t:0}function $(){return{first:null,last:null,hasForceUpdate:!1,callbackList:null}}function q(e,t,n,r){null!==n?n.next=t:(t.next=e.first,e.first=t),null!==r?t.next=r:e.last=t}function Q(e,t){t=t.priorityLevel;var n=null;if(null!==e.last&&0>=V(e.last.priorityLevel,t))n=e.last;else for(e=e.first;null!==e&&0>=V(e.priorityLevel,t);)n=e,e=e.next;return n}function J(e,t){var n=e.alternate,r=e.updateQueue;null===r&&(r=e.updateQueue=$()),null!==n?null===(e=n.updateQueue)&&(e=n.updateQueue=$()):e=null,Nr=r,Ar=e!==r?e:null;var i=Nr;n=Ar;var a=Q(i,t),o=null!==a?a.next:i.first;return null===n?(q(i,t,a,o),null):(r=Q(n,t),e=null!==r?r.next:n.first,q(i,t,a,o),o===e&&null!==o||a===r&&null!==a?(null===r&&(n.first=t),null===e&&(n.last=null),null):(t={priorityLevel:t.priorityLevel,partialState:t.partialState,callback:t.callback,isReplace:t.isReplace,isForced:t.isForced,isTopLevelUnmount:t.isTopLevelUnmount,next:null},q(n,t,r,e),t))}function Y(e,t,n,r){return e=e.partialState,"function"==typeof e?e.call(t,n,r):e}function G(e,t,n){e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n}function X(e){return e.tag===zr&&null!=e.type.childContextTypes}function Z(e,t){var n=e.stateNode,i=e.type.childContextTypes;if("function"!=typeof n.getChildContext)return t;n=n.getChildContext();for(var a in n)a in i||r("108",p(e)||"Unknown",a);return yt({},t,n)}function ee(e,t,n){this.tag=e,this.key=t,this.stateNode=this.type=null,this.sibling=this.child=this.return=null,this.index=0,this.memoizedState=this.updateQueue=this.memoizedProps=this.pendingProps=this.ref=null,this.internalContextTag=n,this.effectTag=li,this.lastEffect=this.firstEffect=this.nextEffect=null,this.pendingWorkPriority=ui,this.alternate=null}function te(e,t,n){var i=void 0;return"function"==typeof e?(i=e.prototype&&e.prototype.isReactComponent?new ee(Zr,t,n):new ee(Xr,t,n),i.type=e):"string"==typeof e?(i=new ee(ti,t,n),i.type=e):"object"==typeof e&&null!==e&&"number"==typeof e.tag?i=e:r("130",null==e?e:typeof e,""),i}function ne(e){return null===e||void 0===e?null:(e=Bi&&e[Bi]||e["@@iterator"],"function"==typeof e?e:null)}function re(e,t){var n=t.ref;if(null!==n&&"function"!=typeof n){if(t._owner){t=t._owner;var i=void 0;t&&("number"==typeof t.tag?(t.tag!==Fi&&r("110"),i=t.stateNode):i=t.getPublicInstance()),i||r("147",n);var a=""+n;return null!==e&&null!==e.ref&&e.ref._stringRef===a?e.ref:(e=function(e){var t=i.refs===kt?i.refs={}:i.refs;null===e?delete t[a]:t[a]=e},e._stringRef=a,e)}"string"!=typeof n&&r("148"),t._owner||r("149",n)}return n}function ie(e,t){"textarea"!==e.type&&r("31","[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,"")}function ae(e,t){function n(n,r){if(t){if(!e){if(null===r.alternate)return;r=r.alternate}var i=n.lastEffect;null!==i?(i.nextEffect=r,n.lastEffect=r):n.firstEffect=n.lastEffect=r,r.nextEffect=null,r.effectTag=Ui}}function i(e,r){if(!t)return null;for(;null!==r;)n(e,r),r=r.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(t,n){return e?(t=xi(t,n),t.index=0,t.sibling=null,t):(t.pendingWorkPriority=n,t.effectTag=Li,t.index=0,t.sibling=null,t)}function u(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index,r<n?(e.effectTag=ji,n):r):(e.effectTag=ji,n):n}function s(e){return t&&null===e.alternate&&(e.effectTag=ji),e}function l(e,t,n,r){return null===t||t.tag!==Oi?(n=Ci(n,e.internalContextTag,r),n.return=e,n):(t=o(t,r),t.pendingProps=n,t.return=e,t)}function c(e,t,n,r){return null===t||t.type!==n.type?(r=Si(n,e.internalContextTag,r),r.ref=re(t,n),r.return=e,r):(r=o(t,r),r.ref=re(t,n),r.pendingProps=n.props,r.return=e,r)}function f(e,t,n,r){return null===t||t.tag!==Mi?(n=_i(n,e.internalContextTag,r),n.return=e,n):(t=o(t,r),t.pendingProps=n,t.return=e,t)}function p(e,t,n,r){return null===t||t.tag!==Ni?(t=Ti(n,e.internalContextTag,r),t.type=n.value,t.return=e,t):(t=o(t,r),t.type=n.value,t.return=e,t)}function d(e,t,n,r){return null===t||t.tag!==Di||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?(n=Pi(n,e.internalContextTag,r),n.return=e,n):(t=o(t,r),t.pendingProps=n.children||[],t.return=e,t)}function h(e,t,n,r){return null===t||t.tag!==Ai?(n=Ei(n,e.internalContextTag,r),n.return=e,n):(t=o(t,r),t.pendingProps=n,t.return=e,t)}function m(e,t,n){if("string"==typeof t||"number"==typeof t)return t=Ci(""+t,e.internalContextTag,n),t.return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Hi:return n=Si(t,e.internalContextTag,n),n.ref=re(null,t),n.return=e,n;case bi:return t=_i(t,e.internalContextTag,n),t.return=e,t;case ki:return n=Ti(t,e.internalContextTag,n),n.type=t.value,n.return=e,n;case wi:return t=Pi(t,e.internalContextTag,n),t.return=e,t}if(Ii(t)||ne(t))return t=Ei(t,e.internalContextTag,n),t.return=e,t;ie(e,t)}return null}function v(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Hi:return n.key===i?c(e,t,n,r):null;case bi:return n.key===i?f(e,t,n,r):null;case ki:return null===i?p(e,t,n,r):null;case wi:return n.key===i?d(e,t,n,r):null}if(Ii(n)||ne(n))return null!==i?null:h(e,t,n,r);ie(e,n)}return null}function y(e,t,n,r,i){if("string"==typeof r||"number"==typeof r)return e=e.get(n)||null,l(t,e,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case Hi:return e=e.get(null===r.key?n:r.key)||null,c(t,e,r,i);case bi:return e=e.get(null===r.key?n:r.key)||null,f(t,e,r,i);case ki:return e=e.get(n)||null,p(t,e,r,i);case wi:return e=e.get(null===r.key?n:r.key)||null,d(t,e,r,i)}if(Ii(r)||ne(r))return e=e.get(n)||null,h(t,e,r,i);ie(t,r)}return null}function g(e,r,o,s){for(var l=null,c=null,f=r,p=r=0,d=null;null!==f&&p<o.length;p++){f.index>p?(d=f,f=null):d=f.sibling;var h=v(e,f,o[p],s);if(null===h){null===f&&(f=d);break}t&&f&&null===h.alternate&&n(e,f),r=u(h,r,p),null===c?l=h:c.sibling=h,c=h,f=d}if(p===o.length)return i(e,f),l;if(null===f){for(;p<o.length;p++)(f=m(e,o[p],s))&&(r=u(f,r,p),null===c?l=f:c.sibling=f,c=f);return l}for(f=a(e,f);p<o.length;p++)(d=y(f,e,p,o[p],s))&&(t&&null!==d.alternate&&f.delete(null===d.key?p:d.key),r=u(d,r,p),null===c?l=d:c.sibling=d,c=d);return t&&f.forEach(function(t){return n(e,t)}),l}function b(e,o,s,l){var c=ne(s);"function"!=typeof c&&r("150"),null==(s=c.call(s))&&r("151");for(var f=c=null,p=o,d=o=0,h=null,g=s.next();null!==p&&!g.done;d++,g=s.next()){p.index>d?(h=p,p=null):h=p.sibling;var b=v(e,p,g.value,l);if(null===b){p||(p=h);break}t&&p&&null===b.alternate&&n(e,p),o=u(b,o,d),null===f?c=b:f.sibling=b,f=b,p=h}if(g.done)return i(e,p),c;if(null===p){for(;!g.done;d++,g=s.next())null!==(g=m(e,g.value,l))&&(o=u(g,o,d),null===f?c=g:f.sibling=g,f=g);return c}for(p=a(e,p);!g.done;d++,g=s.next())null!==(g=y(p,e,d,g.value,l))&&(t&&null!==g.alternate&&p.delete(null===g.key?d:g.key),o=u(g,o,d),null===f?c=g:f.sibling=g,f=g);return t&&p.forEach(function(t){return n(e,t)}),c}return function(e,t,a,u){var l="object"==typeof a&&null!==a;if(l)switch(a.$$typeof){case Hi:e:{var c=a.key;for(l=t;null!==l;){if(l.key===c){if(l.type===a.type){i(e,l.sibling),t=o(l,u),t.ref=re(l,a),t.pendingProps=a.props,t.return=e,e=t;break e}i(e,l);break}n(e,l),l=l.sibling}u=Si(a,e.internalContextTag,u),u.ref=re(t,a),u.return=e,e=u}return s(e);case bi:e:{for(l=a.key;null!==t;){if(t.key===l){if(t.tag===Mi){i(e,t.sibling),t=o(t,u),t.pendingProps=a,t.return=e,e=t;break e}i(e,t);break}n(e,t),t=t.sibling}a=_i(a,e.internalContextTag,u),a.return=e,e=a}return s(e);case ki:e:{if(null!==t){if(t.tag===Ni){i(e,t.sibling),t=o(t,u),t.type=a.value,t.return=e,e=t;break e}i(e,t)}t=Ti(a,e.internalContextTag,u),t.type=a.value,t.return=e,e=t}return s(e);case wi:e:{for(l=a.key;null!==t;){if(t.key===l){if(t.tag===Di&&t.stateNode.containerInfo===a.containerInfo&&t.stateNode.implementation===a.implementation){i(e,t.sibling),t=o(t,u),t.pendingProps=a.children||[],t.return=e,e=t;break e}i(e,t);break}n(e,t),t=t.sibling}a=Pi(a,e.internalContextTag,u),a.return=e,e=a}return s(e)}if("string"==typeof a||"number"==typeof a)return a=""+a,null!==t&&t.tag===Oi?(i(e,t.sibling),t=o(t,u),t.pendingProps=a,t.return=e,e=t):(i(e,t),a=Ci(a,e.internalContextTag,u),a.return=e,e=a),s(e);if(Ii(a))return g(e,t,a,u);if(ne(a))return b(e,t,a,u);if(l&&ie(e,a),void 0===a)switch(e.tag){case Fi:case Ri:a=e.type,r("152",a.displayName||a.name||"Component")}return i(e,t)}}function oe(e,t,n,i){function a(e,t){t.updater=o,e.stateNode=t,Qt.set(t,e)}var o={isMounted:ra,enqueueSetState:function(n,r,i){n=Qt.get(n);var a=t(n,!1);Xi(n,r,void 0===i?null:i,a),e(n,a)},enqueueReplaceState:function(n,r,i){n=Qt.get(n);var a=t(n,!1);Zi(n,r,void 0===i?null:i,a),e(n,a)},enqueueForceUpdate:function(n,r){n=Qt.get(n);var i=t(n,!1);ea(n,void 0===r?null:r,i),e(n,i)}};return{adoptClassInstance:a,constructClassInstance:function(e,t){var n=e.type,r=Yi(e),i=Gi(e),o=i?Ji(e,r):kt;return t=new n(t,o),a(e,t),i&&Qi(e,r,o),t},mountClassInstance:function(e,t){var n=e.alternate,i=e.stateNode,a=i.state||null,u=e.pendingProps;u||r("158");var s=Yi(e);i.props=u,i.state=a,i.refs=kt,i.context=Ji(e,s),Tr.enableAsyncSubtreeAPI&&null!=e.type&&null!=e.type.prototype&&!0===e.type.prototype.unstable_isAsyncReactComponent&&(e.internalContextTag|=qi),"function"==typeof i.componentWillMount&&(s=i.state,i.componentWillMount(),s!==i.state&&o.enqueueReplaceState(i,i.state,null),null!==(s=e.updateQueue)&&(i.state=ta(n,e,s,i,a,u,t))),"function"==typeof i.componentDidMount&&(e.effectTag|=$i)},updateClassInstance:function(e,t,a){var u=t.stateNode;u.props=t.memoizedProps,u.state=t.memoizedState;var s=t.memoizedProps,l=t.pendingProps;l||null==(l=s)&&r("159");var c=u.context,f=Yi(t);if(f=Ji(t,f),"function"!=typeof u.componentWillReceiveProps||s===l&&c===f||(c=u.state,u.componentWillReceiveProps(l,f),u.state!==c&&o.enqueueReplaceState(u,u.state,null)),c=t.memoizedState,a=null!==t.updateQueue?ta(e,t,t.updateQueue,u,c,l,a):c,!(s!==l||c!==a||na()||null!==t.updateQueue&&t.updateQueue.hasForceUpdate))return"function"!=typeof u.componentDidUpdate||s===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=$i),!1;var p=l;if(null===s||null!==t.updateQueue&&t.updateQueue.hasForceUpdate)p=!0;else{var d=t.stateNode,h=t.type;p="function"==typeof d.shouldComponentUpdate?d.shouldComponentUpdate(p,a,f):!h.prototype||!h.prototype.isPureReactComponent||(!wt(s,p)||!wt(c,a))}return p?("function"==typeof u.componentWillUpdate&&u.componentWillUpdate(l,a,f),"function"==typeof u.componentDidUpdate&&(t.effectTag|=$i)):("function"!=typeof u.componentDidUpdate||s===e.memoizedProps&&c===e.memoizedState||(t.effectTag|=$i),n(t,l),i(t,a)),u.props=l,u.state=a,u.context=f,p}}}function ue(e,t,n,i,a){function o(e,t,n){u(e,t,n,t.pendingWorkPriority)}function u(e,t,n,r){t.child=null===e?ia(t,t.child,n,r):e.child===t.child?aa(t,t.child,n,r):oa(t,t.child,n,r)}function s(e,t){var n=t.ref;null===n||e&&e.ref===n||(t.effectTag|=Oa)}function l(e,t,n,r){if(s(e,t),!n)return r&&ha(t,!1),f(e,t);n=t.stateNode,Da.current=t;var i=n.render();return t.effectTag|=Pa,o(e,t,i),t.memoizedState=n.state,t.memoizedProps=n.props,r&&ha(t,!0),t.child}function c(e){var t=e.stateNode;t.pendingContext?da(e,t.pendingContext,t.pendingContext!==t.context):t.context&&da(e,t.context,!1),y(e,t.containerInfo)}function f(e,t){return ua(e,t),t.child}function p(e,t){switch(t.tag){case ga:c(t);break;case ya:pa(t);break;case wa:y(t,t.stateNode.containerInfo)}return null}var d=e.shouldSetTextContent,h=e.useSyncScheduling,m=e.shouldDeprioritizeSubtree,v=t.pushHostContext,y=t.pushHostContainer,g=n.enterHydrationState,b=n.resetHydrationState,k=n.tryToClaimNextHydratableInstance;e=oe(i,a,function(e,t){e.memoizedProps=t},function(e,t){e.memoizedState=t});var w=e.adoptClassInstance,x=e.constructClassInstance,S=e.mountClassInstance,E=e.updateClassInstance;return{beginWork:function(e,t,n){if(t.pendingWorkPriority===_a||t.pendingWorkPriority>n)return p(e,t);switch(t.tag){case ma:null!==e&&r("155");var i=t.type,a=t.pendingProps,u=ca(t);return u=la(t,u),i=i(a,u),t.effectTag|=Pa,"object"==typeof i&&null!==i&&"function"==typeof i.render?(t.tag=ya,a=pa(t),w(t,i),S(t,n),t=l(e,t,!0,a)):(t.tag=va,o(e,t,i),t.memoizedProps=a,t=t.child),t;case va:e:{if(a=t.type,n=t.pendingProps,i=t.memoizedProps,fa())null===n&&(n=i);else if(null===n||i===n){t=f(e,t);break e}i=ca(t),i=la(t,i),a=a(n,i),t.effectTag|=Pa,o(e,t,a),t.memoizedProps=n,t=t.child}return t;case ya:return a=pa(t),i=void 0,null===e?t.stateNode?r("153"):(x(t,t.pendingProps),S(t,n),i=!0):i=E(e,t,n),l(e,t,i,a);case ga:return c(t),i=t.updateQueue,null!==i?(a=t.memoizedState,i=sa(e,t,i,null,a,null,n),a===i?(b(),t=f(e,t)):(a=i.element,null!==e&&null!==e.child||!g(t)?(b(),o(e,t,a)):(t.effectTag|=Ia,t.child=ia(t,t.child,a,n)),t.memoizedState=i,t=t.child)):(b(),t=f(e,t)),t;case ba:v(t),null===e&&k(t),a=t.type;var C=t.memoizedProps;return i=t.pendingProps,null===i&&null===(i=C)&&r("154"),u=null!==e?e.memoizedProps:null,fa()||null!==i&&C!==i?(C=i.children,d(a,i)?C=null:u&&d(a,u)&&(t.effectTag|=Ra),s(e,t),n!==Ta&&!h&&m(a,i)?(t.pendingWorkPriority=Ta,t=null):(o(e,t,C),t.memoizedProps=i,t=t.child)):t=f(e,t),t;case ka:return null===e&&k(t),e=t.pendingProps,null===e&&(e=t.memoizedProps),t.memoizedProps=e,null;case Sa:t.tag=xa;case xa:return n=t.pendingProps,fa()?null===n&&null===(n=e&&e.memoizedProps)&&r("154"):null!==n&&t.memoizedProps!==n||(n=t.memoizedProps),a=n.children,i=t.pendingWorkPriority,t.stateNode=null===e?ia(t,t.stateNode,a,i):e.child===t.child?aa(t,t.stateNode,a,i):oa(t,t.stateNode,a,i),t.memoizedProps=n,t.stateNode;case Ea:return null;case wa:e:{if(y(t,t.stateNode.containerInfo),n=t.pendingWorkPriority,a=t.pendingProps,fa())null===a&&null==(a=e&&e.memoizedProps)&&r("154");else if(null===a||t.memoizedProps===a){t=f(e,t);break e}null===e?t.child=oa(t,t.child,a,n):o(e,t,a),t.memoizedProps=a,t=t.child}return t;case Ca:e:{if(n=t.pendingProps,fa())null===n&&(n=t.memoizedProps);else if(null===n||t.memoizedProps===n){t=f(e,t);break e}o(e,t,n),t.memoizedProps=n,t=t.child}return t;default:r("156")}},beginFailedWork:function(e,t,n){switch(t.tag){case ya:pa(t);break;case ga:c(t);break;default:r("157")}return t.effectTag|=Fa,null===e?t.child=null:t.child!==e.child&&(t.child=e.child),t.pendingWorkPriority===_a||t.pendingWorkPriority>n?p(e,t):(t.firstEffect=null,t.lastEffect=null,u(e,t,null,n),t.tag===ya&&(e=t.stateNode,t.memoizedProps=e.props,t.memoizedState=e.state),t.child)}}}function se(e,t,n){var i=e.createInstance,a=e.createTextInstance,o=e.appendInitialChild,u=e.finalizeInitialChildren,s=e.prepareUpdate,l=t.getRootHostContainer,c=t.popHostContext,f=t.getHostContext,p=t.popHostContainer,d=n.prepareToHydrateHostInstance,h=n.prepareToHydrateHostTextInstance,m=n.popHydrationState;return{completeWork:function(e,t,n){var v=t.pendingProps;switch(null===v?v=t.memoizedProps:t.pendingWorkPriority===Ga&&n!==Ga||(t.pendingProps=null),t.tag){case ja:return null;case Ua:return Na(t),null;case Ba:return p(t),Aa(t),v=t.stateNode,v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),null!==e&&null!==e.child||(m(t),t.effectTag&=~Qa),null;case Ha:c(t),n=l();var y=t.type;if(null!==e&&null!=t.stateNode){var g=e.memoizedProps,b=t.stateNode,k=f();v=s(b,y,g,v,n,k),(t.updateQueue=v)&&(t.effectTag|=Ya),e.ref!==t.ref&&(t.effectTag|=Ja)}else{if(!v)return null===t.stateNode&&r("166"),null;if(e=f(),m(t))d(t,n,e)&&(t.effectTag|=Ya);else{e=i(y,v,n,e,t);e:for(g=t.child;null!==g;){if(g.tag===Ha||g.tag===za)o(e,g.stateNode);else if(g.tag!==Wa&&null!==g.child){g=g.child;continue}if(g===t)break e;for(;null===g.sibling;){if(null===g.return||g.return===t)break e;g=g.return}g=g.sibling}u(e,y,v,n)&&(t.effectTag|=Ya),t.stateNode=e}null!==t.ref&&(t.effectTag|=Ja)}return null;case za:if(e&&null!=t.stateNode)e.memoizedProps!==v&&(t.effectTag|=Ya);else{if("string"!=typeof v)return null===t.stateNode&&r("166"),null;e=l(),n=f(),m(t)?h(t)&&(t.effectTag|=Ya):t.stateNode=a(v,e,n,t)}return null;case Ka:(v=t.memoizedProps)||r("165"),t.tag=Va,n=[];e:for((y=t.stateNode)&&(y.return=t);null!==y;){if(y.tag===Ha||y.tag===za||y.tag===Wa)r("164");else if(y.tag===$a)n.push(y.type);else if(null!==y.child){y.child.return=y,y=y.child;continue}for(;null===y.sibling;){if(null===y.return||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}return y=v.handler,v=y(v.props,n),t.child=Ma(t,null!==e?e.child:null,v,t.pendingWorkPriority),t.child;case Va:return t.tag=Ka,null;case $a:case qa:return null;case Wa:return t.effectTag|=Ya,p(t),null;case La:r("167");default:r("156")}}}}function le(e){return function(t){try{return e(t)}catch(e){}}}function ce(e,t){function n(e){var n=e.ref;if(null!==n)try{n(null)}catch(n){t(e,n)}}function i(e){return e.tag===ro||e.tag===no||e.tag===ao}function a(e){for(var t=e;;)if(u(t),null!==t.child&&t.tag!==ao)t.child.return=t,t=t.child;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}}function o(e){for(var t=e,n=!1,i=void 0,o=void 0;;){if(!n){n=t.return;e:for(;;){switch(null===n&&r("160"),n.tag){case ro:i=n.stateNode,o=!1;break e;case no:case ao:i=n.stateNode.containerInfo,o=!0;break e}n=n.return}n=!0}if(t.tag===ro||t.tag===io)a(t),o?y(i,t.stateNode):v(i,t.stateNode);else if(t.tag===ao?i=t.stateNode.containerInfo:u(t),null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;t=t.return,t.tag===ao&&(n=!1)}t.sibling.return=t.return,t=t.sibling}}function u(e){switch("function"==typeof so&&so(e),e.tag){case to:n(e);var r=e.stateNode;if("function"==typeof r.componentWillUnmount)try{r.props=e.memoizedProps,r.state=e.memoizedState,r.componentWillUnmount()}catch(n){t(e,n)}break;case ro:n(e);break;case oo:a(e.stateNode);break;case ao:o(e)}}var s=e.commitMount,l=e.commitUpdate,c=e.resetTextContent,f=e.commitTextUpdate,p=e.appendChild,d=e.appendChildToContainer,h=e.insertBefore,m=e.insertInContainerBefore,v=e.removeChild,y=e.removeChildFromContainer,g=e.getPublicInstance;return{commitPlacement:function(e){e:{for(var t=e.return;null!==t;){if(i(t)){var n=t;break e}t=t.return}r("160"),n=void 0}var a=t=void 0;switch(n.tag){case ro:t=n.stateNode,a=!1;break;case no:case ao:t=n.stateNode.containerInfo,a=!0;break;default:r("161")}n.effectTag&po&&(c(t),n.effectTag&=~po);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||i(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==ro&&n.tag!==io;){if(n.effectTag&lo)continue t;if(null===n.child||n.tag===ao)continue t;n.child.return=n,n=n.child}if(!(n.effectTag&lo)){n=n.stateNode;break e}}for(var o=e;;){if(o.tag===ro||o.tag===io)n?a?m(t,o.stateNode,n):h(t,o.stateNode,n):a?d(t,o.stateNode):p(t,o.stateNode);else if(o.tag!==ao&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===e)break;for(;null===o.sibling;){if(null===o.return||o.return===e)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},commitDeletion:function(e){o(e),e.return=null,e.child=null,e.alternate&&(e.alternate.child=null,e.alternate.return=null)},commitWork:function(e,t){switch(t.tag){case to:break;case ro:var n=t.stateNode;if(null!=n){var i=t.memoizedProps;e=null!==e?e.memoizedProps:i;var a=t.type,o=t.updateQueue;t.updateQueue=null,null!==o&&l(n,o,a,e,i,t)}break;case io:null===t.stateNode&&r("162"),n=t.memoizedProps,f(t.stateNode,null!==e?e.memoizedProps:n,n);break;case no:case ao:break;default:r("163")}},commitLifeCycles:function(e,t){switch(t.tag){case to:var n=t.stateNode;if(t.effectTag&co)if(null===e)n.props=t.memoizedProps,n.state=t.memoizedState,n.componentDidMount();else{var i=e.memoizedProps;e=e.memoizedState,n.props=t.memoizedProps,n.state=t.memoizedState,n.componentDidUpdate(i,e)}t.effectTag&fo&&null!==t.updateQueue&&uo(t,t.updateQueue,n);break;case no:e=t.updateQueue,null!==e&&uo(t,e,t.child&&t.child.stateNode);break;case ro:n=t.stateNode,null===e&&t.effectTag&co&&s(n,t.type,t.memoizedProps,t);break;case io:case ao:break;default:r("163")}},commitAttachRef:function(e){var t=e.ref;if(null!==t){var n=e.stateNode;switch(e.tag){case ro:t(g(n));break;default:t(n)}}},commitDetachRef:function(e){null!==(e=e.ref)&&e(null)}}}function fe(e){function t(e){return e===yo&&r("174"),e}var n=e.getChildHostContext,i=e.getRootHostContext,a=ho(yo),o=ho(yo),u=ho(yo);return{getHostContext:function(){return t(a.current)},getRootHostContainer:function(){return t(u.current)},popHostContainer:function(e){mo(a,e),mo(o,e),mo(u,e)},popHostContext:function(e){o.current===e&&(mo(a,e),mo(o,e))},pushHostContainer:function(e,t){vo(u,t,e),t=i(t),vo(o,e,e),vo(a,t,e)},pushHostContext:function(e){var r=t(u.current),i=t(a.current);r=n(i,e.type,r),i!==r&&(vo(o,e,e),vo(a,r,e))},resetHostContainer:function(){a.current=yo,u.current=yo}}}function pe(e){function t(e,t){var n=So();n.stateNode=t,n.return=e,n.effectTag=wo,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function n(e,t){switch(e.tag){case go:return o(t,e.type,e.pendingProps);case bo:return u(t,e.pendingProps);default:return!1}}function i(e){for(e=e.return;null!==e&&e.tag!==go&&e.tag!==ko;)e=e.return;h=e}var a=e.shouldSetTextContent,o=e.canHydrateInstance,u=e.canHydrateTextInstance,s=e.getNextHydratableSibling,l=e.getFirstHydratableChild,c=e.hydrateInstance,f=e.hydrateTextInstance,p=e.didNotHydrateInstance,d=e.didNotFindHydratableInstance;if(e=e.didNotFindHydratableTextInstance,!(o&&u&&s&&l&&c&&f&&p&&d&&e))return{enterHydrationState:function(){return!1},resetHydrationState:function(){},tryToClaimNextHydratableInstance:function(){},prepareToHydrateHostInstance:function(){r("175")},prepareToHydrateHostTextInstance:function(){r("176")},popHydrationState:function(){return!1}};var h=null,m=null,v=!1;return{enterHydrationState:function(e){return m=l(e.stateNode.containerInfo),h=e,v=!0},resetHydrationState:function(){m=h=null,v=!1},tryToClaimNextHydratableInstance:function(e){if(v){var r=m;if(r){if(!n(e,r)){if(!(r=s(r))||!n(e,r))return e.effectTag|=xo,v=!1,void(h=e);t(h,m)}e.stateNode=r,h=e,m=l(r)}else e.effectTag|=xo,v=!1,h=e}},prepareToHydrateHostInstance:function(e,t,n){return t=c(e.stateNode,e.type,e.memoizedProps,t,n,e),e.updateQueue=t,null!==t},prepareToHydrateHostTextInstance:function(e){return f(e.stateNode,e.memoizedProps,e)},popHydrationState:function(e){if(e!==h)return!1;if(!v)return i(e),v=!0,!1;var n=e.type;if(e.tag!==go||"head"!==n&&"body"!==n&&!a(n,e.memoizedProps))for(n=m;n;)t(e,n),n=s(n);return i(e),m=h?s(e.stateNode):null,!0}}}function de(e){function t(){for(;null!==$&&$.current.pendingWorkPriority===Ro;){$.isScheduled=!1;var e=$.nextScheduledRoot;if($.nextScheduledRoot=null,$===q)return q=$=null,W=Ro,null;$=e}e=$;for(var t=null,n=Ro;null!==e;)e.current.pendingWorkPriority!==Ro&&(n===Ro||n>e.current.pendingWorkPriority)&&(n=e.current.pendingWorkPriority,t=e),e=e.nextScheduledRoot;null!==t?(W=n,Co(),Go(),x(),z=To(t.current,n),t!==ie&&(re=0,ie=t)):(W=Ro,ie=z=null)}function n(n){ee=!0,V=null;var i=n.stateNode;if(i.current===n&&r("177"),W!==Fo&&W!==Oo||re++,_o.current=null,n.effectTag>Lo)if(null!==n.lastEffect){n.lastEffect.nextEffect=n;var a=n.firstEffect}else a=n;else a=n.firstEffect;for(N(),K=a;null!==K;){var o=!1,u=void 0;try{for(;null!==K;){var s=K.effectTag;if(s&zo&&e.resetTextContent(K.stateNode),s&Vo){var l=K.alternate;null!==l&&O(l)}switch(s&~(Wo|Ko|zo|Vo|Lo)){case jo:T(K),K.effectTag&=~jo;break;case Bo:T(K),K.effectTag&=~jo,I(K.alternate,K);break;case Uo:I(K.alternate,K);break;case Ho:te=!0,P(K),te=!1}K=K.nextEffect}}catch(e){o=!0,u=e}o&&(null===K&&r("178"),f(K,u),null!==K&&(K=K.nextEffect))}for(A(),i.current=n,K=a;null!==K;){i=!1,a=void 0;try{for(;null!==K;){var c=K.effectTag;if(c&(Uo|Wo)&&R(K.alternate,K),c&Vo&&F(K),c&Ko)switch(o=K,u=void 0,null!==J&&(u=J.get(o),J.delete(o),null==u&&null!==o.alternate&&(o=o.alternate,u=J.get(o),J.delete(o))),null==u&&r("184"),o.tag){case Jo:o.stateNode.componentDidCatch(u.error,{componentStack:u.componentStack});break;case $o:null===X&&(X=u.error);break;default:r("157")}var p=K.nextEffect;K.nextEffect=null,K=p}}catch(e){i=!0,a=e}i&&(null===K&&r("178"),f(K,a),null!==K&&(K=K.nextEffect))}ee=!1,"function"==typeof Io&&Io(n.stateNode),G&&(G.forEach(y),G=null),t()}function i(e){for(;;){var t=_(e.alternate,e,W),n=e.return,r=e.sibling,i=e;if(!(i.pendingWorkPriority!==Ro&&i.pendingWorkPriority>W)){for(var a=Yo(i),o=i.child;null!==o;)a=Po(a,o.pendingWorkPriority),o=o.sibling;i.pendingWorkPriority=a}if(null!==t)return t;if(null!==n&&(null===n.firstEffect&&(n.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==n.lastEffect&&(n.lastEffect.nextEffect=e.firstEffect),n.lastEffect=e.lastEffect),e.effectTag>Lo&&(null!==n.lastEffect?n.lastEffect.nextEffect=e:n.firstEffect=e,n.lastEffect=e)),null!==r)return r;if(null===n){V=e;break}e=n}return null}function a(e){var t=E(e.alternate,e,W);return null===t&&(t=i(e)),_o.current=null,t}function o(e){var t=C(e.alternate,e,W);return null===t&&(t=i(e)),_o.current=null,t}function u(e){c(No,e)}function s(){if(null!==J&&0<J.size&&W===Oo)for(;null!==z;){var e=z;if(null===(z=null!==J&&(J.has(e)||null!==e.alternate&&J.has(e.alternate))?o(z):a(z))&&(null===V&&r("179"),L=Oo,n(V),L=W,null===J||0===J.size||W!==Oo))break}}function l(e,i){if(null!==V?(L=Oo,n(V),s()):null===z&&t(),!(W===Ro||W>e)){L=W;e:for(;;){if(W<=Oo)for(;null!==z&&!(null===(z=a(z))&&(null===V&&r("179"),L=Oo,n(V),L=W,s(),W===Ro||W>e||W>Oo)););else if(null!==i)for(;null!==z&&!U;)if(1<i.timeRemaining()){if(null===(z=a(z)))if(null===V&&r("179"),1<i.timeRemaining()){if(L=Oo,n(V),L=W,s(),W===Ro||W>e||W<Do)break}else U=!0}else U=!0;switch(W){case Fo:case Oo:if(W<=e)continue e;break e;case Do:case Mo:case No:if(null===i)break e;if(!U&&W<=e)continue e;break e;case Ro:break e;default:r("181")}}}}function c(e,t){j&&r("182"),j=!0;var n=L,i=!1,a=null;try{l(e,t)}catch(e){i=!0,a=e}for(;i;){if(Z){X=a;break}var s=z;if(null===s)Z=!0;else{var c=f(s,a);if(null===c&&r("183"),!Z){try{i=c,a=e,c=t;for(var p=i;null!==s;){switch(s.tag){case Jo:Eo(s);break;case qo:w(s);break;case $o:k(s);break;case Qo:k(s)}if(s===p||s.alternate===p)break;s=s.return}z=o(i),l(a,c)}catch(e){i=!0,a=e;continue}break}}}if(L=n,null!==t&&(Q=!1),W>Oo&&!Q&&(D(u),Q=!0),e=X,Z=U=j=!1,ie=Y=J=X=null,re=0,null!==e)throw e}function f(e,t){var n=_o.current=null,r=!1,i=!1,a=null;if(e.tag===$o)n=e,d(e)&&(Z=!0);else for(var o=e.return;null!==o&&null===n;){if(o.tag===Jo?"function"==typeof o.stateNode.componentDidCatch&&(r=!0,a=p(o),n=o,i=!0):o.tag===$o&&(n=o),d(o)){if(te||null!==G&&(G.has(o)||null!==o.alternate&&G.has(o.alternate)))return null;n=null,i=!1}o=o.return}if(null!==n){null===Y&&(Y=new Set),Y.add(n);var u="";o=e;do{e:switch(o.tag){case pi:case di:case hi:case mi:var s=o._debugOwner,l=o._debugSource,c=p(o),f=null;s&&(f=p(s)),s=l,c="\n    in "+(c||"Unknown")+(s?" (at "+s.fileName.replace(/^.*[\\\/]/,"")+":"+s.lineNumber+")":f?" (created by "+f+")":"");break e;default:c=""}u+=c,o=o.return}while(o);o=u,e=p(e),null===J&&(J=new Map),t={componentName:e,componentStack:o,error:t,errorBoundary:r?n.stateNode:null,errorBoundaryFound:r,errorBoundaryName:a,willRetry:i},J.set(n,t);try{console.error(t.error)}catch(e){console.error(e)}return ee?(null===G&&(G=new Set),G.add(n)):y(n),n}return null===X&&(X=t),null}function d(e){return null!==Y&&(Y.has(e)||null!==e.alternate&&Y.has(e.alternate))}function h(e,t){return m(e,t,!1)}function m(e,t){re>ne&&(Z=!0,r("185")),!j&&t<=W&&(z=null);for(var n=!0;null!==e&&n;){if(n=!1,(e.pendingWorkPriority===Ro||e.pendingWorkPriority>t)&&(n=!0,e.pendingWorkPriority=t),null!==e.alternate&&(e.alternate.pendingWorkPriority===Ro||e.alternate.pendingWorkPriority>t)&&(n=!0,e.alternate.pendingWorkPriority=t),null===e.return){if(e.tag!==$o)break;var i=e.stateNode;if(t===Ro||i.isScheduled||(i.isScheduled=!0,q?q.nextScheduledRoot=i:$=i,q=i),!j)switch(t){case Fo:H?c(Fo,null):c(Oo,null);break;case Oo:B||r("186");break;default:Q||(D(u),Q=!0)}}e=e.return}}function v(e,t){var n=L;return n===Ro&&(n=!M||e.internalContextTag&Ao||t?Mo:Fo),n===Fo&&(j||B)?Oo:n}function y(e){m(e,Oo,!0)}var g=fe(e),b=pe(e),k=g.popHostContainer,w=g.popHostContext,x=g.resetHostContainer,S=ue(e,g,b,h,v),E=S.beginWork,C=S.beginFailedWork,_=se(e,g,b).completeWork;g=ce(e,f);var T=g.commitPlacement,P=g.commitDeletion,I=g.commitWork,R=g.commitLifeCycles,F=g.commitAttachRef,O=g.commitDetachRef,D=e.scheduleDeferredCallback,M=e.useSyncScheduling,N=e.prepareForCommit,A=e.resetAfterCommit,L=Ro,j=!1,U=!1,B=!1,H=!1,z=null,W=Ro,K=null,V=null,$=null,q=null,Q=!1,J=null,Y=null,G=null,X=null,Z=!1,ee=!1,te=!1,ne=1e3,re=0,ie=null;return{scheduleUpdate:h,getPriorityContext:v,batchedUpdates:function(e,t){var n=B;B=!0;try{return e(t)}finally{B=n,j||B||c(Oo,null)}},unbatchedUpdates:function(e){var t=H,n=B;H=B,B=!1;try{return e()}finally{B=n,H=t}},flushSync:function(e){var t=B,n=L;B=!0,L=Fo;try{return e()}finally{B=t,L=n,j&&r("187"),c(Oo,null)}},deferredUpdates:function(e){var t=L;L=Mo;try{return e()}finally{L=t}}}}function he(){r("196")}function me(e){return e?(e=Qt.get(e),"number"==typeof e.tag?he(e):e._processChildContext(e._context)):kt}function ve(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ye(e,t){var n=ve(e);e=0;for(var r;n;){if(n.nodeType===au){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ve(n)}}function ge(){return!ou&&vt.canUseDOM&&(ou="textContent"in document.documentElement?"textContent":"innerText"),ou}function be(){r("211")}function ke(){r("212")}function we(e){if(null==e)return null;if(e.nodeType===fu)return e;var t=Qt.get(e);if(t)return"number"==typeof t.tag?be(t):ke(t);"function"==typeof e.render?r("188"):r("213",Object.keys(e))}function xe(e){if(void 0!==e._hostParent)return e._hostParent;if("number"==typeof e.tag){do{e=e.return}while(e&&e.tag!==pu);if(e)return e}return null}function Se(e,t){for(var n=0,r=e;r;r=xe(r))n++;r=0;for(var i=t;i;i=xe(i))r++;for(;0<n-r;)e=xe(e),n--;for(;0<r-n;)t=xe(t),r--;for(;n--;){if(e===t||e===t.alternate)return e;e=xe(e),t=xe(t)}return null}function Ee(e,t,n){(t=hu(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=C(n._dispatchListeners,t),n._dispatchInstances=C(n._dispatchInstances,e))}function Ce(e){e&&e.dispatchConfig.phasedRegistrationNames&&du.traverseTwoPhase(e._targetInst,Ee,e)}function _e(e){if(e&&e.dispatchConfig.phasedRegistrationNames){var t=e._targetInst;t=t?du.getParentInstance(t):null,du.traverseTwoPhase(t,Ee,e)}}function Te(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=hu(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=C(n._dispatchListeners,t),n._dispatchInstances=C(n._dispatchInstances,e))}function Pe(e){e&&e.dispatchConfig.registrationName&&Te(e._targetInst,null,e)}function Ie(e,t,n,r){this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface;for(var i in e)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?bt.thatReturnsTrue:bt.thatReturnsFalse,this.isPropagationStopped=bt.thatReturnsFalse,this}function Re(e,t,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,n,r),i}return new this(e,t,n,r)}function Fe(e){e instanceof this||r("223"),e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function Oe(e){e.eventPool=[],e.getPooled=Re,e.release=Fe}function De(e,t,n,r){return Ie.call(this,e,t,n,r)}function Me(e,t,n,r){return Ie.call(this,e,t,n,r)}function Ne(e,t){switch(e){case"topKeyUp":return-1!==wu.indexOf(t.keyCode);case"topKeyDown":return 229!==t.keyCode;case"topKeyPress":case"topMouseDown":case"topBlur":return!0;default:return!1}}function Ae(e){return e=e.detail,"object"==typeof e&&"data"in e?e.data:null}function Le(e,t){switch(e){case"topCompositionEnd":return Ae(t);case"topKeyPress":return 32!==t.which?null:(Ru=!0,Pu);case"topTextInput":return e=t.data,e===Pu&&Ru?null:e;default:return null}}function je(e,t){if(Fu)return"topCompositionEnd"===e||!xu&&Ne(e,t)?(e=gu.getData(),gu.reset(),Fu=!1,e):null;switch(e){case"topPaste":return null;case"topKeyPress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"topCompositionEnd":return Tu?null:t.data;default:return null}}function Ue(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Du[e.type]:"textarea"===t}function Be(e,t,n){return e=Ie.getPooled(Mu.change,e,t,n),e.type="change",pn.enqueueStateRestore(n),mu.accumulateTwoPhaseDispatches(e),e}function He(e){wn.enqueueEvents(e),wn.processEventQueue(!1)}function ze(e){var t=qt.getNodeFromInstance(e);if(Zn.updateValueIfChanged(t))return e}function We(e,t){if("topChange"===e)return t}function Ke(){Nu&&(Nu.detachEvent("onpropertychange",Ve),Au=Nu=null)}function Ve(e){"value"===e.propertyName&&ze(Au)&&(e=Be(Au,e,S(e)),hn.batchedUpdates(He,e))}function $e(e,t,n){"topFocus"===e?(Ke(),Nu=t,Au=n,Nu.attachEvent("onpropertychange",Ve)):"topBlur"===e&&Ke()}function qe(e){if("topSelectionChange"===e||"topKeyUp"===e||"topKeyDown"===e)return ze(Au)}function Qe(e,t){if("topClick"===e)return ze(t)}function Je(e,t){if("topInput"===e||"topChange"===e)return ze(t)}function Ye(e,t,n,r){return Ie.call(this,e,t,n,r)}function Ge(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Uu[e])&&!!t[e]}function Xe(){return Ge}function Ze(e,t,n,r){return Ie.call(this,e,t,n,r)}function et(e,t){if(Qu||null==Vu||Vu!==Et())return null;var n=Vu;return"selectionStart"in n&&cu.hasSelectionCapabilities(n)?n={start:n.selectionStart,end:n.selectionEnd}:window.getSelection?(n=window.getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}):n=void 0,qu&&wt(qu,n)?null:(qu=n,e=Ie.getPooled(Ku.select,$u,e,t),e.type="select",e.target=Vu,mu.accumulateTwoPhaseDispatches(e),e)}function tt(e,t,n,r){return Ie.call(this,e,t,n,r)}function nt(e,t,n,r){return Ie.call(this,e,t,n,r)}function rt(e,t,n,r){return Ie.call(this,e,t,n,r)}function it(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,32<=e||13===e?e:0}function at(e,t,n,r){return Ie.call(this,e,t,n,r)}function ot(e,t,n,r){return Ie.call(this,e,t,n,r)}function ut(e,t,n,r){return Ie.call(this,e,t,n,r)}function st(e,t,n,r){return Ie.call(this,e,t,n,r)}function lt(e,t,n,r){return Ie.call(this,e,t,n,r)}function ct(e){return e[1].toUpperCase()}function ft(e){return!(!e||e.nodeType!==ds&&e.nodeType!==vs&&e.nodeType!==ys&&(e.nodeType!==ms||" react-mount-point-unstable "!==e.nodeValue))}function pt(e){return!(!(e=e?e.nodeType===vs?e.documentElement:e.firstChild:null)||e.nodeType!==ds||!e.hasAttribute(gs))}function dt(e,t,n,i,a){ft(n)||r("200");var o=n._reactRootContainer;if(o)Ns.updateContainer(t,o,e,a);else{if(!i&&!pt(n))for(i=void 0;i=n.lastChild;)n.removeChild(i);var u=Ns.createContainer(n);o=n._reactRootContainer=u,Ns.unbatchedUpdates(function(){Ns.updateContainer(t,u,e,a)})}return Ns.getPublicRootInstance(o)}function ht(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return ft(t)||r("200"),gi.createPortal(e,t,null,n)}var mt=n(0);n(11);var vt=n(12),yt=n(1),gt=n(13),bt=n(2),kt=n(14),wt=n(15),xt=n(16),St=n(19),Et=n(20);mt||r("227");var Ct,_t,Tt={Namespaces:{html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"},getIntrinsicNamespace:i,getChildNamespace:function(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?i(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}},Pt=null,It={},Rt={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},possibleRegistrationNames:null,injectEventPluginOrder:function(e){Pt&&r("101"),Pt=Array.prototype.slice.call(e),a()},injectEventPluginsByName:function(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var i=e[t];It.hasOwnProperty(t)&&It[t]===i||(It[t]&&r("102",t),It[t]=i,n=!0)}n&&a()}},Ft=Rt,Ot={children:!0,dangerouslySetInnerHTML:!0,autoFocus:!0,defaultValue:!0,defaultChecked:!0,innerHTML:!0,suppressContentEditableWarning:!0,style:!0},Dt={MUST_USE_PROPERTY:1,HAS_BOOLEAN_VALUE:4,HAS_NUMERIC_VALUE:8,HAS_POSITIVE_NUMERIC_VALUE:24,HAS_OVERLOADED_BOOLEAN_VALUE:32,HAS_STRING_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(e){var t=Dt,n=e.Properties||{},i=e.DOMAttributeNamespaces||{},a=e.DOMAttributeNames||{};e=e.DOMMutationMethods||{};for(var o in n){Mt.properties.hasOwnProperty(o)&&r("48",o);var s=o.toLowerCase(),l=n[o];s={attributeName:s,attributeNamespace:null,propertyName:o,mutationMethod:null,mustUseProperty:u(l,t.MUST_USE_PROPERTY),hasBooleanValue:u(l,t.HAS_BOOLEAN_VALUE),hasNumericValue:u(l,t.HAS_NUMERIC_VALUE),hasPositiveNumericValue:u(l,t.HAS_POSITIVE_NUMERIC_VALUE),hasOverloadedBooleanValue:u(l,t.HAS_OVERLOADED_BOOLEAN_VALUE),hasStringBooleanValue:u(l,t.HAS_STRING_BOOLEAN_VALUE)},1>=s.hasBooleanValue+s.hasNumericValue+s.hasOverloadedBooleanValue||r("50",o),a.hasOwnProperty(o)&&(s.attributeName=a[o]),i.hasOwnProperty(o)&&(s.attributeNamespace=i[o]),e.hasOwnProperty(o)&&(s.mutationMethod=e[o]),Mt.properties[o]=s}}},Mt={ID_ATTRIBUTE_NAME:"data-reactid",ROOT_ATTRIBUTE_NAME:"data-reactroot",ATTRIBUTE_NAME_START_CHAR:":A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",ATTRIBUTE_NAME_CHAR:":A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",properties:{},shouldSetAttribute:function(e,t){if(Mt.isReservedProp(e)||!("o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1]))return!1;if(null===t)return!0;switch(typeof t){case"boolean":return Mt.shouldAttributeAcceptBooleanValue(e);case"undefined":case"number":case"string":case"object":return!0;default:return!1}},getPropertyInfo:function(e){return Mt.properties.hasOwnProperty(e)?Mt.properties[e]:null},shouldAttributeAcceptBooleanValue:function(e){if(Mt.isReservedProp(e))return!0;var t=Mt.getPropertyInfo(e);return t?t.hasBooleanValue||t.hasStringBooleanValue||t.hasOverloadedBooleanValue:"data-"===(e=e.toLowerCase().slice(0,5))||"aria-"===e},isReservedProp:function(e){return Ot.hasOwnProperty(e)},injection:Dt},Nt=Mt,At={IndeterminateComponent:0,FunctionalComponent:1,ClassComponent:2,HostRoot:3,HostPortal:4,HostComponent:5,HostText:6,CoroutineComponent:7,CoroutineHandlerPhase:8,YieldComponent:9,Fragment:10},Lt={ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_FRAGMENT_NODE:11},jt=At.HostComponent,Ut=At.HostText,Bt=Lt.ELEMENT_NODE,Ht=Lt.COMMENT_NODE,zt=Nt.ID_ATTRIBUTE_NAME,Wt={hasCachedChildNodes:1},Kt=Math.random().toString(36).slice(2),Vt="__reactInternalInstance$"+Kt,$t="__reactEventHandlers$"+Kt,qt={getClosestInstanceFromNode:f,getInstanceFromNode:function(e){var t=e[Vt];return t?t.tag===jt||t.tag===Ut?t:t._hostNode===e?t:null:(t=f(e),null!=t&&t._hostNode===e?t:null)},getNodeFromInstance:function(e){if(e.tag===jt||e.tag===Ut)return e.stateNode;if(void 0===e._hostNode&&r("33"),e._hostNode)return e._hostNode;for(var t=[];!e._hostNode;)t.push(e),e._hostParent||r("34"),e=e._hostParent;for(;t.length;e=t.pop())c(e,e._hostNode);return e._hostNode},precacheChildNodes:c,precacheNode:l,uncacheNode:function(e){var t=e._hostNode;t&&(delete t[Vt],e._hostNode=null)},precacheFiberNode:function(e,t){t[Vt]=e},getFiberCurrentPropsFromNode:function(e){return e[$t]||null},updateFiberProps:function(e,t){e[$t]=t}},Qt={remove:function(e){e._reactInternalFiber=void 0},get:function(e){return e._reactInternalFiber},has:function(e){return void 0!==e._reactInternalFiber},set:function(e,t){e._reactInternalFiber=t}},Jt={ReactCurrentOwner:mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner},Yt={NoEffect:0,PerformedWork:1,Placement:2,Update:4,PlacementAndUpdate:6,Deletion:8,ContentReset:16,Callback:32,Err:64,Ref:128},Gt=At.HostComponent,Xt=At.HostRoot,Zt=At.HostPortal,en=At.HostText,tn=Yt.NoEffect,nn=Yt.Placement,rn={isFiberMounted:function(e){return 2===d(e)},isMounted:function(e){return!!(e=Qt.get(e))&&2===d(e)},findCurrentFiberUsingSlowPath:m,findCurrentHostFiber:function(e){if(!(e=m(e)))return null;for(var t=e;;){if(t.tag===Gt||t.tag===en)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null},findCurrentHostFiberWithNoPortals:function(e){if(!(e=m(e)))return null;for(var t=e;;){if(t.tag===Gt||t.tag===en)return t;if(t.child&&t.tag!==Zt)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}},an={_caughtError:null,_hasCaughtError:!1,_rethrowError:null,_hasRethrowError:!1,injection:{injectErrorUtils:function(e){"function"!=typeof e.invokeGuardedCallback&&r("197"),v=e.invokeGuardedCallback}},invokeGuardedCallback:function(e,t,n,r,i,a,o,u,s){v.apply(an,arguments)},invokeGuardedCallbackAndCatchFirstError:function(e,t,n,r,i,a,o,u,s){if(an.invokeGuardedCallback.apply(this,arguments),an.hasCaughtError()){var l=an.clearCaughtError();an._hasRethrowError||(an._hasRethrowError=!0,an._rethrowError=l)}},rethrowCaughtError:function(){return y.apply(an,arguments)},hasCaughtError:function(){return an._hasCaughtError},clearCaughtError:function(){if(an._hasCaughtError){var e=an._caughtError;return an._caughtError=null,an._hasCaughtError=!1,e}r("198")}},on=an,un={isEndish:function(e){return"topMouseUp"===e||"topTouchEnd"===e||"topTouchCancel"===e},isMoveish:function(e){return"topMouseMove"===e||"topTouchMove"===e},isStartish:function(e){return"topMouseDown"===e||"topTouchStart"===e},executeDirectDispatch:function(e){var t=e._dispatchListeners,n=e._dispatchInstances;return Array.isArray(t)&&r("103"),e.currentTarget=t?un.getNodeFromInstance(n):null,t=t?t(e):null,e.currentTarget=null,e._dispatchListeners=null,e._dispatchInstances=null,t},executeDispatchesInOrder:function(e,t){var n=e._dispatchListeners,r=e._dispatchInstances;if(Array.isArray(n))for(var i=0;i<n.length&&!e.isPropagationStopped();i++)g(e,t,n[i],r[i]);else n&&g(e,t,n,r);e._dispatchListeners=null,e._dispatchInstances=null},executeDispatchesInOrderStopAtTrue:function(e){e:{var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t)){for(var r=0;r<t.length&&!e.isPropagationStopped();r++)if(t[r](e,n[r])){t=n[r];break e}}else if(t&&t(e,n)){t=n;break e}t=null}return e._dispatchInstances=null,e._dispatchListeners=null,t},hasDispatches:function(e){return!!e._dispatchListeners},getFiberCurrentPropsFromNode:function(e){return Ct.getFiberCurrentPropsFromNode(e)},getInstanceFromNode:function(e){return Ct.getInstanceFromNode(e)},getNodeFromInstance:function(e){return Ct.getNodeFromInstance(e)},injection:{injectComponentTree:function(e){Ct=e}}},sn=un,ln=null,cn=null,fn=null,pn={injection:{injectFiberControlledHostComponent:function(e){ln=e}},enqueueStateRestore:function(e){cn?fn?fn.push(e):fn=[e]:cn=e},restoreStateIfNeeded:function(){if(cn){var e=cn,t=fn;if(fn=cn=null,b(e),t)for(e=0;e<t.length;e++)b(t[e])}}},dn=!1,hn={batchedUpdates:function(e,t){if(dn)return k(x,e,t);dn=!0;try{return k(x,e,t)}finally{dn=!1,pn.restoreStateIfNeeded()}},injection:{injectStackBatchedUpdates:function(e){k=e},injectFiberBatchedUpdates:function(e){w=e}}},mn=Lt.TEXT_NODE,vn=At.HostRoot,yn=[],gn={_enabled:!0,_handleTopLevel:null,setHandleTopLevel:function(e){gn._handleTopLevel=e},setEnabled:function(e){gn._enabled=!!e},isEnabled:function(){return gn._enabled},trapBubbledEvent:function(e,t,n){return n?gt.listen(n,t,gn.dispatchEvent.bind(null,e)):null},trapCapturedEvent:function(e,t,n){return n?gt.capture(n,t,gn.dispatchEvent.bind(null,e)):null},dispatchEvent:function(e,t){if(gn._enabled){var n=S(t);if(n=qt.getClosestInstanceFromNode(n),null===n||"number"!=typeof n.tag||rn.isFiberMounted(n)||(n=null),yn.length){var r=yn.pop();r.topLevelType=e,r.nativeEvent=t,r.targetInst=n,e=r}else e={topLevelType:e,nativeEvent:t,targetInst:n,ancestors:[]};try{hn.batchedUpdates(E,e)}finally{e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>yn.length&&yn.push(e)}}}},bn=gn,kn=null,wn={injection:{injectEventPluginOrder:Ft.injectEventPluginOrder,injectEventPluginsByName:Ft.injectEventPluginsByName},getListener:function(e,t){if("number"==typeof e.tag){var n=e.stateNode;if(!n)return null;var i=sn.getFiberCurrentPropsFromNode(n);if(!i)return null;if(n=i[t],R(t,e.type,i))return null}else{if("string"==typeof(i=e._currentElement)||"number"==typeof i||!e._rootNodeID)return null;if(e=i.props,n=e[t],R(t,i.type,e))return null}return n&&"function"!=typeof n&&r("231",t,typeof n),n},extractEvents:function(e,t,n,r){for(var i,a=Ft.plugins,o=0;o<a.length;o++){var u=a[o];u&&(u=u.extractEvents(e,t,n,r))&&(i=C(i,u))}return i},enqueueEvents:function(e){e&&(kn=C(kn,e))},processEventQueue:function(e){var t=kn;kn=null,e?_(t,P):_(t,I),kn&&r("95"),on.rethrowCaughtError()}};vt.canUseDOM&&(_t=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""));var xn={animationend:O("Animation","AnimationEnd"),animationiteration:O("Animation","AnimationIteration"),animationstart:O("Animation","AnimationStart"),transitionend:O("Transition","TransitionEnd")},Sn={},En={};vt.canUseDOM&&(En=document.createElement("div").style,"AnimationEvent"in window||(delete xn.animationend.animation,delete xn.animationiteration.animation,delete xn.animationstart.animation),"TransitionEvent"in window||delete xn.transitionend.transition);var Cn={topAbort:"abort",topAnimationEnd:D("animationend")||"animationend",topAnimationIteration:D("animationiteration")||"animationiteration",topAnimationStart:D("animationstart")||"animationstart",topBlur:"blur",topCancel:"cancel",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topChange:"change",topClick:"click",topClose:"close",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoadedData:"loadeddata",topLoad:"load",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topScroll:"scroll",topSeeked:"seeked",topSeeking:"seeking",topSelectionChange:"selectionchange",topStalled:"stalled",topSuspend:"suspend",topTextInput:"textInput",topTimeUpdate:"timeupdate",topToggle:"toggle",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topTransitionEnd:D("transitionend")||"transitionend",topVolumeChange:"volumechange",topWaiting:"waiting",topWheel:"wheel"},_n={},Tn=0,Pn="_reactListenersID"+(""+Math.random()).slice(2),In=yt({},{handleTopLevel:function(e,t,n,r){e=wn.extractEvents(e,t,n,r),wn.enqueueEvents(e),wn.processEventQueue(!1)}},{setEnabled:function(e){bn&&bn.setEnabled(e)},isEnabled:function(){return!(!bn||!bn.isEnabled())},listenTo:function(e,t){var n=M(t);e=Ft.registrationNameDependencies[e];for(var r=0;r<e.length;r++){var i=e[r];n.hasOwnProperty(i)&&n[i]||("topWheel"===i?F("wheel")?bn.trapBubbledEvent("topWheel","wheel",t):F("mousewheel")?bn.trapBubbledEvent("topWheel","mousewheel",t):bn.trapBubbledEvent("topWheel","DOMMouseScroll",t):"topScroll"===i?bn.trapCapturedEvent("topScroll","scroll",t):"topFocus"===i||"topBlur"===i?(bn.trapCapturedEvent("topFocus","focus",t),bn.trapCapturedEvent("topBlur","blur",t),n.topBlur=!0,n.topFocus=!0):"topCancel"===i?(F("cancel",!0)&&bn.trapCapturedEvent("topCancel","cancel",t),n.topCancel=!0):"topClose"===i?(F("close",!0)&&bn.trapCapturedEvent("topClose","close",t),n.topClose=!0):Cn.hasOwnProperty(i)&&bn.trapBubbledEvent(i,Cn[i],t),n[i]=!0)}},isListeningToAllDependencies:function(e,t){t=M(t),e=Ft.registrationNameDependencies[e];for(var n=0;n<e.length;n++){var r=e[n];if(!t.hasOwnProperty(r)||!t[r])return!1}return!0},trapBubbledEvent:function(e,t,n){return bn.trapBubbledEvent(e,t,n)},trapCapturedEvent:function(e,t,n){return bn.trapCapturedEvent(e,t,n)}}),Rn={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fn=["Webkit","ms","Moz","O"];Object.keys(Rn).forEach(function(e){Fn.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Rn[t]=Rn[e]})});var On={isUnitlessNumber:Rn,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}},Dn=On.isUnitlessNumber,Mn=!1;if(vt.canUseDOM){var Nn=document.createElement("div").style;try{Nn.font=""}catch(e){Mn=!0}}var An,Ln={createDangerousStringForStyles:function(){},setValueForStyles:function(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=n,a=t[n];if(i=null==a||"boolean"==typeof a||""===a?"":r||"number"!=typeof a||0===a||Dn.hasOwnProperty(i)&&Dn[i]?(""+a).trim():a+"px","float"===n&&(n="cssFloat"),r)e.setProperty(n,i);else if(i)e[n]=i;else if(r=Mn&&On.shorthandPropertyExpansions[n])for(var o in r)e[o]="";else e[n]=""}}},jn=new RegExp("^["+Nt.ATTRIBUTE_NAME_START_CHAR+"]["+Nt.ATTRIBUTE_NAME_CHAR+"]*$"),Un={},Bn={},Hn={setAttributeForID:function(e,t){e.setAttribute(Nt.ID_ATTRIBUTE_NAME,t)},setAttributeForRoot:function(e){e.setAttribute(Nt.ROOT_ATTRIBUTE_NAME,"")},getValueForProperty:function(){},getValueForAttribute:function(){},setValueForProperty:function(e,t,n){var r=Nt.getPropertyInfo(t);if(r&&Nt.shouldSetAttribute(t,n)){var i=r.mutationMethod;i?i(e,n):null==n||r.hasBooleanValue&&!n||r.hasNumericValue&&isNaN(n)||r.hasPositiveNumericValue&&1>n||r.hasOverloadedBooleanValue&&!1===n?Hn.deleteValueForProperty(e,t):r.mustUseProperty?e[r.propertyName]=n:(t=r.attributeName,(i=r.attributeNamespace)?e.setAttributeNS(i,t,""+n):r.hasBooleanValue||r.hasOverloadedBooleanValue&&!0===n?e.setAttribute(t,""):e.setAttribute(t,""+n))}else Hn.setValueForAttribute(e,t,Nt.shouldSetAttribute(t,n)?n:null)},setValueForAttribute:function(e,t,n){N(t)&&(null==n?e.removeAttribute(t):e.setAttribute(t,""+n))},deleteValueForAttribute:function(e,t){e.removeAttribute(t)},deleteValueForProperty:function(e,t){var n=Nt.getPropertyInfo(t);n?(t=n.mutationMethod)?t(e,void 0):n.mustUseProperty?e[n.propertyName]=!n.hasBooleanValue&&"":e.removeAttribute(n.attributeName):e.removeAttribute(t)}},zn=Hn,Wn=Jt.ReactDebugCurrentFrame,Kn={current:null,phase:null,resetCurrentFiber:function(){Wn.getCurrentStack=null,Kn.current=null,Kn.phase=null},setCurrentFiber:function(e,t){Wn.getCurrentStack=A,Kn.current=e,Kn.phase=t},getCurrentFiberOwnerName:function(){return null},getCurrentFiberStackAddendum:A},Vn=Kn,$n={getHostProps:function(e,t){var n=t.value,r=t.checked;return yt({type:void 0,step:void 0,min:void 0,max:void 0},t,{defaultChecked:void 0,defaultValue:void 0,value:null!=n?n:e._wrapperState.initialValue,checked:null!=r?r:e._wrapperState.initialChecked})},initWrapperState:function(e,t){var n=t.defaultValue;e._wrapperState={initialChecked:null!=t.checked?t.checked:t.defaultChecked,initialValue:null!=t.value?t.value:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}},updateWrapper:function(e,t){var n=t.checked;null!=n&&zn.setValueForProperty(e,"checked",n||!1),n=t.value,null!=n?0===n&&""===e.value?e.value="0":"number"===t.type?(t=parseFloat(e.value)||0,(n!=t||n==t&&e.value!=n)&&(e.value=""+n)):e.value!==""+n&&(e.value=""+n):(null==t.value&&null!=t.defaultValue&&e.defaultValue!==""+t.defaultValue&&(e.defaultValue=""+t.defaultValue),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked))},postMountWrapper:function(e,t){switch(t.type){case"submit":case"reset":break;case"color":case"date":case"datetime":case"datetime-local":case"month":case"time":case"week":e.value="",e.value=e.defaultValue;break;default:e.value=e.value}t=e.name,""!==t&&(e.name=""),e.defaultChecked=!e.defaultChecked,e.defaultChecked=!e.defaultChecked,""!==t&&(e.name=t)},restoreControlledState:function(e,t){$n.updateWrapper(e,t);var n=t.name;if("radio"===t.type&&null!=n){for(t=e;t.parentNode;)t=t.parentNode;for(n=t.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var a=qt.getFiberCurrentPropsFromNode(i);a||r("90"),$n.updateWrapper(i,a)}}}}},qn=$n,Qn={validateProps:function(){},postMountWrapper:function(e,t){null!=t.value&&e.setAttribute("value",t.value)},getHostProps:function(e,t){return e=yt({children:void 0},t),(t=L(t.children))&&(e.children=t),e}},Jn={getHostProps:function(e,t){return yt({},t,{value:void 0})},initWrapperState:function(e,t){var n=t.value;e._wrapperState={initialValue:null!=n?n:t.defaultValue,wasMultiple:!!t.multiple}},postMountWrapper:function(e,t){e.multiple=!!t.multiple;var n=t.value;null!=n?j(e,!!t.multiple,n):null!=t.defaultValue&&j(e,!!t.multiple,t.defaultValue)},postUpdateWrapper:function(e,t){e._wrapperState.initialValue=void 0;var n=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=!!t.multiple;var r=t.value;null!=r?j(e,!!t.multiple,r):n!==!!t.multiple&&(null!=t.defaultValue?j(e,!!t.multiple,t.defaultValue):j(e,!!t.multiple,t.multiple?[]:""))},restoreControlledState:function(e,t){var n=t.value;null!=n&&j(e,!!t.multiple,n)}},Yn={getHostProps:function(e,t){return null!=t.dangerouslySetInnerHTML&&r("91"),yt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})},initWrapperState:function(e,t){var n=t.value,i=n;null==n&&(n=t.defaultValue,t=t.children,null!=t&&(null!=n&&r("92"),Array.isArray(t)&&(1>=t.length||r("93"),t=t[0]),n=""+t),null==n&&(n=""),i=n),e._wrapperState={initialValue:""+i}},updateWrapper:function(e,t){var n=t.value;null!=n&&(n=""+n,n!==e.value&&(e.value=n),null==t.defaultValue&&(e.defaultValue=n)),null!=t.defaultValue&&(e.defaultValue=t.defaultValue)},postMountWrapper:function(e){var t=e.textContent;t===e._wrapperState.initialValue&&(e.value=t)},restoreControlledState:function(e,t){Yn.updateWrapper(e,t)}},Gn=Yn,Xn=yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),Zn={_getTrackerFromNode:function(e){return e._valueTracker},track:function(e){e._valueTracker||(e._valueTracker=H(e))},updateValueIfChanged:function(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=B(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)},stopTracking:function(e){(e=e._valueTracker)&&e.stopTracking()}},er=Tt.Namespaces,tr=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n)})}:e}(function(e,t){if(e.namespaceURI!==er.svg||"innerHTML"in e)e.innerHTML=t;else for(An=An||document.createElement("div"),An.innerHTML="<svg>"+t+"</svg>",t=An.firstChild;t.firstChild;)e.appendChild(t.firstChild)}),nr=/["'&<>]/,rr=Lt.TEXT_NODE;vt.canUseDOM&&("textContent"in document.documentElement||(W=function(e,t){if(e.nodeType===rr)e.nodeValue=t;else{if("boolean"==typeof t||"number"==typeof t)t=""+t;else{t=""+t;var n=nr.exec(t);if(n){var r,i="",a=0;for(r=n.index;r<t.length;r++){switch(t.charCodeAt(r)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#x27;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}a!==r&&(i+=t.substring(a,r)),a=r+1,i+=n}t=a!==r?i+t.substring(a,r):i}}tr(e,t)}}));var ir=W,ar=(Vn.getCurrentFiberOwnerName,Lt.DOCUMENT_NODE),or=Lt.DOCUMENT_FRAGMENT_NODE,ur=In.listenTo,sr=Ft.registrationNameModules,lr=Tt.Namespaces.html,cr=Tt.getIntrinsicNamespace,fr={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"},pr={createElement:function(e,t,n,r){return n=n.nodeType===ar?n:n.ownerDocument,r===lr&&(r=cr(e)),r===lr?"script"===e?(e=n.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):e="string"==typeof t.is?n.createElement(e,{is:t.is}):n.createElement(e):e=n.createElementNS(r,e),e},createTextNode:function(e,t){return(t.nodeType===ar?t:t.ownerDocument).createTextNode(e)},setInitialProperties:function(e,t,n,r){var i=z(t,n);switch(t){case"iframe":case"object":In.trapBubbledEvent("topLoad","load",e);var a=n;break;case"video":case"audio":for(a in fr)fr.hasOwnProperty(a)&&In.trapBubbledEvent(a,fr[a],e);a=n;break;case"source":In.trapBubbledEvent("topError","error",e),a=n;break;case"img":case"image":In.trapBubbledEvent("topError","error",e),In.trapBubbledEvent("topLoad","load",e),a=n;break;case"form":In.trapBubbledEvent("topReset","reset",e),In.trapBubbledEvent("topSubmit","submit",e),a=n;break;case"details":In.trapBubbledEvent("topToggle","toggle",e),a=n;break;case"input":qn.initWrapperState(e,n),a=qn.getHostProps(e,n),In.trapBubbledEvent("topInvalid","invalid",e),K(r,"onChange");break;case"option":Qn.validateProps(e,n),a=Qn.getHostProps(e,n);break;case"select":Jn.initWrapperState(e,n),a=Jn.getHostProps(e,n),In.trapBubbledEvent("topInvalid","invalid",e),K(r,"onChange");break;case"textarea":Gn.initWrapperState(e,n),a=Gn.getHostProps(e,n),In.trapBubbledEvent("topInvalid","invalid",e),K(r,"onChange");break;default:a=n}U(t,a);var o,u=a;for(o in u)if(u.hasOwnProperty(o)){var s=u[o];"style"===o?Ln.setValueForStyles(e,s):"dangerouslySetInnerHTML"===o?null!=(s=s?s.__html:void 0)&&tr(e,s):"children"===o?"string"==typeof s?ir(e,s):"number"==typeof s&&ir(e,""+s):"suppressContentEditableWarning"!==o&&(sr.hasOwnProperty(o)?null!=s&&K(r,o):i?zn.setValueForAttribute(e,o,s):null!=s&&zn.setValueForProperty(e,o,s))}switch(t){case"input":Zn.track(e),qn.postMountWrapper(e,n);break;case"textarea":Zn.track(e),Gn.postMountWrapper(e,n);break;case"option":Qn.postMountWrapper(e,n);break;case"select":Jn.postMountWrapper(e,n);break;default:"function"==typeof a.onClick&&(e.onclick=bt)}},diffProperties:function(e,t,n,r,i){var a=null;switch(t){case"input":n=qn.getHostProps(e,n),r=qn.getHostProps(e,r),a=[];break;case"option":n=Qn.getHostProps(e,n),r=Qn.getHostProps(e,r),a=[];break;case"select":n=Jn.getHostProps(e,n),r=Jn.getHostProps(e,r),a=[];break;case"textarea":n=Gn.getHostProps(e,n),r=Gn.getHostProps(e,r),a=[];break;default:"function"!=typeof n.onClick&&"function"==typeof r.onClick&&(e.onclick=bt)}U(t,r);var o,u;e=null;for(o in n)if(!r.hasOwnProperty(o)&&n.hasOwnProperty(o)&&null!=n[o])if("style"===o)for(u in t=n[o])t.hasOwnProperty(u)&&(e||(e={}),e[u]="");else"dangerouslySetInnerHTML"!==o&&"children"!==o&&"suppressContentEditableWarning"!==o&&(sr.hasOwnProperty(o)?a||(a=[]):(a=a||[]).push(o,null));for(o in r){var s=r[o];if(t=null!=n?n[o]:void 0,r.hasOwnProperty(o)&&s!==t&&(null!=s||null!=t))if("style"===o)if(t){for(u in t)!t.hasOwnProperty(u)||s&&s.hasOwnProperty(u)||(e||(e={}),e[u]="");for(u in s)s.hasOwnProperty(u)&&t[u]!==s[u]&&(e||(e={}),e[u]=s[u])}else e||(a||(a=[]),a.push(o,e)),e=s;else"dangerouslySetInnerHTML"===o?(s=s?s.__html:void 0,t=t?t.__html:void 0,null!=s&&t!==s&&(a=a||[]).push(o,""+s)):"children"===o?t===s||"string"!=typeof s&&"number"!=typeof s||(a=a||[]).push(o,""+s):"suppressContentEditableWarning"!==o&&(sr.hasOwnProperty(o)?(null!=s&&K(i,o),a||t===s||(a=[])):(a=a||[]).push(o,s))}return e&&(a=a||[]).push("style",e),a},updateProperties:function(e,t,n,r,i){z(n,r),r=z(n,i);for(var a=0;a<t.length;a+=2){var o=t[a],u=t[a+1];"style"===o?Ln.setValueForStyles(e,u):"dangerouslySetInnerHTML"===o?tr(e,u):"children"===o?ir(e,u):r?null!=u?zn.setValueForAttribute(e,o,u):zn.deleteValueForAttribute(e,o):null!=u?zn.setValueForProperty(e,o,u):zn.deleteValueForProperty(e,o)}switch(n){case"input":qn.updateWrapper(e,i),Zn.updateValueIfChanged(e);break;case"textarea":Gn.updateWrapper(e,i);break;case"select":Jn.postUpdateWrapper(e,i)}},diffHydratedProperties:function(e,t,n,r,i){switch(t){case"iframe":case"object":In.trapBubbledEvent("topLoad","load",e);break;case"video":case"audio":for(var a in fr)fr.hasOwnProperty(a)&&In.trapBubbledEvent(a,fr[a],e);break;case"source":In.trapBubbledEvent("topError","error",e);break;case"img":case"image":In.trapBubbledEvent("topError","error",e),In.trapBubbledEvent("topLoad","load",e);break;case"form":In.trapBubbledEvent("topReset","reset",e),In.trapBubbledEvent("topSubmit","submit",e);break;case"details":In.trapBubbledEvent("topToggle","toggle",e);break;case"input":qn.initWrapperState(e,n),In.trapBubbledEvent("topInvalid","invalid",e),K(i,"onChange");break;case"option":Qn.validateProps(e,n);break;case"select":Jn.initWrapperState(e,n),In.trapBubbledEvent("topInvalid","invalid",e),K(i,"onChange");break;case"textarea":Gn.initWrapperState(e,n),In.trapBubbledEvent("topInvalid","invalid",e),K(i,"onChange")}U(t,n),r=null;for(var o in n)n.hasOwnProperty(o)&&(a=n[o],"children"===o?"string"==typeof a?e.textContent!==a&&(r=["children",a]):"number"==typeof a&&e.textContent!==""+a&&(r=["children",""+a]):sr.hasOwnProperty(o)&&null!=a&&K(i,o));switch(t){case"input":Zn.track(e),qn.postMountWrapper(e,n);break;case"textarea":Zn.track(e),Gn.postMountWrapper(e,n);break;case"select":case"option":break;default:"function"==typeof n.onClick&&(e.onclick=bt)}return r},diffHydratedText:function(e,t){return e.nodeValue!==t},warnForDeletedHydratableElement:function(){},warnForDeletedHydratableText:function(){},warnForInsertedHydratedElement:function(){},warnForInsertedHydratedText:function(){},restoreControlledState:function(e,t,n){switch(t){case"input":qn.restoreControlledState(e,n);break;case"textarea":Gn.restoreControlledState(e,n);break;case"select":Jn.restoreControlledState(e,n)}}},dr=void 0;if(vt.canUseDOM)if("function"!=typeof requestIdleCallback){var hr=null,mr=null,vr=!1,yr=!1,gr=0,br=33,kr=33,wr={timeRemaining:"object"==typeof performance&&"function"==typeof performance.now?function(){return gr-performance.now()}:function(){return gr-Date.now()}},xr="__reactIdleCallback$"+Math.random().toString(36).slice(2);window.addEventListener("message",function(e){e.source===window&&e.data===xr&&(vr=!1,e=mr,mr=null,null!==e&&e(wr))},!1);var Sr=function(e){yr=!1;var t=e-gr+kr;t<kr&&br<kr?(8>t&&(t=8),kr=t<br?br:t):br=t,gr=e+kr,vr||(vr=!0,window.postMessage(xr,"*")),t=hr,hr=null,null!==t&&t(e)};dr=function(e){return mr=e,yr||(yr=!0,requestAnimationFrame(Sr)),0}}else dr=requestIdleCallback;else dr=function(e){return setTimeout(function(){e({timeRemaining:function(){return 1/0}})}),0};var Er,Cr,_r={rIC:dr},Tr={enableAsyncSubtreeAPI:!0},Pr={NoWork:0,SynchronousPriority:1,TaskPriority:2,HighPriority:3,LowPriority:4,OffscreenPriority:5},Ir=Yt.Callback,Rr=Pr.NoWork,Fr=Pr.SynchronousPriority,Or=Pr.TaskPriority,Dr=At.ClassComponent,Mr=At.HostRoot,Nr=void 0,Ar=void 0,Lr={addUpdate:function(e,t,n,r){J(e,{priorityLevel:r,partialState:t,callback:n,isReplace:!1,isForced:!1,isTopLevelUnmount:!1,next:null})},addReplaceUpdate:function(e,t,n,r){J(e,{priorityLevel:r,partialState:t,callback:n,isReplace:!0,isForced:!1,isTopLevelUnmount:!1,next:null})},addForceUpdate:function(e,t,n){J(e,{priorityLevel:n,partialState:null,callback:t,isReplace:!1,isForced:!0,isTopLevelUnmount:!1,next:null})},getUpdatePriority:function(e){var t=e.updateQueue;return null===t||e.tag!==Dr&&e.tag!==Mr?Rr:null!==t.first?t.first.priorityLevel:Rr},addTopLevelUpdate:function(e,t,n,r){var i=null===t.element;t={priorityLevel:r,partialState:t,callback:n,isReplace:!1,isForced:!1,isTopLevelUnmount:i,next:null},e=J(e,t),i&&(i=Nr,n=Ar,null!==i&&null!==t.next&&(t.next=null,i.last=t),null!==n&&null!==e&&null!==e.next&&(e.next=null,n.last=t))},beginUpdateQueue:function(e,t,n,r,i,a,o){null!==e&&e.updateQueue===n&&(n=t.updateQueue={first:n.first,last:n.last,callbackList:null,hasForceUpdate:!1}),e=n.callbackList;for(var u=n.hasForceUpdate,s=!0,l=n.first;null!==l&&0>=V(l.priorityLevel,o);){n.first=l.next,null===n.first&&(n.last=null);var c;l.isReplace?(i=Y(l,r,i,a),s=!0):(c=Y(l,r,i,a))&&(i=s?yt({},i,c):yt(i,c),s=!1),l.isForced&&(u=!0),null===l.callback||l.isTopLevelUnmount&&null!==l.next||(e=null!==e?e:[],e.push(l.callback),t.effectTag|=Ir),l=l.next}return n.callbackList=e,n.hasForceUpdate=u,null!==n.first||null!==e||u||(t.updateQueue=null),i},commitCallbacks:function(e,t,n){if(null!==(e=t.callbackList))for(t.callbackList=null,t=0;t<e.length;t++){var i=e[t];"function"!=typeof i&&r("191",i),i.call(n)}}},jr=[],Ur=-1,Br={createCursor:function(e){return{current:e}},isEmpty:function(){return-1===Ur},pop:function(e){0>Ur||(e.current=jr[Ur],jr[Ur]=null,Ur--)},push:function(e,t){Ur++,jr[Ur]=e.current,e.current=t},reset:function(){for(;-1<Ur;)jr[Ur]=null,Ur--}},Hr=rn.isFiberMounted,zr=At.ClassComponent,Wr=At.HostRoot,Kr=Br.createCursor,Vr=Br.pop,$r=Br.push,qr=Kr(kt),Qr=Kr(!1),Jr=kt,Yr={getUnmaskedContext:function(e){return X(e)?Jr:qr.current},cacheContext:G,getMaskedContext:function(e,t){var n=e.type.contextTypes;if(!n)return kt;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&G(e,t,a),a},hasContextChanged:function(){return Qr.current},isContextConsumer:function(e){return e.tag===zr&&null!=e.type.contextTypes},isContextProvider:X,popContextProvider:function(e){X(e)&&(Vr(Qr,e),Vr(qr,e))},popTopLevelContextObject:function(e){Vr(Qr,e),Vr(qr,e)},pushTopLevelContextObject:function(e,t,n){null!=qr.cursor&&r("168"),$r(qr,t,e),$r(Qr,n,e)},processChildContext:Z,pushContextProvider:function(e){if(!X(e))return!1;var t=e.stateNode;return t=t&&t.__reactInternalMemoizedMergedChildContext||kt,Jr=qr.current,$r(qr,t,e),$r(Qr,Qr.current,e),!0},invalidateContextProvider:function(e,t){var n=e.stateNode;if(n||r("169"),t){var i=Z(e,Jr);n.__reactInternalMemoizedMergedChildContext=i,Vr(Qr,e),Vr(qr,e),$r(qr,i,e)}else Vr(Qr,e);$r(Qr,t,e)},resetContext:function(){Jr=kt,qr.current=kt,Qr.current=!1},findCurrentUnmaskedContext:function(e){for(Hr(e)&&e.tag===zr?void 0:r("170");e.tag!==Wr;){if(X(e))return e.stateNode.__reactInternalMemoizedMergedChildContext;(e=e.return)||r("171")}return e.stateNode.context}},Gr={NoContext:0,AsyncUpdates:1},Xr=At.IndeterminateComponent,Zr=At.ClassComponent,ei=At.HostRoot,ti=At.HostComponent,ni=At.HostText,ri=At.HostPortal,ii=At.CoroutineComponent,ai=At.YieldComponent,oi=At.Fragment,ui=Pr.NoWork,si=Gr.NoContext,li=Yt.NoEffect,ci={createWorkInProgress:function(e,t){var n=e.alternate;return null===n?(n=new ee(e.tag,e.key,e.internalContextTag),n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.effectTag=li,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.pendingWorkPriority=t,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n},createHostRootFiber:function(){return new ee(ei,null,si)},createFiberFromElement:function(e,t,n){return t=te(e.type,e.key,t),t.pendingProps=e.props,t.pendingWorkPriority=n,t},createFiberFromFragment:function(e,t,n){return t=new ee(oi,null,t),t.pendingProps=e,t.pendingWorkPriority=n,t},createFiberFromText:function(e,t,n){return t=new ee(ni,null,t),t.pendingProps=e,t.pendingWorkPriority=n,t},createFiberFromElementType:te,createFiberFromHostInstanceForDeletion:function(){var e=new ee(ti,null,si);return e.type="DELETED",e},createFiberFromCoroutine:function(e,t,n){return t=new ee(ii,e.key,t),t.type=e.handler,t.pendingProps=e,t.pendingWorkPriority=n,t},createFiberFromYield:function(e,t){return new ee(ai,null,t)},createFiberFromPortal:function(e,t,n){return t=new ee(ri,e.key,t),t.pendingProps=e.children||[],t.pendingWorkPriority=n,t.stateNode={containerInfo:e.containerInfo,implementation:e.implementation},t},largerPriority:function(e,t){return e!==ui&&(t===ui||t>e)?e:t}},fi=ci.createHostRootFiber,pi=At.IndeterminateComponent,di=At.FunctionalComponent,hi=At.ClassComponent,mi=At.HostComponent;"function"==typeof Symbol&&Symbol.for?(Er=Symbol.for("react.coroutine"),Cr=Symbol.for("react.yield")):(Er=60104,Cr=60105);var vi={createCoroutine:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Er,key:null==r?null:""+r,children:e,handler:t,props:n}},createYield:function(e){return{$$typeof:Cr,value:e}},isCoroutine:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===Er},isYield:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===Cr},REACT_YIELD_TYPE:Cr,REACT_COROUTINE_TYPE:Er},yi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.portal")||60106,gi={createPortal:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:yi,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}},isPortal:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===yi},REACT_PORTAL_TYPE:yi},bi=vi.REACT_COROUTINE_TYPE,ki=vi.REACT_YIELD_TYPE,wi=gi.REACT_PORTAL_TYPE,xi=ci.createWorkInProgress,Si=ci.createFiberFromElement,Ei=ci.createFiberFromFragment,Ci=ci.createFiberFromText,_i=ci.createFiberFromCoroutine,Ti=ci.createFiberFromYield,Pi=ci.createFiberFromPortal,Ii=Array.isArray,Ri=At.FunctionalComponent,Fi=At.ClassComponent,Oi=At.HostText,Di=At.HostPortal,Mi=At.CoroutineComponent,Ni=At.YieldComponent,Ai=At.Fragment,Li=Yt.NoEffect,ji=Yt.Placement,Ui=Yt.Deletion,Bi="function"==typeof Symbol&&Symbol.iterator,Hi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,zi=ae(!0,!0),Wi=ae(!1,!0),Ki=ae(!1,!1),Vi={reconcileChildFibers:zi,reconcileChildFibersInPlace:Wi,mountChildFibersInPlace:Ki,cloneChildFibers:function(e,t){if(null!==e&&t.child!==e.child&&r("153"),null!==t.child){e=t.child;var n=xi(e,e.pendingWorkPriority);for(n.pendingProps=e.pendingProps,t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,n=n.sibling=xi(e,e.pendingWorkPriority),n.pendingProps=e.pendingProps,n.return=t;n.sibling=null}}},$i=Yt.Update,qi=Gr.AsyncUpdates,Qi=Yr.cacheContext,Ji=Yr.getMaskedContext,Yi=Yr.getUnmaskedContext,Gi=Yr.isContextConsumer,Xi=Lr.addUpdate,Zi=Lr.addReplaceUpdate,ea=Lr.addForceUpdate,ta=Lr.beginUpdateQueue,na=Yr.hasContextChanged,ra=rn.isMounted,ia=Vi.mountChildFibersInPlace,aa=Vi.reconcileChildFibers,oa=Vi.reconcileChildFibersInPlace,ua=Vi.cloneChildFibers,sa=Lr.beginUpdateQueue,la=Yr.getMaskedContext,ca=Yr.getUnmaskedContext,fa=Yr.hasContextChanged,pa=Yr.pushContextProvider,da=Yr.pushTopLevelContextObject,ha=Yr.invalidateContextProvider,ma=At.IndeterminateComponent,va=At.FunctionalComponent,ya=At.ClassComponent,ga=At.HostRoot,ba=At.HostComponent,ka=At.HostText,wa=At.HostPortal,xa=At.CoroutineComponent,Sa=At.CoroutineHandlerPhase,Ea=At.YieldComponent,Ca=At.Fragment,_a=Pr.NoWork,Ta=Pr.OffscreenPriority,Pa=Yt.PerformedWork,Ia=Yt.Placement,Ra=Yt.ContentReset,Fa=Yt.Err,Oa=Yt.Ref,Da=Jt.ReactCurrentOwner,Ma=Vi.reconcileChildFibers,Na=Yr.popContextProvider,Aa=Yr.popTopLevelContextObject,La=At.IndeterminateComponent,ja=At.FunctionalComponent,Ua=At.ClassComponent,Ba=At.HostRoot,Ha=At.HostComponent,za=At.HostText,Wa=At.HostPortal,Ka=At.CoroutineComponent,Va=At.CoroutineHandlerPhase,$a=At.YieldComponent,qa=At.Fragment,Qa=Yt.Placement,Ja=Yt.Ref,Ya=Yt.Update,Ga=Pr.OffscreenPriority,Xa=null,Za=null,eo={injectInternals:function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!t.supportsFiber)return!0;try{var n=t.inject(e);Xa=le(function(e){return t.onCommitFiberRoot(n,e)}),Za=le(function(e){return t.onCommitFiberUnmount(n,e)})}catch(e){}return!0},onCommitRoot:function(e){"function"==typeof Xa&&Xa(e)},onCommitUnmount:function(e){"function"==typeof Za&&Za(e)}},to=At.ClassComponent,no=At.HostRoot,ro=At.HostComponent,io=At.HostText,ao=At.HostPortal,oo=At.CoroutineComponent,uo=Lr.commitCallbacks,so=eo.onCommitUnmount,lo=Yt.Placement,co=Yt.Update,fo=Yt.Callback,po=Yt.ContentReset,ho=Br.createCursor,mo=Br.pop,vo=Br.push,yo={},go=At.HostComponent,bo=At.HostText,ko=At.HostRoot,wo=Yt.Deletion,xo=Yt.Placement,So=ci.createFiberFromHostInstanceForDeletion,Eo=Yr.popContextProvider,Co=Br.reset,_o=Jt.ReactCurrentOwner,To=ci.createWorkInProgress,Po=ci.largerPriority,Io=eo.onCommitRoot,Ro=Pr.NoWork,Fo=Pr.SynchronousPriority,Oo=Pr.TaskPriority,Do=Pr.HighPriority,Mo=Pr.LowPriority,No=Pr.OffscreenPriority,Ao=Gr.AsyncUpdates,Lo=Yt.PerformedWork,jo=Yt.Placement,Uo=Yt.Update,Bo=Yt.PlacementAndUpdate,Ho=Yt.Deletion,zo=Yt.ContentReset,Wo=Yt.Callback,Ko=Yt.Err,Vo=Yt.Ref,$o=At.HostRoot,qo=At.HostComponent,Qo=At.HostPortal,Jo=At.ClassComponent,Yo=Lr.getUpdatePriority,Go=Yr.resetContext;me._injectFiber=function(e){he=e};var Xo=Lr.addTopLevelUpdate,Zo=Yr.findCurrentUnmaskedContext,eu=Yr.isContextProvider,tu=Yr.processChildContext,nu=At.HostComponent,ru=rn.findCurrentHostFiber,iu=rn.findCurrentHostFiberWithNoPortals;me._injectFiber(function(e){var t=Zo(e);return eu(e)?tu(e,t,!1):t});var au=Lt.TEXT_NODE,ou=null,uu={getOffsets:function(e){var t=window.getSelection&&window.getSelection();if(!t||0===t.rangeCount)return null;var n=t.anchorNode,r=t.anchorOffset,i=t.focusNode,a=t.focusOffset,o=t.getRangeAt(0);try{o.startContainer.nodeType,o.endContainer.nodeType}catch(e){return null}t=t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset?0:o.toString().length;var u=o.cloneRange();return u.selectNodeContents(e),u.setEnd(o.startContainer,o.startOffset),e=u.startContainer===u.endContainer&&u.startOffset===u.endOffset?0:u.toString().length,o=e+t,t=document.createRange(),t.setStart(n,r),t.setEnd(i,a),n=t.collapsed,{start:n?o:e,end:n?e:o}},setOffsets:function(e,t){if(window.getSelection){var n=window.getSelection(),r=e[ge()].length,i=Math.min(t.start,r);if(t=void 0===t.end?i:Math.min(t.end,r),!n.extend&&i>t&&(r=t,t=i,i=r),r=ye(e,i),e=ye(e,t),r&&e){var a=document.createRange();a.setStart(r.node,r.offset),n.removeAllRanges(),i>t?(n.addRange(a),n.extend(e.node,e.offset)):(a.setEnd(e.node,e.offset),n.addRange(a))}}}},su=Lt.ELEMENT_NODE,lu={hasSelectionCapabilities:function(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&"text"===e.type||"textarea"===t||"true"===e.contentEditable)},getSelectionInformation:function(){var e=Et();return{focusedElem:e,selectionRange:lu.hasSelectionCapabilities(e)?lu.getSelection(e):null}},restoreSelection:function(e){var t=Et(),n=e.focusedElem;if(e=e.selectionRange,t!==n&&xt(document.documentElement,n)){for(lu.hasSelectionCapabilities(n)&&lu.setSelection(n,e),t=[],e=n;e=e.parentNode;)e.nodeType===su&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(St(n),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}},getSelection:function(e){return("selectionStart"in e?{start:e.selectionStart,end:e.selectionEnd}:uu.getOffsets(e))||{start:0,end:0}},setSelection:function(e,t){var n=t.start,r=t.end;void 0===r&&(r=n),"selectionStart"in e?(e.selectionStart=n,e.selectionEnd=Math.min(r,e.value.length)):uu.setOffsets(e,t)}},cu=lu,fu=Lt.ELEMENT_NODE;we._injectFiber=function(e){be=e},we._injectStack=function(e){ke=e};var pu=At.HostComponent,du={isAncestor:function(e,t){for(;t;){if(e===t||e===t.alternate)return!0;t=xe(t)}return!1},getLowestCommonAncestor:Se,getParentInstance:function(e){return xe(e)},traverseTwoPhase:function(e,t,n){for(var r=[];e;)r.push(e),e=xe(e);for(e=r.length;0<e--;)t(r[e],"captured",n);for(e=0;e<r.length;e++)t(r[e],"bubbled",n)},traverseEnterLeave:function(e,t,n,r,i){for(var a=e&&t?Se(e,t):null,o=[];e&&e!==a;)o.push(e),e=xe(e);for(e=[];t&&t!==a;)e.push(t),t=xe(t);for(t=0;t<o.length;t++)n(o[t],"bubbled",r);for(t=e.length;0<t--;)n(e[t],"captured",i)}},hu=wn.getListener,mu={accumulateTwoPhaseDispatches:function(e){_(e,Ce)},accumulateTwoPhaseDispatchesSkipTarget:function(e){_(e,_e)},accumulateDirectDispatches:function(e){_(e,Pe)},accumulateEnterLeaveDispatches:function(e,t,n,r){du.traverseEnterLeave(n,r,Te,e,t)}},vu={_root:null,_startText:null,_fallbackText:null},yu={initialize:function(e){return vu._root=e,vu._startText=yu.getText(),!0},reset:function(){vu._root=null,vu._startText=null,vu._fallbackText=null},getData:function(){if(vu._fallbackText)return vu._fallbackText;var e,t,n=vu._startText,r=n.length,i=yu.getText(),a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return vu._fallbackText=i.slice(e,1<t?1-t:void 0),vu._fallbackText},getText:function(){return"value"in vu._root?vu._root.value:vu._root[ge()]}},gu=yu,bu="dispatchConfig _targetInst nativeEvent isDefaultPrevented isPropagationStopped _dispatchListeners _dispatchInstances".split(" "),ku={type:null,target:null,currentTarget:bt.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};yt(Ie.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=bt.thatReturnsTrue)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=bt.thatReturnsTrue)},persist:function(){this.isPersistent=bt.thatReturnsTrue},isPersistent:bt.thatReturnsFalse,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;for(t=0;t<bu.length;t++)this[bu[t]]=null}}),Ie.Interface=ku,Ie.augmentClass=function(e,t){function n(){}n.prototype=this.prototype;var r=new n;yt(r,e.prototype),e.prototype=r,e.prototype.constructor=e,e.Interface=yt({},this.Interface,t),e.augmentClass=this.augmentClass,Oe(e)},Oe(Ie),Ie.augmentClass(De,{data:null}),Ie.augmentClass(Me,{data:null});var wu=[9,13,27,32],xu=vt.canUseDOM&&"CompositionEvent"in window,Su=null;vt.canUseDOM&&"documentMode"in document&&(Su=document.documentMode);var Eu;if(Eu=vt.canUseDOM&&"TextEvent"in window&&!Su){var Cu=window.opera;Eu=!("object"==typeof Cu&&"function"==typeof Cu.version&&12>=parseInt(Cu.version(),10))}var _u=Eu,Tu=vt.canUseDOM&&(!xu||Su&&8<Su&&11>=Su),Pu=String.fromCharCode(32),Iu={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["topCompositionEnd","topKeyPress","topTextInput","topPaste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"topBlur topCompositionEnd topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"topBlur topCompositionStart topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"topBlur topCompositionUpdate topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")}},Ru=!1,Fu=!1,Ou={eventTypes:Iu,extractEvents:function(e,t,n,r){var i;if(xu)e:{switch(e){case"topCompositionStart":var a=Iu.compositionStart;break e;case"topCompositionEnd":a=Iu.compositionEnd;break e;case"topCompositionUpdate":a=Iu.compositionUpdate;break e}a=void 0}else Fu?Ne(e,n)&&(a=Iu.compositionEnd):"topKeyDown"===e&&229===n.keyCode&&(a=Iu.compositionStart);return a?(Tu&&(Fu||a!==Iu.compositionStart?a===Iu.compositionEnd&&Fu&&(i=gu.getData()):Fu=gu.initialize(r)),a=De.getPooled(a,t,n,r),i?a.data=i:null!==(i=Ae(n))&&(a.data=i),mu.accumulateTwoPhaseDispatches(a),i=a):i=null,(e=_u?Le(e,n):je(e,n))?(t=Me.getPooled(Iu.beforeInput,t,n,r),t.data=e,mu.accumulateTwoPhaseDispatches(t)):t=null,[i,t]}},Du={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},Mu={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"topBlur topChange topClick topFocus topInput topKeyDown topKeyUp topSelectionChange".split(" ")}},Nu=null,Au=null,Lu=!1;vt.canUseDOM&&(Lu=F("input")&&(!document.documentMode||9<document.documentMode));var ju={eventTypes:Mu,_isInputEventSupported:Lu,extractEvents:function(e,t,n,r){var i=t?qt.getNodeFromInstance(t):window,a=i.nodeName&&i.nodeName.toLowerCase();if("select"===a||"input"===a&&"file"===i.type)var o=We;else if(Ue(i))if(Lu)o=Je;else{o=qe;var u=$e}else!(a=i.nodeName)||"input"!==a.toLowerCase()||"checkbox"!==i.type&&"radio"!==i.type||(o=Qe);if(o&&(o=o(e,t)))return Be(o,n,r);u&&u(e,i,t),"topBlur"===e&&null!=t&&(e=t._wrapperState||i._wrapperState)&&e.controlled&&"number"===i.type&&(e=""+i.value,i.getAttribute("value")!==e&&i.setAttribute("value",e))}};Ie.augmentClass(Ye,{view:function(e){return e.view?e.view:(e=S(e),e.window===e?e:(e=e.ownerDocument)?e.defaultView||e.parentWindow:window)},detail:function(e){return e.detail||0}});var Uu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};Ye.augmentClass(Ze,{screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Xe,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)}});var Bu={mouseEnter:{registrationName:"onMouseEnter",dependencies:["topMouseOut","topMouseOver"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["topMouseOut","topMouseOver"]}},Hu={eventTypes:Bu,extractEvents:function(e,t,n,r){if("topMouseOver"===e&&(n.relatedTarget||n.fromElement)||"topMouseOut"!==e&&"topMouseOver"!==e)return null;var i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window;if("topMouseOut"===e?(e=t,t=(t=n.relatedTarget||n.toElement)?qt.getClosestInstanceFromNode(t):null):e=null,e===t)return null;var a=null==e?i:qt.getNodeFromInstance(e);i=null==t?i:qt.getNodeFromInstance(t);var o=Ze.getPooled(Bu.mouseLeave,e,n,r);return o.type="mouseleave",o.target=a,o.relatedTarget=i,n=Ze.getPooled(Bu.mouseEnter,t,n,r),n.type="mouseenter",n.target=i,n.relatedTarget=a,mu.accumulateEnterLeaveDispatches(o,n,e,t),[o,n]}},zu=Lt.DOCUMENT_NODE,Wu=vt.canUseDOM&&"documentMode"in document&&11>=document.documentMode,Ku={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"topBlur topContextMenu topFocus topKeyDown topKeyUp topMouseDown topMouseUp topSelectionChange".split(" ")}},Vu=null,$u=null,qu=null,Qu=!1,Ju=In.isListeningToAllDependencies,Yu={eventTypes:Ku,extractEvents:function(e,t,n,r){var i=r.window===r?r.document:r.nodeType===zu?r:r.ownerDocument;if(!i||!Ju("onSelect",i))return null;switch(i=t?qt.getNodeFromInstance(t):window,e){case"topFocus":(Ue(i)||"true"===i.contentEditable)&&(Vu=i,$u=t,qu=null);break;case"topBlur":qu=$u=Vu=null;break;case"topMouseDown":Qu=!0;break;case"topContextMenu":case"topMouseUp":return Qu=!1,et(n,r);case"topSelectionChange":if(Wu)break;case"topKeyDown":case"topKeyUp":return et(n,r)}return null}};Ie.augmentClass(tt,{animationName:null,elapsedTime:null,pseudoElement:null}),Ie.augmentClass(nt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ye.augmentClass(rt,{relatedTarget:null});var Gu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};Ye.augmentClass(at,{key:function(e){if(e.key){var t=Gu[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?(e=it(e),13===e?"Enter":String.fromCharCode(e)):"keydown"===e.type||"keyup"===e.type?Xu[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Xe,charCode:function(e){return"keypress"===e.type?it(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?it(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ze.augmentClass(ot,{dataTransfer:null}),Ye.augmentClass(ut,{touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Xe}),Ie.augmentClass(st,{propertyName:null,elapsedTime:null,pseudoElement:null}),Ze.augmentClass(lt,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null});var Zu={},es={};"abort animationEnd animationIteration animationStart blur cancel canPlay canPlayThrough click close contextMenu copy cut doubleClick drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error focus input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing progress rateChange reset scroll seeked seeking stalled submit suspend timeUpdate toggle touchCancel touchEnd touchMove touchStart transitionEnd volumeChange waiting wheel".split(" ").forEach(function(e){var t=e[0].toUpperCase()+e.slice(1),n="on"+t;t="top"+t,n={phasedRegistrationNames:{bubbled:n,captured:n+"Capture"},dependencies:[t]},Zu[e]=n,es[t]=n});var ts={eventTypes:Zu,extractEvents:function(e,t,n,i){var a=es[e];if(!a)return null;switch(e){case"topAbort":case"topCancel":case"topCanPlay":case"topCanPlayThrough":case"topClose":case"topDurationChange":case"topEmptied":case"topEncrypted":case"topEnded":case"topError":case"topInput":case"topInvalid":case"topLoad":case"topLoadedData":case"topLoadedMetadata":case"topLoadStart":case"topPause":case"topPlay":case"topPlaying":case"topProgress":case"topRateChange":case"topReset":case"topSeeked":case"topSeeking":case"topStalled":case"topSubmit":case"topSuspend":case"topTimeUpdate":case"topToggle":case"topVolumeChange":case"topWaiting":var o=Ie;break;case"topKeyPress":if(0===it(n))return null;case"topKeyDown":case"topKeyUp":o=at;break;case"topBlur":case"topFocus":o=rt;break;case"topClick":if(2===n.button)return null;case"topDoubleClick":case"topMouseDown":case"topMouseMove":case"topMouseUp":case"topMouseOut":case"topMouseOver":case"topContextMenu":o=Ze;break;case"topDrag":case"topDragEnd":case"topDragEnter":case"topDragExit":case"topDragLeave":case"topDragOver":case"topDragStart":case"topDrop":o=ot;break;case"topTouchCancel":case"topTouchEnd":case"topTouchMove":case"topTouchStart":o=ut;break;case"topAnimationEnd":case"topAnimationIteration":case"topAnimationStart":o=tt;break;case"topTransitionEnd":o=st;break;case"topScroll":o=Ye;break;case"topWheel":o=lt;break;case"topCopy":case"topCut":case"topPaste":o=nt}return o||r("86",e),e=o.getPooled(a,t,n,i),mu.accumulateTwoPhaseDispatches(e),e}};bn.setHandleTopLevel(In.handleTopLevel),wn.injection.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin TapEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),sn.injection.injectComponentTree(qt),wn.injection.injectEventPluginsByName({SimpleEventPlugin:ts,EnterLeaveEventPlugin:Hu,ChangeEventPlugin:ju,SelectEventPlugin:Yu,BeforeInputEventPlugin:Ou});var ns=Nt.injection.MUST_USE_PROPERTY,rs=Nt.injection.HAS_BOOLEAN_VALUE,is=Nt.injection.HAS_NUMERIC_VALUE,as=Nt.injection.HAS_POSITIVE_NUMERIC_VALUE,os=Nt.injection.HAS_STRING_BOOLEAN_VALUE,us={Properties:{allowFullScreen:rs,allowTransparency:os,async:rs,autoPlay:rs,capture:rs,checked:ns|rs,cols:as,contentEditable:os,controls:rs,default:rs,defer:rs,disabled:rs,download:Nt.injection.HAS_OVERLOADED_BOOLEAN_VALUE,draggable:os,formNoValidate:rs,hidden:rs,loop:rs,multiple:ns|rs,muted:ns|rs,noValidate:rs,open:rs,playsInline:rs,readOnly:rs,required:rs,reversed:rs,rows:as,rowSpan:is,scoped:rs,seamless:rs,selected:ns|rs,size:as,start:is,span:as,spellCheck:os,style:0,itemScope:rs,acceptCharset:0,className:0,htmlFor:0,httpEquiv:0,value:os},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMMutationMethods:{value:function(e,t){if(null==t)return e.removeAttribute("value");"number"!==e.type||!1===e.hasAttribute("value")?e.setAttribute("value",""+t):e.validity&&!e.validity.badInput&&e.ownerDocument.activeElement!==e&&e.setAttribute("value",""+t)}}},ss=Nt.injection.HAS_STRING_BOOLEAN_VALUE,ls={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},cs={Properties:{autoReverse:ss,externalResourcesRequired:ss,preserveAlpha:ss},DOMAttributeNames:{autoReverse:"autoReverse",externalResourcesRequired:"externalResourcesRequired",preserveAlpha:"preserveAlpha"},DOMAttributeNamespaces:{xlinkActuate:ls.xlink,xlinkArcrole:ls.xlink,xlinkHref:ls.xlink,xlinkRole:ls.xlink,xlinkShow:ls.xlink,xlinkTitle:ls.xlink,xlinkType:ls.xlink,xmlBase:ls.xml,xmlLang:ls.xml,xmlSpace:ls.xml}},fs=/[\-\:]([a-z])/g;"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode x-height xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type xml:base xmlns:xlink xml:lang xml:space".split(" ").forEach(function(e){var t=e.replace(fs,ct);cs.Properties[t]=0,cs.DOMAttributeNames[t]=e}),Nt.injection.injectDOMPropertyConfig(us),Nt.injection.injectDOMPropertyConfig(cs);var ps=eo.injectInternals,ds=Lt.ELEMENT_NODE,hs=Lt.TEXT_NODE,ms=Lt.COMMENT_NODE,vs=Lt.DOCUMENT_NODE,ys=Lt.DOCUMENT_FRAGMENT_NODE,gs=Nt.ROOT_ATTRIBUTE_NAME,bs=Tt.getChildNamespace,ks=pr.createElement,ws=pr.createTextNode,xs=pr.setInitialProperties,Ss=pr.diffProperties,Es=pr.updateProperties,Cs=pr.diffHydratedProperties,_s=pr.diffHydratedText,Ts=pr.warnForDeletedHydratableElement,Ps=pr.warnForDeletedHydratableText,Is=pr.warnForInsertedHydratedElement,Rs=pr.warnForInsertedHydratedText,Fs=qt.precacheFiberNode,Os=qt.updateFiberProps;pn.injection.injectFiberControlledHostComponent(pr),we._injectFiber(function(e){return Ns.findHostInstance(e)});var Ds=null,Ms=null,Ns=function(e){var t=e.getPublicInstance;e=de(e);var n=e.scheduleUpdate,r=e.getPriorityContext;return{createContainer:function(e){var t=fi();return e={current:t,containerInfo:e,isScheduled:!1,nextScheduledRoot:null,context:null,pendingContext:null},t.stateNode=e},updateContainer:function(e,t,i,a){var o=t.current;i=me(i),null===t.context?t.context=i:t.pendingContext=i,t=a,a=r(o,Tr.enableAsyncSubtreeAPI&&null!=e&&null!=e.type&&null!=e.type.prototype&&!0===e.type.prototype.unstable_isAsyncReactComponent),e={element:e},Xo(o,e,void 0===t?null:t,a),n(o,a)},batchedUpdates:e.batchedUpdates,unbatchedUpdates:e.unbatchedUpdates,deferredUpdates:e.deferredUpdates,flushSync:e.flushSync,getPublicRootInstance:function(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case nu:return t(e.child.stateNode);default:return e.child.stateNode}},findHostInstance:function(e){return e=ru(e),null===e?null:e.stateNode},findHostInstanceWithNoPortals:function(e){return e=iu(e),null===e?null:e.stateNode}}}({getRootHostContext:function(e){if(e.nodeType===vs)e=(e=e.documentElement)?e.namespaceURI:bs(null,"");else{var t=e.nodeType===ms?e.parentNode:e;e=t.namespaceURI||null,t=t.tagName,e=bs(e,t)}return e},getChildHostContext:function(e,t){return bs(e,t)},getPublicInstance:function(e){return e},prepareForCommit:function(){Ds=In.isEnabled(),Ms=cu.getSelectionInformation(),In.setEnabled(!1)},resetAfterCommit:function(){cu.restoreSelection(Ms),Ms=null,In.setEnabled(Ds),Ds=null},createInstance:function(e,t,n,r,i){return e=ks(e,t,n,r),Fs(i,e),Os(e,t),e},appendInitialChild:function(e,t){e.appendChild(t)},finalizeInitialChildren:function(e,t,n,r){xs(e,t,n,r);e:{switch(t){case"button":case"input":case"select":case"textarea":e=!!n.autoFocus;break e}e=!1}return e},prepareUpdate:function(e,t,n,r,i){return Ss(e,t,n,r,i)},commitMount:function(e){e.focus()},commitUpdate:function(e,t,n,r,i){Os(e,i),Es(e,t,n,r,i)},shouldSetTextContent:function(e,t){return"textarea"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&"string"==typeof t.dangerouslySetInnerHTML.__html},resetTextContent:function(e){e.textContent=""},shouldDeprioritizeSubtree:function(e,t){return!!t.hidden},createTextInstance:function(e,t,n,r){return e=ws(e,t),Fs(r,e),e},commitTextUpdate:function(e,t,n){e.nodeValue=n},appendChild:function(e,t){e.appendChild(t)},appendChildToContainer:function(e,t){e.nodeType===ms?e.parentNode.insertBefore(t,e):e.appendChild(t)},insertBefore:function(e,t,n){e.insertBefore(t,n)},insertInContainerBefore:function(e,t,n){e.nodeType===ms?e.parentNode.insertBefore(t,n):e.insertBefore(t,n)},removeChild:function(e,t){e.removeChild(t)},removeChildFromContainer:function(e,t){e.nodeType===ms?e.parentNode.removeChild(t):e.removeChild(t)},canHydrateInstance:function(e,t){return e.nodeType===ds&&t===e.nodeName.toLowerCase()},canHydrateTextInstance:function(e,t){return""!==t&&e.nodeType===hs},getNextHydratableSibling:function(e){for(e=e.nextSibling;e&&e.nodeType!==ds&&e.nodeType!==hs;)e=e.nextSibling;return e},getFirstHydratableChild:function(e){for(e=e.firstChild;e&&e.nodeType!==ds&&e.nodeType!==hs;)e=e.nextSibling;return e},hydrateInstance:function(e,t,n,r,i,a){return Fs(a,e),Os(e,n),Cs(e,t,n,i,r)},hydrateTextInstance:function(e,t,n){return Fs(n,e),_s(e,t)},didNotHydrateInstance:function(e,t){1===t.nodeType?Ts(e,t):Ps(e,t)},didNotFindHydratableInstance:function(e,t,n){Is(e,t,n)},didNotFindHydratableTextInstance:function(e,t){Rs(e,t)},scheduleDeferredCallback:_r.rIC,useSyncScheduling:!0});hn.injection.injectFiberBatchedUpdates(Ns.batchedUpdates);var As={createPortal:ht,hydrate:function(e,t,n){return dt(null,e,t,!0,n)},render:function(e,t,n){return dt(null,e,t,!1,n)},unstable_renderSubtreeIntoContainer:function(e,t,n,i){return null!=e&&Qt.has(e)||r("38"),dt(e,t,n,!1,i)},unmountComponentAtNode:function(e){return ft(e)||r("40"),!!e._reactRootContainer&&(Ns.unbatchedUpdates(function(){dt(null,null,e,!1,function(){e._reactRootContainer=null})}),!0)},findDOMNode:we,unstable_createPortal:ht,unstable_batchedUpdates:hn.batchedUpdates,unstable_deferredUpdates:Ns.deferredUpdates,flushSync:Ns.flushSync,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{EventPluginHub:wn,EventPluginRegistry:Ft,EventPropagators:mu,ReactControlledComponent:pn,ReactDOMComponentTree:qt,ReactDOMEventListener:bn}};ps({findFiberByHostInstance:qt.getClosestInstanceFromNode,findHostInstanceByFiber:Ns.findHostInstance,bundleType:0,version:"16.0.1",rendererPackageName:"react-dom"}),e.exports=As},function(e,t,n){"use strict";function r(e,t,n,r,a,o,u,s){if(i(t),!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,a,o,u,s],f=0;l=new Error(t.replace(/%s/g,function(){return c[f++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}}var i=function(e){};e.exports=r},function(e,t,n){"use strict";var r=!("undefined"==typeof window||!window.document||!window.document.createElement),i={canUseDOM:r,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen,isInWorker:!r};e.exports=i},function(e,t,n){"use strict";var r=n(2),i={listen:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function(){e.detachEvent("on"+t,n)}}):void 0},capture:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!0),{remove:function(){e.removeEventListener(t,n,!0)}}):{remove:r}},registerDefault:function(){}};e.exports=i},function(e,t,n){"use strict";var r={};e.exports=r},function(e,t,n){"use strict";function r(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!==e&&t!==t}function i(e,t){if(r(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var o=0;o<n.length;o++)if(!a.call(t,n[o])||!r(e[n[o]],t[n[o]]))return!1;return!0}var a=Object.prototype.hasOwnProperty;e.exports=i},function(e,t,n){"use strict";function r(e,t){return!(!e||!t)&&(e===t||!i(e)&&(i(t)?r(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}var i=n(17);e.exports=r},function(e,t,n){"use strict";function r(e){return i(e)&&3==e.nodeType}var i=n(18);e.exports=r},function(e,t,n){"use strict";function r(e){var t=e?e.ownerDocument||e:document,n=t.defaultView||window;return!(!e||!("function"==typeof n.Node?e instanceof n.Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}e.exports=r},function(e,t,n){"use strict";function r(e){try{e.focus()}catch(e){}}e.exports=r},function(e,t,n){"use strict";function r(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}e.exports=r},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return m});var p=n(0),d=n.n(p),h=n(22),m=function(e){function t(e){return i(this,t),u(this,l(t).call(this,e))}return c(t,e),o(t,[{key:"render",value:function(){return d.a.createElement("div",{id:"editor-container"},d.a.createElement("div",{key:"editor",id:"editor"},d.a.createElement(h.a,null)))}}]),t}(d.a.Component)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){function o(e){i(s,r,a,o,u,"next",e)}function u(e){i(s,r,a,o,u,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?c(e):t}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return k});var h=n(0),m=n.n(h),v=n(23),y=n.n(v),g=n(29),b=(n.n(g),n(5)),k=(n.n(b),function(e){function t(e){var n;return o(this,t),n=l(this,f(t).call(this,e)),n.state={},n}return p(t,e),s(t,[{key:"componentDidMount",value:function(){this.configureEditorKit(),this.configureEditor()}},{key:"configureEditorKit",value:function(){var e=this,t=new g.EditorKitDelegate({insertRawText:function(t){e.redactor.insertion.insertHtml(t)},preprocessElement:function(t){var n=e.redactor.cleaner.input(t.outerHTML),r=$R.dom(n).nodes[0],i=!0,a=!1,o=void 0;try{for(var u,s=t.attributes[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;r.setAttribute(l.nodeName,l.nodeValue)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r.tagName!=t.tagName&&(r.setAttribute("ghost",!0),r.removeAttribute("fscollapsable")),r},insertElement:function(t,n,r){n?"afterend"==r?n.insertAdjacentElement("afterend",t):"child"==r&&n.after(t):e.redactor.insertion.insertHtml(t.outerHTML)},getElementsBySelector:function(t){return e.redactor.editor.getElement().find(t).nodes},getCurrentLineText:function(){return e.redactor.selection.getCurrent().textContent},getPreviousLineText:function(){var t=e.redactor.selection.getElement(),n=t.previousSibling;return n&&n.textContent},replaceText:function(t){var n,r=t.regex,i=t.replacement,a=t.previousLine,o=e.redactor.marker.insert("start");if(n=a?e.redactor.selection.getElement().previousSibling:o.previousSibling){var u=n.textContent;u=u.replace(/&nbsp;/," "),u=u.replace(r,"").replace(/\s$/,"").trim(),0==u.length?n.remove():n.textContent=u,e.redactor.insertion.insertHtml(i,"start"),e.redactor.selection.restoreMarkers()}},onReceiveNote:function(e){},clearUndoHistory:function(){$R("#editor","module.buffer.clear")},setEditorRawText:function(t){var n=e.redactor.cleaner.input(t);$R("#editor","source.setCode",n)}});this.editorKit=new g.EditorKit({delegate:t,mode:"html",supportsFilesafe:!0,coallesedSavingDelay:0})}},{key:"configureEditor",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.editorKit.getFilesafe();case 2:t=e.sent,window.filesafe_params={embed:y.a,client:t},this.redactor=$R("#editor",{styles:!0,toolbarFixed:!0,tabAsSpaces:2,tabKey:!0,linkSize:2e4,buttonsAdd:["filesafe"],buttons:["bold","italic","underline","deleted","format","fontsize","fontfamily","fontcolor","filesafe","link","lists","alignment","line","redo","undo","indent","outdent","textdirection","html"],plugins:["filesafe","fontsize","fontfamily","fontcolor","alignment","table","inlinestyle","textdirection"],fontfamily:["Arial","Helvetica","Georgia","Times New Roman","Trebuchet MS","Monospace"],callbacks:{changed:function(e){n.editorKit.onEditorValueChanged(e)},pasted:function(e){n.editorKit.onEditorPaste()},image:{resized:function(e){}}},imageEditable:!1,imageCaption:!1,imageLink:!1,imageResizable:!0,imageUpload:function(e,t,r){n.onEditorFilesDrop(t)}}),this.redactor.editor.getElement().on("keyup.textsearcher",function(e){var t=e.which;n.editorKit.onEditorKeyUp({key:t,isSpace:t==n.redactor.keycodes.SPACE,isEnter:t==n.redactor.keycodes.ENTER})}),this.redactor.editor.endFocus();case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"onEditorFilesDrop",value:function(e){if(!this.editorKit.canUploadFiles())return void this.redactor.plugin.filesafe.open();var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.editorKit.uploadJSFileObject(o).then(function(e){!e||e.uuid})}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"render",value:function(){return m.a.createElement("div",{key:"editor",className:"sn-component "+this.state.platform})}}]),t}(m.a.Component))},function(e,t,n){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(t){return e[t]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=14)}([function(e,t){e.exports=n(3)},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){e.exports=n(13)},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){var r=n(11);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(12),i=n(2);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},function(e,t){function n(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise(function(i,a){function o(e){n(s,i,a,o,u,"next",e)}function u(e){n(s,i,a,o,u,"throw",e)}var s=e.apply(t,r);o(void 0)})}}},function(e,t){e.exports=n(25)},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t,n){var r=function(e){"use strict";function t(e,t,i,a){var o=t&&t.prototype instanceof r?t:r,u=Object.create(o.prototype),l=new f(a||[]);return u._invoke=function(e,t,r){var i="suspendedStart";return function(a,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw o;return d()}for(r.method=a,r.arg=o;;){var u=r.delegate;if(u){var l=s(u,r);if(l){if(l===k)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var c=n(e,t,r);if("normal"===c.type){if(i=r.done?"completed":"suspendedYield",c.arg===k)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i="completed",r.method="throw",r.arg=c.arg)}}}(e,i,l),u}function n(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function r(){}function i(){}function a(){}function o(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function u(e,t){var r;this._invoke=function(i,a){function o(){return new t(function(r,o){!function r(i,a,o,u){var s=n(e[i],e,a);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==typeof c&&m.call(c,"__await")?t.resolve(c.__await).then(function(e){r("next",e,o,u)},function(e){r("throw",e,o,u)}):t.resolve(c).then(function(e){l.value=e,o(l)},function(e){return r("throw",e,o,u)})}u(s.arg)}(i,a,r,o)})}return r=r?r.then(o,o):o()}}function s(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,s(e,t),"throw"===t.method))return k;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return k}var i=n(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,k;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,k):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,k)}function l(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function c(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function f(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(l,this),this.reset(!0)}function p(e){if(e){var t=e[y];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(m.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:d}}function d(){return{value:void 0,done:!0}}var h=Object.prototype,m=h.hasOwnProperty,v="function"==typeof Symbol?Symbol:{},y=v.iterator||"@@iterator",g=v.asyncIterator||"@@asyncIterator",b=v.toStringTag||"@@toStringTag";e.wrap=t;var k={},w={};w[y]=function(){return this};var x=Object.getPrototypeOf,S=x&&x(x(p([])));S&&S!==h&&m.call(S,y)&&(w=S);var E=a.prototype=r.prototype=Object.create(w);return i.prototype=E.constructor=a,a.constructor=i,a[b]=i.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===i||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,b in e||(e[b]="GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},o(u.prototype),u.prototype[g]=function(){return this},e.AsyncIterator=u,e.async=function(n,r,i,a,o){void 0===o&&(o=Promise);var s=new u(t(n,r,i,a),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},o(E),E[b]="Generator",E[y]=function(){return this},E.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=p,f.prototype={constructor:f,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(c),!e)for(var t in this)"t"===t.charAt(0)&&m.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){function t(t,r){return a.type="throw",a.arg=e,n.next=t,r&&(n.method="next",n.arg=void 0),!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var o=m.call(i,"catchLoc"),u=m.call(i,"finallyLoc");if(o&&u){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&m.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,k):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),k},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),c(n),k}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;c(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:p(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),k}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){"use strict";function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw o}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}n.r(t);var m=n(0),v=n.n(m),y=n(10),g=n.n(y),b=n(6),k=n.n(b),w=n(5),x=n.n(w),S=n(7),E=n.n(S),C=n(8),_=n.n(C),T=n(4),P=n.n(T),I=n(2),R=n.n(I),F=n(1),O=n.n(F),D=function(){function e(){k()(this,e),this.unloadHandlers=[],this.dataChangeObservers=[]}return x()(e,null,[{key:"get",value:function(){return null==this.instance&&(this.instance=new e),this.instance}}]),x()(e,[{key:"setFilesafeInstance",value:function(e){var t=this;this.filesafe=e,this.fsObserver=e.addDataChangeObserver(function(){var e,n=r(t.dataChangeObservers);try{for(n.s();!(e=n.n()).done;)(0,e.value)()}catch(e){n.e(e)}finally{n.f()}})}},{key:"setDelegate",value:function(e){this.delegate=e}},{key:"getDelegate",value:function(){return this.delegate||{}}},{key:"addDataChangeObserver",value:function(e){this.dataChangeObservers.push(e)}},{key:"addUnloadHandler",value:function(e){this.unloadHandlers.push(e)}},{key:"unload",value:function(){var t,n=r(this.unloadHandlers);try{for(n.s();!(t=n.n()).done;)(0,t.value)()}catch(e){n.e(e)}finally{n.f()}this.dataChangeObservers=[],this.filesafe&&this.filesafe.removeDataChangeObserver(this.fsObserver),e.instance=null}},{key:"defaultRelayServerUrl",value:function(){return window.default_fs_relay_server_url||"https://filesafe.standardnotes.org"}}]),e}();O()(D,"instance",null);var M=function(e){function t(e){var r;return k()(this,t),r=n.call(this,e),O()(R()(r),"exportCredential",function(e){var t=btoa(JSON.stringify(e,null,2));D.get().filesafe.downloadBase64Data({base64Data:t,fileName:"sn-filesafe-keys-".concat(e.created_at.toISOString(),".json"),fileType:"text/json"})}),O()(R()(r),"deleteCredential",function(e){0==r.numFilesForCredential(e)?D.get().filesafe.deleteCredential(e):alert("This key has files encrypted with it and cannot be deleted. First delete any associated files, then try again.")}),O()(R()(r),"createNewKeys",function(){D.get().filesafe.createNewCredentials()}),O()(R()(r),"labelForCredential",function(e){return e.created_at.toLocaleString()}),O()(R()(r),"numFilesForCredential",function(e){return D.get().filesafe.numberOfFilesEncryptedWithCredential(e)}),O()(R()(r),"setCredentialAsDefault",function(e){D.get().filesafe.setCredentialAsDefault(e)}),r.state={credentials:D.get().filesafe.getAllCredentials()||[]},D.get().addDataChangeObserver(function(){r.setState({credentials:D.get().filesafe.getAllCredentials()})}),r}E()(t,e);var n=a(t);return x()(t,[{key:"render",value:function(){var e=this;return v.a.createElement("div",null,v.a.createElement("div",{className:"sk-panel-row"},v.a.createElement("div",{className:"sk-h2 sk-bold"},"Keys"),v.a.createElement("div",{className:"sk-button info no-border",onClick:this.createNewKeys},v.a.createElement("div",{className:"sk-label"},"Create New"))),v.a.createElement("div",{className:"list-container"},this.state.credentials.map(function(t){return v.a.createElement("div",{className:"list-item sk-horizontal-group top"},v.a.createElement("div",{className:"sk-circle x-small "+(t.content.isDefault?"info":"sk-secondary-contrast")}),v.a.createElement("div",null,v.a.createElement("div",{className:"sk-panel-row condensed sk-bold"},e.labelForCredential(t)),v.a.createElement("div",{style:{marginTop:3},className:"sk-panel-row condensed"},e.numFilesForCredential(t)," encrypted files"),v.a.createElement("div",{className:"sk-panel-row condensed"},v.a.createElement("div",{className:"sk-horizontal-group"},e.state.credentials.length>1&&!t.content.isDefault&&v.a.createElement("a",{className:"info",onClick:function(){e.setCredentialAsDefault(t)}},"Make Default"),v.a.createElement("a",{className:"info",onClick:function(){e.exportCredential(t)}},"Export"),v.a.createElement("a",{className:"danger",onClick:function(){e.deleteCredential(t)}},"Delete")))))})))}}]),t}(v.a.Component),N=n(3),A=n.n(N),L=n(9),j=n.n(L),U=function(){function e(t){var n=t.credentialManager,r=t.integrationManager;k()(this,e),this.credentialManager=n,this.integrationManager=r}var t;return x()(e,[{key:"getMessages",value:(t=j()(A.a.mark(function e(){var t,n;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.credentialManager.getDefaultCredentials();case 3:return e.sent||t.push({message:"Create keys by selecting <strong>Create New</strong> under <i>Keys</i>.",css:"sk-base"}),(n=this.integrationManager.integrations)&&0!=n.length||t.push({message:"Add a new integration by selecting <strong>Add New</strong> under <i>Integrations</i>",css:"sk-base"}),e.abrupt("return",t);case 8:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})}]),e}(),B=function(e){function t(e){var r;return k()(this,t),(r=n.call(this,e)).state={},r}E()(t,e);var n=o(t);return x()(t,[{key:"render",value:function(){return v.a.createElement("div",{id:"messages"},v.a.createElement("div",{className:"title"},"Complete the following steps before uploading your first file:"),v.a.createElement("ul",null,this.props.messages.map(function(e){return v.a.createElement("li",{dangerouslySetInnerHTML:{__html:e.message},className:e.css})})))}}]),t}(v.a.Component),H=function(e){function t(e){var r;return k()(this,t),r=n.call(this,e),O()(R()(r),"setStatusForFile",function(e,t,n){r.setState({fileStatusFile:e,fileStatus:t,hasStatusSpinner:n})}),O()(R()(r),"decryptFileDescriptor",function(){var e=j()(A.a.mark(function e(t){var n,i;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=D.get().filesafe.integrationForFileDescriptor(t)){e.next=4;break}return alert("Unable to find integration for file. If you have deleted the integration, please re-add it and try again."),e.abrupt("return");case 4:return i=D.get().filesafe.displayStringForIntegration(n),r.setStatusForFile(t,"Downloading from ".concat(i,"..."),!0),e.abrupt("return",D.get().filesafe.downloadFileFromDescriptor(t).then(function(e){return r.setStatusForFile(t,"Decrypting...",!0),D.get().filesafe.decryptFile({fileDescriptor:t,fileItem:e}).then(function(e){return{base64Data:e.decryptedData,fileName:t.content.fileName,fileType:t.content.fileType}}).catch(function(e){console.error("filesafe-embed | error decrypting file:",e),r.flashErrorForFileDescriptor(t,"Error decrypting file.")})}).catch(function(e){console.error("Error downloading file",e),r.flashErrorForFileDescriptor(t,"Error downloading file.")}));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),O()(R()(r),"downloadFile",function(){var e=j()(A.a.mark(function e(t){var n,i;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isMobile){e.next=5;break}return n=D.get().filesafe.getPlatform(),alert("Downloading files is not currently supported on ".concat("ios"==n?"iOS":"Android",".")),e.abrupt("return");case 5:return e.next=7,r.decryptFileDescriptor(t);case 7:if(i=e.sent){e.next=11;break}return console.error("decryptFile returned nil data"),e.abrupt("return");case 11:D.get().filesafe.downloadBase64Data(i),r.setStatusForFile(t,null);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),O()(R()(r),"previewFile",function(){var e=j()(A.a.mark(function e(t){var n,i;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.decryptFileDescriptor(t);case 2:n=e.sent,i=D.get().filesafe.createTemporaryFileUrl({base64Data:n.base64Data,dataType:n.fileType}),r.setStatusForFile(t,null),r.setState({previewUrl:i,previewingFile:t});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),O()(R()(r),"onClickPreview",function(){setTimeout(function(){r.revokePreview()},500)}),O()(R()(r),"selectFile",function(e,t){e.target.focus(),r.state.selectedFile==t?(r.setState({selectedFile:null}),r.delegate.onSelectFile&&r.delegate.onSelectFile(null)):(r.setState({selectedFile:t}),r.delegate.onSelectFile&&r.delegate.onSelectFile(t)),r.revokePreview()}),O()(R()(r),"deleteFile",function(e){D.get().filesafe.deleteFileFromDescriptor(e)}),O()(R()(r),"copyInsertionLink",function(e){var t="[FileSafe:".concat(e.uuid,":").concat(e.content.fileName,"]");D.get().filesafe.copyTextToClipboard(t),r.setState({copiedLink:e}),setTimeout(function(){r.setState({copiedLink:null})},1e3)}),O()(R()(r),"isFileSelected",function(e){return r.state.selectedFile==e}),O()(R()(r),"elementForFile",function(e){var t,n=D.get().filesafe.integrationForFileDescriptor(e);t=n?D.get().filesafe.displayStringForIntegration(n):"Integration Not Found";var i=e.content.serverMetadata.file_path,a=r.state.previewUrl&&r.state.previewingFile==e,o=r.state.fileStatusFile==e&&r.state.fileStatus,u=r.state.hasStatusSpinner;return v.a.createElement("div",{className:"file-item-container "+(r.isFileSelected(e)?"expanded":"")},v.a.createElement("div",{onClick:function(t){r.selectFile(t,e)},className:"file-item-button sk-button info "+(r.isFileSelected(e)?"selected":void 0)},v.a.createElement("div",{className:"sk-label"},e.content.fileName),o&&v.a.createElement("div",{className:"file-download-status sk-horizontal-group"},u&&v.a.createElement("div",{className:"sk-spinner x-small"}),v.a.createElement("div",{className:"file-status-label"},r.state.fileStatus)),r.isFileSelected(e)&&v.a.createElement("div",{className:"file-item-options-wrapper"},v.a.createElement("div",{onClick:function(e){e.stopPropagation()},className:"sk-app-bar file-item-options"},v.a.createElement("div",{className:"center"},v.a.createElement("div",{onClick:function(t){t.stopPropagation(),r.downloadFile(e)},className:"sk-app-bar-item"},v.a.createElement("div",{className:"sk-label contrast "+(r.isMobile?"disabled":"")},"Download")),v.a.createElement("div",{className:"sk-app-bar-item border"}),r.supportsPreviews&&a&&v.a.createElement("a",{className:"sk-app-bar-item",href:r.state.previewUrl,onClick:function(e){e.stopPropagation(),r.onClickPreview()},target:"_blank"},v.a.createElement("div",{className:"sk-label contrast"},"Open Preview")),r.supportsPreviews&&!a&&v.a.createElement("div",{onClick:function(t){t.stopPropagation(),r.previewFile(e)},className:"sk-app-bar-item"},v.a.createElement("div",{className:"sk-label contrast "+(r.isMobile?"disabled":"")},"Preview")),r.supportsPreviews&&v.a.createElement("div",{className:"sk-app-bar-item border"}),v.a.createElement("div",{onClick:function(t){t.stopPropagation(),r.copyInsertionLink(e)},className:"sk-app-bar-item"},v.a.createElement("div",{className:"sk-label contrast"},r.state.copiedLink==e?"Copied":"Copy Insert Link")),v.a.createElement("div",{className:"sk-app-bar-item border"}),v.a.createElement("div",{onClick:function(t){t.stopPropagation(),r.deleteFile(e)},className:"sk-app-bar-item"},v.a.createElement("div",{className:"sk-label contrast"},"Delete")))),v.a.createElement("div",{className:"file-location"},v.a.createElement("strong",null,t),v.a.createElement("span",null," ",i)))))}),r.state={},r.delegate=D.get().getDelegate(),r}E()(t,e);var n=u(t);return x()(t,[{key:"revokePreview",value:function(){this.state.previewUrl&&D.get().filesafe.revokeTempUrl(this.state.previewUrl),this.setState({previewUrl:null,previewingFile:null})}},{key:"flashErrorForFileDescriptor",value:function(e,t){var n=this;this.setStatusForFile(e,t,!1),setTimeout(function(){n.setStatusForFile(null)},2500)}},{key:"render",value:function(){var e=this;return this.props.files.map(function(t){return e.elementForFile(t)})}},{key:"supportsPreviews",get:function(){if(void 0!==this._supportsPreview)return this._supportsPreview;var e=D.get().filesafe.getEnvironment();if(null==e)return!1;this._supportsPreview="web"==e}},{key:"isMobile",get:function(){return D.get().filesafe.isMobile()}}]),t}(v.a.Component),z=function(e){function t(e){var n;return k()(this,t),n=u.call(this,e),O()(R()(n),"event_preventDefaults",function(e){e.preventDefault(),e.stopPropagation()}),O()(R()(n),"event_highlight",function(e){n.event_preventDefaults(e),n.rootElement.classList.add("highlight")}),O()(R()(n),"event_unhighlight",function(e){n.event_preventDefaults(e),n.rootElement.classList.remove("highlight")}),O()(R()(n),"event_drop",function(e){n.event_unhighlight(e),n.event_preventDefaults(e);var t=e.dataTransfer.files;n.handleDroppedFiles(t)}),O()(R()(n),"handleDroppedFiles",function(){var e=j()(A.a.mark(function e(t){var r,i,a;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=D.get().filesafe.getAllIntegrations().length){e.next=3;break}return alert("Please set up at least one integration before attempting to upload a file. To do this, press Expand, and select Add New in the Integrations section."),e.abrupt("return");case 3:r=s(t),e.prev=4,r.s();case 6:if((i=r.n()).done){e.next=14;break}if(a=i.value){e.next=10;break}return e.abrupt("continue",12);case 10:return e.next=12,n.readFile(a);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[4,16,19,22]])}));return function(t){return e.apply(this,arguments)}}()),n.messagesManager=new U({credentialManager:D.get().filesafe.credentialManager,integrationManager:D.get().filesafe.integrationManager}),n.messagesManager.getMessages().then(function(e){n.setState({messages:e})}),n.state={noteFiles:D.get().filesafe.fileDescriptorsForCurrentNote(),messages:[]},D.get().addDataChangeObserver(function(){n.reload()}),D.get().addUnloadHandler(function(){window.removeEventListener("dragenter",n.event_highlight,!1),window.removeEventListener("dragover",n.event_highlight,!1),window.removeEventListener("dragleave",n.event_unhighlight,!1),window.removeEventListener("drop",n.event_drop,!1)}),n}E()(t,e);var n,r,i,a,o,u=c(t);return x()(t,[{key:"reload",value:(o=j()(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.messagesManager.getMessages();case 2:t=e.sent,this.setState({noteFiles:D.get().filesafe.fileDescriptorsForCurrentNote(),messages:t});case 4:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"componentDidMount",value:function(){this.configureFileForm(),window.addEventListener("dragenter",this.event_highlight,!1),window.addEventListener("dragover",this.event_highlight,!1),window.addEventListener("dragleave",this.event_unhighlight,!1),window.addEventListener("drop",this.event_drop,!1)}},{key:"configureFileForm",value:function(){var e=this,t=this.fileInput;this.dropContainer,t&&(t.onchange=function(t){var n=t.target.files;e.handledFiles||e.handleDroppedFiles(n)})}},{key:"reset",value:function(){this.setState({rawData:null,decryptedItems:null,requestPassword:!1})}},{key:"readFile",value:(a=j()(A.a.mark(function e(t){var n=this;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){var i=new FileReader,a=!1;i.onload=function(){var r=j()(A.a.mark(function r(i){var o,u,s,l;return A.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(o=i.target.result,!a){r.next=7;break}o=JSON.parse(o),u=o.items[0],n.decryptDraggedFile(u).then(e),r.next=20;break;case 7:if(!((s=o).byteLength>5e7)){r.next=14;break}return alert("The maximum upload size is ".concat(50," megabytes per file.")),n.setState({status:null}),e(),r.abrupt("return");case 14:return r.next=16,SFJS.crypto.arrayBufferToBase64(s);case 16:return l=r.sent,r.next=19,n.encryptFile(l,t.name,t.type);case 19:e();case 20:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}(),n.setState({status:"Reading file..."}),t.name.endsWith(".sf")||t.name.endsWith(".json")?(a=!0,i.readAsText(t)):i.readAsArrayBuffer(t)}));case 4:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)})},{key:"decryptDraggedFile",value:(i=j()(A.a.mark(function e(t){var n,r,i,a,o,u=this;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({status:"Decrypting..."}),n=D.get().filesafe.getAllCredentials(),r=function(){var e=j()(A.a.mark(function e(n){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){D.get().filesafe.decryptFile({fileItem:t,credential:n}).then(function(t){var n=t.decryptedItem;D.get().filesafe.downloadBase64Data({base64Data:t.decryptedData,fileName:n.content.fileName,fileType:n.content.fileType}),u.setState({status:null}),e(!0)}).catch(function(e){console.error("Error decrypting:",e),u.flashError("Error decrypting file."),r(!1)})}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),i=s(n),e.prev=4,i.s();case 6:if((a=i.n()).done){e.next=15;break}return o=a.value,e.next=10,r(o);case 10:if(!e.sent){e.next=13;break}return e.abrupt("return");case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),i.e(e.t0);case 20:return e.prev=20,i.f(),e.finish(20);case 23:case"end":return e.stop()}},e,this,[[4,17,20,23]])})),function(e){return i.apply(this,arguments)})},{key:"wait",value:(r=j()(A.a.mark(function e(t){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){setTimeout(function(){e()},1e3*t)}));case 1:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)})},{key:"encryptFile",value:(n=j()(A.a.mark(function e(t,n,r){var i,a,o=this;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=D.get().filesafe.getDefaultCredentials()){e.next=5;break}return this.setState({status:null}),alert("Please set up at least one key before attempting to upload a file. To do this, press Expand, and select Create New in the Keys section."),e.abrupt("return");case 5:if(a=D.get().filesafe.getDefaultIntegration()){e.next=10;break}return this.setState({status:null}),alert("Please set up at least one integration before attempting to upload a file. To do this, press Expand, and select Add New in the Integrations section."),e.abrupt("return");case 10:return this.setState({status:"Encrypting..."}),e.abrupt("return",D.get().filesafe.encryptFile({data:t,inputFileName:n,fileType:r,credential:i}).then(function(){var e=j()(A.a.mark(function e(t){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.setState({status:"Uploading to ".concat(D.get().filesafe.displayStringForIntegration(a),"...")}),e.next=3,o.wait(.5);case 3:return e.abrupt("return",D.get().filesafe.uploadFile({fileItem:t,inputFileName:n,fileType:r,credential:i}).then(function(){o.setState({status:"Upload Success."}),setTimeout(function(){o.setState({status:null})},2e3)}).catch(function(e){console.error("fs-embed | error uploading file:",e),o.flashError("Error uploading file.")}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 12:case"end":return e.stop()}},e,this)})),function(e,t,r){return n.apply(this,arguments)})},{key:"flashError",value:function(e){var t=this;this.setState({status:e,statusClass:"danger"}),setTimeout(function(){t.setState({status:null,statusClass:null})},2500)}},{key:"render",value:function(){var e=this,t=this.state.statusClass?this.state.statusClass:"info",n="info"==t;return v.a.createElement("div",{className:"sn-component files-view"},v.a.createElement("div",{className:"sk-panel-row align-top"},v.a.createElement("div",{className:"files"},this.state.messages.length>0&&v.a.createElement("div",{id:"messages-container",className:"sk-panel-section"},v.a.createElement(B,{messages:this.state.messages})),this.state.status&&v.a.createElement("div",{id:"file-upload-status",className:"sk-horizontal-group"},n&&v.a.createElement("div",{className:"sk-spinner info small"}),v.a.createElement("div",{className:t},this.state.status)),v.a.createElement("div",{id:"add-file-button-container"},v.a.createElement("div",{className:"file sk-button info"},v.a.createElement("label",{className:"no-style"},v.a.createElement("input",{type:"file",style:{display:"none"},onChange:function(t){e.handleDroppedFiles(t.target.files)}}),v.a.createElement("div",{id:"attach-file-button-label",className:"sk-label"},"Attach File")))),v.a.createElement(H,{files:this.state.noteFiles}))))}},{key:"rootElement",get:function(){return document.getElementById("filesafe-embed")}},{key:"dropContainer",get:function(){return document.getElementById("files-view")}},{key:"fileInput",get:function(){return document.getElementById("file-input")}}]),t}(v.a.Component),W=function(e){function t(e){var r;return k()(this,t),r=n.call(this,e),O()(R()(r),"toggleVisibility",function(){r.setState({expanded:!r.state.expanded})}),r.state={expanded:!1,files:D.get().filesafe.getAllFileDescriptors()||[]},D.get().addDataChangeObserver(function(){r.setState({files:D.get().filesafe.getAllFileDescriptors()})}),r}E()(t,e);var n=f(t);return x()(t,[{key:"render",value:function(){return v.a.createElement("div",{className:"files-view"},v.a.createElement("div",{className:"sk-panel-row justify-left"},v.a.createElement("div",{className:"sk-horizontal-group"},v.a.createElement("div",{className:"sk-panel-section-title"},"All Files ",v.a.createElement("span",{style:{fontWeight:"normal"}},"(",this.state.files.length,")")),v.a.createElement("a",{className:"info",onClick:this.toggleVisibility},this.state.expanded?"Hide":"Show"))),this.state.expanded&&v.a.createElement("div",{className:"sk-panel-row"},v.a.createElement("div",{className:"files"},v.a.createElement(H,{files:this.state.files}))))}}]),t}(v.a.Component),K=function(e){function t(e){var r;return k()(this,t),r=n.call(this,e),O()(R()(r),"handleKeyPress",function(e){"Enter"===e.key&&r.submitIntegrationCode()}),O()(R()(r),"handleTextChange",function(e){var t=e.target.value;r.setState({integrationCode:t})}),O()(R()(r),"submitIntegrationCode",function(){var e=r.state.integrationCode;e&&0!=e.length&&D.get().filesafe.saveIntegrationFromCode(e).then(function(){r.setState({integrationCode:null,showInputForm:!1}),r.reloadIntegrations()}).catch(function(){alert("Invalid integration code. Ensure the correct value is copied and try again.")})}),O()(R()(r),"addNewIntegrationClicked",function(){window.open(D.get().defaultRelayServerUrl(),"_blank"),r.setState({showInputForm:!0})}),O()(R()(r),"cancelIntegrationForm",function(){r.setState({showInputForm:!1})}),O()(R()(r),"deleteIntegration",function(e){D.get().filesafe.deleteIntegration(e)}),O()(R()(r),"setIntegrationAsDefaultUploadSource",function(e){D.get().filesafe.setIntegrationAsDefault(e)}),r.state={integrations:D.get().filesafe.getAllIntegrations()||[]},D.get().addDataChangeObserver(function(){r.reloadIntegrations()}),r}E()(t,e);var n=p(t);return x()(t,[{key:"reloadIntegrations",value:function(){var e=D.get().filesafe.getAllIntegrations();this.setState({integrations:e})}},{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"displayStringForIntegration",value:function(e){return D.get().filesafe.displayStringForIntegration(e)}},{key:"render",value:function(){var e=this,t=this.state.integrations.length>1;return v.a.createElement("div",null,v.a.createElement("div",{className:"sk-panel-row"},v.a.createElement("div",{className:"sk-h2 sk-bold"},"Integrations"),!this.state.showInputForm&&v.a.createElement("div",{className:"sk-button info no-border",onClick:this.addNewIntegrationClicked},v.a.createElement("div",{className:"sk-label"},"Add New"))),v.a.createElement("div",{id:"integrations"},this.state.showInputForm&&v.a.createElement("div",{className:"sk-notification info"},v.a.createElement("strong",null,"New Integration"),v.a.createElement("p",{className:"sk-p"},"A new browser tab has opened—if not, try ",v.a.createElement("a",{href:D.get().defaultRelayServerUrl(),target:"_blank"},"this link"),". Complete the authentication flow and enter the code you receive below."),v.a.createElement("div",{className:"sk-panel-row"}),v.a.createElement("input",{className:"title sk-input contrast",type:"text",placeholder:"Enter integration code",value:this.state.integrationCode,onChange:this.handleTextChange,onKeyPress:this.handleKeyPress}),v.a.createElement("div",{className:"sk-button-group",style:{marginTop:10}},v.a.createElement("div",{className:"sk-button neutral",onClick:this.cancelIntegrationForm},v.a.createElement("a",{className:"sk-label"},"Cancel")),v.a.createElement("div",{className:"sk-button sk-base",onClick:this.submitIntegrationCode},v.a.createElement("a",{className:"sk-label"},"Submit"))))),v.a.createElement("div",{className:"list-container"},this.state.integrations.map(function(n){return v.a.createElement("div",{className:"list-item sk-horizontal-group top"},v.a.createElement("div",{className:"sk-circle x-small "+(n.content.isDefaultUploadSource?"info":"sk-secondary-contrast")}),v.a.createElement("div",null,v.a.createElement("div",{className:"sk-panel-row condensed sk-bold"},e.displayStringForIntegration(n)),v.a.createElement("div",{className:"sk-panel-row condensed"},v.a.createElement("div",{className:"sk-horizontal-group"},t&&!n.content.isDefaultUploadSource&&v.a.createElement("a",{className:"info",onClick:function(){e.setIntegrationAsDefaultUploadSource(n)}},"Make Default"),v.a.createElement("a",{className:"danger",onClick:function(){e.deleteIntegration(n)}},"Delete")))))})))}}]),t}(v.a.Component),V=function(e){function t(e){var r;return k()(this,t),(r=n.call(this,e)).state={messages:[]},r}E()(t,e);var n=d(t);return x()(t,[{key:"render",value:function(){return v.a.createElement("div",{id:"home",className:"sk-panel static"},v.a.createElement("div",{id:"main-content",className:"sk-panel-content"},v.a.createElement("div",{className:"sk-panel-section"},v.a.createElement(z,null)),v.a.createElement("div",{className:"sk-panel-section"},v.a.createElement(K,null)),v.a.createElement("div",{className:"sk-panel-section"},v.a.createElement(M,null)),v.a.createElement("div",{className:"sk-panel-section"},v.a.createElement(W,null))))}}]),t}(v.a.Component),$=function(e){function t(e){return k()(this,t),n.call(this,e)}E()(t,e);var n=h(t);return x()(t,null,[{key:"renderInElement",value:function(e,n,r){D.get().setFilesafeInstance(n),D.get().setDelegate(r),g.a.render(v.a.createElement(t),e)}},{key:"unload",value:function(e){D.get().unload(),g.a.unmountComponentAtNode(e)}}]),x()(t,[{key:"render",value:function(){return v.a.createElement("div",{id:"filesafe-embed"},v.a.createElement("div",{className:"sn-component"},v.a.createElement(V,null)))}}]),t}(v.a.Component);t.default={FilesafeEmbed:$,React:v.a,ReactDOM:g.a}}])},function(e,t,n){"use strict";function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(e,t,n){this.props=e,this.context=t,this.refs=N,this.updater=n||M}function a(){}function o(e,t,n){this.props=e,this.context=t,this.refs=N,this.updater=n||M}function u(e,t,n){var r,i={},a=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)j.call(t,r)&&!U.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var s=Array(u),l=0;l<u;l++)s[l]=arguments[l+2];i.children=s}if(e&&e.defaultProps)for(r in u=e.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:x,type:e,key:a,ref:o,props:i,_owner:L.current}}function s(e,t){return{$$typeof:x,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function l(e){return"object"==typeof e&&null!==e&&e.$$typeof===x}function c(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}function f(e,t,n,r){if(H.length){var i=H.pop();return i.result=e,i.keyPrefix=t,i.func=n,i.context=r,i.count=0,i}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function p(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>H.length&&H.push(e)}function d(e,t,n,i){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var o=!1;if(null===e)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case x:case S:o=!0}}if(o)return n(i,e,""===t?"."+m(e,0):t),1;if(o=0,t=""===t?".":t+":",Array.isArray(e))for(var u=0;u<e.length;u++){a=e[u];var s=t+m(a,u);o+=d(a,s,n,i)}else if(null===e||"object"!=typeof e?s=null:(s=D&&e[D]||e["@@iterator"],s="function"==typeof s?s:null),"function"==typeof s)for(e=s.call(e),u=0;!(a=e.next()).done;)a=a.value,s=t+m(a,u++),o+=d(a,s,n,i);else if("object"===a)throw n=""+e,Error(r(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return o}function h(e,t,n){return null==e?0:d(e,"",t,n)}function m(e,t){return"object"==typeof e&&null!==e&&null!=e.key?c(e.key):t.toString(36)}function v(e,t){e.func.call(e.context,t,e.count++)}function y(e,t,n){var r=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?g(e,r,n,function(e){return e}):null!=e&&(l(e)&&(e=s(e,i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(B,"$&/")+"/")+n)),r.push(e))}function g(e,t,n,r,i){var a="";null!=n&&(a=(""+n).replace(B,"$&/")+"/"),t=f(t,a,r,i),h(e,y,t),p(t)}function b(){var e=z.current;if(null===e)throw Error(r(321));return e}/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var k=n(4),w="function"==typeof Symbol&&Symbol.for,x=w?Symbol.for("react.element"):60103,S=w?Symbol.for("react.portal"):60106,E=w?Symbol.for("react.fragment"):60107,C=w?Symbol.for("react.strict_mode"):60108,_=w?Symbol.for("react.profiler"):60114,T=w?Symbol.for("react.provider"):60109,P=w?Symbol.for("react.context"):60110,I=w?Symbol.for("react.forward_ref"):60112,R=w?Symbol.for("react.suspense"):60113,F=w?Symbol.for("react.memo"):60115,O=w?Symbol.for("react.lazy"):60116,D="function"==typeof Symbol&&Symbol.iterator,M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N={};i.prototype.isReactComponent={},i.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(r(85));this.updater.enqueueSetState(this,e,t,"setState")},i.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},a.prototype=i.prototype;var A=o.prototype=new a;A.constructor=o,k(A,i.prototype),A.isPureReactComponent=!0;var L={current:null},j=Object.prototype.hasOwnProperty,U={key:!0,ref:!0,__self:!0,__source:!0},B=/\/+/g,H=[],z={current:null},W={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:L,IsSomeRendererActing:{current:!1},assign:k};t.Children={map:function(e,t,n){if(null==e)return e;var r=[];return g(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;t=f(null,null,t,n),h(e,v,t),p(t)},count:function(e){return h(e,function(){return null},null)},toArray:function(e){var t=[];return g(e,t,null,function(e){return e}),t},only:function(e){if(!l(e))throw Error(r(143));return e}},t.Component=i,t.Fragment=E,t.Profiler=_,t.PureComponent=o,t.StrictMode=C,t.Suspense=R,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(r(267,e));var i=k({},e.props),a=e.key,o=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,u=L.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)j.call(t,l)&&!U.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==s?s[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){s=Array(l);for(var c=0;c<l;c++)s[c]=arguments[c+2];i.children=s}return{$$typeof:x,type:e.type,key:a,ref:o,props:i,_owner:u}},t.createContext=function(e,t){return void 0===t&&(t=null),e={$$typeof:P,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider={$$typeof:T,_context:e},e.Consumer=e},t.createElement=u,t.createFactory=function(e){var t=u.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:I,render:e}},t.isValidElement=l,t.lazy=function(e){return{$$typeof:O,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:F,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return b().useCallback(e,t)},t.useContext=function(e,t){return b().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return b().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return b().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return b().useLayoutEffect(e,t)},t.useMemo=function(e,t){return b().useMemo(e,t)},t.useReducer=function(e,t,n){return b().useReducer(e,t,n)},t.useRef=function(e){return b().useRef(e)},t.useState=function(e){return b().useState(e)},t.version="16.13.1"},function(e,t,n){"use strict";function r(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}r(),e.exports=n(26)},function(e,t,n){"use strict";function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(e,t,n,r,i,a,o,u,s){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(e){this.onError(e)}}function a(e,t,n,r,a,o,u,s,l){Hi=!1,zi=null,i.apply(Vi,arguments)}function o(e,t,n,i,o,u,s,l,c){if(a.apply(this,arguments),Hi){if(!Hi)throw Error(r(198));var f=zi;Hi=!1,zi=null,Wi||(Wi=!0,Ki=f)}}function u(e,t,n){var r=e.type||"unknown-event";e.currentTarget=Qi(n),o(r,t,void 0,e),e.currentTarget=null}function s(){if(Ji)for(var e in Yi){var t=Yi[e],n=Ji.indexOf(e);if(!(-1<n))throw Error(r(96,e));if(!Gi[n]){if(!t.extractEvents)throw Error(r(97,e));Gi[n]=t,n=t.eventTypes;for(var i in n){var a=void 0,o=n[i],u=t,s=i;if(Xi.hasOwnProperty(s))throw Error(r(99,s));Xi[s]=o;var c=o.phasedRegistrationNames;if(c){for(a in c)c.hasOwnProperty(a)&&l(c[a],u,s);a=!0}else o.registrationName?(l(o.registrationName,u,s),a=!0):a=!1;if(!a)throw Error(r(98,i,e))}}}}function l(e,t,n){if(Zi[e])throw Error(r(100,e));Zi[e]=t,ea[e]=t.eventTypes[n].dependencies}function c(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var i=e[t];if(!Yi.hasOwnProperty(t)||Yi[t]!==i){if(Yi[t])throw Error(r(102,t));Yi[t]=i,n=!0}}n&&s()}function f(e){if(e=qi(e)){if("function"!=typeof na)throw Error(r(280));var t=e.stateNode;t&&(t=$i(t),na(e.stateNode,e.type,t))}}function p(e){ra?ia?ia.push(e):ia=[e]:ra=e}function d(){if(ra){var e=ra,t=ia;if(ia=ra=null,f(e),t)for(e=0;e<t.length;e++)f(t[e])}}function h(e,t){return e(t)}function m(e,t,n,r,i){return e(t,n,r,i)}function v(){}function y(){null===ra&&null===ia||(v(),d())}function g(e,t,n){if(ua)return e(t,n);ua=!0;try{return aa(e,t,n)}finally{ua=!1,y()}}function b(e){return!!la.call(fa,e)||!la.call(ca,e)&&(sa.test(e)?fa[e]=!0:(ca[e]=!0,!1))}function k(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}function w(e,t,n,r){if(null===t||void 0===t||k(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function x(e,t,n,r,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a}function S(e){return e[1].toUpperCase()}function E(e,t,n,r){var i=pa.hasOwnProperty(t)?pa[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(w(t,n,i,r)&&(n=null),r||null===i?b(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(i=i.type,n=3===i||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}function C(e){return null===e||"object"!=typeof e?null:(e=Oa&&e[Oa]||e["@@iterator"],"function"==typeof e?e:null)}function _(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then(function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)},function(t){0===e._status&&(e._status=2,e._result=t)})}}function T(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case ka:return"Fragment";case ba:return"Portal";case xa:return"Profiler";case wa:return"StrictMode";case Ta:return"Suspense";case Pa:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case Ea:return"Context.Consumer";case Sa:return"Context.Provider";case _a:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case Ia:return T(e.type);case Fa:return T(e.render);case Ra:if(e=1===e._status?e._result:null)return T(e)}return null}function P(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break e;default:var r=e._debugOwner,i=e._debugSource,a=T(e.type);n=null,r&&(n=T(r.type)),r=a,a="",i?a=" (at "+i.fileName.replace(va,"")+":"+i.lineNumber+")":n&&(a=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+a}t+=n,e=e.return}while(e);return t}function I(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function R(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function F(e){var t=R(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function O(e){e._valueTracker||(e._valueTracker=F(e))}function D(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=R(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function M(e,t){var n=t.checked;return Ui({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function N(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=I(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function A(e,t){null!=(t=t.checked)&&E(e,"checked",t,!1)}function L(e,t){A(e,t);var n=I(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?U(e,t.type,n):t.hasOwnProperty("defaultValue")&&U(e,t.type,I(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function j(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,""!==n&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function U(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function B(e){var t="";return ji.Children.forEach(e,function(e){null!=e&&(t+=e)}),t}function H(e,t){return e=Ui({children:void 0},t),(t=B(t.children))&&(e.children=t),e}function z(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+I(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function W(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return Ui({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function K(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:I(n)}}function V(e,t){var n=I(t.value),r=I(t.defaultValue);null!=n&&(n=""+n,n!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function $(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function q(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Q(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?q(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}function J(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}function Y(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}function G(e){if(Aa[e])return Aa[e];if(!Na[e])return e;var t,n=Na[e];for(t in n)if(n.hasOwnProperty(t)&&t in La)return Aa[e]=n[t];return e}function X(e){var t=$a.get(e);return void 0===t&&(t=new Map,$a.set(e,t)),t}function Z(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{t=e,0!=(1026&t.effectTag)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ee(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function te(e){if(Z(e)!==e)throw Error(r(188))}function ne(e){var t=e.alternate;if(!t){if(null===(t=Z(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,i=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(i=a.return)){n=i;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return te(a),e;if(o===i)return te(a),t;o=o.sibling}throw Error(r(188))}if(n.return!==i.return)n=a,i=o;else{for(var u=!1,s=a.child;s;){if(s===n){u=!0,n=a,i=o;break}if(s===i){u=!0,i=a,n=o;break}s=s.sibling}if(!u){for(s=o.child;s;){if(s===n){u=!0,n=o,i=a;break}if(s===i){u=!0,i=o,n=a;break}s=s.sibling}if(!u)throw Error(r(189))}}if(n.alternate!==i)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}function re(e){if(!(e=ne(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function ie(e,t){if(null==t)throw Error(r(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function ae(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}function oe(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)u(e,t[r],n[r]);else t&&u(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function ue(e){if(null!==e&&(qa=ie(qa,e)),e=qa,qa=null,e){if(ae(e,oe),qa)throw Error(r(95));if(Wi)throw e=Ki,Wi=!1,Ki=null,e}}function se(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function le(e){if(!ta)return!1;e="on"+e;var t=e in document;return t||(t=document.createElement("div"),t.setAttribute(e,"return;"),t="function"==typeof t[e]),t}function ce(e){e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>Qa.length&&Qa.push(e)}function fe(e,t,n,r){if(Qa.length){var i=Qa.pop();return i.topLevelType=e,i.eventSystemFlags=r,i.nativeEvent=t,i.targetInst=n,i}return{topLevelType:e,eventSystemFlags:r,nativeEvent:t,targetInst:n,ancestors:[]}}function pe(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;t=n.tag,5!==t&&6!==t||e.ancestors.push(n),n=Qe(r)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var i=se(e.nativeEvent);r=e.topLevelType;var a=e.nativeEvent,o=e.eventSystemFlags;0===n&&(o|=64);for(var u=null,s=0;s<Gi.length;s++){var l=Gi[s];l&&(l=l.extractEvents(r,t,a,i,o))&&(u=ie(u,l))}ue(u)}}function de(e,t,n){if(!n.has(e)){switch(e){case"scroll":Te(t,"scroll",!0);break;case"focus":case"blur":Te(t,"focus",!0),Te(t,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":le(e)&&Te(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===Va.indexOf(e)&&_e(e,t)}n.set(e,null)}}function he(e,t){var n=X(t);ro.forEach(function(e){de(e,t,n)}),io.forEach(function(e){de(e,t,n)})}function me(e,t,n,r,i){return{blockedOn:e,topLevelType:t,eventSystemFlags:32|n,nativeEvent:i,container:r}}function ve(e,t){switch(e){case"focus":case"blur":Ga=null;break;case"dragenter":case"dragleave":Xa=null;break;case"mouseover":case"mouseout":Za=null;break;case"pointerover":case"pointerout":eo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":to.delete(t.pointerId)}}function ye(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e=me(t,n,r,i,a),null!==t&&null!==(t=Je(t))&&Ua(t),e):(e.eventSystemFlags|=r,e)}function ge(e,t,n,r,i){switch(t){case"focus":return Ga=ye(Ga,e,t,n,r,i),!0;case"dragenter":return Xa=ye(Xa,e,t,n,r,i),!0;case"mouseover":return Za=ye(Za,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return eo.set(a,ye(eo.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,to.set(a,ye(to.get(a)||null,e,t,n,r,i)),!0}return!1}function be(e){var t=Qe(e.target);if(null!==t){var n=Z(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ee(n)))return e.blockedOn=t,void Bi.unstable_runWithPriority(e.priority,function(){Ba(n)})}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function ke(e){if(null!==e.blockedOn)return!1;var t=Fe(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);if(null!==t){var n=Je(t);return null!==n&&Ua(n),e.blockedOn=t,!1}return!0}function we(e,t,n){ke(e)&&n.delete(t)}function xe(){for(Ja=!1;0<Ya.length;){var e=Ya[0];if(null!==e.blockedOn){e=Je(e.blockedOn),null!==e&&ja(e);break}var t=Fe(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);null!==t?e.blockedOn=t:Ya.shift()}null!==Ga&&ke(Ga)&&(Ga=null),null!==Xa&&ke(Xa)&&(Xa=null),null!==Za&&ke(Za)&&(Za=null),eo.forEach(we),to.forEach(we)}function Se(e,t){e.blockedOn===t&&(e.blockedOn=null,Ja||(Ja=!0,Bi.unstable_scheduleCallback(Bi.unstable_NormalPriority,xe)))}function Ee(e){function t(t){return Se(t,e)}if(0<Ya.length){Se(Ya[0],e);for(var n=1;n<Ya.length;n++){var r=Ya[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ga&&Se(Ga,e),null!==Xa&&Se(Xa,e),null!==Za&&Se(Za,e),eo.forEach(t),to.forEach(t),n=0;n<no.length;n++)r=no[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<no.length&&(n=no[0],null===n.blockedOn);)be(n),null===n.blockedOn&&no.shift()}function Ce(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1],a="on"+(i[0].toUpperCase()+i.slice(1));a={phasedRegistrationNames:{bubbled:a,captured:a+"Capture"},dependencies:[r],eventPriority:t},uo.set(r,t),oo.set(r,a),ao[i]=a}}function _e(e,t){Te(t,e,!1)}function Te(e,t,n){var r=uo.get(t);switch(void 0===r?2:r){case 0:r=Pe.bind(null,t,1,e);break;case 1:r=Ie.bind(null,t,1,e);break;default:r=Re.bind(null,t,1,e)}n?e.addEventListener(t,r,!0):e.addEventListener(t,r,!1)}function Pe(e,t,n,r){oa||v();var i=Re,a=oa;oa=!0;try{m(i,e,t,n,r)}finally{(oa=a)||y()}}function Ie(e,t,n,r){po(fo,Re.bind(null,e,t,n,r))}function Re(e,t,n,r){if(ho)if(0<Ya.length&&-1<ro.indexOf(e))e=me(null,e,t,n,r),Ya.push(e);else{var i=Fe(e,t,n,r);if(null===i)ve(e,r);else if(-1<ro.indexOf(e))e=me(i,e,t,n,r),Ya.push(e);else if(!ge(i,e,t,n,r)){ve(e,r),e=fe(e,r,null,t);try{g(pe,e)}finally{ce(e)}}}}function Fe(e,t,n,r){if(n=se(r),null!==(n=Qe(n))){var i=Z(n);if(null===i)n=null;else{var a=i.tag;if(13===a){if(null!==(n=ee(i)))return n;n=null}else if(3===a){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}e=fe(e,r,n,t);try{g(pe,e)}finally{ce(e)}return null}function Oe(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||mo.hasOwnProperty(e)&&mo[e]?(""+t).trim():t+"px"}function De(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=Oe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}function Me(e,t){if(t){if(yo[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if(!("object"==typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(r(62,""))}}function Ne(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Ae(e,t){e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument;var n=X(e);t=ea[t];for(var r=0;r<t.length;r++)de(t[r],e,n)}function Le(){}function je(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Ue(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Be(e,t){var n=Ue(e);e=0;for(var r;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ue(n)}}function He(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?He(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ze(){for(var e=window,t=je();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;e=t.contentWindow,t=je(e.document)}return t}function We(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function Ke(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Ve(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}function $e(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function qe(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if(n===bo||n===xo||n===wo){if(0===t)return e;t--}else n===ko&&t++}e=e.previousSibling}return null}function Qe(e){var t=e[Po];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ro]||n[Po]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=qe(e);null!==e;){if(n=e[Po])return n;e=qe(e)}return t}e=n,n=e.parentNode}return null}function Je(e){return e=e[Po]||e[Ro],!e||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ye(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function Ge(e){return e[Io]||null}function Xe(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function Ze(e,t){var n=e.stateNode;if(!n)return null;var i=$i(n);if(!i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!("button"===e||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(r(231,t,typeof n));return n}function et(e,t,n){(t=Ze(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=ie(n._dispatchListeners,t),n._dispatchInstances=ie(n._dispatchInstances,e))}function tt(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=Xe(t);for(t=n.length;0<t--;)et(n[t],"captured",e);for(t=0;t<n.length;t++)et(n[t],"bubbled",e)}}function nt(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=Ze(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=ie(n._dispatchListeners,t),n._dispatchInstances=ie(n._dispatchInstances,e))}function rt(e){e&&e.dispatchConfig.registrationName&&nt(e._targetInst,null,e)}function it(e){ae(e,tt)}function at(){if(Do)return Do;var e,t,n=Oo,r=n.length,i="value"in Fo?Fo.value:Fo.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Do=i.slice(e,1<t?1-t:void 0)}function ot(){return!0}function ut(){return!1}function st(e,t,n,r){this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface;for(var i in e)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?ot:ut,this.isPropagationStopped=ut,this}function lt(e,t,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,n,r),i}return new this(e,t,n,r)}function ct(e){if(!(e instanceof this))throw Error(r(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function ft(e){e.eventPool=[],e.getPooled=lt,e.release=ct}function pt(e,t){switch(e){case"keyup":return-1!==Ao.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function dt(e){return e=e.detail,"object"==typeof e&&"data"in e?e.data:null}function ht(e,t){switch(e){case"compositionend":return dt(t);case"keypress":return 32!==t.which?null:(Wo=!0,Ho);case"textInput":return e=t.data,e===Ho&&Wo?null:e;default:return null}}function mt(e,t){if(Ko)return"compositionend"===e||!Lo&&pt(e,t)?(e=at(),Do=Oo=Fo=null,Ko=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bo&&"ko"!==t.locale?null:t.data;default:return null}}function vt(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$o[e.type]:"textarea"===t}function yt(e,t,n){return e=st.getPooled(qo.change,e,t,n),e.type="change",p(n),it(e),e}function gt(e){ue(e)}function bt(e){if(D(Ye(e)))return e}function kt(e,t){if("change"===e)return t}function wt(){Qo&&(Qo.detachEvent("onpropertychange",xt),Jo=Qo=null)}function xt(e){if("value"===e.propertyName&&bt(Jo))if(e=yt(Jo,e,se(e)),oa)ue(e);else{oa=!0;try{h(gt,e)}finally{oa=!1,y()}}}function St(e,t,n){"focus"===e?(wt(),Qo=t,Jo=n,Qo.attachEvent("onpropertychange",xt)):"blur"===e&&wt()}function Et(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return bt(Jo)}function Ct(e,t){if("click"===e)return bt(t)}function _t(e,t){if("input"===e||"change"===e)return bt(t)}function Tt(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Zo[e])&&!!t[e]}function Pt(){return Tt}function It(e,t){return e===t&&(0!==e||1/e==1/t)||e!==e&&t!==t}function Rt(e,t){if(su(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!lu.call(t,n[r])||!su(e[n[r]],t[n[r]]))return!1;return!0}function Ft(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return mu||null==pu||pu!==je(n)?null:(n=pu,"selectionStart"in n&&We(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),hu&&Rt(hu,n)?null:(hu=n,e=st.getPooled(fu.select,du,e,t),e.type="select",e.target=pu,it(e),e))}function Ot(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Dt(e){0>Mu||(e.current=Du[Mu],Du[Mu]=null,Mu--)}function Mt(e,t){Mu++,Du[Mu]=e.current,e.current=t}function Nt(e,t){var n=e.type.contextTypes;if(!n)return Nu;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function At(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Lt(){Dt(Lu),Dt(Au)}function jt(e,t,n){if(Au.current!==Nu)throw Error(r(168));Mt(Au,t),Mt(Lu,n)}function Ut(e,t,n){var i=e.stateNode;if(e=t.childContextTypes,"function"!=typeof i.getChildContext)return n;i=i.getChildContext();for(var a in i)if(!(a in e))throw Error(r(108,T(t)||"Unknown",a));return Ui({},n,{},i)}function Bt(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Nu,ju=Au.current,Mt(Au,e),Mt(Lu,Lu.current),!0}function Ht(e,t,n){var i=e.stateNode;if(!i)throw Error(r(169));n?(e=Ut(e,t,ju),i.__reactInternalMemoizedMergedChildContext=e,Dt(Lu),Dt(Au),Mt(Au,e)):Dt(Lu),Mt(Lu,n)}function zt(){switch(Ku()){case Vu:return 99;case $u:return 98;case qu:return 97;case Qu:return 96;case Ju:return 95;default:throw Error(r(332))}}function Wt(e){switch(e){case 99:return Vu;case 98:return $u;case 97:return qu;case 96:return Qu;case 95:return Ju;default:throw Error(r(332))}}function Kt(e,t){return e=Wt(e),Uu(e,t)}function Vt(e,t,n){return e=Wt(e),Bu(e,t,n)}function $t(e){return null===Zu?(Zu=[e],es=Bu(Vu,Qt)):Zu.push(e),Yu}function qt(){if(null!==es){var e=es;es=null,Hu(e)}Qt()}function Qt(){if(!ts&&null!==Zu){ts=!0;var e=0;try{var t=Zu;Kt(99,function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}}),Zu=null}catch(t){throw null!==Zu&&(Zu=Zu.slice(e+1)),Bu(Vu,qt),t}finally{ts=!1}}}function Jt(e,t,n){return n/=10,1073741821-(1+((1073741821-e+t/10)/n|0))*n}function Yt(e,t){if(e&&e.defaultProps){t=Ui({},t),e=e.defaultProps;for(var n in e)void 0===t[n]&&(t[n]=e[n])}return t}function Gt(){us=os=as=null}function Xt(e){var t=is.current;Dt(is),e.type._context._currentValue=t}function Zt(e,t){for(;null!==e;){var n=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t);else{if(!(null!==n&&n.childExpirationTime<t))break;n.childExpirationTime=t}e=e.return}}function en(e,t){as=e,us=os=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(Ns=!0),e.firstContext=null)}function tn(e,t){if(us!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(us=e,t=1073741823),t={context:e,observedBits:t,next:null},null===os){if(null===as)throw Error(r(308));os=t,as.dependencies={expirationTime:0,firstContext:t,responders:null}}else os=os.next=t;return e._currentValue}function nn(e){e.updateQueue={baseState:e.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function rn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,baseQueue:e.baseQueue,shared:e.shared,effects:e.effects})}function an(e,t){return e={expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null},e.next=e}function on(e,t){if(null!==(e=e.updateQueue)){e=e.shared;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function un(e,t){var n=e.alternate;null!==n&&rn(n,e),e=e.updateQueue,n=e.baseQueue,null===n?(e.baseQueue=t.next=t,t.next=t):(t.next=n.next,n.next=t)}function sn(e,t,n,r){var i=e.updateQueue;ss=!1;var a=i.baseQueue,o=i.shared.pending;if(null!==o){if(null!==a){var u=a.next;a.next=o.next,o.next=u}a=o,i.shared.pending=null,u=e.alternate,null!==u&&null!==(u=u.updateQueue)&&(u.baseQueue=o)}if(null!==a){u=a.next;var s=i.baseState,l=0,c=null,f=null,p=null;if(null!==u)for(var d=u;;){if((o=d.expirationTime)<r){var h={expirationTime:d.expirationTime,suspenseConfig:d.suspenseConfig,tag:d.tag,payload:d.payload,callback:d.callback,next:null};null===p?(f=p=h,c=s):p=p.next=h,o>l&&(l=o)}else{null!==p&&(p=p.next={expirationTime:1073741823,suspenseConfig:d.suspenseConfig,tag:d.tag,payload:d.payload,callback:d.callback,next:null}),Gr(o,d.suspenseConfig);e:{var m=e,v=d;switch(o=t,h=n,v.tag){case 1:if("function"==typeof(m=v.payload)){s=m.call(h,s,o);break e}s=m;break e;case 3:m.effectTag=-4097&m.effectTag|64;case 0:if(m=v.payload,null===(o="function"==typeof m?m.call(h,s,o):m)||void 0===o)break e;s=Ui({},s,o);break e;case 2:ss=!0}}null!==d.callback&&(e.effectTag|=32,o=i.effects,null===o?i.effects=[d]:o.push(d))}if(null===(d=d.next)||d===u){if(null===(o=i.shared.pending))break;d=a.next=o.next,o.next=u,i.baseQueue=a=o,i.shared.pending=null}}null===p?c=s:p.next=f,i.baseState=c,i.baseQueue=p,Xr(l),e.expirationTime=l,e.memoizedState=s}}function ln(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],a=i.callback;if(null!==a){if(i.callback=null,i=a,a=n,"function"!=typeof i)throw Error(r(191,i));i.call(a)}}}function cn(e,t,n,r){t=e.memoizedState,n=n(r,t),n=null===n||void 0===n?t:Ui({},t,n),e.memoizedState=n,0===e.expirationTime&&(e.updateQueue.baseState=n)}function fn(e,t,n,r,i,a,o){return e=e.stateNode,"function"==typeof e.shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!Rt(n,r)||!Rt(i,a))}function pn(e,t,n){var r=!1,i=Nu,a=t.contextType;return"object"==typeof a&&null!==a?a=tn(a):(i=At(t)?ju:Au.current,r=t.contextTypes,a=(r=null!==r&&void 0!==r)?Nt(e,i):Nu),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=fs,e.stateNode=t,t._reactInternalFiber=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function dn(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fs.enqueueReplaceState(t,t.state,null)}function hn(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=cs,nn(e);var a=t.contextType;"object"==typeof a&&null!==a?i.context=tn(a):(a=At(t)?ju:Au.current,i.context=Nt(e,a)),sn(e,n,i,r),i.state=e.memoizedState,a=t.getDerivedStateFromProps,"function"==typeof a&&(cn(e,t,a,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&fs.enqueueReplaceState(i,i.state,null),sn(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.effectTag|=4)}function mn(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var i=n.stateNode}if(!i)throw Error(r(147,e));var a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;t===cs&&(t=i.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!=typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function vn(e,t){if("textarea"!==e.type)throw Error(r(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function yn(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return e=gi(e,t),e.index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index,r<n?(t.effectTag=2,n):r):(t.effectTag=2,n):n}function u(t){return e&&null===t.alternate&&(t.effectTag=2),t}function s(e,t,n,r){return null===t||6!==t.tag?(t=wi(n,e.mode,r),t.return=e,t):(t=a(t,n),t.return=e,t)}function l(e,t,n,r){return null!==t&&t.elementType===n.type?(r=a(t,n.props),r.ref=mn(e,t,n),r.return=e,r):(r=bi(n.type,n.key,n.props,null,e.mode,r),r.ref=mn(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?(t=xi(n,e.mode,r),t.return=e,t):(t=a(t,n.children||[]),t.return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?(t=ki(n,e.mode,r,i),t.return=e,t):(t=a(t,n),t.return=e,t)}function p(e,t,n){if("string"==typeof t||"number"==typeof t)return t=wi(""+t,e.mode,n),t.return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case ga:return n=bi(t.type,t.key,t.props,null,e.mode,n),n.ref=mn(e,null,t),n.return=e,n;case ba:return t=xi(t,e.mode,n),t.return=e,t}if(ps(t)||C(t))return t=ki(t,e.mode,n,null),t.return=e,t;vn(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:s(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case ga:return n.key===i?n.type===ka?f(e,t,n.props.children,r,i):l(e,t,n,r):null;case ba:return n.key===i?c(e,t,n,r):null}if(ps(n)||C(n))return null!==i?null:f(e,t,n,r,null);vn(e,n)}return null}function h(e,t,n,r,i){if("string"==typeof r||"number"==typeof r)return e=e.get(n)||null,s(t,e,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case ga:return e=e.get(null===r.key?n:r.key)||null,r.type===ka?f(t,e,r.props.children,i,r.key):l(t,e,r,i);case ba:return e=e.get(null===r.key?n:r.key)||null,c(t,e,r,i)}if(ps(r)||C(r))return e=e.get(n)||null,f(t,e,r,i,null);vn(t,r)}return null}function m(r,a,u,s){for(var l=null,c=null,f=a,m=a=0,v=null;null!==f&&m<u.length;m++){f.index>m?(v=f,f=null):v=f.sibling;var y=d(r,f,u[m],s);if(null===y){null===f&&(f=v);break}e&&f&&null===y.alternate&&t(r,f),a=o(y,a,m),null===c?l=y:c.sibling=y,c=y,f=v}if(m===u.length)return n(r,f),l;if(null===f){for(;m<u.length;m++)null!==(f=p(r,u[m],s))&&(a=o(f,a,m),null===c?l=f:c.sibling=f,c=f);return l}for(f=i(r,f);m<u.length;m++)null!==(v=h(f,r,m,u[m],s))&&(e&&null!==v.alternate&&f.delete(null===v.key?m:v.key),a=o(v,a,m),null===c?l=v:c.sibling=v,c=v);return e&&f.forEach(function(e){return t(r,e)}),l}function v(a,u,s,l){var c=C(s);if("function"!=typeof c)throw Error(r(150));if(null==(s=c.call(s)))throw Error(r(151));for(var f=c=null,m=u,v=u=0,y=null,g=s.next();null!==m&&!g.done;v++,g=s.next()){m.index>v?(y=m,m=null):y=m.sibling;var b=d(a,m,g.value,l);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(a,m),u=o(b,u,v),null===f?c=b:f.sibling=b,f=b,m=y}if(g.done)return n(a,m),c;if(null===m){for(;!g.done;v++,g=s.next())null!==(g=p(a,g.value,l))&&(u=o(g,u,v),null===f?c=g:f.sibling=g,f=g);return c}for(m=i(a,m);!g.done;v++,g=s.next())null!==(g=h(m,a,v,g.value,l))&&(e&&null!==g.alternate&&m.delete(null===g.key?v:g.key),u=o(g,u,v),null===f?c=g:f.sibling=g,f=g);return e&&m.forEach(function(e){return t(a,e)}),c}return function(e,i,o,s){var l="object"==typeof o&&null!==o&&o.type===ka&&null===o.key;l&&(o=o.props.children);var c="object"==typeof o&&null!==o;if(c)switch(o.$$typeof){case ga:e:{for(c=o.key,l=i;null!==l;){if(l.key===c){switch(l.tag){case 7:if(o.type===ka){n(e,l.sibling),i=a(l,o.props.children),i.return=e,e=i;break e}break;default:if(l.elementType===o.type){n(e,l.sibling),i=a(l,o.props),i.ref=mn(e,l,o),i.return=e,e=i;break e}}n(e,l);break}t(e,l),l=l.sibling}o.type===ka?(i=ki(o.props.children,e.mode,s,o.key),i.return=e,e=i):(s=bi(o.type,o.key,o.props,null,e.mode,s),s.ref=mn(e,i,o),s.return=e,e=s)}return u(e);case ba:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(e,i.sibling),i=a(i,o.children||[]),i.return=e,e=i;break e}n(e,i);break}t(e,i),i=i.sibling}i=xi(o,e.mode,s),i.return=e,e=i}return u(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==i&&6===i.tag?(n(e,i.sibling),i=a(i,o),i.return=e,e=i):(n(e,i),i=wi(o,e.mode,s),i.return=e,e=i),u(e);if(ps(o))return m(e,i,o,s);if(C(o))return v(e,i,o,s);if(c&&vn(e,o),void 0===o&&!l)switch(e.tag){case 1:case 0:throw e=e.type,Error(r(152,e.displayName||e.name||"Component"))}return n(e,i)}}function gn(e){if(e===ms)throw Error(r(174));return e}function bn(e,t){switch(Mt(gs,t),Mt(ys,e),Mt(vs,ms),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Q(null,"");break;default:e=8===e?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Q(t,e)}Dt(vs),Mt(vs,t)}function kn(){Dt(vs),Dt(ys),Dt(gs)}function wn(e){gn(gs.current);var t=gn(vs.current),n=Q(t,e.type);t!==n&&(Mt(ys,e),Mt(vs,n))}function xn(e){ys.current===e&&(Dt(vs),Dt(ys))}function Sn(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||n.data===wo||n.data===xo))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.effectTag))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function En(e,t){return{responder:e,props:t}}function Cn(){throw Error(r(321))}function _n(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!su(e[n],t[n]))return!1;return!0}function Tn(e,t,n,i,a,o){if(xs=o,Ss=t,t.memoizedState=null,t.updateQueue=null,t.expirationTime=0,ks.current=null===e||null===e.memoizedState?Ps:Is,e=n(i,a),t.expirationTime===xs){o=0;do{if(t.expirationTime=0,!(25>o))throw Error(r(301));o+=1,Cs=Es=null,t.updateQueue=null,ks.current=Rs,e=n(i,a)}while(t.expirationTime===xs)}if(ks.current=Ts,t=null!==Es&&null!==Es.next,xs=0,Cs=Es=Ss=null,_s=!1,t)throw Error(r(300));return e}function Pn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Cs?Ss.memoizedState=Cs=e:Cs=Cs.next=e,Cs}function In(){if(null===Es){var e=Ss.alternate;e=null!==e?e.memoizedState:null}else e=Es.next;var t=null===Cs?Ss.memoizedState:Cs.next;if(null!==t)Cs=t,Es=e;else{if(null===e)throw Error(r(310));Es=e,e={memoizedState:Es.memoizedState,baseState:Es.baseState,baseQueue:Es.baseQueue,queue:Es.queue,next:null},null===Cs?Ss.memoizedState=Cs=e:Cs=Cs.next=e}return Cs}function Rn(e,t){return"function"==typeof t?t(e):t}function Fn(e){var t=In(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=Es,a=i.baseQueue,o=n.pending;if(null!==o){if(null!==a){var u=a.next;a.next=o.next,o.next=u}i.baseQueue=a=o,n.pending=null}if(null!==a){a=a.next,i=i.baseState;var s=u=o=null,l=a;do{var c=l.expirationTime;if(c<xs){var f={expirationTime:l.expirationTime,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===s?(u=s=f,o=i):s=s.next=f,c>Ss.expirationTime&&(Ss.expirationTime=c,Xr(c))}else null!==s&&(s=s.next={expirationTime:1073741823,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),Gr(c,l.suspenseConfig),i=l.eagerReducer===e?l.eagerState:e(i,l.action);l=l.next}while(null!==l&&l!==a);null===s?o=i:s.next=u,su(i,t.memoizedState)||(Ns=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=s,n.lastRenderedState=i}return[t.memoizedState,n.dispatch]}function On(e){var t=In(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var u=a=a.next;do{o=e(o,u.action),u=u.next}while(u!==a);su(o,t.memoizedState)||(Ns=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function Dn(e){var t=Pn();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=t.queue={pending:null,dispatch:null,lastRenderedReducer:Rn,lastRenderedState:e},e=e.dispatch=Qn.bind(null,Ss,e),[t.memoizedState,e]}function Mn(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ss.updateQueue,null===t?(t={lastEffect:null},Ss.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,null===n?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Nn(){return In().memoizedState}function An(e,t,n,r){var i=Pn();Ss.effectTag|=e,i.memoizedState=Mn(1|t,n,void 0,void 0===r?null:r)}function Ln(e,t,n,r){var i=In();r=void 0===r?null:r;var a=void 0;if(null!==Es){var o=Es.memoizedState;if(a=o.destroy,null!==r&&_n(r,o.deps))return void Mn(t,n,a,r)}Ss.effectTag|=e,i.memoizedState=Mn(1|t,n,a,r)}function jn(e,t){return An(516,4,e,t)}function Un(e,t){return Ln(516,4,e,t)}function Bn(e,t){return Ln(4,2,e,t)}function Hn(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zn(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ln(4,2,Hn.bind(null,t,e),n)}function Wn(){}function Kn(e,t){return Pn().memoizedState=[e,void 0===t?null:t],e}function Vn(e,t){var n=In();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&_n(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $n(e,t){var n=In();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&_n(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qn(e,t,n){var r=zt();Kt(98>r?98:r,function(){e(!0)}),Kt(97<r?97:r,function(){var r=ws.suspense;ws.suspense=void 0===t?null:t;try{e(!1),n()}finally{ws.suspense=r}})}function Qn(e,t,n){var r=Lr(),i=ls.suspense;r=jr(r,e,i),i={expirationTime:r,suspenseConfig:i,action:n,eagerReducer:null,eagerState:null,next:null};var a=t.pending;if(null===a?i.next=i:(i.next=a.next,a.next=i),t.pending=i,a=e.alternate,e===Ss||null!==a&&a===Ss)_s=!0,i.expirationTime=xs,Ss.expirationTime=xs;else{if(0===e.expirationTime&&(null===a||0===a.expirationTime)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,u=a(o,n);if(i.eagerReducer=a,i.eagerState=u,su(u,o))return}catch(e){}Ur(e,r)}}function Jn(e,t){var n=mi(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Yn(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Gn(e){if(Ds){var t=Os;if(t){var n=t;if(!Yn(e,t)){if(!(t=$e(n.nextSibling))||!Yn(e,t))return e.effectTag=-1025&e.effectTag|2,Ds=!1,void(Fs=e);Jn(Fs,n)}Fs=e,Os=$e(t.firstChild)}else e.effectTag=-1025&e.effectTag|2,Ds=!1,Fs=e}}function Xn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Fs=e}function Zn(e){if(e!==Fs)return!1;if(!Ds)return Xn(e),Ds=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Ve(t,e.memoizedProps))for(t=Os;t;)Jn(e,t),t=$e(t.nextSibling);if(Xn(e),13===e.tag){if(e=e.memoizedState,!(e=null!==e?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if(n===ko){if(0===t){Os=$e(e.nextSibling);break e}t--}else n!==bo&&n!==xo&&n!==wo||t++}e=e.nextSibling}Os=null}}else Os=Fs?$e(e.stateNode.nextSibling):null;return!0}function er(){Os=Fs=null,Ds=!1}function tr(e,t,n,r){t.child=null===e?hs(t,null,n,r):ds(t,e.child,n,r)}function nr(e,t,n,r,i){n=n.render;var a=t.ref;return en(t,i),r=Tn(e,t,n,r,a,i),null===e||Ns?(t.effectTag|=1,tr(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),hr(e,t,i))}function rr(e,t,n,r,i,a){if(null===e){var o=n.type;return"function"!=typeof o||vi(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?(e=bi(n.type,null,r,null,t.mode,a),e.ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,ir(e,t,o,r,i,a))}return o=e.child,i<a&&(i=o.memoizedProps,n=n.compare,(n=null!==n?n:Rt)(i,r)&&e.ref===t.ref)?hr(e,t,a):(t.effectTag|=1,e=gi(o,r),e.ref=t.ref,e.return=t,t.child=e)}function ir(e,t,n,r,i,a){return null!==e&&Rt(e.memoizedProps,r)&&e.ref===t.ref&&(Ns=!1,i<a)?(t.expirationTime=e.expirationTime,hr(e,t,a)):or(e,t,n,r,a)}function ar(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function or(e,t,n,r,i){var a=At(n)?ju:Au.current;return a=Nt(t,a),en(t,i),n=Tn(e,t,n,r,a,i),null===e||Ns?(t.effectTag|=1,tr(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),hr(e,t,i))}function ur(e,t,n,r,i){if(At(n)){var a=!0;Bt(t)}else a=!1;if(en(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),pn(t,n,r),hn(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,u=t.memoizedProps;o.props=u;var s=o.context,l=n.contextType;"object"==typeof l&&null!==l?l=tn(l):(l=At(n)?ju:Au.current,l=Nt(t,l));var c=n.getDerivedStateFromProps,f="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate;f||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(u!==r||s!==l)&&dn(t,o,r,l),ss=!1;var p=t.memoizedState;o.state=p,sn(t,r,o,i),s=t.memoizedState,u!==r||p!==s||Lu.current||ss?("function"==typeof c&&(cn(t,n,c,r),s=t.memoizedState),(u=ss||fn(t,n,u,r,p,s,l))?(f||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.effectTag|=4)):("function"==typeof o.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=s),o.props=r,o.state=s,o.context=l,r=u):("function"==typeof o.componentDidMount&&(t.effectTag|=4),r=!1)}else o=t.stateNode,rn(e,t),u=t.memoizedProps,o.props=t.type===t.elementType?u:Yt(t.type,u),s=o.context,l=n.contextType,"object"==typeof l&&null!==l?l=tn(l):(l=At(n)?ju:Au.current,l=Nt(t,l)),c=n.getDerivedStateFromProps,(f="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(u!==r||s!==l)&&dn(t,o,r,l),ss=!1,s=t.memoizedState,o.state=s,sn(t,r,o,i),p=t.memoizedState,u!==r||s!==p||Lu.current||ss?("function"==typeof c&&(cn(t,n,c,r),p=t.memoizedState),(c=ss||fn(t,n,u,r,s,p,l))?(f||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"==typeof o.componentDidUpdate&&(t.effectTag|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!=typeof o.componentDidUpdate||u===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=4),"function"!=typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!=typeof o.componentDidUpdate||u===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=4),"function"!=typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=256),r=!1);return sr(e,t,n,r,a,i)}function sr(e,t,n,r,i,a){ar(e,t);var o=0!=(64&t.effectTag);if(!r&&!o)return i&&Ht(t,n,!1),hr(e,t,a);r=t.stateNode,Ms.current=t;var u=o&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&o?(t.child=ds(t,e.child,null,a),t.child=ds(t,null,u,a)):tr(e,t,u,a),t.memoizedState=r.state,i&&Ht(t,n,!0),t.child}function lr(e){var t=e.stateNode;t.pendingContext?jt(e,t.pendingContext,t.pendingContext!==t.context):t.context&&jt(e,t.context,!1),bn(e,t.containerInfo)}function cr(e,t,n){var r,i=t.mode,a=t.pendingProps,o=bs.current,u=!1;if((r=0!=(64&t.effectTag))||(r=0!=(2&o)&&(null===e||null!==e.memoizedState)),r?(u=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(o|=1),Mt(bs,1&o),null===e){if(void 0!==a.fallback&&Gn(t),u){if(u=a.fallback,a=ki(null,i,0,null),a.return=t,0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,a.child=e;null!==e;)e.return=a,e=e.sibling;return n=ki(u,i,n,null),n.return=t,a.sibling=n,t.memoizedState=As,t.child=a,n}return i=a.children,t.memoizedState=null,t.child=hs(t,null,i,n)}if(null!==e.memoizedState){if(e=e.child,i=e.sibling,u){if(a=a.fallback,n=gi(e,e.pendingProps),n.return=t,0==(2&t.mode)&&(u=null!==t.memoizedState?t.child.child:t.child)!==e.child)for(n.child=u;null!==u;)u.return=n,u=u.sibling;return i=gi(i,a),i.return=t,n.sibling=i,n.childExpirationTime=0,t.memoizedState=As,t.child=n,i}return n=ds(t,e.child,a.children,n),t.memoizedState=null,t.child=n}if(e=e.child,u){if(u=a.fallback,a=ki(null,i,0,null),a.return=t,a.child=e,null!==e&&(e.return=a),0==(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,a.child=e;null!==e;)e.return=a,e=e.sibling;return n=ki(u,i,n,null),n.return=t,a.sibling=n,n.effectTag|=2,a.childExpirationTime=0,t.memoizedState=As,t.child=a,n}return t.memoizedState=null,t.child=ds(t,e,a.children,n)}function fr(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t),Zt(e.return,t)}function pr(e,t,n,r,i,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailExpiration=0,o.tailMode=i,o.lastEffect=a)}function dr(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(tr(e,t,r.children,n),0!=(2&(r=bs.current)))r=1&r|2,t.effectTag|=64;else{if(null!==e&&0!=(64&e.effectTag))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&fr(e,n);else if(19===e.tag)fr(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Mt(bs,r),0==(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)e=n.alternate,null!==e&&null===Sn(e)&&(i=n),n=n.sibling;n=i,null===n?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),pr(t,!1,i,n,a,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Sn(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}pr(t,!0,n,null,a,t.lastEffect);break;case"together":pr(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function hr(e,t,n){null!==e&&(t.dependencies=e.dependencies);var i=t.expirationTime;if(0!==i&&Xr(i),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(e=t.child,n=gi(e,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,n=n.sibling=gi(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function mr(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function vr(e,t,n){var i=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return At(t.type)&&Lt(),null;case 3:return kn(),Dt(Lu),Dt(Au),n=t.stateNode,n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||!Zn(t)||(t.effectTag|=4),Ru(t),null;case 5:xn(t),n=gn(gs.current);var a=t.type;if(null!==e&&null!=t.stateNode)Fu(e,t,a,i,n),e.ref!==t.ref&&(t.effectTag|=128);else{if(!i){if(null===t.stateNode)throw Error(r(166));return null}if(e=gn(vs.current),Zn(t)){i=t.stateNode,a=t.type;var o=t.memoizedProps;switch(i[Po]=t,i[Io]=o,a){case"iframe":case"object":case"embed":_e("load",i);break;case"video":case"audio":for(e=0;e<Va.length;e++)_e(Va[e],i);break;case"source":_e("error",i);break;case"img":case"image":case"link":_e("error",i),_e("load",i);break;case"form":_e("reset",i),_e("submit",i);break;case"details":_e("toggle",i);break;case"input":N(i,o),_e("invalid",i),Ae(n,"onChange");break;case"select":i._wrapperState={wasMultiple:!!o.multiple},_e("invalid",i),Ae(n,"onChange");break;case"textarea":K(i,o),_e("invalid",i),Ae(n,"onChange")}Me(a,o),e=null;for(var u in o)if(o.hasOwnProperty(u)){var s=o[u];"children"===u?"string"==typeof s?i.textContent!==s&&(e=["children",s]):"number"==typeof s&&i.textContent!==""+s&&(e=["children",""+s]):Zi.hasOwnProperty(u)&&null!=s&&Ae(n,u)}switch(a){case"input":O(i),j(i,o,!0);break;case"textarea":O(i),$(i);break;case"select":case"option":break;default:"function"==typeof o.onClick&&(i.onclick=Le)}n=e,t.updateQueue=n,null!==n&&(t.effectTag|=4)}else{switch(u=9===n.nodeType?n:n.ownerDocument,e===go&&(e=q(a)),e===go?"script"===a?(e=u.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof i.is?e=u.createElement(a,{is:i.is}):(e=u.createElement(a),"select"===a&&(u=e,i.multiple?u.multiple=!0:i.size&&(u.size=i.size))):e=u.createElementNS(e,a),e[Po]=t,e[Io]=i,Iu(e,t,!1,!1),t.stateNode=e,u=Ne(a,i),a){case"iframe":case"object":case"embed":_e("load",e),s=i;break;case"video":case"audio":for(s=0;s<Va.length;s++)_e(Va[s],e);s=i;break;case"source":_e("error",e),s=i;break;case"img":case"image":case"link":_e("error",e),_e("load",e),s=i;break;case"form":_e("reset",e),_e("submit",e),s=i;break;case"details":_e("toggle",e),s=i;break;case"input":N(e,i),s=M(e,i),_e("invalid",e),Ae(n,"onChange");break;case"option":s=H(e,i);break;case"select":e._wrapperState={wasMultiple:!!i.multiple},s=Ui({},i,{value:void 0}),_e("invalid",e),Ae(n,"onChange");break;case"textarea":K(e,i),s=W(e,i),_e("invalid",e),Ae(n,"onChange");break;default:s=i}Me(a,s);var l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];"style"===o?De(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&Ma(e,c):"children"===o?"string"==typeof c?("textarea"!==a||""!==c)&&J(e,c):"number"==typeof c&&J(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(Zi.hasOwnProperty(o)?null!=c&&Ae(n,o):null!=c&&E(e,o,c,u))}switch(a){case"input":O(e),j(e,i,!1);break;case"textarea":O(e),$(e);break;case"option":null!=i.value&&e.setAttribute("value",""+I(i.value));break;case"select":e.multiple=!!i.multiple,n=i.value,null!=n?z(e,!!i.multiple,n,!1):null!=i.defaultValue&&z(e,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof s.onClick&&(e.onclick=Le)}Ke(a,i)&&(t.effectTag|=4)}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)Ou(e,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(r(166));n=gn(gs.current),gn(vs.current),Zn(t)?(n=t.stateNode,i=t.memoizedProps,n[Po]=t,n.nodeValue!==i&&(t.effectTag|=4)):(n=(9===n.nodeType?n:n.ownerDocument).createTextNode(i),n[Po]=t,t.stateNode=n)}return null;case 13:return Dt(bs),(i=t.memoizedState,0!=(64&t.effectTag))?(t.expirationTime=n,t):(n=null!==i,i=!1,null===e?void 0!==t.memoizedProps.fallback&&Zn(t):(a=e.memoizedState,i=null!==a,n||null===a||null!==(a=e.child.sibling)&&(o=t.firstEffect,null!==o?(t.firstEffect=a,a.nextEffect=o):(t.firstEffect=t.lastEffect=a,a.nextEffect=null),a.effectTag=8)),n&&!i&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&bs.current)?rl===qs&&(rl=Ys):(rl!==qs&&rl!==Ys||(rl=Gs),0!==sl&&null!==el&&(Ci(el,nl),_i(el,sl)))),(n||i)&&(t.effectTag|=4),null);case 4:return kn(),Ru(t),null;case 10:return Xt(t),null;case 17:return At(t.type)&&Lt(),null;case 19:if(Dt(bs),null===(i=t.memoizedState))return null;if(a=0!=(64&t.effectTag),null===(o=i.rendering)){if(a)mr(i,!1);else if(rl!==qs||null!==e&&0!=(64&e.effectTag))for(o=t.child;null!==o;){if(null!==(e=Sn(o))){for(t.effectTag|=64,mr(i,!1),a=e.updateQueue,null!==a&&(t.updateQueue=a,t.effectTag|=4),null===i.lastEffect&&(t.firstEffect=null),t.lastEffect=i.lastEffect,i=t.child;null!==i;)a=i,o=n,a.effectTag&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,e=a.alternate,null===e?(a.childExpirationTime=0,a.expirationTime=o,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null):(a.childExpirationTime=e.childExpirationTime,a.expirationTime=e.expirationTime,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,o=e.dependencies,a.dependencies=null===o?null:{expirationTime:o.expirationTime,firstContext:o.firstContext,responders:o.responders}),i=i.sibling;return Mt(bs,1&bs.current|2),t.child}o=o.sibling}}else{if(!a)if(null!==(e=Sn(o))){if(t.effectTag|=64,a=!0,n=e.updateQueue,null!==n&&(t.updateQueue=n,t.effectTag|=4),mr(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate)return t=t.lastEffect=i.lastEffect,null!==t&&(t.nextEffect=null),null}else 2*rs()-i.renderingStartTime>i.tailExpiration&&1<n&&(t.effectTag|=64,a=!0,mr(i,!1),t.expirationTime=t.childExpirationTime=n-1);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,null!==n?n.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(0===i.tailExpiration&&(i.tailExpiration=rs()+500),n=i.tail,i.rendering=n,i.tail=n.sibling,i.lastEffect=t.lastEffect,i.renderingStartTime=rs(),n.sibling=null,t=bs.current,Mt(bs,a?1&t|2:1&t),n):null}throw Error(r(156,t.tag))}function yr(e){switch(e.tag){case 1:At(e.type)&&Lt();var t=e.effectTag;return 4096&t?(e.effectTag=-4097&t|64,e):null;case 3:if(kn(),Dt(Lu),Dt(Au),0!=(64&(t=e.effectTag)))throw Error(r(285));return e.effectTag=-4097&t|64,e;case 5:return xn(e),null;case 13:return Dt(bs),t=e.effectTag,4096&t?(e.effectTag=-4097&t|64,e):null;case 19:return Dt(bs),null;case 4:return kn(),null;case 10:return Xt(e),null;default:return null}}function gr(e,t){return{value:e,source:t,stack:P(t)}}function br(e,t){var n=t.source,r=t.stack;null===r&&null!==n&&(r=P(n)),null!==n&&T(n.type),t=t.value,null!==e&&1===e.tag&&T(e.type);try{console.error(t)}catch(e){setTimeout(function(){throw e})}}function kr(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){ci(e,t)}}function wr(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){ci(e,t)}else t.current=null}function xr(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.effectTag&&null!==e){var n=e.memoizedProps,i=e.memoizedState;e=t.stateNode,t=e.getSnapshotBeforeUpdate(t.elementType===t.type?n:Yt(t.type,n),i),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(r(163))}function Sr(e,t){if(t=t.updateQueue,null!==(t=null!==t?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==t)}}function Er(e,t){if(t=t.updateQueue,null!==(t=null!==t?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Cr(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:return void Er(3,n);case 1:if(e=n.stateNode,4&n.effectTag)if(null===t)e.componentDidMount();else{var i=n.elementType===n.type?t.memoizedProps:Yt(n.type,t.memoizedProps);e.componentDidUpdate(i,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}return void(null!==(t=n.updateQueue)&&ln(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}ln(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.effectTag&&Ke(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&null!==(n=n.alternate)&&null!==(n=n.memoizedState)&&null!==(n=n.dehydrated)&&Ee(n));case 19:case 17:case 20:case 21:return}throw Error(r(163))}function _r(e,t,n){switch("function"==typeof El&&El(t),t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e.next;Kt(97<n?97:n,function(){var e=r;do{var n=e.destroy;if(void 0!==n){var i=t;try{n()}catch(e){ci(i,e)}}e=e.next}while(e!==r)})}break;case 1:wr(t),n=t.stateNode,"function"==typeof n.componentWillUnmount&&kr(t,n);break;case 5:wr(t);break;case 4:Or(e,t,n)}}function Tr(e){var t=e.alternate;e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.alternate=null,e.firstEffect=null,e.lastEffect=null,e.pendingProps=null,e.memoizedProps=null,e.stateNode=null,null!==t&&Tr(t)}function Pr(e){return 5===e.tag||3===e.tag||4===e.tag}function Ir(e){e:{for(var t=e.return;null!==t;){if(Pr(t)){var n=t;break e}t=t.return}throw Error(r(160))}switch(t=n.stateNode,n.tag){case 5:var i=!1;break;case 3:case 4:t=t.containerInfo,i=!0;break;default:throw Error(r(161))}16&n.effectTag&&(J(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Pr(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}i?Rr(e,n,t):Fr(e,n,t)}function Rr(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Le));else if(4!==r&&null!==(e=e.child))for(Rr(e,t,n),e=e.sibling;null!==e;)Rr(e,t,n),e=e.sibling}function Fr(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(Fr(e,t,n),e=e.sibling;null!==e;)Fr(e,t,n),e=e.sibling}function Or(e,t,n){for(var i,a,o=t,u=!1;;){if(!u){u=o.return;e:for(;;){if(null===u)throw Error(r(160));switch(i=u.stateNode,u.tag){case 5:a=!1;break e;case 3:case 4:i=i.containerInfo,a=!0;break e}u=u.return}u=!0}if(5===o.tag||6===o.tag){e:for(var s=e,l=o,c=n,f=l;;)if(_r(s,f,c),null!==f.child&&4!==f.tag)f.child.return=f,f=f.child;else{if(f===l)break e;for(;null===f.sibling;){if(null===f.return||f.return===l)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}a?(s=i,l=o.stateNode,8===s.nodeType?s.parentNode.removeChild(l):s.removeChild(l)):i.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){i=o.stateNode.containerInfo,a=!0,o.child.return=o,o=o.child;continue}}else if(_r(e,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;o=o.return,4===o.tag&&(u=!1)}o.sibling.return=o.return,o=o.sibling}}function Dr(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void Sr(3,t);case 1:return;case 5:var n=t.stateNode;if(null!=n){var i=t.memoizedProps,a=null!==e?e.memoizedProps:i;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[Io]=i,"input"===e&&"radio"===i.type&&null!=i.name&&A(n,i),Ne(e,a),t=Ne(e,i),a=0;a<o.length;a+=2){var u=o[a],s=o[a+1];"style"===u?De(n,s):"dangerouslySetInnerHTML"===u?Ma(n,s):"children"===u?J(n,s):E(n,u,s,t)}switch(e){case"input":L(n,i);break;case"textarea":V(n,i);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!i.multiple,e=i.value,null!=e?z(n,!!i.multiple,e,!1):t!==!!i.multiple&&(null!=i.defaultValue?z(n,!!i.multiple,i.defaultValue,!0):z(n,!!i.multiple,i.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(r(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return t=t.stateNode,void(t.hydrate&&(t.hydrate=!1,Ee(t.containerInfo)));case 12:return;case 13:if(n=t,null===t.memoizedState?i=!1:(i=!0,n=t.child,cl=rs()),null!==n)e:for(e=n;;){if(5===e.tag)o=e.stateNode,i?(o=o.style,"function"==typeof o.setProperty?o.setProperty("display","none","important"):o.display="none"):(o=e.stateNode,a=e.memoizedProps.style,a=void 0!==a&&null!==a&&a.hasOwnProperty("display")?a.display:null,o.style.display=Oe("display",a));else if(6===e.tag)e.stateNode.nodeValue=i?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){o=e.child.sibling,o.return=e,e=o;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===n)break;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}return void Mr(t);case 19:return void Mr(t);case 17:return}throw Error(r(163))}function Mr(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new js),t.forEach(function(t){var r=pi.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function Nr(e,t,n){n=an(n,null),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){dl||(dl=!0,hl=r),br(e,t)},n}function Ar(e,t,n){n=an(n,null),n.tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return br(e,t),r(i)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===ml?ml=new Set([this]):ml.add(this),br(e,t));var n=t.stack;this.componentDidCatch(t.value,{componentStack:null!==n?n:""})}),n}function Lr(){return(Zs&(Vs|$s))!==Ws?1073741821-(rs()/10|0):0!==xl?xl:xl=1073741821-(rs()/10|0)}function jr(e,t,n){if(0==(2&(t=t.mode)))return 1073741823;var i=zt();if(0==(4&t))return 99===i?1073741823:1073741822;if((Zs&Vs)!==Ws)return nl;if(null!==n)e=Jt(e,0|n.timeoutMs||5e3,250);else switch(i){case 99:e=1073741823;break;case 98:e=Jt(e,150,100);break;case 97:case 96:e=Jt(e,5e3,250);break;case 95:e=2;break;default:throw Error(r(326))}return null!==el&&e===nl&&--e,e}function Ur(e,t){if(50<kl)throw kl=0,wl=null,Error(r(185));if(null!==(e=Br(e,t))){var n=zt();1073741823===t?(Zs&Ks)!==Ws&&(Zs&(Vs|$s))===Ws?Kr(e):(zr(e),Zs===Ws&&qt()):zr(e),(4&Zs)===Ws||98!==n&&99!==n||(null===bl?bl=new Map([[e,t]]):(void 0===(n=bl.get(e))||n>t)&&bl.set(e,t))}}function Br(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var r=e.return,i=null;if(null===r&&3===e.tag)i=e.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(el===i&&(Xr(t),rl===Gs&&Ci(i,nl)),_i(i,t)),i}function Hr(e){var t=e.lastExpiredTime;if(0!==t)return t;if(t=e.firstPendingTime,!Ei(e,t))return t;var n=e.lastPingedTime;return e=e.nextKnownPendingLevel,e=n>e?n:e,2>=e&&t!==e?0:e}function zr(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=$t(Kr.bind(null,e));else{var t=Hr(e),n=e.callbackNode;if(0===t)null!==n&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var r=Lr();if(1073741823===t?r=99:1===t||2===t?r=95:(r=10*(1073741821-t)-10*(1073741821-r),r=0>=r?99:250>=r?98:5250>=r?97:95),null!==n){var i=e.callbackPriority;if(e.callbackExpirationTime===t&&i>=r)return;n!==Yu&&Hu(n)}e.callbackExpirationTime=t,e.callbackPriority=r,t=1073741823===t?$t(Kr.bind(null,e)):Vt(r,Wr.bind(null,e),{timeout:10*(1073741821-t)-rs()}),e.callbackNode=t}}}function Wr(e,t){if(xl=0,t)return t=Lr(),Ti(e,t),zr(e),null;var n=Hr(e);if(0!==n){if(t=e.callbackNode,(Zs&(Vs|$s))!==Ws)throw Error(r(327));if(ui(),e===el&&n===nl||Qr(e,n),null!==tl){var i=Zs;Zs|=Vs;for(var a=Yr();;)try{ei();break}catch(t){Jr(e,t)}if(Gt(),Zs=i,Hs.current=a,rl===Qs)throw t=il,Qr(e,n),Ci(e,n),zr(e),t;if(null===tl)switch(a=e.finishedWork=e.current.alternate,e.finishedExpirationTime=n,i=rl,el=null,i){case qs:case Qs:throw Error(r(345));case Js:Ti(e,2<n?2:n);break;case Ys:if(Ci(e,n),i=e.lastSuspendedTime,n===i&&(e.nextKnownPendingLevel=ri(a)),1073741823===al&&10<(a=cl+fl-rs())){if(ll){var o=e.lastPingedTime;if(0===o||o>=n){e.lastPingedTime=n,Qr(e,n);break}}if(0!==(o=Hr(e))&&o!==n)break;if(0!==i&&i!==n){e.lastPingedTime=i;break}e.timeoutHandle=Co(ii.bind(null,e),a);break}ii(e);break;case Gs:if(Ci(e,n),i=e.lastSuspendedTime,n===i&&(e.nextKnownPendingLevel=ri(a)),ll&&(0===(a=e.lastPingedTime)||a>=n)){e.lastPingedTime=n,Qr(e,n);break}if(0!==(a=Hr(e))&&a!==n)break;if(0!==i&&i!==n){e.lastPingedTime=i;break}if(1073741823!==ol?i=10*(1073741821-ol)-rs():1073741823===al?i=0:(i=10*(1073741821-al)-5e3,a=rs(),n=10*(1073741821-n)-a,i=a-i,0>i&&(i=0),i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Bs(i/1960))-i,n<i&&(i=n)),10<i){e.timeoutHandle=Co(ii.bind(null,e),i);break}ii(e);break;case Xs:if(1073741823!==al&&null!==ul){o=al;var u=ul;if(i=0|u.busyMinDurationMs,0>=i?i=0:(a=0|u.busyDelayMs,o=rs()-(10*(1073741821-o)-(0|u.timeoutMs||5e3)),i=o<=a?0:a+i-o),10<i){Ci(e,n),e.timeoutHandle=Co(ii.bind(null,e),i);break}}ii(e);break;default:throw Error(r(329))}if(zr(e),e.callbackNode===t)return Wr.bind(null,e)}}return null}function Kr(e){var t=e.lastExpiredTime;if(t=0!==t?t:1073741823,(Zs&(Vs|$s))!==Ws)throw Error(r(327));if(ui(),e===el&&t===nl||Qr(e,t),null!==tl){var n=Zs;Zs|=Vs;for(var i=Yr();;)try{Zr();break}catch(t){Jr(e,t)}if(Gt(),Zs=n,Hs.current=i,rl===Qs)throw n=il,Qr(e,t),Ci(e,t),zr(e),n;if(null!==tl)throw Error(r(261));e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,el=null,ii(e),zr(e)}return null}function Vr(){if(null!==bl){var e=bl;bl=null,e.forEach(function(e,t){Ti(t,e),zr(t)}),qt()}}function $r(e,t){var n=Zs;Zs|=1;try{return e(t)}finally{(Zs=n)===Ws&&qt()}}function qr(e,t){var n=Zs;Zs&=-2,Zs|=Ks;try{return e(t)}finally{(Zs=n)===Ws&&qt()}}function Qr(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,_o(n)),null!==tl)for(n=tl.return;null!==n;){var r=n;switch(r.tag){case 1:r=r.type.childContextTypes,null!==r&&void 0!==r&&Lt();break;case 3:kn(),Dt(Lu),Dt(Au);break;case 5:xn(r);break;case 4:kn();break;case 13:case 19:Dt(bs);break;case 10:Xt(r)}n=n.return}el=e,tl=gi(e.current,null),nl=t,rl=qs,il=null,ol=al=1073741823,ul=null,sl=0,ll=!1}function Jr(e,t){for(;;){try{if(Gt(),ks.current=Ts,_s)for(var n=Ss.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(xs=0,Cs=Es=Ss=null,_s=!1,null===tl||null===tl.return)return rl=Qs,il=t,tl=null;e:{var i=e,a=tl.return,o=tl,u=t;if(t=nl,o.effectTag|=2048,o.firstEffect=o.lastEffect=null,null!==u&&"object"==typeof u&&"function"==typeof u.then){var s=u;if(0==(2&o.mode)){var l=o.alternate;l?(o.updateQueue=l.updateQueue,o.memoizedState=l.memoizedState,o.expirationTime=l.expirationTime):(o.updateQueue=null,o.memoizedState=null)}var c=0!=(1&bs.current),f=a;do{var p;if(p=13===f.tag){var d=f.memoizedState;if(null!==d)p=null!==d.dehydrated;else{var h=f.memoizedProps;p=void 0!==h.fallback&&(!0!==h.unstable_avoidThisFallback||!c)}}if(p){var m=f.updateQueue;if(null===m){var v=new Set;v.add(s),f.updateQueue=v}else m.add(s);if(0==(2&f.mode)){if(f.effectTag|=64,o.effectTag&=-2981,1===o.tag)if(null===o.alternate)o.tag=17;else{var y=an(1073741823,null);y.tag=2,on(o,y)}o.expirationTime=1073741823;break e}u=void 0,o=t;var g=i.pingCache;if(null===g?(g=i.pingCache=new Us,u=new Set,g.set(s,u)):void 0===(u=g.get(s))&&(u=new Set,g.set(s,u)),!u.has(o)){u.add(o);var b=fi.bind(null,i,s,o);s.then(b,b)}f.effectTag|=4096,f.expirationTime=t;break e}f=f.return}while(null!==f);u=Error((T(o.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+P(o))}rl!==Xs&&(rl=Js),u=gr(u,o),f=a;do{switch(f.tag){case 3:s=u,f.effectTag|=4096,f.expirationTime=t;un(f,Nr(f,s,t));break e;case 1:s=u;var k=f.type,w=f.stateNode;if(0==(64&f.effectTag)&&("function"==typeof k.getDerivedStateFromError||null!==w&&"function"==typeof w.componentDidCatch&&(null===ml||!ml.has(w)))){f.effectTag|=4096,f.expirationTime=t;un(f,Ar(f,s,t));break e}}f=f.return}while(null!==f)}tl=ni(tl)}catch(e){t=e;continue}break}}function Yr(){var e=Hs.current;return Hs.current=Ts,null===e?Ts:e}function Gr(e,t){e<al&&2<e&&(al=e),null!==t&&e<ol&&2<e&&(ol=e,ul=t)}function Xr(e){e>sl&&(sl=e)}function Zr(){for(;null!==tl;)tl=ti(tl)}function ei(){for(;null!==tl&&!Gu();)tl=ti(tl)}function ti(e){var t=Ls(e.alternate,e,nl);return e.memoizedProps=e.pendingProps,null===t&&(t=ni(e)),zs.current=null,t}function ni(e){tl=e;do{var t=tl.alternate;if(e=tl.return,0==(2048&tl.effectTag)){if(t=vr(t,tl,nl),1===nl||1!==tl.childExpirationTime){for(var n=0,r=tl.child;null!==r;){var i=r.expirationTime,a=r.childExpirationTime;i>n&&(n=i),a>n&&(n=a),r=r.sibling}tl.childExpirationTime=n}if(null!==t)return t;null!==e&&0==(2048&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=tl.firstEffect),null!==tl.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=tl.firstEffect),e.lastEffect=tl.lastEffect),1<tl.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=tl:e.firstEffect=tl,e.lastEffect=tl))}else{if(null!==(t=yr(tl)))return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}if(null!==(t=tl.sibling))return t;tl=e}while(null!==tl);return rl===qs&&(rl=Xs),null}function ri(e){var t=e.expirationTime;return e=e.childExpirationTime,t>e?t:e}function ii(e){var t=zt();return Kt(99,ai.bind(null,e,t)),null}function ai(e,t){do{ui()}while(null!==yl);if((Zs&(Vs|$s))!==Ws)throw Error(r(327));var n=e.finishedWork,i=e.finishedExpirationTime;if(null===n)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90,e.nextKnownPendingLevel=0;var a=ri(n);if(e.firstPendingTime=a,i<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:i<=e.firstSuspendedTime&&(e.firstSuspendedTime=i-1),i<=e.lastPingedTime&&(e.lastPingedTime=0),i<=e.lastExpiredTime&&(e.lastExpiredTime=0),e===el&&(tl=el=null,nl=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,a=n.firstEffect):a=n:a=n.firstEffect,null!==a){var o=Zs;Zs|=$s,zs.current=null,So=ho;var u=ze();if(We(u)){if("selectionStart"in u)var s={start:u.selectionStart,end:u.selectionEnd};else e:{s=(s=u.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&0!==l.rangeCount){s=l.anchorNode;var c=l.anchorOffset,f=l.focusNode;l=l.focusOffset;try{s.nodeType,f.nodeType}catch(e){s=null;break e}var p=0,d=-1,h=-1,m=0,v=0,y=u,g=null;t:for(;;){for(var b;y!==s||0!==c&&3!==y.nodeType||(d=p+c),y!==f||0!==l&&3!==y.nodeType||(h=p+l),3===y.nodeType&&(p+=y.nodeValue.length),null!==(b=y.firstChild);)g=y,y=b;for(;;){if(y===u)break t;if(g===s&&++m===c&&(d=p),g===f&&++v===l&&(h=p),null!==(b=y.nextSibling))break;y=g,g=y.parentNode}y=b}s=-1===d||-1===h?null:{start:d,end:h}}else s=null}s=s||{start:0,end:0}}else s=null;Eo={activeElementDetached:null,focusedElem:u,selectionRange:s},ho=!1,pl=a;do{try{oi()}catch(e){if(null===pl)throw Error(r(330));ci(pl,e),pl=pl.nextEffect}}while(null!==pl);pl=a;do{try{for(u=e,s=t;null!==pl;){var k=pl.effectTag;if(16&k&&J(pl.stateNode,""),128&k){var w=pl.alternate;if(null!==w){var x=w.ref;null!==x&&("function"==typeof x?x(null):x.current=null)}}switch(1038&k){case 2:Ir(pl),pl.effectTag&=-3;break;case 6:Ir(pl),pl.effectTag&=-3,Dr(pl.alternate,pl);break;case 1024:pl.effectTag&=-1025;break;case 1028:pl.effectTag&=-1025,Dr(pl.alternate,pl);break;case 4:Dr(pl.alternate,pl);break;case 8:c=pl,Or(u,c,s),Tr(c)}pl=pl.nextEffect}}catch(e){if(null===pl)throw Error(r(330));ci(pl,e),pl=pl.nextEffect}}while(null!==pl);if(x=Eo,w=ze(),k=x.focusedElem,s=x.selectionRange,w!==k&&k&&k.ownerDocument&&He(k.ownerDocument.documentElement,k)){null!==s&&We(k)&&(w=s.start,x=s.end,void 0===x&&(x=w),"selectionStart"in k?(k.selectionStart=w,k.selectionEnd=Math.min(x,k.value.length)):(x=(w=k.ownerDocument||document)&&w.defaultView||window,x.getSelection&&(x=x.getSelection(),c=k.textContent.length,u=Math.min(s.start,c),s=void 0===s.end?u:Math.min(s.end,c),!x.extend&&u>s&&(c=s,s=u,u=c),c=Be(k,u),f=Be(k,s),c&&f&&(1!==x.rangeCount||x.anchorNode!==c.node||x.anchorOffset!==c.offset||x.focusNode!==f.node||x.focusOffset!==f.offset)&&(w=w.createRange(),w.setStart(c.node,c.offset),x.removeAllRanges(),u>s?(x.addRange(w),x.extend(f.node,f.offset)):(w.setEnd(f.node,f.offset),x.addRange(w)))))),w=[];for(x=k;x=x.parentNode;)1===x.nodeType&&w.push({element:x,left:x.scrollLeft,top:x.scrollTop});for("function"==typeof k.focus&&k.focus(),k=0;k<w.length;k++)x=w[k],x.element.scrollLeft=x.left,x.element.scrollTop=x.top}ho=!!So,Eo=So=null,e.current=n,pl=a;do{try{for(k=e;null!==pl;){var S=pl.effectTag;if(36&S&&Cr(k,pl.alternate,pl),128&S){w=void 0;var E=pl.ref;if(null!==E){var C=pl.stateNode;switch(pl.tag){case 5:w=C;break;default:w=C}"function"==typeof E?E(w):E.current=w}}pl=pl.nextEffect}}catch(e){if(null===pl)throw Error(r(330));ci(pl,e),pl=pl.nextEffect}}while(null!==pl);pl=null,Xu(),Zs=o}else e.current=n;if(vl)vl=!1,yl=e,gl=t;else for(pl=a;null!==pl;)t=pl.nextEffect,pl.nextEffect=null,pl=t;if(t=e.firstPendingTime,0===t&&(ml=null),1073741823===t?e===wl?kl++:(kl=0,wl=e):kl=0,"function"==typeof Sl&&Sl(n.stateNode,i),zr(e),dl)throw dl=!1,e=hl,hl=null,e;return(Zs&Ks)!==Ws?null:(qt(),null)}function oi(){for(;null!==pl;){var e=pl.effectTag;0!=(256&e)&&xr(pl.alternate,pl),0==(512&e)||vl||(vl=!0,Vt(97,function(){return ui(),null})),pl=pl.nextEffect}}function ui(){if(90!==gl){var e=97<gl?97:gl;return gl=90,Kt(e,si)}}function si(){if(null===yl)return!1;var e=yl;if(yl=null,(Zs&(Vs|$s))!==Ws)throw Error(r(331));var t=Zs;for(Zs|=$s,e=e.current.firstEffect;null!==e;){try{var n=e;if(0!=(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:Sr(5,n),Er(5,n)}}catch(t){if(null===e)throw Error(r(330));ci(e,t)}n=e.nextEffect,e.nextEffect=null,e=n}return Zs=t,qt(),!0}function li(e,t,n){t=gr(n,t),t=Nr(e,t,1073741823),on(e,t),null!==(e=Br(e,1073741823))&&zr(e)}function ci(e,t){if(3===e.tag)li(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){li(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===ml||!ml.has(r))){e=gr(t,e),e=Ar(n,e,1073741823),on(n,e),n=Br(n,1073741823),null!==n&&zr(n);break}}n=n.return}}function fi(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),el===e&&nl===n?rl===Gs||rl===Ys&&1073741823===al&&rs()-cl<fl?Qr(e,nl):ll=!0:Ei(e,n)&&(0!==(t=e.lastPingedTime)&&t<n||(e.lastPingedTime=n,zr(e)))}function pi(e,t){var n=e.stateNode;null!==n&&n.delete(t),t=0,0===t&&(t=Lr(),t=jr(t,e,null)),null!==(e=Br(e,t))&&zr(e)}function di(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);Sl=function(e){try{t.onCommitFiberRoot(n,e,void 0,64==(64&e.current.effectTag))}catch(e){}},El=function(e){try{t.onCommitFiberUnmount(n,e)}catch(e){}}}catch(e){}return!0}function hi(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function mi(e,t,n,r){return new hi(e,t,n,r)}function vi(e){return!(!(e=e.prototype)||!e.isReactComponent)}function yi(e){if("function"==typeof e)return vi(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===_a)return 11;if(e===Ia)return 14}return 2}function gi(e,t){var n=e.alternate;return null===n?(n=mi(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function bi(e,t,n,i,a,o){var u=2;if(i=e,"function"==typeof e)vi(e)&&(u=1);else if("string"==typeof e)u=5;else e:switch(e){case ka:return ki(n.children,a,o,t);case Ca:u=8,a|=7;break;case wa:u=8,a|=1;break;case xa:return e=mi(12,n,t,8|a),e.elementType=xa,e.type=xa,e.expirationTime=o,e;case Ta:return e=mi(13,n,t,a),e.type=Ta,e.elementType=Ta,e.expirationTime=o,e;case Pa:return e=mi(19,n,t,a),e.elementType=Pa,e.expirationTime=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case Sa:u=10;break e;case Ea:u=9;break e;case _a:u=11;break e;case Ia:u=14;break e;case Ra:u=16,i=null;break e;case Fa:u=22;break e}throw Error(r(130,null==e?e:typeof e,""))}return t=mi(u,n,t,a),t.elementType=e,t.type=i,t.expirationTime=o,t}function ki(e,t,n,r){return e=mi(7,e,r,t),e.expirationTime=n,e}function wi(e,t,n){return e=mi(6,e,null,t),e.expirationTime=n,e}function xi(e,t,n){return t=mi(4,null!==e.children?e.children:[],e.key,t),t.expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Si(e,t,n){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Ei(e,t){var n=e.firstSuspendedTime;return e=e.lastSuspendedTime,0!==n&&n>=t&&e<=t}function Ci(e,t){var n=e.firstSuspendedTime,r=e.lastSuspendedTime;n<t&&(e.firstSuspendedTime=t),(r>t||0===n)&&(e.lastSuspendedTime=t),t<=e.lastPingedTime&&(e.lastPingedTime=0),t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function _i(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var n=e.firstSuspendedTime;0!==n&&(t>=n?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function Ti(e,t){var n=e.lastExpiredTime;(0===n||n>t)&&(e.lastExpiredTime=t)}function Pi(e,t,n,i){var a=t.current,o=Lr(),u=ls.suspense;o=jr(o,a,u);e:if(n){n=n._reactInternalFiber;t:{if(Z(n)!==n||1!==n.tag)throw Error(r(170));var s=n;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(At(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(null!==s);throw Error(r(171))}if(1===n.tag){var l=n.type;if(At(l)){n=Ut(n,l,s);break e}}n=s}else n=Nu;return null===t.context?t.context=n:t.pendingContext=n,t=an(o,u),t.payload={element:e},i=void 0===i?null:i,null!==i&&(t.callback=i),on(a,t),Ur(a,o),o}function Ii(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Ri(e,t){null!==(e=e.memoizedState)&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function Fi(e,t){Ri(e,t),(e=e.alternate)&&Ri(e,t)}function Oi(e,t,n){n=null!=n&&!0===n.hydrate;var r=new Si(e,t,n),i=mi(3,null,null,2===t?7:1===t?3:0);r.current=i,i.stateNode=r,nn(i),e[Ro]=r.current,n&&0!==t&&he(e,9===e.nodeType?e:e.ownerDocument),this._internalRoot=r}function Di(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Mi(e,t){if(t||(t=e?9===e.nodeType?e.documentElement:e.firstChild:null,t=!(!t||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new Oi(e,0,t?{hydrate:!0}:void 0)}function Ni(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a._internalRoot;if("function"==typeof i){var u=i;i=function(){var e=Ii(o);u.call(e)}}Pi(t,o,e,i)}else{if(a=n._reactRootContainer=Mi(n,r),o=a._internalRoot,"function"==typeof i){var s=i;i=function(){var e=Ii(o);s.call(e)}}qr(function(){Pi(t,o,e,i)})}return Ii(o)}function Ai(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:ba,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Li(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Di(t))throw Error(r(200));return Ai(e,t,null,n)}/** @license React v16.13.1
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var ji=n(3),Ui=n(4),Bi=n(27);if(!ji)throw Error(r(227));var Hi=!1,zi=null,Wi=!1,Ki=null,Vi={onError:function(e){Hi=!0,zi=e}},$i=null,qi=null,Qi=null,Ji=null,Yi={},Gi=[],Xi={},Zi={},ea={},ta=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),na=null,ra=null,ia=null,aa=h,oa=!1,ua=!1,sa=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la=Object.prototype.hasOwnProperty,ca={},fa={},pa={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){pa[e]=new x(e,0,!1,e,null,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];pa[t]=new x(t,1,!1,e[1],null,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){pa[e]=new x(e,2,!1,e.toLowerCase(),null,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){pa[e]=new x(e,2,!1,e,null,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){pa[e]=new x(e,3,!1,e.toLowerCase(),null,!1)}),["checked","multiple","muted","selected"].forEach(function(e){pa[e]=new x(e,3,!0,e,null,!1)}),["capture","download"].forEach(function(e){pa[e]=new x(e,4,!1,e,null,!1)}),["cols","rows","size","span"].forEach(function(e){pa[e]=new x(e,6,!1,e,null,!1)}),["rowSpan","start"].forEach(function(e){pa[e]=new x(e,5,!1,e.toLowerCase(),null,!1)});var da=/[\-:]([a-z])/g;"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(da,S);pa[t]=new x(t,1,!1,e,null,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(da,S);pa[t]=new x(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(da,S);pa[t]=new x(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)}),["tabIndex","crossOrigin"].forEach(function(e){pa[e]=new x(e,1,!1,e.toLowerCase(),null,!1)}),pa.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach(function(e){pa[e]=new x(e,1,!1,e.toLowerCase(),null,!0)});var ha=ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;ha.hasOwnProperty("ReactCurrentDispatcher")||(ha.ReactCurrentDispatcher={current:null}),ha.hasOwnProperty("ReactCurrentBatchConfig")||(ha.ReactCurrentBatchConfig={suspense:null});var ma,va=/^(.*)[\\\/]/,ya="function"==typeof Symbol&&Symbol.for,ga=ya?Symbol.for("react.element"):60103,ba=ya?Symbol.for("react.portal"):60106,ka=ya?Symbol.for("react.fragment"):60107,wa=ya?Symbol.for("react.strict_mode"):60108,xa=ya?Symbol.for("react.profiler"):60114,Sa=ya?Symbol.for("react.provider"):60109,Ea=ya?Symbol.for("react.context"):60110,Ca=ya?Symbol.for("react.concurrent_mode"):60111,_a=ya?Symbol.for("react.forward_ref"):60112,Ta=ya?Symbol.for("react.suspense"):60113,Pa=ya?Symbol.for("react.suspense_list"):60120,Ia=ya?Symbol.for("react.memo"):60115,Ra=ya?Symbol.for("react.lazy"):60116,Fa=ya?Symbol.for("react.block"):60121,Oa="function"==typeof Symbol&&Symbol.iterator,Da={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"},Ma=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n)})}:e}(function(e,t){if(e.namespaceURI!==Da.svg||"innerHTML"in e)e.innerHTML=t;else{for(ma=ma||document.createElement("div"),ma.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ma.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}),Na={animationend:Y("Animation","AnimationEnd"),animationiteration:Y("Animation","AnimationIteration"),animationstart:Y("Animation","AnimationStart"),transitionend:Y("Transition","TransitionEnd")},Aa={},La={};ta&&(La=document.createElement("div").style,"AnimationEvent"in window||(delete Na.animationend.animation,delete Na.animationiteration.animation,delete Na.animationstart.animation),"TransitionEvent"in window||delete Na.transitionend.transition);var ja,Ua,Ba,Ha=G("animationend"),za=G("animationiteration"),Wa=G("animationstart"),Ka=G("transitionend"),Va="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$a=new("function"==typeof WeakMap?WeakMap:Map),qa=null,Qa=[],Ja=!1,Ya=[],Ga=null,Xa=null,Za=null,eo=new Map,to=new Map,no=[],ro="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),io="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" "),ao={},oo=new Map,uo=new Map,so=["abort","abort",Ha,"animationEnd",za,"animationIteration",Wa,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Ka,"transitionEnd","waiting","waiting"];Ce("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Ce("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Ce(so,2);for(var lo="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),co=0;co<lo.length;co++)uo.set(lo[co],0);var fo=Bi.unstable_UserBlockingPriority,po=Bi.unstable_runWithPriority,ho=!0,mo={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vo=["Webkit","ms","Moz","O"];Object.keys(mo).forEach(function(e){vo.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),mo[t]=mo[e]})});var yo=Ui({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),go=Da.html,bo="$",ko="/$",wo="$?",xo="$!",So=null,Eo=null,Co="function"==typeof setTimeout?setTimeout:void 0,_o="function"==typeof clearTimeout?clearTimeout:void 0,To=Math.random().toString(36).slice(2),Po="__reactInternalInstance$"+To,Io="__reactEventHandlers$"+To,Ro="__reactContainere$"+To,Fo=null,Oo=null,Do=null;Ui(st.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ot)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ot)},persist:function(){this.isPersistent=ot},isPersistent:ut,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=ut,this._dispatchInstances=this._dispatchListeners=null}}),st.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},st.extend=function(e){function t(){}function n(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var i=new t;return Ui(i,n.prototype),n.prototype=i,n.prototype.constructor=n,n.Interface=Ui({},r.Interface,e),n.extend=r.extend,ft(n),n},ft(st);var Mo=st.extend({data:null}),No=st.extend({data:null}),Ao=[9,13,27,32],Lo=ta&&"CompositionEvent"in window,jo=null;ta&&"documentMode"in document&&(jo=document.documentMode);var Uo=ta&&"TextEvent"in window&&!jo,Bo=ta&&(!Lo||jo&&8<jo&&11>=jo),Ho=String.fromCharCode(32),zo={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},Wo=!1,Ko=!1,Vo={eventTypes:zo,extractEvents:function(e,t,n,r){var i;if(Lo)e:{switch(e){case"compositionstart":var a=zo.compositionStart;break e;case"compositionend":a=zo.compositionEnd;break e;case"compositionupdate":a=zo.compositionUpdate;break e}a=void 0}else Ko?pt(e,n)&&(a=zo.compositionEnd):"keydown"===e&&229===n.keyCode&&(a=zo.compositionStart);return a?(Bo&&"ko"!==n.locale&&(Ko||a!==zo.compositionStart?a===zo.compositionEnd&&Ko&&(i=at()):(Fo=r,Oo="value"in Fo?Fo.value:Fo.textContent,Ko=!0)),a=Mo.getPooled(a,t,n,r),i?a.data=i:null!==(i=dt(n))&&(a.data=i),it(a),i=a):i=null,(e=Uo?ht(e,n):mt(e,n))?(t=No.getPooled(zo.beforeInput,t,n,r),t.data=e,it(t)):t=null,null===i?t:null===t?i:[i,t]}},$o={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},qo={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}},Qo=null,Jo=null,Yo=!1;ta&&(Yo=le("input")&&(!document.documentMode||9<document.documentMode));var Go={eventTypes:qo,_isInputEventSupported:Yo,extractEvents:function(e,t,n,r){var i=t?Ye(t):window,a=i.nodeName&&i.nodeName.toLowerCase();if("select"===a||"input"===a&&"file"===i.type)var o=kt;else if(vt(i))if(Yo)o=_t;else{o=Et;var u=St}else(a=i.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(o=Ct);if(o&&(o=o(e,t)))return yt(o,n,r);u&&u(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&U(i,"number",i.value)}},Xo=st.extend({view:null,detail:null}),Zo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},eu=0,tu=0,nu=!1,ru=!1,iu=Xo.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Pt,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=eu;return eu=e.screenX,nu?"mousemove"===e.type?e.screenX-t:0:(nu=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=tu;return tu=e.screenY,ru?"mousemove"===e.type?e.screenY-t:0:(ru=!0,0)}}),au=iu.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),ou={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},uu={eventTypes:ou,extractEvents:function(e,t,n,r,i){var a="mouseover"===e||"pointerover"===e,o="mouseout"===e||"pointerout"===e;if(a&&0==(32&i)&&(n.relatedTarget||n.fromElement)||!o&&!a)return null;if(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,o){if(o=t,null!==(t=(t=n.relatedTarget||n.toElement)?Qe(t):null)){var u=Z(t);(t!==u||5!==t.tag&&6!==t.tag)&&(t=null)}}else o=null;if(o===t)return null;if("mouseout"===e||"mouseover"===e)var s=iu,l=ou.mouseLeave,c=ou.mouseEnter,f="mouse";else"pointerout"!==e&&"pointerover"!==e||(s=au,l=ou.pointerLeave,c=ou.pointerEnter,f="pointer");if(e=null==o?a:Ye(o),a=null==t?a:Ye(t),l=s.getPooled(l,o,n,r),l.type=f+"leave",l.target=e,l.relatedTarget=a,n=s.getPooled(c,t,n,r),n.type=f+"enter",n.target=a,n.relatedTarget=e,r=o,f=t,r&&f)e:{for(s=r,c=f,o=0,e=s;e;e=Xe(e))o++;for(e=0,t=c;t;t=Xe(t))e++;for(;0<o-e;)s=Xe(s),o--;for(;0<e-o;)c=Xe(c),e--;for(;o--;){if(s===c||s===c.alternate)break e;s=Xe(s),c=Xe(c)}s=null}else s=null;for(c=s,s=[];r&&r!==c&&(null===(o=r.alternate)||o!==c);)s.push(r),r=Xe(r);for(r=[];f&&f!==c&&(null===(o=f.alternate)||o!==c);)r.push(f),f=Xe(f);for(f=0;f<s.length;f++)nt(s[f],"bubbled",l);for(f=r.length;0<f--;)nt(r[f],"captured",n);return 0==(64&i)?[l]:[l,n]}},su="function"==typeof Object.is?Object.is:It,lu=Object.prototype.hasOwnProperty,cu=ta&&"documentMode"in document&&11>=document.documentMode,fu={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},pu=null,du=null,hu=null,mu=!1,vu={eventTypes:fu,extractEvents:function(e,t,n,r,i,a){if(i=a||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument),!(a=!i)){e:{i=X(i),a=ea.onSelect;for(var o=0;o<a.length;o++)if(!i.has(a[o])){i=!1;break e}i=!0}a=!i}if(a)return null;switch(i=t?Ye(t):window,e){case"focus":(vt(i)||"true"===i.contentEditable)&&(pu=i,du=t,hu=null);break;case"blur":hu=du=pu=null;break;case"mousedown":mu=!0;break;case"contextmenu":case"mouseup":case"dragend":return mu=!1,Ft(n,r);case"selectionchange":if(cu)break;case"keydown":case"keyup":return Ft(n,r)}return null}},yu=st.extend({animationName:null,elapsedTime:null,pseudoElement:null}),gu=st.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bu=Xo.extend({relatedTarget:null}),ku={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xu=Xo.extend({key:function(e){if(e.key){var t=ku[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?(e=Ot(e),13===e?"Enter":String.fromCharCode(e)):"keydown"===e.type||"keyup"===e.type?wu[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Pt,charCode:function(e){return"keypress"===e.type?Ot(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Ot(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Su=iu.extend({dataTransfer:null}),Eu=Xo.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Pt}),Cu=st.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),_u=iu.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),Tu={eventTypes:ao,extractEvents:function(e,t,n,r){var i=oo.get(e);if(!i)return null;switch(e){case"keypress":if(0===Ot(n))return null;case"keydown":case"keyup":e=xu;break;case"blur":case"focus":e=bu;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=iu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=Su;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=Eu;break;case Ha:case za:case Wa:e=yu;break;case Ka:e=Cu;break;case"scroll":e=Xo;break;case"wheel":e=_u;break;case"copy":case"cut":case"paste":e=gu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=au;break;default:e=st}return t=e.getPooled(i,t,n,r),it(t),t}};if(Ji)throw Error(r(101));Ji=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),s();var Pu=Je;$i=Ge,qi=Pu,Qi=Ye,c({SimpleEventPlugin:Tu,EnterLeaveEventPlugin:uu,ChangeEventPlugin:Go,SelectEventPlugin:vu,BeforeInputEventPlugin:Vo});var Iu,Ru,Fu,Ou,Du=[],Mu=-1,Nu={},Au={current:Nu},Lu={current:!1},ju=Nu,Uu=Bi.unstable_runWithPriority,Bu=Bi.unstable_scheduleCallback,Hu=Bi.unstable_cancelCallback,zu=Bi.unstable_requestPaint,Wu=Bi.unstable_now,Ku=Bi.unstable_getCurrentPriorityLevel,Vu=Bi.unstable_ImmediatePriority,$u=Bi.unstable_UserBlockingPriority,qu=Bi.unstable_NormalPriority,Qu=Bi.unstable_LowPriority,Ju=Bi.unstable_IdlePriority,Yu={},Gu=Bi.unstable_shouldYield,Xu=void 0!==zu?zu:function(){},Zu=null,es=null,ts=!1,ns=Wu(),rs=1e4>ns?Wu:function(){return Wu()-ns},is={current:null},as=null,os=null,us=null,ss=!1,ls=ha.ReactCurrentBatchConfig,cs=(new ji.Component).refs,fs={isMounted:function(e){return!!(e=e._reactInternalFiber)&&Z(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var r=Lr(),i=ls.suspense;r=jr(r,e,i),i=an(r,i),i.payload=t,void 0!==n&&null!==n&&(i.callback=n),on(e,i),Ur(e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var r=Lr(),i=ls.suspense;r=jr(r,e,i),i=an(r,i),i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),on(e,i),Ur(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=Lr(),r=ls.suspense;n=jr(n,e,r),r=an(n,r),r.tag=2,void 0!==t&&null!==t&&(r.callback=t),on(e,r),Ur(e,n)}},ps=Array.isArray,ds=yn(!0),hs=yn(!1),ms={},vs={current:ms},ys={current:ms},gs={current:ms},bs={current:0},ks=ha.ReactCurrentDispatcher,ws=ha.ReactCurrentBatchConfig,xs=0,Ss=null,Es=null,Cs=null,_s=!1,Ts={readContext:tn,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useLayoutEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useResponder:Cn,useDeferredValue:Cn,useTransition:Cn},Ps={readContext:tn,useCallback:Kn,useContext:tn,useEffect:jn,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,An(4,2,Hn.bind(null,t,e),n)},useLayoutEffect:function(e,t){return An(4,2,e,t)},useMemo:function(e,t){var n=Pn();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Pn();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},e=e.dispatch=Qn.bind(null,Ss,e),[r.memoizedState,e]},useRef:function(e){var t=Pn();return e={current:e},t.memoizedState=e},useState:Dn,useDebugValue:Wn,useResponder:En,useDeferredValue:function(e,t){var n=Dn(e),r=n[0],i=n[1];return jn(function(){var n=ws.suspense;ws.suspense=void 0===t?null:t;try{i(e)}finally{ws.suspense=n}},[e,t]),r},useTransition:function(e){var t=Dn(!1),n=t[0];return t=t[1],[Kn(qn.bind(null,t,e),[t,e]),n]}},Is={readContext:tn,useCallback:Vn,useContext:tn,useEffect:Un,useImperativeHandle:zn,useLayoutEffect:Bn,useMemo:$n,useReducer:Fn,useRef:Nn,useState:function(){return Fn(Rn)},useDebugValue:Wn,useResponder:En,useDeferredValue:function(e,t){var n=Fn(Rn),r=n[0],i=n[1];return Un(function(){var n=ws.suspense;ws.suspense=void 0===t?null:t;try{i(e)}finally{ws.suspense=n}},[e,t]),r},useTransition:function(e){var t=Fn(Rn),n=t[0];return t=t[1],[Vn(qn.bind(null,t,e),[t,e]),n]}},Rs={readContext:tn,useCallback:Vn,useContext:tn,useEffect:Un,useImperativeHandle:zn,useLayoutEffect:Bn,useMemo:$n,useReducer:On,useRef:Nn,useState:function(){return On(Rn)},useDebugValue:Wn,useResponder:En,useDeferredValue:function(e,t){var n=On(Rn),r=n[0],i=n[1];return Un(function(){var n=ws.suspense;ws.suspense=void 0===t?null:t;try{i(e)}finally{ws.suspense=n}},[e,t]),r},useTransition:function(e){var t=On(Rn),n=t[0];return t=t[1],[Vn(qn.bind(null,t,e),[t,e]),n]}},Fs=null,Os=null,Ds=!1,Ms=ha.ReactCurrentOwner,Ns=!1,As={dehydrated:null,retryTime:0};Iu=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ru=function(){},Fu=function(e,t,n,r,i){var a=e.memoizedProps;if(a!==r){var o=t.stateNode;switch(gn(vs.current),e=null,n){case"input":a=M(o,a),r=M(o,r),e=[];break;case"option":a=H(o,a),r=H(o,r),e=[];break;case"select":a=Ui({},a,{value:void 0}),r=Ui({},r,{value:void 0}),e=[];break;case"textarea":a=W(o,a),r=W(o,r),e=[];break;default:"function"!=typeof a.onClick&&"function"==typeof r.onClick&&(o.onclick=Le)}Me(n,r);var u,s;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u)for(s in o=a[u])o.hasOwnProperty(s)&&(n||(n={}),n[s]="");else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(Zi.hasOwnProperty(u)?e||(e=[]):(e=e||[]).push(u,null));for(u in r){var l=r[u];if(o=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(null!=l||null!=o))if("style"===u)if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(e||(e=[]),e.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,o=o?o.__html:void 0,null!=l&&o!==l&&(e=e||[]).push(u,l)):"children"===u?o===l||"string"!=typeof l&&"number"!=typeof l||(e=e||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(Zi.hasOwnProperty(u)?(null!=l&&Ae(i,u),e||o===l||(e=[])):(e=e||[]).push(u,l))}n&&(e=e||[]).push("style",n),i=e,(t.updateQueue=i)&&(t.effectTag|=4)}},Ou=function(e,t,n,r){n!==r&&(t.effectTag|=4)};var Ls,js="function"==typeof WeakSet?WeakSet:Set,Us="function"==typeof WeakMap?WeakMap:Map,Bs=Math.ceil,Hs=ha.ReactCurrentDispatcher,zs=ha.ReactCurrentOwner,Ws=0,Ks=8,Vs=16,$s=32,qs=0,Qs=1,Js=2,Ys=3,Gs=4,Xs=5,Zs=Ws,el=null,tl=null,nl=0,rl=qs,il=null,al=1073741823,ol=1073741823,ul=null,sl=0,ll=!1,cl=0,fl=500,pl=null,dl=!1,hl=null,ml=null,vl=!1,yl=null,gl=90,bl=null,kl=0,wl=null,xl=0;Ls=function(e,t,n){var i=t.expirationTime;if(null!==e){var a=t.pendingProps;if(e.memoizedProps!==a||Lu.current)Ns=!0;else{if(i<n){switch(Ns=!1,t.tag){case 3:lr(t),er();break;case 5:if(wn(t),4&t.mode&&1!==n&&a.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:At(t.type)&&Bt(t);break;case 4:bn(t,t.stateNode.containerInfo);break;case 10:i=t.memoizedProps.value,a=t.type._context,Mt(is,a._currentValue),a._currentValue=i;break;case 13:if(null!==t.memoizedState)return 0!==(i=t.child.childExpirationTime)&&i>=n?cr(e,t,n):(Mt(bs,1&bs.current),t=hr(e,t,n),null!==t?t.sibling:null);Mt(bs,1&bs.current);break;case 19:if(i=t.childExpirationTime>=n,0!=(64&e.effectTag)){if(i)return dr(e,t,n);t.effectTag|=64}if(a=t.memoizedState,null!==a&&(a.rendering=null,a.tail=null),Mt(bs,bs.current),!i)return null}return hr(e,t,n)}Ns=!1}}else Ns=!1;switch(t.expirationTime=0,t.tag){case 2:if(i=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,a=Nt(t,Au.current),en(t,n),a=Tn(null,t,i,e,a,n),t.effectTag|=1,"object"==typeof a&&null!==a&&"function"==typeof a.render&&void 0===a.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,At(i)){var o=!0;Bt(t)}else o=!1;t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,nn(t);var u=i.getDerivedStateFromProps;"function"==typeof u&&cn(t,i,u,e),a.updater=fs,t.stateNode=a,a._reactInternalFiber=t,hn(t,i,e,n),t=sr(null,t,i,!0,o,n)}else t.tag=0,tr(null,t,a,n),t=t.child;return t;case 16:e:{if(a=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,_(a),1!==a._status)throw a._result;switch(a=a._result,t.type=a,o=t.tag=yi(a),e=Yt(a,e),o){case 0:t=or(null,t,a,e,n);break e;case 1:t=ur(null,t,a,e,n);break e;case 11:t=nr(null,t,a,e,n);break e;case 14:t=rr(null,t,a,Yt(a.type,e),i,n);break e}throw Error(r(306,a,""))}return t;case 0:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:Yt(i,a),or(e,t,i,a,n);case 1:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:Yt(i,a),ur(e,t,i,a,n);case 3:if(lr(t),i=t.updateQueue,null===e||null===i)throw Error(r(282));if(i=t.pendingProps,a=t.memoizedState,a=null!==a?a.element:null,rn(e,t),sn(t,i,null,n),(i=t.memoizedState.element)===a)er(),t=hr(e,t,n);else{if((a=t.stateNode.hydrate)&&(Os=$e(t.stateNode.containerInfo.firstChild),Fs=t,a=Ds=!0),a)for(n=hs(t,null,i,n),t.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else tr(e,t,i,n),er();t=t.child}return t;case 5:return wn(t),null===e&&Gn(t),i=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,u=a.children,Ve(i,a)?u=null:null!==o&&Ve(i,o)&&(t.effectTag|=16),ar(e,t),4&t.mode&&1!==n&&a.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(tr(e,t,u,n),t=t.child),t;case 6:return null===e&&Gn(t),null;case 13:return cr(e,t,n);case 4:return bn(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ds(t,null,i,n):tr(e,t,i,n),t.child;case 11:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:Yt(i,a),nr(e,t,i,a,n);case 7:return tr(e,t,t.pendingProps,n),t.child;case 8:case 12:return tr(e,t,t.pendingProps.children,n),t.child;case 10:e:{i=t.type._context,a=t.pendingProps,u=t.memoizedProps,o=a.value;var s=t.type._context;if(Mt(is,s._currentValue),s._currentValue=o,null!==u)if(s=u.value,0===(o=su(s,o)?0:0|("function"==typeof i._calculateChangedBits?i._calculateChangedBits(s,o):1073741823))){if(u.children===a.children&&!Lu.current){t=hr(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){u=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i&&0!=(c.observedBits&o)){1===s.tag&&(c=an(n,null),c.tag=2,on(s,c)),s.expirationTime<n&&(s.expirationTime=n),c=s.alternate,null!==c&&c.expirationTime<n&&(c.expirationTime=n),Zt(s.return,n),l.expirationTime<n&&(l.expirationTime=n);break}c=c.next}}else u=10===s.tag&&s.type===t.type?null:s.child;if(null!==u)u.return=s;else for(u=s;null!==u;){if(u===t){u=null;break}if(null!==(s=u.sibling)){s.return=u.return,u=s;break}u=u.return}s=u}tr(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,o=t.pendingProps,i=o.children,en(t,n),a=tn(a,o.unstable_observedBits),i=i(a),t.effectTag|=1,tr(e,t,i,n),t.child;case 14:return a=t.type,o=Yt(a,t.pendingProps),o=Yt(a.type,o),rr(e,t,a,o,i,n);case 15:return ir(e,t,t.type,t.pendingProps,i,n);case 17:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:Yt(i,a),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,At(i)?(e=!0,Bt(t)):e=!1,en(t,n),pn(t,i,a),hn(t,i,a,n),sr(null,t,i,!0,e,n);case 19:return dr(e,t,n)}throw Error(r(156,t.tag))};var Sl=null,El=null;Oi.prototype.render=function(e){Pi(e,this._internalRoot,null,null)},Oi.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Pi(null,e,null,function(){t[Ro]=null})},ja=function(e){if(13===e.tag){var t=Jt(Lr(),150,100);Ur(e,t),Fi(e,t)}},Ua=function(e){13===e.tag&&(Ur(e,3),Fi(e,3))},Ba=function(e){if(13===e.tag){var t=Lr();t=jr(t,e,null),Ur(e,t),Fi(e,t)}},na=function(e,t,n){switch(t){case"input":if(L(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var a=Ge(i);if(!a)throw Error(r(90));D(i),L(i,a)}}}break;case"textarea":V(e,n);break;case"select":null!=(t=n.value)&&z(e,!!n.multiple,t,!1)}},h=$r,m=function(e,t,n,r,i){var a=Zs;Zs|=4;try{return Kt(98,e.bind(null,t,n,r,i))}finally{(Zs=a)===Ws&&qt()}},v=function(){(Zs&(1|Vs|$s))===Ws&&(Vr(),ui())},aa=function(e,t){var n=Zs;Zs|=2;try{return e(t)}finally{(Zs=n)===Ws&&qt()}};var Cl={Events:[Je,Ye,Ge,c,Xi,it,function(e){ae(e,rt)},p,d,Re,ue,ui,{current:!1}]};!function(e){var t=e.findFiberByHostInstance;di(Ui({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ha.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=re(e),null===e?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:Qe,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"}),t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cl,t.createPortal=Li,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"==typeof e.render)throw Error(r(188));throw Error(r(268,Object.keys(e)))}return e=re(t),e=null===e?null:e.stateNode},t.flushSync=function(e,t){if((Zs&(Vs|$s))!==Ws)throw Error(r(187));var n=Zs;Zs|=1;try{return Kt(99,e.bind(null,t))}finally{Zs=n,qt()}},t.hydrate=function(e,t,n){if(!Di(t))throw Error(r(200));return Ni(null,e,t,!0,n)},t.render=function(e,t,n){if(!Di(t))throw Error(r(200));return Ni(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Di(e))throw Error(r(40));return!!e._reactRootContainer&&(qr(function(){Ni(null,null,e,!1,function(){e._reactRootContainer=null,e[Ro]=null})}),!0)},t.unstable_batchedUpdates=$r,t.unstable_createPortal=function(e,t){return Li(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Di(n))throw Error(r(200));if(null==e||void 0===e._reactInternalFiber)throw Error(r(38));return Ni(e,t,n,!1,i)},t.version="16.13.1"},function(e,t,n){"use strict";e.exports=n(28)},function(e,t,n){"use strict";function r(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function i(e){return e=e[0],void 0===e?null:e}function a(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var a=2*(r+1)-1,u=e[a],s=a+1,l=e[s];if(void 0!==u&&0>o(u,n))void 0!==l&&0>o(l,u)?(e[r]=l,e[s]=n,r=s):(e[r]=u,e[a]=n,r=a);else{if(!(void 0!==l&&0>o(l,n)))break e;e[r]=l,e[s]=n,r=s}}}return t}return null}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}function u(e){for(var t=i(M);null!==t;){if(null===t.callback)a(M);else{if(!(t.startTime<=e))break;a(M),t.sortIndex=t.expirationTime,r(D,t)}t=i(M)}}function s(e){if(B=!1,u(e),!U)if(null!==i(D))U=!0,f(l);else{var t=i(M);null!==t&&p(s,t.startTime-e)}}function l(e,n){U=!1,B&&(B=!1,d()),j=!0;var r=L;try{for(u(n),A=i(D);null!==A&&(!(A.expirationTime>n)||e&&!h());){var o=A.callback;if(null!==o){A.callback=null,L=A.priorityLevel;var l=o(A.expirationTime<=n);n=t.unstable_now(),"function"==typeof l?A.callback=l:A===i(D)&&a(D),u(n)}else a(D);A=i(D)}if(null!==A)var c=!0;else{var f=i(M);null!==f&&p(s,f.startTime-n),c=!1}return c}finally{A=null,L=r,j=!1}}function c(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}/** @license React v0.19.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var f,p,d,h,m;if("undefined"==typeof window||"function"!=typeof MessageChannel){var v=null,y=null,g=function(){if(null!==v)try{var e=t.unstable_now();v(!0,e),v=null}catch(e){throw setTimeout(g,0),e}},b=Date.now();t.unstable_now=function(){return Date.now()-b},f=function(e){null!==v?setTimeout(f,0,e):(v=e,setTimeout(g,0))},p=function(e,t){y=setTimeout(e,t)},d=function(){clearTimeout(y)},h=function(){return!1},m=t.unstable_forceFrameRate=function(){}}else{var k=window.performance,w=window.Date,x=window.setTimeout,S=window.clearTimeout;if("undefined"!=typeof console){var E=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof E&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"==typeof k&&"function"==typeof k.now)t.unstable_now=function(){return k.now()};else{var C=w.now();t.unstable_now=function(){return w.now()-C}}var _=!1,T=null,P=-1,I=5,R=0;h=function(){return t.unstable_now()>=R},m=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):I=0<e?Math.floor(1e3/e):5};var F=new MessageChannel,O=F.port2;F.port1.onmessage=function(){if(null!==T){var e=t.unstable_now();R=e+I;try{T(!0,e)?O.postMessage(null):(_=!1,T=null)}catch(e){throw O.postMessage(null),e}}else _=!1},f=function(e){T=e,_||(_=!0,O.postMessage(null))},p=function(e,n){P=x(function(){e(t.unstable_now())},n)},d=function(){S(P),P=-1}}var D=[],M=[],N=1,A=null,L=3,j=!1,U=!1,B=!1,H=m;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){U||j||(U=!0,f(l))},t.unstable_getCurrentPriorityLevel=function(){return L},t.unstable_getFirstCallbackNode=function(){return i(D)},t.unstable_next=function(e){switch(L){case 1:case 2:case 3:var t=3;break;default:t=L}var n=L;L=t;try{return e()}finally{L=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=H,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=L;L=e;try{return t()}finally{L=n}},t.unstable_scheduleCallback=function(e,n,a){var o=t.unstable_now();if("object"==typeof a&&null!==a){var u=a.delay;u="number"==typeof u&&0<u?o+u:o,a="number"==typeof a.timeout?a.timeout:c(e)}else a=c(e),u=o;return a=u+a,e={id:N++,callback:n,priorityLevel:e,startTime:u,expirationTime:a,sortIndex:-1},u>o?(e.sortIndex=u,r(M,e),null===i(D)&&e===i(M)&&(B?d():B=!0,p(s,u-o))):(e.sortIndex=a,r(D,e),U||j||(U=!0,f(l))),e},t.unstable_shouldYield=function(){var e=t.unstable_now();u(e);var n=i(D);return n!==A&&null!==A&&null!==n&&null!==n.callback&&n.startTime<=e&&n.expirationTime<A.expirationTime||h()},t.unstable_wrapCallback=function(e){var t=L;return function(){var n=L;L=t;try{return e.apply(this,arguments)}finally{L=n}}}},function(e,t,n){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return o});var o=function(){function e(){r(this,e)}return a(e,null,[{key:"htmlToText",value:function(e){var t=document.implementation.createHTMLDocument("New").body;return t.innerHTML=e,t.textContent||t.innerText||""}},{key:"truncateString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:90;return e.length<=t?e:e.substring(0,t)+"..."}},{key:"sleep",value:function(e){return new Promise(function(t,n){setTimeout(function(){t()},1e3*e)})}}]),e}()},function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){function o(e){r(s,i,a,o,u,"next",e)}function u(e){r(s,i,a,o,u,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"EditorKit",function(){return c});var s=n(2),l=n(8);n.d(t,"EditorKitDelegate",function(){return l.a});var c=function(){function e(t){var n=t.delegate,r=t.mode,i=void 0===r?"plaintext":r,o=t.supportsFilesafe,u=void 0!==o&&o,l=t.coallesedSavingDelay,c=void 0===l?250:l;a(this,e),this.delegate=n,this.mode=i,this.supportsFilesafe=u,this.coallesedSavingDelay=c,this.internal=new s.a({delegate:n,mode:i,supportsFilesafe:u,coallesedSavingDelay:c})}return u(e,[{key:"getFilesafe",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.internal.getFilesafe());case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"onEditorValueChanged",value:function(e){this.internal.onEditorValueChanged(e)}},{key:"onEditorKeyUp",value:function(e){var t=e.key,n=e.isSpace,r=e.isEnter;this.internal.onEditorKeyUp({key:t,isSpace:n,isEnter:r})}},{key:"onEditorPaste",value:function(){this.internal.onEditorPaste()}},{key:"canUploadFiles",value:function(){return this.internal.canUploadFiles()}},{key:"uploadJSFileObject",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.internal.uploadJSFileObject(t));case 1:case"end":return e.stop()}},e,this)}));return e}()}]),e}()},function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){function o(e){r(s,i,a,o,u,"next",e)}function u(e){r(s,i,a,o,u,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",function(){return h});var s=n(3),l=n.n(s),c=n(0),f=n(4),p=n(5),d=n(6),h=function(){function e(t){var n=t.delegate,r=t.mode,i=t.supportsFilesafe,o=t.coallesedSavingDelay,u=void 0===o?250:o;a(this,e),this.delegate=n,this.mode=r,this.supportsFilesafe=i,this.coallesedSavingDelay=u,this.fileIdsPendingAssociation=[],this.connectToBridge(),i&&(this.filesafeImportPromise=this.importFilesafe())}return u(e,[{key:"importFilesafe",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){e()}).then(n.bind(null,7)).then(function(e){return t.FilesafeClass=e.default,t.configureFilesafe(),t.filesafe}));case 1:case"end":return e.stop()}},e)}));return e}()},{key:"getFilesafe",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.filesafe&&!this.filesafeImportPromise){e.next=5;break}if(!this.filesafeImportPromise){e.next=3;break}return e.abrupt("return",this.filesafeImportPromise);case 3:e.next=6;break;case 5:return e.abrupt("return",this.importFilesafe());case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"configureFilesafe",value:function(){var e=this;this.filesafe=new this.FilesafeClass({componentManager:this.componentManager}),this.filesafe.addDataChangeObserver(function(){var t=e.filesafe.getAllFileDescriptors();if(e.note&&e.fileIdsPendingAssociation.length>0){var n=!1,r=!0,i=!1,a=void 0;try{for(var o,u=e.fileIdsPendingAssociation.slice()[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){(function(){var r=o.value,i=t.find(function(e){return e.uuid==r});if(!i)return"continue";n=!0,e.fileIdsPendingAssociation.splice(e.fileIdsPendingAssociation.indexOf(r),1);var a=d.a.insertionSyntaxForFileDescriptor(i);e.delegate.insertRawText(a)})()}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}n&&e.textExpander.searchPatterns()}t.length>0&&e.fileLoader.loadFilesafeElements()}),this.filesafe.addNewFileDescriptorHandler(function(t){e.fileIdsPendingAssociation.push(t.uuid)}),this.fileLoader=new f.a({filesafe:this.filesafe,getElementsBySelector:this.delegate.getElementsBySelector,insertElement:this.delegate.insertElement,preprocessElement:this.delegate.preprocessElement}),this.textExpander=new p.a({afterExpand:function(){e.fileLoader.loadFilesafeElements()},getCurrentLineText:this.delegate.getCurrentLineText,getPreviousLineText:this.delegate.getPreviousLineText,replaceText:this.delegate.replaceText,patterns:[{regex:d.a.FilesafeSyntaxPattern,callback:function(e){return d.a.expandedFilesafeSyntax(e)}}]})}},{key:"connectToBridge",value:function(){var e=this;this.componentManager=new l.a(null,function(){document.documentElement.classList.add(e.componentManager.platform)}),this.componentManager.coallesedSavingDelay=this.coallesedSavingDelay,this.componentManager.streamContextItem(function(t){var n=e.FilesafeClass.getSFItemClass(),r=!0;if(e.note&&e.note.uuid==t.uuid&&(r=!1),e.note=new n(t),e.supportsFilesafe&&e.filesafe.setCurrentNote(e.note),!t.isMetadataUpdate){var i=t.content.text;if("html"==e.mode&&r){/<[a-z][\s\S]*>/i.test(i)||(e.ignoreNextTextChange=!0)}e.previousText=i,e.supportsFilesafe&&(e.needsFilesafeElementLoad=!0,i=d.a.expandedFilesafeSyntax(i)),e.delegate.setEditorRawText(i),r&&e.delegate.clearUndoHistory()}})}},{key:"onEditorKeyUp",value:function(e){var t=e.key,n=e.isSpace,r=e.isEnter;this.textExpander.onKeyUp({key:t,isSpace:n,isEnter:r})}},{key:"onEditorPaste",value:function(){this.textExpander.onKeyUp({isPaste:!0})}},{key:"onEditorValueChanged",value:function(e){var t=this;if(this.needsFilesafeElementLoad&&(this.needsFilesafeElementLoad=!1,this.fileLoader.loadFilesafeElements()),this.ignoreNextTextChange)return void(this.ignoreNextTextChange=!1);if(this.supportsFilesafe){e=d.a.collapseFilesafeSyntax(e);if(this.previousText==e)return}this.previousText=e;var n=this.note;n&&this.componentManager.saveItemWithPresave(n,function(){if(n.content.text=e,t.delegate.generateCustomPreview){var r=t.delegate.generateCustomPreview(e);r.html?(n.content.preview_html=r.html,n.content.preview_plain=null):r.plain&&(n.content.preview_plain=r.plain,n.content.preview_html=null)}else{if("html"==t.mode){var i=d.a.removeFilesafeSyntaxFromHtml(e);i=c.a.truncateString(c.a.htmlToText(i)),n.content.preview_plain=i.length>0?i:" "}else n.content.preview_plain=e;n.content.preview_html=null}})}},{key:"canUploadFiles",value:function(){var e=this.filesafe.getAllCredentials(),t=this.filesafe.getAllIntegrations();return e.length>0&&t.length>0}},{key:"uploadJSFileObject",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.fileLoader.insertStatusAtCursor("Processing file..."),e.abrupt("return",this.filesafe.encryptAndUploadJavaScriptFileObject(t).then(function(e){r.fileLoader.removeCursorStatus(n)}));case 2:case"end":return e.stop()}},e,this)}));return e}()}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t,n){r(this,e),this.sentMessages=[],this.messageQueue=[],this.loggingEnabled=!1,this.acceptsThemes=!0,this.activeThemes=[],this.initialPermissions=t,this.onReadyCallback=n,this.coallesedSaving=!0,this.coallesedSavingDelay=250,this.registerMessageHandler()}return i(e,[{key:"registerMessageHandler",value:function(){var e=this,t=function(t){e.loggingEnabled&&console.log("Components API Message received:",t.data),e.origin||(e.origin=t.origin);var n=t.data,r="string"==typeof n?JSON.parse(n):n;e.handleMessage(r)};document.addEventListener("message",function(e){t(e)},!1),window.addEventListener("message",function(e){t(e)},!1)}},{key:"handleMessage",value:function(e){if("component-registered"===e.action)this.sessionKey=e.sessionKey,this.componentData=e.componentData,this.onReady(e.data),this.loggingEnabled&&console.log("Component successfully registered with payload:",e);else if("themes"===e.action)this.acceptsThemes&&this.activateThemes(e.data.themes);else if(e.original){var t=this.sentMessages.filter(function(t){return t.messageId===e.original.messageId})[0];t||alert("This extension is attempting to communicate with Standard Notes, but an error is preventing it from doing so. Please restart this extension and try again."),t.callback&&t.callback(e.data)}}},{key:"onReady",value:function(e){this.environment=e.environment,this.platform=e.platform,this.uuid=e.uuid,this.isMobile="mobile"==this.environment,this.initialPermissions&&this.initialPermissions.length>0&&this.requestPermissions(this.initialPermissions);var t=!0,n=!1,r=void 0;try{for(var i,a=this.messageQueue[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.postMessage(o.action,o.data,o.callback)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}this.messageQueue=[],this.loggingEnabled&&console.log("onReadyData",e),this.activateThemes(e.activeThemeUrls||[]),this.onReadyCallback&&this.onReadyCallback()}},{key:"getSelfComponentUUID",value:function(){return this.uuid}},{key:"isRunningInDesktopApplication",value:function(){return"desktop"===this.environment}},{key:"setComponentDataValueForKey",value:function(e,t){this.componentData[e]=t,this.postMessage("set-component-data",{componentData:this.componentData},function(e){})}},{key:"clearComponentData",value:function(){this.componentData={},this.postMessage("set-component-data",{componentData:this.componentData},function(e){})}},{key:"componentDataValueForKey",value:function(e){return this.componentData[e]}},{key:"postMessage",value:function(e,t,n){if(!this.sessionKey)return void this.messageQueue.push({action:e,data:t,callback:n});var r={action:e,data:t,messageId:this.generateUUID(),sessionKey:this.sessionKey,api:"component"},i=JSON.parse(JSON.stringify(r));i.callback=n,this.sentMessages.push(i),this.isMobile&&(r=JSON.stringify(r)),this.loggingEnabled&&console.log("Posting message:",r),window.parent.postMessage(r,this.origin)}},{key:"setSize",value:function(e,t,n){this.postMessage("set-size",{type:e,width:t,height:n},function(e){})}},{key:"requestPermissions",value:function(e,t){this.postMessage("request-permissions",{permissions:e},function(e){t&&t()}.bind(this))}},{key:"streamItems",value:function(e,t){Array.isArray(e)||(e=[e]),this.postMessage("stream-items",{content_types:e},function(e){t(e.items)}.bind(this))}},{key:"streamContextItem",value:function(e){var t=this;this.postMessage("stream-context-item",null,function(n){var r=n.item;(!t.lastStreamedItem||t.lastStreamedItem.uuid!==r.uuid)&&t.pendingSaveTimeout&&(clearTimeout(t.pendingSaveTimeout),t._performSavingOfItems(t.pendingSaveParams),t.pendingSaveTimeout=null,t.pendingSaveParams=null),t.lastStreamedItem=r,e(t.lastStreamedItem)})}},{key:"selectItem",value:function(e){this.postMessage("select-item",{item:this.jsonObjectForItem(e)})}},{key:"createItem",value:function(e,t){this.postMessage("create-item",{item:this.jsonObjectForItem(e)},function(e){var n=e.item;!n&&e.items&&e.items.length>0&&(n=e.items[0]),this.associateItem(n),t&&t(n)}.bind(this))}},{key:"createItems",value:function(e,t){var n=this,r=e.map(function(e){return n.jsonObjectForItem(e)});this.postMessage("create-items",{items:r},function(e){t&&t(e.items)}.bind(this))}},{key:"associateItem",value:function(e){this.postMessage("associate-item",{item:this.jsonObjectForItem(e)})}},{key:"deassociateItem",value:function(e){this.postMessage("deassociate-item",{item:this.jsonObjectForItem(e)})}},{key:"clearSelection",value:function(){this.postMessage("clear-selection",{content_type:"Tag"})}},{key:"deleteItem",value:function(e,t){this.deleteItems([e],t)}},{key:"deleteItems",value:function(e,t){var n={items:e.map(function(e){return this.jsonObjectForItem(e)}.bind(this))};this.postMessage("delete-items",n,function(e){t&&t(e)})}},{key:"sendCustomEvent",value:function(e,t,n){this.postMessage(e,t,function(e){n&&n(e)}.bind(this))}},{key:"saveItem",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.saveItems([e],t,n)}},{key:"saveItemWithPresave",value:function(e,t,n){this.saveItemsWithPresave([e],t,n)}},{key:"saveItemsWithPresave",value:function(e,t,n){this.saveItems(e,n,!1,t)}},{key:"_performSavingOfItems",value:function(e){var t=e.items,n=e.presave,r=e.callback;n&&n();var i=[],a=!0,o=!1,u=void 0;try{for(var s,l=t[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;i.push(this.jsonObjectForItem(c))}}catch(e){o=!0,u=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw u}}this.postMessage("save-items",{items:i},function(e){r&&r()})}},{key:"saveItems",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments[3];if(this.pendingSaveItems||(this.pendingSaveItems=[]),1!=this.coallesedSaving||r)this._performSavingOfItems({items:e,presave:i,callback:t});else{this.pendingSaveTimeout&&clearTimeout(this.pendingSaveTimeout);var a=e.map(function(e){return e.uuid}),o=this.pendingSaveItems.filter(function(e){return!a.includes(e.uuid)});this.pendingSaveItems=o.concat(e),this.pendingSaveParams={items:this.pendingSaveItems,presave:i,callback:t},this.pendingSaveTimeout=setTimeout(function(){n._performSavingOfItems(n.pendingSaveParams),n.pendingSaveItems=[],n.pendingSaveTimeout=null,n.pendingSaveParams=null},this.coallesedSavingDelay)}}},{key:"jsonObjectForItem",value:function(e){var t=Object.assign({},e);return t.children=null,t.parent=null,t}},{key:"getItemAppDataValue",value:function(e,t){var n=e.content.appData&&e.content.appData["org.standardnotes.sn"];return n?n[t]:null}},{key:"activateThemes",value:function(e){if(this.loggingEnabled&&console.log("Incoming themes",e),this.activeThemes.sort().toString()!=e.sort().toString()){var t=e||[],n=[],r=!0,i=!1,a=void 0;try{for(var o,u=this.activeThemes[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;e.includes(s)?t=t.filter(function(e){return e!=s}):n.push(s)}}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}this.loggingEnabled&&(console.log("Deactivating themes:",n),console.log("Activating themes:",t));var l=!0,c=!1,f=void 0;try{for(var p,d=n[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var h=p.value;this.deactivateTheme(h)}}catch(e){c=!0,f=e}finally{try{!l&&d.return&&d.return()}finally{if(c)throw f}}this.activeThemes=e;var m=!0,v=!1,y=void 0;try{for(var g,b=t[Symbol.iterator]();!(m=(g=b.next()).done);m=!0){var k=g.value;if(k){var w=document.createElement("link");w.id=btoa(k),w.href=k,w.type="text/css",w.rel="stylesheet",w.media="screen,print",w.className="custom-theme",document.getElementsByTagName("head")[0].appendChild(w)}}}catch(e){v=!0,y=e}finally{try{!m&&b.return&&b.return()}finally{if(v)throw y}}}}},{key:"themeElementForUrl",value:function(e){return Array.from(document.getElementsByClassName("custom-theme")).slice().find(function(t){return t.id==btoa(e)})}},{key:"deactivateTheme",value:function(e){var t=this.themeElementForUrl(e);t&&(t.disabled=!0,t.parentNode.removeChild(t))}},{key:"generateUUID",value:function(){var e=window.crypto||window.msCrypto;if(e){var t=new Uint32Array(4);e.getRandomValues(t);var n=-1;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){n++;var r=t[n>>3]>>n%8*4&15;return("x"==e?r:3&r|8).toString(16)})}var r=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(r+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==e?t:3&t|8).toString(16)})}}]),e}();void 0!==e&&void 0!==e.exports&&(e.exports=a),window&&(window.ComponentManager=a)},function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){function o(e){r(s,i,a,o,u,"next",e)}function u(e){r(s,i,a,o,u,"throw",e)}var s=e.apply(t,n);o(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}n.d(t,"a",function(){return l});var s=n(0),l=function(){function e(t){var n=t.filesafe,r=t.getElementsBySelector,i=t.preprocessElement,o=t.insertElement;a(this,e),this.filesafe=n,this.getElementsBySelector=r,this.insertElement=o,this.preprocessElement=i,this.uuidToFileTempUrlAndTypeMapping={},this.currentlyLoadingIds=[],this.statusElementMapping={},this.fileTypeToElementType={"image/png":"img","image/jpg":"img","image/jpeg":"img","image/gif":"img","image/tiff":"img","image/bmp":"img","video/mp4":"video","audio/mpeg":"audio","audio/mp3":"audio"}}return u(e,[{key:"fileTypeForElementType",value:function(e){return this.fileTypeToElementType[e.toLowerCase()]}},{key:"loadFilesafeElements",value:function(){var e=this.getElementsBySelector("*[fsplaceholder]"),t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.loadFilesafeElement(o)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"loadFilesafeElement",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,u,l,c,f,p,d,h,m=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.getAttribute("fsid"),r=t.getAttribute("fsname"),i=r&&"undefined"!=r?r:"file",!(a=this.uuidToFileTempUrlAndTypeMapping[n])){e.next=7;break}return this.insertMediaElement({url:a.url,fsid:n,fileType:a.fileType,fsname:a.fsname,fsElement:t}),e.abrupt("return");case 7:if(!this.currentlyLoadingIds.includes(n)){e.next=9;break}return e.abrupt("return");case 9:if(o=this.filesafe.findFileDescriptor(n)){e.next=13;break}return this.setStatus("Unable to find ".concat(i," ").concat(n,"."),t,n,r,!0),e.abrupt("return",{success:!1});case 13:if(u='[fsid="'.concat(o.uuid,'"][fscollapsable]'),l=document.querySelectorAll("img".concat(u,", figure").concat(u,", video").concat(u,", audio").concat(u)),!(l.length>0)){e.next=17;break}return e.abrupt("return",{success:!1});case 17:return c=function(){m.currentlyLoadingIds.splice(m.currentlyLoadingIds.indexOf(n),1)},this.currentlyLoadingIds.push(n),this.setStatus("Downloading ".concat(i,"..."),t,n,r),e.next=22,s.a.sleep(.05);case 22:return e.next=24,this.filesafe.downloadFileFromDescriptor(o).catch(function(e){m.setStatus("Unable to download ".concat(i," ").concat(n,"."),t,n,r)});case 24:if(f=e.sent){e.next=27;break}return e.abrupt("return");case 27:return this.setStatus("Decrypting ".concat(i,"..."),t,n,r),e.next=30,s.a.sleep(.05);case 30:return e.next=32,this.filesafe.decryptFile({fileDescriptor:o,fileItem:f}).catch(function(e){m.setStatus("Unable to decrypt ".concat(i," ").concat(n,"."),t,n,r)});case 32:if(p=e.sent){e.next=35;break}return e.abrupt("return");case 35:return this.setStatus(null,t,n),e.next=38,s.a.sleep(.05);case 38:return d=o.content.fileType,h=this.filesafe.createTemporaryFileUrl({base64Data:p.decryptedData,dataType:d}),this.insertMediaElement({url:h,fsid:n,fileType:d,fsname:r,fsElement:t}),c(),this.uuidToFileTempUrlAndTypeMapping[n]={url:h,fileType:d,fsname:r},e.abrupt("return",{success:!0});case 44:case"end":return e.stop()}},e,this)}));return e}()},{key:"insertMediaElement",value:function(e){var t,n=e.url,r=e.fsid,i=e.fsname,a=e.fileType,o=e.fsElement,u=this.fileTypeForElementType(a);return t="img"==u?this.createImageElement({url:n,fsid:r,fsname:i,fsElement:o}):"video"==u?this.createVideoElement({url:n,fsid:r,fileType:a,fsname:i,fsElement:o}):"audio"==u?this.createAudioElement({url:n,fsid:r,fsname:i}):this.createDownloadElement({url:n,fsid:r,fileType:a,fsname:i,fsElement:o}),this.insertElementNearElement(t,o),o.remove(),!0}},{key:"wrapElementInTag",value:function(e){var t=e.element,n=e.tagName,r=e.fsid,i=e.fsname,a=document.createElement(n);return a.setAttribute("fsid",r),a.setAttribute("fsname",i),a.setAttribute("fscollapsable",!0),a.setAttribute("contenteditable",!0),a.append(t),a}},{key:"basicwrapElementInTag",value:function(e,t){var n=document.createElement(t);return n.append(e),n}},{key:"createImageElement",value:function(e){var t=e.url,n=e.fsid,r=e.fsname,i=e.fsElement,a=document.createElement("img");return a.setAttribute("src",t),a.setAttribute("srcset","".concat(t," 2x")),a.setAttribute("fsid",n),a.setAttribute("fsname",r),a.setAttribute("fscollapsable",!0),i.getAttribute("width")&&(a.setAttribute("width",i.getAttribute("width")),a.setAttribute("height",i.getAttribute("height"))),a}},{key:"createVideoElement",value:function(e){var t=e.url,n=e.fsid,r=e.fileType,i=e.fsname,a=e.fsElement,o=document.createElement("video");o.setAttribute("controls",!0),o.setAttribute("fsid",n),o.setAttribute("fsname",i),o.setAttribute("fscollapsable",!0),a.getAttribute("width")&&(o.setAttribute("width",a.getAttribute("width")),o.setAttribute("height",a.getAttribute("height")));var u=document.createElement("source");return u.setAttribute("src",t),u.setAttribute("type",r),o.append(u),this.wrapElementInTag({element:o,tagName:"p",fsid:n,fsname:i})}},{key:"createDownloadElement",value:function(e){var t=e.url,n=e.fsid,r=(e.fileType,e.fsname),i=(e.fsElement,document.createElement("a"));return i.setAttribute("fsid",n),i.setAttribute("fsname",r),i.setAttribute("ghost","true"),i.setAttribute("fscollapsable",!0),i.setAttribute("href",t),i.textContent="".concat(r),i}},{key:"createAudioElement",value:function(e){var t=e.url,n=e.fsid,r=e.fsname,i=document.createElement("audio");return i.setAttribute("src",t),i.setAttribute("controls",!0),i.setAttribute("fsid",n),i.setAttribute("fsname",r),i.setAttribute("fscollapsable",!0),this.wrapElementInTag({element:i,tagName:"p",fsid:n,fsname:r})}},{key:"setStatus",value:function(e,t,n,r,i){if(n){var a=this.statusElementMapping[n];a&&(a.remove(),delete this.statusElementMapping[n])}if(e){var o=document.createElement("label");return o.setAttribute("id",n),o.setAttribute("ghost","true"),o.setAttribute("contenteditable",!1),o.style.fontWeight="bold",o.textContent=e,i&&(o.style.userSelect="all"),o=this.insertElementNearElement(o,t),n&&(this.statusElementMapping[n]=o),o}}},{key:"insertStatusAtCursor",value:function(e){var t=Math.random().toString(36).substring(7);return this.setStatus(e,null,t),t}},{key:"removeCursorStatus",value:function(e){var t=this.getElementsBySelector("#".concat(e));t.length>0&&t[0].remove()}},{key:"insertElementNearElement",value:function(e,t){var n=this.preprocessElement(e),r="child";if("figure"==n.tagName.toLowerCase()){var i=t.closest("p");i&&(t=i,r="afterend")}return this.insertElement(n,t,r),n}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return o});var o=function(){function e(t){var n=t.patterns,i=t.afterExpand,a=t.beforeExpand,o=t.getCurrentLineText,u=t.getPreviousLineText,s=t.replaceText;r(this,e),this.patterns=n,this.afterExpand=i,this.beforeExpand=a,this.getCurrentLineText=o,this.getPreviousLineText=u,this.replaceText=s}return a(e,[{key:"onKeyUp",value:function(e){var t=(e.key,e.isSpace),n=e.isEnter,r=e.isPaste;(t||n||r)&&this.searchPatterns({searchPreviousLine:n})}},{key:"searchPatterns",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.searchPreviousLine;e=n?this.getPreviousLineText():this.getCurrentLineText();var r=!0,i=!1,a=void 0;try{for(var o,u=this.patterns[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=s.regex.exec(e);if(l){var c=l[0];if(c){var f=s.callback(c);this.replaceSelection(s.regex,f,n)}}}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"replaceSelection",value:function(e,t,n){this.beforeExpand&&this.beforeExpand(),this.replaceText({regex:e,replacement:t,previousLine:n}),this.afterExpand&&this.afterExpand()}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return o});var o=function(){function e(){r(this,e)}return a(e,null,[{key:"expandedFilesafeSyntax",value:function(e){var t=this;return e.replace(this.FilesafeSyntaxPattern,function(e){return t.filesafeSyntaxToHtmlElement(e)})}},{key:"removeFilesafeSyntaxFromHtml",value:function(e){return e.replace(this.FilesafeSyntaxPattern,function(e){return""})}},{key:"insertionSyntaxForFileDescriptor",value:function(e){return"[FileSafe:".concat(e.uuid,":").concat(e.content.fileName,"]")}},{key:"filesafeSyntaxToHtmlElement",value:function(e){e=e.replace("<p>",""),e=e.replace("</p>",""),e=e.replace("[","").replace("]","");var t=e.split(":"),n=t[1],r=t[2],i=t[3],a="";if(i){var o=i.split("x");a="width=".concat(o[0]," height=").concat(o[1])}return"<p fsplaceholder=true style='display: none;' fscollapsable=true ghost=true fsid='".concat(n,"' fsname='").concat(r,"' ").concat(a,"></p>")}},{key:"collapseFilesafeSyntax",value:function(e){var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("*[fscollapsable]"),r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=s.getAttribute("fsid"),c=s.getAttribute("fsname"),f=s.getAttribute("width"),p=s.getAttribute("height"),d=["FileSafe",l,c];if(f||p){var h="".concat(f,"x").concat(p);d.push(h)}var m="<p>[".concat(d.join(":"),"]</p>");s.insertAdjacentHTML("afterend",m),s.remove()}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return t.querySelectorAll("*[ghost]").forEach(function(e){e.remove()}),t.body.innerHTML}}]),e}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(o,"FilesafeSyntaxPattern",/(<p>)?\[FileSafe[^\]]*\](<\/p>)?/g)},function(e,t){e.exports=n(5)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return i});var i=function e(t){var n=t.insertRawText,i=t.onReceiveNote,a=t.setEditorRawText,o=t.getCurrentLineText,u=t.getPreviousLineText,s=t.replaceText,l=t.getElementsBySelector,c=t.insertElement,f=t.preprocessElement,p=t.clearUndoHistory,d=t.generateCustomPreview;r(this,e),this.insertRawText=n,this.onReceiveNote=i,this.setEditorRawText=a,this.getCurrentLineText=o,this.getPreviousLineText=u,this.replaceText=s,this.getElementsBySelector=l,this.insertElement=c,this.preprocessElement=f,this.clearUndoHistory=p,this.generateCustomPreview=d}}])},function(e,t){}]);